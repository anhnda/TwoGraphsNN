class Net52(torch.nn.Module):
    def __init__(self, numNode=10000, numAtomFeature=0):
        super(Net52, self).__init__()

        self.convD1 = SAGEConv(config.EMBED_DIM, config.EMBED_DIM)  # SAGEConv(config.EMBED_DIM, config.EMBED_DIM)
        self.convD2 = SAGEConv(config.EMBED_DIM, config.EMBED_DIM)  # SAGEConv(config.EMBED_DIM, config.EMBED_DIM)
        self.convD3 = SAGEConv(config.EMBED_DIM, config.EMBED_DIM)  # SAGEConv(config.EMBED_DIM, config.EMBED_DIM)

        # self.my_reset_params(self.convD1.weight, config.EMBED_DIM)
        # self.my_reset_params(self.convD1.bias, config.EMBED_DIM)
        #
        # self.my_reset_params(self.convD2.weight, config.EMBED_DIM)
        # self.my_reset_params(self.convD2.bias, config.EMBED_DIM)

        self.convS1 = SAGEConv(config.EMBED_DIM, config.EMBED_DIM)  # SAGEConv(config.EMBED_DIM, config.EMBED_DIM)
        self.convS2 = SAGEConv(config.EMBED_DIM, config.EMBED_DIM)  # SAGEConv(config.EMBED_DIM, config.EMBED_DIM)

        # self.my_reset_params(self.convS1.weight, config.EMBED_DIM)
        # self.my_reset_params(self.convS1.bias, config.EMBED_DIM)
        #
        # self.my_reset_params(self.convS2.weight, config.EMBED_DIM)
        # self.my_reset_params(self.convS2.bias, config.EMBED_DIM)


        self.L1 = Linear(config.CHEM_FINGERPRINT_SIZE, config.EMBED_DIM * 2)
        self.L1C = Linear(config.CHEM_FINGERPRINT_SIZE + config.EMBED_DIM, config.EMBED_DIM * 2)
        self.actL1 = F.relu
        self.L2 = Linear(config.EMBED_DIM * 2, config.EMBED_DIM)
        self.actL2 = F.relu

        self.linear1 = Linear(config.EMBED_DIM * 2, config.EMBED_DIM)
        self.act1 = F.relu
        self.linear2 = Linear(config.EMBED_DIM, 1)
        self.act2 = F.relu

        self.nodesEmbedding = torch.nn.Embedding(num_embeddings=numNode + 1, embedding_dim=config.EMBED_DIM)
        self.nodesEmbedding.weight.data.uniform_(0.001, 0.3)

        # Molecule graph neural net

        self.mlinear1 = Linear(numAtomFeature, config.EMBED_DIM * 2)
        self.mact1 = F.relu
        self.mlinear2 = Linear(config.EMBED_DIM * 2, config.EMBED_DIM)
        self.mact2 = F.relu

        self.conv1 = EATConv(config.EMBED_DIM, config.EMBED_DIM, extProb=config.CROSS_PROB)
        self.conv1g = GATConv(config.EMBED_DIM, config.EMBED_DIM)

        self.pool1 = TopKPooling(config.EMBED_DIM, ratio=1)
        self.conv2 = EATConv(config.EMBED_DIM, config.EMBED_DIM, extProb=config.CROSS_PROB)
        self.conv2g = GATConv(config.EMBED_DIM, config.EMBED_DIM)

        self.pool2 = TopKPooling(config.EMBED_DIM, ratio=1)
        self.conv3 = EATConv(config.EMBED_DIM, config.EMBED_DIM, extProb=config.CROSS_PROB)
        self.conv3g = GATConv(config.EMBED_DIM, config.EMBED_DIM)



        self.pool3 = TopKPooling(config.EMBED_DIM, ratio=1)

        self.conv4= EATConv(config.EMBED_DIM, config.EMBED_DIM, extProb=config.CROSS_PROB)
        self.conv4g = GATConv(config.EMBED_DIM, config.EMBED_DIM)
        self.pool4 = TopKPooling(config.EMBED_DIM, ratio=1)

        self.conv5 = EATConv(config.EMBED_DIM, config.EMBED_DIM, extProb=config.CROSS_PROB)
        self.conv5g = GATConv(config.EMBED_DIM, config.EMBED_DIM)
        self.pool5 = TopKPooling(config.EMBED_DIM, ratio=1)

        self.lin1 = torch.nn.Linear(config.EMBED_DIM * 2, config.EMBED_DIM)
        self.lin2 = torch.nn.Linear(config.EMBED_DIM, config.EMBED_DIM)

        self.bn1 = torch.nn.BatchNorm1d(128)
        self.bn2 = torch.nn.BatchNorm1d(64)
        self.act1 = torch.nn.ReLU()
        self.act2 = torch.nn.ReLU()

    def my_reset_params(self, tensor, size=10):
        bound = 1.0 / math.sqrt(size)
        if tensor is not None:
            tensor.data.uniform_(0.0, bound)

    def forward(self, x, drugEdges, seEdges, drugNodes, seNodes, proteinNodes, proteinWeight, drugGraphBatch, nDrug, drugFeatures = None):


        if config.INNER_FEATURE and drugFeatures is not None:
            nDrug = drugFeatures.shape[0]


            xDrug = self.L1(drugFeatures)
            xDrug = self.actL1(xDrug)
            xDrug = self.L2(xDrug)
            xDrug = self.actL2(xDrug)

            x = self.nodesEmbedding(x[nDrug:])
            x = x.squeeze(1)
            x = torch.cat((xDrug, x), dim=0)

        elif config.INNER_GRAPH:
            xAtom, edge_index, batch = drugGraphBatch.x, drugGraphBatch.edge_index, drugGraphBatch.batch
            # xDrug = self.mact1(self.mlinear1(xDrug))
            # xDrug = self.mact2(self.mlinear2(xDrug))

            xProtein = self.nodesEmbedding(proteinNodes)
            xAtom = self.nodesEmbedding(xAtom)
            xAtom = xAtom.squeeze(1)




            iLevel = 0
            if config.BOTH_GRAPH and config.EXT_MODE and iLevel >= config.INTER_LEVELS:
                xAtom = F.relu(self.conv1(xAtom, edge_index, xProtein, proteinWeight))
            else:
                xAtom = F.relu(self.conv1g(xAtom, edge_index))
            xAtom, edge_index, _, batch, _, _ = self.pool1(xAtom, edge_index, None, batch)
            x1 = torch.cat([gmp(xAtom, batch), gap(xAtom, batch)], dim=1)
            iLevel += 1

            if config.BOTH_GRAPH and config.EXT_MODE and iLevel >= config.INTER_LEVELS:
                xAtom = F.relu(self.conv2(xAtom, edge_index, xProtein, proteinWeight))
            else:
                xAtom = F.relu(self.conv2g(xAtom, edge_index))

            iLevel += 1
            xAtom, edge_index, _, batch, _, _ = self.pool2(xAtom, edge_index, None, batch)
            x2 = torch.cat([gmp(xAtom, batch), gap(xAtom, batch)], dim=1)

            if config.BOTH_GRAPH and config.EXT_MODE and iLevel >= config.INTER_LEVELS:
                xAtom = F.relu(self.conv3(xAtom, edge_index, xProtein, proteinWeight))
            else:
                xAtom = F.relu(self.conv3g(xAtom, edge_index))

            xAtom, edge_index, _, batch, _, _ = self.pool3(xAtom, edge_index, None, batch)
            x3 = torch.cat([gmp(xAtom, batch), gap(xAtom, batch)], dim=1)
            iLevel += 1
            xsum = 0
            if config.N_INNER_LAYER >= 4:
                if config.BOTH_GRAPH and config.EXT_MODE and iLevel >= config.INTER_LEVELS:
                    xAtom = F.relu(self.conv4(xAtom, edge_index, xProtein, proteinWeight))
                else:
                    xAtom = F.relu(self.conv4g(xAtom, edge_index))

                xAtom, edge_index, _, batch, _, _ = self.pool4(xAtom, edge_index, None, batch)
                x4 = torch.cat([gmp(xAtom, batch), gap(xAtom, batch)], dim=1)
                xsum += x4
                iLevel += 1
                if config.N_INNER_LAYER == 5:
                    if config.BOTH_GRAPH and config.EXT_MODE and iLevel >= config.INTER_LEVELS:
                        xAtom = F.relu(self.conv5(xAtom, edge_index, xProtein, proteinWeight))
                    else:
                        xAtom = F.relu(self.conv5g(xAtom, edge_index))

                    xAtom, edge_index, _, batch, _, _ = self.pool5(xAtom, edge_index, None, batch)
                    x5 = torch.cat([gmp(xAtom, batch), gap(xAtom, batch)], dim=1)
                    xsum += x5

            xDrug = x1 + x2 + x3 + xsum


            xDrug = self.lin1(xDrug)
            xDrug = self.act1(xDrug)

            # xDrug = self.lin2(xDrug)
            # xDrug = self.act2(xDrug)

            if config.COMBINE_FEATURE:
                #print (drugFeatures.shape, xDrug.shape)
                combinedFeatures = torch.cat((drugFeatures, xDrug), dim=1)
                xDrug = self.L1C(combinedFeatures)
                xDrug = self.actL1(xDrug)
                xDrug = self.L2(xDrug)
                xDrug = self.actL2(xDrug)

            x = self.nodesEmbedding(x[nDrug:])
            x = x.squeeze(1)

            x = torch.cat((xDrug, x), dim=0)
        else:
            x = self.nodesEmbedding(x)

        if config.OUTER_GRAPH:
            # Conv Drug:
            x = self.convD1(x, drugEdges)
            x = F.relu(x)
            x = self.convD2(x, drugEdges)
            x = F.relu(x)
            x = self.convD3(x, drugEdges)
            x = F.relu(x)
        if config.SE_GRAPH:
            # Conv SE:
            x = self.convS1(x, seEdges)
            x = F.relu(x)
            # x = self.convS2(x, seEdges)
            # x = F.relu(x)

        drugEmbedding = x[drugNodes]
        seEmbedding = x[seNodes]
        # re = torch.sigmoid(re)
        return drugEmbedding, seEmbedding, x

    def cal(self, drugE, seE):
        return torch.matmul(drugE, seE.t())

    def cal2(self, drugE, seE):
        nDrug, nDim = drugE.shape
        nSe, _ = seE.shape
        preRe = list()
        for i in range(nDrug):
            dE = drugE[i]
            dE = dE.squeeze()
            de = dE.expand((nSe, nDim))
            v = torch.cat((de, seE), dim=1)
            v = self.linear1(v)
            v = self.act1(v)
            v = self.linear2(v)
            # v = self.act2(v)
            v = v.squeeze()
            preRe.append(v)
        return torch.stack(preRe)

('Undirected graph: ', True)
('Protein Test: ', True)
('Inner Graph, Outer Graph, Se Graph: ', True, True, False)
('Drug Features: ', False)
('Combine Features: ', False)
('Inner mode: ', True)
('Cross Prob: ', 0.05)
('Inner Level: ', 0)
MPNNX
<models.MPNNXP5.MPNNXP5 object at 0x7fa193235790>
('Manual torch seed: ', 1772727637)
('Config: ', 'Protein Test: ', True, 'KNN: ', 2)
KFold: 5 x 10
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  66635.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_0_0
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19463.0)
('VALIDATE SUM PROTEIN TEST: ', 2334.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 38180.4, 59640.0)
('Error: ', tensor(45156.2422, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5106866716341442, 0.2825498228963045)
('Val: AUC, AUPR, Erros: ', 0.5142617984009517, 0.23917418642899563, 4887.0156)
('Test: AUC, AUPR, Erros: ', 0.49756967099459415, 0.2593058780705509, 5353.141)
10((646, 331), (646, 331), 59823.246, 59640.0)
('Error: ', tensor(42795.9062, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6276973663960683, 0.37775685673572734)
('Val: AUC, AUPR, Erros: ', 0.6466115222808383, 0.3395156667873604, 4834.5635)
('Test: AUC, AUPR, Erros: ', 0.6098948099498951, 0.3431552862338909, 5158.3643)
20((646, 331), (646, 331), 55709.816, 59640.0)
('Error: ', tensor(42425.2734, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6681883422822139, 0.4312878622316205)
('Val: AUC, AUPR, Erros: ', 0.6811056104265683, 0.38945616594786725, 4746.3403)
('Test: AUC, AUPR, Erros: ', 0.6465210385871678, 0.38676526462038857, 5103.094)
30((646, 331), (646, 331), 53968.664, 59640.0)
('Error: ', tensor(41578.4805, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6964741227883474, 0.4865645119827551)
('Val: AUC, AUPR, Erros: ', 0.7078715426073223, 0.4459781558459645, 4629.628)
('Test: AUC, AUPR, Erros: ', 0.6779620940097071, 0.439813712849375, 5003.8604)
40((646, 331), (646, 331), 50648.254, 59640.0)
('Error: ', tensor(40038.0469, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7124746019669311, 0.5175699014532326)
('Val: AUC, AUPR, Erros: ', 0.7218904875088402, 0.474517051817681, 4420.595)
('Test: AUC, AUPR, Erros: ', 0.6956633660123458, 0.4709938365360371, 4825.521)
50((646, 331), (646, 331), 42559.926, 59640.0)
('Error: ', tensor(39703.1445, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7210131874440535, 0.5391346025548345)
('Val: AUC, AUPR, Erros: ', 0.7287701659102022, 0.4930140912921232, 4305.485)
('Test: AUC, AUPR, Erros: ', 0.7046704340403478, 0.4890752769367942, 4768.388)
60((646, 331), (646, 331), 44364.277, 59640.0)
('Error: ', tensor(38258.3438, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7276899721414457, 0.5528938006404805)
('Val: AUC, AUPR, Erros: ', 0.733202537226062, 0.5032442192209788, 4172.081)
('Test: AUC, AUPR, Erros: ', 0.7107075336123069, 0.5036679274839543, 4628.291)
70((646, 331), (646, 331), 45370.54, 59640.0)
('Error: ', tensor(37497.7031, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7325611756117323, 0.5606822548132084)
('Val: AUC, AUPR, Erros: ', 0.7358013133928318, 0.5098134775319793, 4107.4116)
('Test: AUC, AUPR, Erros: ', 0.7142328831973239, 0.5111078713627408, 4562.1865)
80((646, 331), (646, 331), 50497.598, 59640.0)
('Error: ', tensor(36495.8203, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7370049924697899, 0.5662581312530093)
('Val: AUC, AUPR, Erros: ', 0.7376786816277711, 0.5132413549065049, 4065.2302)
('Test: AUC, AUPR, Erros: ', 0.7165104847369206, 0.5156633924402246, 4491.753)
90((646, 331), (646, 331), 53193.51, 59640.0)
('Error: ', tensor(36017.4336, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.740306891461403, 0.5702061743547955)
('Val: AUC, AUPR, Erros: ', 0.7385498549096263, 0.5145902433398922, 4058.3132)
('Test: AUC, AUPR, Erros: ', 0.7190926394162968, 0.5200531957013997, 4460.6143)
100((646, 331), (646, 331), 52815.895, 59640.0)
('Error: ', tensor(35887.2578, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7428533101766528, 0.5733403097327984)
('Val: AUC, AUPR, Erros: ', 0.7393121950815895, 0.5155461021628199, 4047.5605)
('Test: AUC, AUPR, Erros: ', 0.7202974874203645, 0.5216092919842179, 4448.335)
110((646, 331), (646, 331), 53708.73, 59640.0)
('Error: ', tensor(35642.8320, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.745320559038839, 0.5765978568453717)
('Val: AUC, AUPR, Erros: ', 0.7403511296172804, 0.5167827265511689, 4041.4116)
('Test: AUC, AUPR, Erros: ', 0.7214850606999694, 0.5237718223056678, 4436.052)
120((646, 331), (646, 331), 53896.586, 59640.0)
('Error: ', tensor(35512.1953, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7473317334404344, 0.5793144833213094)
('Val: AUC, AUPR, Erros: ', 0.7411004570082476, 0.5176644557411871, 4036.8494)
('Test: AUC, AUPR, Erros: ', 0.7230044212328836, 0.5256156217049874, 4424.864)
130((646, 331), (646, 331), 54371.793, 59640.0)
('Error: ', tensor(35359.1797, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7493514399168761, 0.5820144235057858)
('Val: AUC, AUPR, Erros: ', 0.7421502310003424, 0.5187114960076128, 4033.0881)
('Test: AUC, AUPR, Erros: ', 0.724282036624003, 0.5274324233301302, 4416.2446)
140((646, 331), (646, 331), 53942.0, 59640.0)
('Error: ', tensor(35291.0742, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7511123411198211, 0.5845147707899867)
('Val: AUC, AUPR, Erros: ', 0.7428534761480808, 0.5190977742433766, 4026.7268)
('Test: AUC, AUPR, Erros: ', 0.7256025304134709, 0.529326843311274, 4406.133)
150((646, 331), (646, 331), 54118.586, 59640.0)
('Error: ', tensor(35177.9414, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7529596011704243, 0.5869891808434281)
('Val: AUC, AUPR, Erros: ', 0.7436877533640465, 0.519747962634607, 4023.4072)
('Test: AUC, AUPR, Erros: ', 0.7268272358738276, 0.5309809079427247, 4398.203)
160((646, 331), (646, 331), 53858.812, 59640.0)
('Error: ', tensor(35105.2656, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7547116553671103, 0.5893623848222912)
('Val: AUC, AUPR, Erros: ', 0.7442054082344194, 0.5196396676462113, 4020.2703)
('Test: AUC, AUPR, Erros: ', 0.7277365594780054, 0.5322131231619771, 4391.703)

Validation:  [0.7442054082344194, 0.5196396676462113, 4020.2703, 0.7277365594780054, 0.5322131231619771, 4391.703]
Train: 0.7547 0.5894
Test: 0.7277 0.5322
0
[0.5562147835886305, 0.5621939673389067, 0.5754567038073054, 0.5762256848244005, 0.581435297203798, 0.5792275705645161, 0.5852534985735687, 0.5950231499810109, 0.603472202052758, 0.6027980168452183, 0.6103761268147915, 0.6137374796583701, 0.6168577351622045, 0.6181414294439943, 0.6236361273339285, 0.6255558660621385, 0.6292379562710343, 0.6347744513581899, 0.6370321397220221, 0.6408222011255136, 0.6408081798463043, 0.6445189607749064, 0.6468971102942129, 0.6520611850104727, 0.6535279168749702, 0.6561248944894905, 0.6587158573571639, 0.6596599841671053, 0.6620870557588225, 0.6628682106639127, 0.6681890282322286, 0.6702057028235988, 0.6744411832971009, 0.6761504579662485, 0.6798414649325488, 0.681424359780493, 0.6822620245193137, 0.6861725454734771, 0.6861725454734771, 0.6879350373143137, 0.6884971361694407, 0.6903350078528753, 0.6914284539622528, 0.6957487013283813, 0.6991846844669046, 0.6991846844669046, 0.700389646697432, 0.700389646697432, 0.7029102516742417, 0.7043959616477181, 0.7043959616477181, 0.7070521881931616, 0.7070521881931616, 0.7070521881931616, 0.7070521881931616, 0.7070521881931616, 0.7070521881931616, 0.7070521881931616, 0.7101092966003284, 0.7101092966003284, 0.7115680460187515, 0.7133772093553483, 0.7133772093553483, 0.7133772093553483, 0.7133772093553483, 0.7133772093553483, 0.7133772093553483, 0.715547863102338, 0.715547863102338, 0.715547863102338, 0.7226308819696343, 0.7226308819696343, 0.7226308819696343, 0.7248785847737743, 0.7248785847737743, 0.7248785847737743, 0.7248785847737743, 0.7248785847737743, 0.7277365594780054, 0.7277365594780054, 0.7277365594780054, 0.7277365594780054, 0.7277365594780054, 0.7277365594780054, 0.7277365594780054, 0.7277365594780054, 0.7277365594780054, 0.7277365594780054, 0.7277365594780054, 0.7277365594780054]
[0.13636762979045922, 0.14610176961942914, 0.15828216188618574, 0.16289587737635675, 0.17203365500521928, 0.1713700110450044, 0.18258381411663188, 0.2001310558297035, 0.2164793617481393, 0.2123703034885003, 0.22790230023082897, 0.23214166720826296, 0.23697544404564502, 0.238219655305869, 0.24637854672085577, 0.24962196258637329, 0.2579050651835462, 0.2730224181389246, 0.2760631980704005, 0.2846605209661826, 0.28425265380082054, 0.2950875796355103, 0.30121407948692025, 0.31367585544160836, 0.3168618866146343, 0.31937381036811746, 0.32644709735890093, 0.3291722952509218, 0.3363276601079893, 0.3384915147560784, 0.35108727910867427, 0.3554117802804432, 0.36793321770429177, 0.3718108900018754, 0.3812805053217033, 0.3859193628085117, 0.38705197549674336, 0.3954829815294566, 0.3954829815294566, 0.40014469523425616, 0.40052524144251317, 0.4062024027319077, 0.41010265971482657, 0.42256802302724294, 0.4332468965778522, 0.4332468965778522, 0.4368558199637164, 0.4368558199637164, 0.4448980257509625, 0.450209562371751, 0.450209562371751, 0.4586997674182929, 0.4586997674182929, 0.4586997674182929, 0.4586997674182929, 0.4586997674182929, 0.4586997674182929, 0.4586997674182929, 0.46928638641312953, 0.46928638641312953, 0.4741157396426691, 0.48070914456731134, 0.48070914456731134, 0.48070914456731134, 0.48070914456731134, 0.48070914456731134, 0.48070914456731134, 0.4888580824969292, 0.4888580824969292, 0.4888580824969292, 0.5145078501224478, 0.5145078501224478, 0.5145078501224478, 0.5217133208299631, 0.5217133208299631, 0.5217133208299631, 0.5217133208299631, 0.5217133208299631, 0.5322131231619771, 0.5322131231619771, 0.5322131231619771, 0.5322131231619771, 0.5322131231619771, 0.5322131231619771, 0.5322131231619771, 0.5322131231619771, 0.5322131231619771, 0.5322131231619771, 0.5322131231619771, 0.5322131231619771]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  65637.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_0_1
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19245.0)
('VALIDATE SUM PROTEIN TEST: ', 2846.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 40421.492, 59364.0)
('Error: ', tensor(44573.8438, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.48551775933831565, 0.26576124844646376)
('Val: AUC, AUPR, Erros: ', 0.48670935786604486, 0.2641227122494105, 5480.9473)
('Test: AUC, AUPR, Erros: ', 0.47103783017632317, 0.21649075673648255, 4862.1904)
10((646, 331), (646, 331), 59002.28, 59364.0)
('Error: ', tensor(42467.4883, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6611933568242476, 0.42670350489895303)
('Val: AUC, AUPR, Erros: ', 0.6583131421680919, 0.4251398664469958, 5249.4346)
('Test: AUC, AUPR, Erros: ', 0.6606065179215374, 0.37465043382477436, 4806.8193)
20((646, 331), (646, 331), 46552.836, 59364.0)
('Error: ', tensor(42501.7617, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7083938864801553, 0.507905894643668)
('Val: AUC, AUPR, Erros: ', 0.7033464533676288, 0.5007958087832078, 5233.009)
('Test: AUC, AUPR, Erros: ', 0.7073480003558664, 0.4558476799533214, 4683.5615)
30((646, 331), (646, 331), 70792.05, 59364.0)
('Error: ', tensor(38664.7500, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.72751768608925, 0.5466852830822556)
('Val: AUC, AUPR, Erros: ', 0.7169225039334766, 0.529140051859935, 4844.557)
('Test: AUC, AUPR, Erros: ', 0.7261580160353167, 0.49319583617351753, 4534.874)
40((646, 331), (646, 331), 63713.688, 59364.0)
('Error: ', tensor(36791.3359, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7351871793290563, 0.5598913501443474)
('Val: AUC, AUPR, Erros: ', 0.7207077913732249, 0.5339700593817016, 4620.464)
('Test: AUC, AUPR, Erros: ', 0.7325793674467366, 0.5045987639508505, 4248.89)
50((646, 331), (646, 331), 68495.54, 59364.0)
('Error: ', tensor(36068.9453, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7415896034708336, 0.5690589964955015)
('Val: AUC, AUPR, Erros: ', 0.7235622452144053, 0.5361467510832456, 4607.811)
('Test: AUC, AUPR, Erros: ', 0.7377320833177514, 0.5109270241783247, 4262.2896)
60((646, 331), (646, 331), 70355.445, 59364.0)
('Error: ', tensor(35909.2109, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7454288852159748, 0.5748753031921329)
('Val: AUC, AUPR, Erros: ', 0.7245174602432766, 0.535407806962932, 4652.1426)
('Test: AUC, AUPR, Erros: ', 0.7403950385359168, 0.5141192511909314, 4300.502)
70((646, 331), (646, 331), 66899.76, 59364.0)
('Error: ', tensor(35414.5625, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7483328717238419, 0.5794265185934127)
('Val: AUC, AUPR, Erros: ', 0.7252601190326203, 0.5346959753077047, 4599.862)
('Test: AUC, AUPR, Erros: ', 0.7421893275573817, 0.5166922816511181, 4209.7124)
80((646, 331), (646, 331), 67819.17, 59364.0)
('Error: ', tensor(35310.1055, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7508204311718119, 0.5835220009722457)
('Val: AUC, AUPR, Erros: ', 0.7258284125872935, 0.5342728971261499, 4620.637)
('Test: AUC, AUPR, Erros: ', 0.7436060674068731, 0.5190174815753689, 4223.4106)
90((646, 331), (646, 331), 66852.97, 59364.0)
('Error: ', tensor(35085.5508, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7531042236059236, 0.5871119953013599)
('Val: AUC, AUPR, Erros: ', 0.7263819393288097, 0.5341161976637521, 4607.864)
('Test: AUC, AUPR, Erros: ', 0.7444706819055842, 0.5203765707762444, 4198.469)
100((646, 331), (646, 331), 66965.445, 59364.0)
('Error: ', tensor(34955.8242, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7552829193745589, 0.5904059614427339)
('Val: AUC, AUPR, Erros: ', 0.7268915914612628, 0.5337660667289192, 4613.5312)
('Test: AUC, AUPR, Erros: ', 0.7454415060009296, 0.5212881315202555, 4195.9556)
110((646, 331), (646, 331), 67027.15, 59364.0)
('Error: ', tensor(34826.6055, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7575109274698575, 0.5935744085457956)
('Val: AUC, AUPR, Erros: ', 0.7275721177228927, 0.5338299256581273, 4616.153)
('Test: AUC, AUPR, Erros: ', 0.746401735138888, 0.52195829434171, 4193.5166)
120((646, 331), (646, 331), 67475.87, 59364.0)
('Error: ', tensor(34733.4844, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7597182878342885, 0.5965435225349844)
('Val: AUC, AUPR, Erros: ', 0.728008382735526, 0.5335938129419223, 4626.5366)
('Test: AUC, AUPR, Erros: ', 0.7471633689803585, 0.5225403130319264, 4202.993)
130((646, 331), (646, 331), 67456.08, 59364.0)
('Error: ', tensor(34611.6094, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7619150073579162, 0.5993170845264952)
('Val: AUC, AUPR, Erros: ', 0.7286363382976948, 0.5335898941223938, 4626.4873)
('Test: AUC, AUPR, Erros: ', 0.7479725481782207, 0.522694965692136, 4201.124)
140((646, 331), (646, 331), 67744.74, 59364.0)
('Error: ', tensor(34519.3984, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7641005651825377, 0.601961530316441)
('Val: AUC, AUPR, Erros: ', 0.7292351121595063, 0.5337157213728859, 4633.318)
('Test: AUC, AUPR, Erros: ', 0.7490398251951564, 0.5227285586992899, 4204.4766)
150((646, 331), (646, 331), 67726.44, 59364.0)
('Error: ', tensor(34412.8398, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7661475625653892, 0.604382626059989)
('Val: AUC, AUPR, Erros: ', 0.7296933655059352, 0.533617602384411, 4634.717)
('Test: AUC, AUPR, Erros: ', 0.7497346137816692, 0.5225425248962893, 4205.0977)
160((646, 331), (646, 331), 67768.5, 59364.0)
('Error: ', tensor(34315.6914, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7681472723269709, 0.6066662246692749)
('Val: AUC, AUPR, Erros: ', 0.7301836933840876, 0.5336888557935092, 4635.763)
('Test: AUC, AUPR, Erros: ', 0.7509078287296651, 0.52294597274297, 4203.4116)

Validation:  [0.7252601190326203, 0.5346959753077047, 4599.862, 0.7421893275573817, 0.5166922816511181, 4209.7124]
Train: 0.7483 0.5794
Test: 0.7422 0.5167
1
[0.5230764372060481, 0.5435307517084282, 0.5499830780563112, 0.5455162015073003, 0.5544655687213473, 0.5551832718750089, 0.5630493377167756, 0.5809670153433735, 0.5877770970813662, 0.5896194812214973, 0.5982795856063338, 0.603777530812245, 0.6064563739169703, 0.6077088138038823, 0.6147828047840622, 0.6197008731827891, 0.6228860862674899, 0.6274919059069799, 0.6325480723377819, 0.6352459780769144, 0.6359674920728909, 0.6396495306425075, 0.6454001838091843, 0.6496615254061548, 0.6517214518556086, 0.657108715373551, 0.6586033256661517, 0.6597137813150316, 0.6623843092405907, 0.6637569097606886, 0.6709202639489178, 0.6751913736077225, 0.6787243422436773, 0.6810189659761453, 0.6844612914693302, 0.6867091442547291, 0.6886462537843365, 0.6932532948888832, 0.6932532948888832, 0.6965076200283997, 0.6984206930241187, 0.6997313598078165, 0.7016762278826678, 0.7066260288416647, 0.7104285071170331, 0.7104285071170331, 0.7112602522327462, 0.7112602522327462, 0.7147259514023308, 0.7162587846508081, 0.7162587846508081, 0.7194502575739947, 0.7194502575739947, 0.7194502575739947, 0.7194502575739947, 0.7194502575739947, 0.7194502575739947, 0.7194502575739947, 0.7227842797159945, 0.7227842797159945, 0.7243161907189394, 0.7264324437661871, 0.7264324437661871, 0.7264324437661871, 0.7264324437661871, 0.7264324437661871, 0.7264324437661871, 0.7291389920512931, 0.7291389920512931, 0.7291389920512931, 0.7365297208650021, 0.7365297208650021, 0.7365297208650021, 0.7390580384716894, 0.7390580384716894, 0.7390580384716894, 0.7390580384716894, 0.7390580384716894, 0.7421893275573817, 0.7421893275573817, 0.7421893275573817, 0.7421893275573817, 0.7421893275573817, 0.7421893275573817, 0.7421893275573817, 0.7421893275573817, 0.7421893275573817, 0.7421893275573817, 0.7421893275573817, 0.7421893275573817]
[0.10250901430147652, 0.11129387819082587, 0.11121294175567276, 0.11001924774797087, 0.11940179544277416, 0.1211089302241033, 0.13023944468121576, 0.1490394149145271, 0.15725266927644432, 0.1585230200829526, 0.1741565509014688, 0.1825957470351094, 0.18322068818025053, 0.18299498500061218, 0.1944063395853891, 0.2030131165703024, 0.2063349737571401, 0.21626852721889586, 0.2243027263782464, 0.23035189436495385, 0.23217180294068027, 0.2405002838495663, 0.2521473051792503, 0.2593248386087115, 0.26313828077084855, 0.2745697547147734, 0.2780141217450565, 0.27972331802252326, 0.28616674670940334, 0.2905124128053992, 0.30885759613154395, 0.3191351390929946, 0.3244071599626136, 0.32849762625517914, 0.33533244324820477, 0.34082231629672755, 0.34685073153272866, 0.35962363284809745, 0.35962363284809745, 0.36967234031062957, 0.3746037981551662, 0.3750984058477402, 0.38267596202382415, 0.3964613306944912, 0.40669946104073385, 0.40669946104073385, 0.4083304053865496, 0.4083304053865496, 0.42040127197286997, 0.4251162195754964, 0.4251162195754964, 0.43412821678352537, 0.43412821678352537, 0.43412821678352537, 0.43412821678352537, 0.43412821678352537, 0.43412821678352537, 0.43412821678352537, 0.4455506005021012, 0.4455506005021012, 0.4490736051125893, 0.456579300954135, 0.456579300954135, 0.456579300954135, 0.456579300954135, 0.456579300954135, 0.456579300954135, 0.46928056921936, 0.46928056921936, 0.46928056921936, 0.4952574301254272, 0.4952574301254272, 0.4952574301254272, 0.5043375093592757, 0.5043375093592757, 0.5043375093592757, 0.5043375093592757, 0.5043375093592757, 0.5166922816511181, 0.5166922816511181, 0.5166922816511181, 0.5166922816511181, 0.5166922816511181, 0.5166922816511181, 0.5166922816511181, 0.5166922816511181, 0.5166922816511181, 0.5166922816511181, 0.5166922816511181, 0.5166922816511181]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  65277.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_0_2
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19732.0)
('VALIDATE SUM PROTEIN TEST: ', 2552.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 63190.555, 58006.0)
('Error: ', tensor(42372.8047, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.51336659107178, 0.28031172300956764)
('Val: AUC, AUPR, Erros: ', 0.5054189499802477, 0.2868495084480993, 5461.284)
('Test: AUC, AUPR, Erros: ', 0.5109864315651118, 0.2774175071714153, 5313.1357)
10((646, 331), (646, 331), 46840.89, 58006.0)
('Error: ', tensor(42223.4414, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.714702311023703, 0.48628408731711315)
('Val: AUC, AUPR, Erros: ', 0.7014045324973092, 0.4809931902138602, 5498.491)
('Test: AUC, AUPR, Erros: ', 0.7032616462505035, 0.4686590339500766, 5295.828)
20((646, 331), (646, 331), 62092.125, 58006.0)
('Error: ', tensor(38171.2695, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7440585272243534, 0.5415277352849519)
('Val: AUC, AUPR, Erros: ', 0.7185127749182885, 0.523753229638013, 4977.3467)
('Test: AUC, AUPR, Erros: ', 0.7226503452323254, 0.5018256638981187, 4832.444)
30((646, 331), (646, 331), 64404.84, 58006.0)
('Error: ', tensor(36636.3008, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7472835268794951, 0.5607007068074298)
('Val: AUC, AUPR, Erros: ', 0.7160332989484061, 0.5406440485558703, 4806.754)
('Test: AUC, AUPR, Erros: ', 0.7223997493161023, 0.5164514827771969, 4681.281)
40((646, 331), (646, 331), 62813.63, 58006.0)
('Error: ', tensor(35146.4375, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7555033891638232, 0.5746389017338698)
('Val: AUC, AUPR, Erros: ', 0.7207103004060191, 0.5515071035096817, 4668.0635)
('Test: AUC, AUPR, Erros: ', 0.7270210474245565, 0.5243296479783648, 4562.4316)
50((646, 331), (646, 331), 64790.3, 58006.0)
('Error: ', tensor(34709.1289, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.757916300516104, 0.5815632394048786)
('Val: AUC, AUPR, Erros: ', 0.7226785835559881, 0.5560481772224093, 4641.467)
('Test: AUC, AUPR, Erros: ', 0.7288191462360745, 0.5286873528428937, 4576.5747)
60((646, 331), (646, 331), 65594.25, 58006.0)
('Error: ', tensor(34534.0820, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7593288934990075, 0.5860907065332153)
('Val: AUC, AUPR, Erros: ', 0.7236323929244757, 0.5585560013769799, 4635.8203)
('Test: AUC, AUPR, Erros: ', 0.7296606047185952, 0.5313365898495452, 4587.8125)
70((646, 331), (646, 331), 65883.0, 58006.0)
('Error: ', tensor(34371.9844, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7608692509504669, 0.5899862945368504)
('Val: AUC, AUPR, Erros: ', 0.7244179830664368, 0.5601886106345808, 4630.379)
('Test: AUC, AUPR, Erros: ', 0.7301599841323624, 0.5326964790370504, 4593.323)
80((646, 331), (646, 331), 65334.09, 58006.0)
('Error: ', tensor(34196.8164, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7619127979218913, 0.5928322596930591)
('Val: AUC, AUPR, Erros: ', 0.7249481219858245, 0.561215106940323, 4621.6724)
('Test: AUC, AUPR, Erros: ', 0.7304845372884556, 0.5339296585179731, 4582.481)
90((646, 331), (646, 331), 65704.91, 58006.0)
('Error: ', tensor(34063.5078, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7642066432671072, 0.5966123899757471)
('Val: AUC, AUPR, Erros: ', 0.7258372358563233, 0.5621979321060123, 4620.6494)
('Test: AUC, AUPR, Erros: ', 0.730787260477434, 0.5341225690437615, 4594.573)
100((646, 331), (646, 331), 65232.156, 58006.0)
('Error: ', tensor(33913.2305, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7654810898538404, 0.5990233966236671)
('Val: AUC, AUPR, Erros: ', 0.726460072649717, 0.5629670904513504, 4610.635)
('Test: AUC, AUPR, Erros: ', 0.7310061513841881, 0.5348552572401046, 4580.9844)
110((646, 331), (646, 331), 65833.016, 58006.0)
('Error: ', tensor(33832.2734, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7677636585981508, 0.6019658438952188)
('Val: AUC, AUPR, Erros: ', 0.7269327686079324, 0.5632155882338187, 4614.3076)
('Test: AUC, AUPR, Erros: ', 0.7310393204056382, 0.5347169418803486, 4597.038)
120((646, 331), (646, 331), 65725.76, 58006.0)
('Error: ', tensor(33728.0117, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7690270134598913, 0.6040908339201367)
('Val: AUC, AUPR, Erros: ', 0.7275835428700423, 0.5638430472439739, 4606.994)
('Test: AUC, AUPR, Erros: ', 0.7312059679040712, 0.5354517115801759, 4588.2153)
130((646, 331), (646, 331), 65906.21, 58006.0)
('Error: ', tensor(33622.6328, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.771427162123138, 0.6068058724781868)
('Val: AUC, AUPR, Erros: ', 0.7273908262617399, 0.5635047429292896, 4611.479)
('Test: AUC, AUPR, Erros: ', 0.7313806252372861, 0.5356859250607006, 4594.2173)
140((646, 331), (646, 331), 65971.56, 58006.0)
('Error: ', tensor(33524.7266, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7734060816952918, 0.609135696738645)
('Val: AUC, AUPR, Erros: ', 0.7275007860615739, 0.5634173292876442, 4611.944)
('Test: AUC, AUPR, Erros: ', 0.7313071782900538, 0.5355703183573601, 4596.273)
150((646, 331), (646, 331), 66128.516, 58006.0)
('Error: ', tensor(33438.5156, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7753895851058353, 0.6113757754300329)
('Val: AUC, AUPR, Erros: ', 0.7272604958179885, 0.5631135795929858, 4614.881)
('Test: AUC, AUPR, Erros: ', 0.7313068756337306, 0.5358072714685175, 4599.274)
160((646, 331), (646, 331), 66258.79, 58006.0)
('Error: ', tensor(33359.3594, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7771251285938654, 0.6134279604450724)
('Val: AUC, AUPR, Erros: ', 0.727078072141117, 0.5628659539995686, 4617.104)
('Test: AUC, AUPR, Erros: ', 0.7310480622464111, 0.5356067683207244, 4603.251)

Validation:  [0.7275835428700423, 0.5638430472439739, 4606.994, 0.7312059679040712, 0.5354517115801759, 4588.2153]
Train: 0.7690 0.6041
Test: 0.7312 0.5355
2
[0.5974922623555365, 0.6007334103776791, 0.6017748978603752, 0.6033122961244933, 0.5958712522003193, 0.5944033756069268, 0.598013295712267, 0.5947223627610316, 0.59818368412222, 0.5990866634692047, 0.6036448011731945, 0.6068145873367018, 0.6084072536558615, 0.611683328853178, 0.616848051741101, 0.6195887546060819, 0.6247264827396954, 0.6302507230221013, 0.6353842332114867, 0.6389274509081463, 0.6392825174126741, 0.6426759171742755, 0.6456768340740324, 0.6500087309754805, 0.6519239975478586, 0.6590766777248, 0.6609078756214879, 0.6620312552161057, 0.6647108114872973, 0.6656384254207651, 0.672515350265539, 0.6748718229083666, 0.6780687367779286, 0.6797216658853719, 0.6836399633243322, 0.6854023245725446, 0.686372675740768, 0.6899615025606745, 0.6899615025606745, 0.6918535780681935, 0.6929534132567887, 0.6947978357036846, 0.6963545184140438, 0.7006185960668322, 0.7045767954518489, 0.7045767954518489, 0.7052115105705875, 0.7052115105705875, 0.7075894864471732, 0.7085023427063035, 0.7085023427063035, 0.7109656357104295, 0.7109656357104295, 0.7109656357104295, 0.7109656357104295, 0.7109656357104295, 0.7109656357104295, 0.7109656357104295, 0.7143190960188023, 0.7143190960188023, 0.7161832608993419, 0.7178555571342906, 0.7178555571342906, 0.7178555571342906, 0.7178555571342906, 0.7178555571342906, 0.7178555571342906, 0.7200940246513767, 0.7200940246513767, 0.7200940246513767, 0.7270384313997507, 0.7270384313997507, 0.7270384313997507, 0.7289275822524944, 0.7289275822524944, 0.7289275822524944, 0.7289275822524944, 0.7289275822524944, 0.7312059679040712, 0.7312059679040712, 0.7312059679040712, 0.7312059679040712, 0.7312059679040712, 0.7312059679040712, 0.7312059679040712, 0.7312059679040712, 0.7312059679040712, 0.7312059679040712, 0.7312059679040712, 0.7312059679040712]
[0.1698018378409309, 0.17591230951388565, 0.17700298792413688, 0.18250870670539798, 0.1765943119762618, 0.18074249057252256, 0.1923143654951595, 0.192548361281841, 0.2004321795214451, 0.2031136963918812, 0.21432942783204129, 0.22276760020592742, 0.2279644674851587, 0.23344189450122876, 0.24429562596503654, 0.25081184599194734, 0.26061251015309217, 0.2742639543404868, 0.285218395561297, 0.29317523066842965, 0.29425160805154676, 0.3020127428157424, 0.310503827365903, 0.31863568926322805, 0.32278968924467744, 0.3374710412009781, 0.34093757188176976, 0.3429177437835571, 0.34724435664631215, 0.3500927929848411, 0.36651525409988495, 0.3710885290131287, 0.37919627665868527, 0.3834944486661342, 0.3932521492697847, 0.3985151109343623, 0.4003193828760154, 0.40807399034694397, 0.40807399034694397, 0.4128541670583935, 0.41519119772969565, 0.4202939717152477, 0.4254880998578034, 0.43762693418016774, 0.44955058276550663, 0.44955058276550663, 0.45143528595551285, 0.45143528595551285, 0.4580856952806498, 0.46079904661305493, 0.46079904661305493, 0.46743687164347214, 0.46743687164347214, 0.46743687164347214, 0.46743687164347214, 0.46743687164347214, 0.46743687164347214, 0.46743687164347214, 0.4780055851950674, 0.4780055851950674, 0.4847247018387404, 0.4899739466376501, 0.4899739466376501, 0.4899739466376501, 0.4899739466376501, 0.4899739466376501, 0.4899739466376501, 0.4974141696171755, 0.4974141696171755, 0.4974141696171755, 0.5230151916109215, 0.5230151916109215, 0.5230151916109215, 0.5280456211744535, 0.5280456211744535, 0.5280456211744535, 0.5280456211744535, 0.5280456211744535, 0.5354517115801759, 0.5354517115801759, 0.5354517115801759, 0.5354517115801759, 0.5354517115801759, 0.5354517115801759, 0.5354517115801759, 0.5354517115801759, 0.5354517115801759, 0.5354517115801759, 0.5354517115801759, 0.5354517115801759]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
647 81 331
Num Drug-SE:  65133.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_0_3
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((647, 3826), (81, 3826), (647, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19668.0)
('VALIDATE SUM PROTEIN TEST: ', 2359.0)
(647, 3826) (647, 331)
0((647, 331), (647, 331), 35244.645, 57502.0)
('Error: ', tensor(44364.8750, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5135213422048477, 0.2841398696508004)
('Val: AUC, AUPR, Erros: ', 0.5184876200200954, 0.31378992511036846, 5931.4956)
('Test: AUC, AUPR, Erros: ', 0.5149993461443492, 0.3002128131108082, 5843.569)
10((647, 331), (647, 331), 57515.9, 57502.0)
('Error: ', tensor(41872.4766, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6105339504680576, 0.35985739337445616)
('Val: AUC, AUPR, Erros: ', 0.609021206737542, 0.3865671369596873, 5484.76)
('Test: AUC, AUPR, Erros: ', 0.6017570542962553, 0.36833891017437653, 5443.331)
20((647, 331), (647, 331), 55958.574, 57502.0)
('Error: ', tensor(41488.2969, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.662774060280253, 0.41960067446345434)
('Val: AUC, AUPR, Erros: ', 0.6571408267301331, 0.4452835624297312, 5446.3843)
('Test: AUC, AUPR, Erros: ', 0.6554722081286077, 0.432126289036717, 5401.599)
30((647, 331), (647, 331), 55865.55, 57502.0)
('Error: ', tensor(40791.8203, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6945742975413252, 0.46860716864513824)
('Val: AUC, AUPR, Erros: ', 0.6863729473781018, 0.4910821705510137, 5360.844)
('Test: AUC, AUPR, Erros: ', 0.6848685128398255, 0.4779871826774552, 5317.285)
40((647, 331), (647, 331), 50456.57, 57502.0)
('Error: ', tensor(39887.0078, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7147288286845433, 0.5068006160168088)
('Val: AUC, AUPR, Erros: ', 0.7065265421577702, 0.5275347424705272, 5281.8174)
('Test: AUC, AUPR, Erros: ', 0.7020054442877408, 0.5113349971728882, 5229.8047)
50((647, 331), (647, 331), 49483.816, 57502.0)
('Error: ', tensor(38469.3633, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7245319744036924, 0.5282253823639931)
('Val: AUC, AUPR, Erros: ', 0.7167558272759231, 0.5462345582035806, 5109.6113)
('Test: AUC, AUPR, Erros: ', 0.7095297650533354, 0.5277792722221686, 5065.7476)
60((647, 331), (647, 331), 59756.848, 57502.0)
('Error: ', tensor(36837.5312, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7298960099005861, 0.5380431685338707)
('Val: AUC, AUPR, Erros: ', 0.7211476546928061, 0.5536945707624984, 4840.213)
('Test: AUC, AUPR, Erros: ', 0.7137498430268174, 0.5356758333779164, 4834.9985)
70((647, 331), (647, 331), 33768.562, 57502.0)
('Error: ', tensor(39367.4492, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7347436569104198, 0.5485661216146922)
('Val: AUC, AUPR, Erros: ', 0.7227701347113028, 0.5599200150936838, 5334.534)
('Test: AUC, AUPR, Erros: ', 0.7141974711022449, 0.54067594564318, 5259.2856)
80((647, 331), (647, 331), 66065.63, 57502.0)
('Error: ', tensor(35523.2695, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7385136061993931, 0.553771080967576)
('Val: AUC, AUPR, Erros: ', 0.7249634922313015, 0.5617349670811344, 4654.945)
('Test: AUC, AUPR, Erros: ', 0.7173167895783198, 0.5443291527115013, 4694.393)
90((647, 331), (647, 331), 65195.04, 57502.0)
('Error: ', tensor(35215.3125, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7418009869744533, 0.5594440998282592)
('Val: AUC, AUPR, Erros: ', 0.7255304813008885, 0.5637540918947425, 4639.8633)
('Test: AUC, AUPR, Erros: ', 0.7190179894341846, 0.5479036495843475, 4671.611)
100((647, 331), (647, 331), 65378.67, 57502.0)
('Error: ', tensor(35028.4141, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7448249266002414, 0.5641962205292208)
('Val: AUC, AUPR, Erros: ', 0.7259161924309661, 0.5655844160545236, 4633.0776)
('Test: AUC, AUPR, Erros: ', 0.7200229594203655, 0.5502735871314879, 4662.751)
110((647, 331), (647, 331), 64999.637, 57502.0)
('Error: ', tensor(34832.9531, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7475019315132907, 0.5682349360830354)
('Val: AUC, AUPR, Erros: ', 0.726046855432674, 0.5666650083879117, 4629.3047)
('Test: AUC, AUPR, Erros: ', 0.7208809997746691, 0.5522423643739001, 4652.225)
120((647, 331), (647, 331), 65142.586, 57502.0)
('Error: ', tensor(34699.4844, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7498226288531742, 0.5716687196025774)
('Val: AUC, AUPR, Erros: ', 0.7260141011525195, 0.5673442667202174, 4628.736)
('Test: AUC, AUPR, Erros: ', 0.722005976527607, 0.5542309490686859, 4643.9106)
130((647, 331), (647, 331), 64962.36, 57502.0)
('Error: ', tensor(34560.5898, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7518722791730055, 0.5747262499757236)
('Val: AUC, AUPR, Erros: ', 0.7260073247605614, 0.5679578280154783, 4627.913)
('Test: AUC, AUPR, Erros: ', 0.722283752445468, 0.555371293478497, 4637.928)
140((647, 331), (647, 331), 64827.535, 57502.0)
('Error: ', tensor(34435.9141, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7537786398096467, 0.5775645522663768)
('Val: AUC, AUPR, Erros: ', 0.7257933819301372, 0.5681472728689387, 4628.98)
('Test: AUC, AUPR, Erros: ', 0.7227831116396009, 0.5561681152060535, 4632.895)
150((647, 331), (647, 331), 64865.16, 57502.0)
('Error: ', tensor(34339.2422, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7554888397840847, 0.5800413576442203)
('Val: AUC, AUPR, Erros: ', 0.7256221705942063, 0.5684803881656566, 4629.4233)
('Test: AUC, AUPR, Erros: ', 0.723283939788435, 0.5570993963082003, 4628.842)
160((647, 331), (647, 331), 64894.027, 57502.0)
('Error: ', tensor(34243.6016, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.757183257744561, 0.5824753800918423)
('Val: AUC, AUPR, Erros: ', 0.7250208938752041, 0.5682328998212576, 4632.836)
('Test: AUC, AUPR, Erros: ', 0.7237992081036013, 0.5577850016573502, 4625.2056)

Validation:  [0.7260073247605614, 0.5679578280154783, 4627.913, 0.722283752445468, 0.555371293478497, 4637.928]
Train: 0.7519 0.5747
Test: 0.7223 0.5554
3
[0.5167466594993089, 0.5461668105157573, 0.5501570974502386, 0.5519544559024732, 0.5611290548291858, 0.5647564407482948, 0.5696131853327571, 0.5757846008948441, 0.5824603272028275, 0.5838876671209212, 0.5850609006172363, 0.588678368664186, 0.5900388546679999, 0.592932132021699, 0.5996535682092493, 0.6027843733294183, 0.6076823561032613, 0.6120473991283034, 0.615898205064862, 0.6204438088815725, 0.621086150496142, 0.6259071587009307, 0.6286960952306495, 0.6325666490706834, 0.6358111763580727, 0.642976721827287, 0.6436891388135276, 0.6444034890924386, 0.6471681601970893, 0.6482748202754702, 0.6544761450383358, 0.6581421559912348, 0.6619301792932586, 0.6641059107397522, 0.6691784215905745, 0.6712910722820543, 0.6722297045935497, 0.6759753617573916, 0.6759753617573916, 0.6779697168621351, 0.6794008032696778, 0.6814465294321042, 0.6832629503323671, 0.6880071399939347, 0.6925256775454653, 0.6925256775454653, 0.6938462880435902, 0.6938462880435902, 0.697218675114268, 0.6985641572047894, 0.6985641572047894, 0.7014512560006481, 0.7014512560006481, 0.7014512560006481, 0.7014512560006481, 0.7014512560006481, 0.7014512560006481, 0.7014512560006481, 0.7047304484069152, 0.7047304484069152, 0.7063368239990835, 0.7083083309308915, 0.7083083309308915, 0.7083083309308915, 0.7083083309308915, 0.7083083309308915, 0.7083083309308915, 0.7107653122413686, 0.7107653122413686, 0.7107653122413686, 0.7175325475616199, 0.7175325475616199, 0.7175325475616199, 0.7197705310034992, 0.7197705310034992, 0.7197705310034992, 0.7197705310034992, 0.7197705310034992, 0.722283752445468, 0.722283752445468, 0.722283752445468, 0.722283752445468, 0.722283752445468, 0.722283752445468, 0.722283752445468, 0.722283752445468, 0.722283752445468, 0.722283752445468, 0.722283752445468, 0.722283752445468]
[0.1321127337298309, 0.15658437679397158, 0.1633806164000081, 0.17192911699236157, 0.18615151867889174, 0.19008525112351077, 0.19834299091589577, 0.20819820105035713, 0.21788208096488992, 0.2198695580445885, 0.22089414629463694, 0.22785633403280126, 0.2295506393973999, 0.2368607007130612, 0.2516650242133585, 0.2577035515509444, 0.26710206160690597, 0.27427530143849843, 0.2813335383441263, 0.2901933513235768, 0.2907200349003044, 0.30196786215780025, 0.3066983265020964, 0.3148814672221304, 0.32333360579217746, 0.3395193185569302, 0.3395878880969989, 0.34099887161778286, 0.3489340450868099, 0.35272438850400367, 0.36663569906558524, 0.3750949168689593, 0.3840629883559604, 0.3898927411981381, 0.4036005279414853, 0.4092840911549921, 0.41067940318423424, 0.41905770250789387, 0.41905770250789387, 0.4239836905070712, 0.42728143441557404, 0.4327432632841853, 0.43851510193228893, 0.45216134614602116, 0.4656249225400917, 0.4656249225400917, 0.4687824728083332, 0.4687824728083332, 0.47882448303107794, 0.4825647864624354, 0.4825647864624354, 0.4889505152629073, 0.4889505152629073, 0.4889505152629073, 0.4889505152629073, 0.4889505152629073, 0.4889505152629073, 0.4889505152629073, 0.49924103085268623, 0.49924103085268623, 0.5038097350861729, 0.5098525510339693, 0.5098525510339693, 0.5098525510339693, 0.5098525510339693, 0.5098525510339693, 0.5098525510339693, 0.518237605150149, 0.518237605150149, 0.518237605150149, 0.5398422690587628, 0.5398422690587628, 0.5398422690587628, 0.5467262297828037, 0.5467262297828037, 0.5467262297828037, 0.5467262297828037, 0.5467262297828037, 0.555371293478497, 0.555371293478497, 0.555371293478497, 0.555371293478497, 0.555371293478497, 0.555371293478497, 0.555371293478497, 0.555371293478497, 0.555371293478497, 0.555371293478497, 0.555371293478497, 0.555371293478497]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
647 80 331
Num Drug-SE:  65689.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_0_4
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((647, 3826), (80, 3826), (647, 331), (80, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19436.0)
('VALIDATE SUM PROTEIN TEST: ', 2616.0)
(647, 3826) (647, 331)
0((647, 331), (647, 331), 45158.152, 57914.0)
('Error: ', tensor(43017.9180, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.49870991293311134, 0.2671723049762237)
('Val: AUC, AUPR, Erros: ', 0.49076809665478854, 0.2612430112079247, 5368.211)
('Test: AUC, AUPR, Erros: ', 0.48957904028618304, 0.2842660697770685, 5675.2217)
10((647, 331), (647, 331), 55519.836, 57914.0)
('Error: ', tensor(41885.4609, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6381817455237239, 0.37585511756540885)
('Val: AUC, AUPR, Erros: ', 0.6257604536902442, 0.35854073041128376, 5233.568)
('Test: AUC, AUPR, Erros: ', 0.6292008103478359, 0.3893361934849606, 5476.1772)
20((647, 331), (647, 331), 50302.79, 57914.0)
('Error: ', tensor(41368.1797, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6763163300383399, 0.4355733696064289)
('Val: AUC, AUPR, Erros: ', 0.6625096136273483, 0.40790967977932674, 5176.1567)
('Test: AUC, AUPR, Erros: ', 0.669179205656276, 0.4459085617573856, 5440.503)
30((647, 331), (647, 331), 46844.367, 57914.0)
('Error: ', tensor(40316.9062, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7014255075039975, 0.4921055742750068)
('Val: AUC, AUPR, Erros: ', 0.6892728647367935, 0.45850933605505195, 5055.653)
('Test: AUC, AUPR, Erros: ', 0.695207701914391, 0.5009387221857424, 5326.481)
40((647, 331), (647, 331), 43841.273, 57914.0)
('Error: ', tensor(39408.4531, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7142820703827352, 0.5220109051220062)
('Val: AUC, AUPR, Erros: ', 0.7032565669481498, 0.4881905742339804, 4951.1436)
('Test: AUC, AUPR, Erros: ', 0.7080496557225014, 0.5310071177688207, 5227.2266)
50((647, 331), (647, 331), 58023.203, 57914.0)
('Error: ', tensor(36897.8516, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7229210144402707, 0.5383797120025186)
('Val: AUC, AUPR, Erros: ', 0.7126481871683946, 0.5082014299632367, 4655.0835)
('Test: AUC, AUPR, Erros: ', 0.71498206628384, 0.5441066443926368, 4832.632)
60((647, 331), (647, 331), 31163.676, 57914.0)
('Error: ', tensor(40196.3711, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7279829024622929, 0.546148461962077)
('Val: AUC, AUPR, Erros: ', 0.7171055744417025, 0.5147067531968831, 5076.3525)
('Test: AUC, AUPR, Erros: ', 0.7190346924795286, 0.554167437627181, 5411.3125)
70((647, 331), (647, 331), 51346.297, 57914.0)
('Error: ', tensor(35842.8594, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7334156691088636, 0.554270660074188)
('Val: AUC, AUPR, Erros: ', 0.7227857985689616, 0.5269302966197276, 4548.5225)
('Test: AUC, AUPR, Erros: ', 0.7216108628554191, 0.5592808010709279, 4763.1226)
80((647, 331), (647, 331), 50422.832, 57914.0)
('Error: ', tensor(35679.2422, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7369898295213353, 0.5585148453924157)
('Val: AUC, AUPR, Erros: ', 0.7255654710577001, 0.5316669882575175, 4535.8604)
('Test: AUC, AUPR, Erros: ', 0.7224884589037268, 0.5614654330976361, 4765.374)
90((647, 331), (647, 331), 51449.477, 57914.0)
('Error: ', tensor(35376.3984, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7401697913295511, 0.5622731085681468)
('Val: AUC, AUPR, Erros: ', 0.7280748314232026, 0.535744215817803, 4506.957)
('Test: AUC, AUPR, Erros: ', 0.722916819015154, 0.5625154637702773, 4740.5303)
100((647, 331), (647, 331), 51313.133, 57914.0)
('Error: ', tensor(35240.7344, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7429286160058095, 0.5655771943373453)
('Val: AUC, AUPR, Erros: ', 0.7299164063391312, 0.5379640481629014, 4498.3335)
('Test: AUC, AUPR, Erros: ', 0.7229341880319842, 0.5629015519348706, 4742.5425)
110((647, 331), (647, 331), 52047.008, 57914.0)
('Error: ', tensor(35046.6797, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7453877221194761, 0.5686797849592574)
('Val: AUC, AUPR, Erros: ', 0.7315193197921346, 0.5398836989111871, 4482.8154)
('Test: AUC, AUPR, Erros: ', 0.7227956862815881, 0.5629904208378806, 4732.3955)
120((647, 331), (647, 331), 51699.152, 57914.0)
('Error: ', tensor(34956.8203, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7476547795699642, 0.5715976632735937)
('Val: AUC, AUPR, Erros: ', 0.7328879200802337, 0.5416524012368669, 4478.8228)
('Test: AUC, AUPR, Erros: ', 0.7225936666004842, 0.5630693739895357, 4739.8745)
130((647, 331), (647, 331), 52058.074, 57914.0)
('Error: ', tensor(34819.7734, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7497951082708626, 0.5743727149564396)
('Val: AUC, AUPR, Erros: ', 0.73412548458423, 0.5432333455882137, 4469.0796)
('Test: AUC, AUPR, Erros: ', 0.72228344812115, 0.5630344604165962, 4736.8013)
140((647, 331), (647, 331), 52001.316, 57914.0)
('Error: ', tensor(34722.2461, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7518995094306538, 0.5770784757887486)
('Val: AUC, AUPR, Erros: ', 0.7352857165522836, 0.5446808056842397, 4463.983)
('Test: AUC, AUPR, Erros: ', 0.7218613521325781, 0.5628499585414264, 4741.114)
150((647, 331), (647, 331), 52100.766, 57914.0)
('Error: ', tensor(34617.8438, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7539551116918874, 0.5796558866921759)
('Val: AUC, AUPR, Erros: ', 0.736363479336407, 0.546003222195347, 4457.8413)
('Test: AUC, AUPR, Erros: ', 0.7215613137123953, 0.5628500870844009, 4742.007)
160((647, 331), (647, 331), 52000.18, 57914.0)
('Error: ', tensor(34534.0273, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7558891696744947, 0.5821204368380423)
('Val: AUC, AUPR, Erros: ', 0.7372956130240449, 0.5470612588354957, 4454.5005)
('Test: AUC, AUPR, Erros: ', 0.721199266664432, 0.5626112320821927, 4746.8633)

Validation:  [0.7372956130240449, 0.5470612588354957, 4454.5005, 0.721199266664432, 0.5626112320821927, 4746.8633]
Train: 0.7559 0.5821
Test: 0.7212 0.5626
4
[0.5360157671432214, 0.5252951335945543, 0.5272484858321149, 0.5282183291982375, 0.5349991978248387, 0.5374449258436196, 0.5423305749943163, 0.5576509713931079, 0.5660997986561879, 0.5701716872608942, 0.575040893766363, 0.5773397726617252, 0.5806181275154136, 0.5822362078388184, 0.5901018478027867, 0.5977432744638531, 0.6039473935239847, 0.6085588413981804, 0.613607168357515, 0.6162426659117564, 0.6170200364881733, 0.6221066205706763, 0.6263467538513457, 0.6304759258655517, 0.6323431783157909, 0.636194610629241, 0.6393256541303926, 0.640691866395174, 0.6426463272391125, 0.6435848831155773, 0.6491922393914986, 0.6522271695831274, 0.6566130429905682, 0.6609555078478019, 0.666145395473224, 0.6686128620180304, 0.6697743290169721, 0.6733370723130893, 0.6733370723130893, 0.6762841209586156, 0.6778492459612958, 0.6806112351656415, 0.682108094787372, 0.688166236511817, 0.6921261640288103, 0.6921261640288103, 0.6930629305188477, 0.6930629305188477, 0.6958470699647086, 0.6973503666477252, 0.6973503666477252, 0.7006441660400423, 0.7006441660400423, 0.7006441660400423, 0.7006441660400423, 0.7006441660400423, 0.7006441660400423, 0.7006441660400423, 0.7042136447515129, 0.7042136447515129, 0.7061569975807352, 0.7078979370152627, 0.7078979370152627, 0.7078979370152627, 0.7078979370152627, 0.7078979370152627, 0.7078979370152627, 0.7100625752940259, 0.7100625752940259, 0.7100625752940259, 0.7167169314896353, 0.7167169314896353, 0.7167169314896353, 0.7188583948643301, 0.7188583948643301, 0.7188583948643301, 0.7188583948643301, 0.7188583948643301, 0.721199266664432, 0.721199266664432, 0.721199266664432, 0.721199266664432, 0.721199266664432, 0.721199266664432, 0.721199266664432, 0.721199266664432, 0.721199266664432, 0.721199266664432, 0.721199266664432, 0.721199266664432]
[0.13917264820148031, 0.1534954372191507, 0.15613554613858954, 0.1542727234074199, 0.16144692625877652, 0.1658201005477697, 0.1743369667665733, 0.19271542613984272, 0.20394178407011646, 0.21077741362393249, 0.21870723579804457, 0.22151455429658334, 0.22514058747977536, 0.22759395836121965, 0.24364288742107848, 0.25619178179241364, 0.2672604076349904, 0.2730336307998452, 0.2832549371201012, 0.28943288449518995, 0.29100086936429087, 0.3012599867683816, 0.30890562354221396, 0.3162381969963638, 0.3207601632043108, 0.3277935957553293, 0.3347626229240242, 0.3377803231014631, 0.34170861942561165, 0.34500518561918864, 0.35833424559901295, 0.3662204073316263, 0.37771085221038325, 0.388398705781769, 0.4026896689401209, 0.4087003104337853, 0.41106235641839484, 0.4178135120727545, 0.4178135120727545, 0.42905775157866954, 0.433102790577714, 0.44123936702361805, 0.4455200515894137, 0.46432865472444607, 0.4733990859808576, 0.4733990859808576, 0.47573188027553737, 0.47573188027553737, 0.48327268701102927, 0.48780276128291367, 0.48780276128291367, 0.49674460402122855, 0.49674460402122855, 0.49674460402122855, 0.49674460402122855, 0.49674460402122855, 0.49674460402122855, 0.49674460402122855, 0.5078749928530433, 0.5078749928530433, 0.5137568063236854, 0.5185392637117847, 0.5185392637117847, 0.5185392637117847, 0.5185392637117847, 0.5185392637117847, 0.5185392637117847, 0.5252393034492273, 0.5252393034492273, 0.5252393034492273, 0.5488201752181969, 0.5488201752181969, 0.5488201752181969, 0.5549432772330102, 0.5549432772330102, 0.5549432772330102, 0.5549432772330102, 0.5549432772330102, 0.5626112320821927, 0.5626112320821927, 0.5626112320821927, 0.5626112320821927, 0.5626112320821927, 0.5626112320821927, 0.5626112320821927, 0.5626112320821927, 0.5626112320821927, 0.5626112320821927, 0.5626112320821927, 0.5626112320821927]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  65516.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_0_5
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19621.0)
('VALIDATE SUM PROTEIN TEST: ', 2591.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 52930.004, 58297.0)
('Error: ', tensor(42555.8047, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.4832193603215631, 0.2557532486316875)
('Val: AUC, AUPR, Erros: ', 0.4890825853043913, 0.26181638937074175, 5376.7085)
('Test: AUC, AUPR, Erros: ', 0.4896084762766193, 0.2558961781975999, 5289.281)
10((646, 331), (646, 331), 61272.08, 58297.0)
('Error: ', tensor(42192.6367, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6321946369897724, 0.37564698964199744)
('Val: AUC, AUPR, Erros: ', 0.630476625042997, 0.37494207209038616, 5326.22)
('Test: AUC, AUPR, Erros: ', 0.616596765595938, 0.3539514004452851, 5256.2354)
20((646, 331), (646, 331), 59503.547, 58297.0)
('Error: ', tensor(41667.7891, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6705005041134843, 0.4246077466313839)
('Val: AUC, AUPR, Erros: ', 0.6689870186437659, 0.4244697516614423, 5262.032)
('Test: AUC, AUPR, Erros: ', 0.6610592017028247, 0.4086492326120041, 5191.833)
30((646, 331), (646, 331), 64502.098, 58297.0)
('Error: ', tensor(41118.9570, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6913021839040504, 0.46475331031436046)
('Val: AUC, AUPR, Erros: ', 0.6911773456965987, 0.4657793616069708, 5189.799)
('Test: AUC, AUPR, Erros: ', 0.683533906769436, 0.45206589850485907, 5131.6284)
40((646, 331), (646, 331), 68025.19, 58297.0)
('Error: ', tensor(40267.6680, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7053672450718408, 0.49828904137212565)
('Val: AUC, AUPR, Erros: ', 0.7054256125566762, 0.49951577639688916, 5081.5093)
('Test: AUC, AUPR, Erros: ', 0.6979992059654294, 0.4867401249869103, 5034.7573)
50((646, 331), (646, 331), 69806.77, 58297.0)
('Error: ', tensor(39096.2305, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.71504022364273, 0.5234950971030115)
('Val: AUC, AUPR, Erros: ', 0.7153405210599518, 0.526024463702256, 4933.0723)
('Test: AUC, AUPR, Erros: ', 0.7065568897940765, 0.5088648073528245, 4902.4)
60((646, 331), (646, 331), 72211.64, 58297.0)
('Error: ', tensor(38060.0352, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7217726562583411, 0.5378779408859182)
('Val: AUC, AUPR, Erros: ', 0.7221976062906659, 0.5404567762074466, 4801.2163)
('Test: AUC, AUPR, Erros: ', 0.7123814455988182, 0.519022929745043, 4790.083)
70((646, 331), (646, 331), 70122.72, 58297.0)
('Error: ', tensor(36969.8398, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7286168004172443, 0.548640163534931)
('Val: AUC, AUPR, Erros: ', 0.7286106642833624, 0.5514530415641636, 4666.8438)
('Test: AUC, AUPR, Erros: ', 0.719321912548614, 0.5301673236243376, 4661.504)
80((646, 331), (646, 331), 68279.31, 58297.0)
('Error: ', tensor(36264.9219, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7334646990923761, 0.5553525261885761)
('Val: AUC, AUPR, Erros: ', 0.7330934110755098, 0.5579288324404468, 4581.0474)
('Test: AUC, AUPR, Erros: ', 0.7243291756910938, 0.5363557068505936, 4577.867)
90((646, 331), (646, 331), 67228.54, 58297.0)
('Error: ', tensor(35853.6250, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7372579557948915, 0.5601520340594555)
('Val: AUC, AUPR, Erros: ', 0.735915357504555, 0.5620316441359766, 4535.2637)
('Test: AUC, AUPR, Erros: ', 0.7279509438168219, 0.5407239084664328, 4531.038)
100((646, 331), (646, 331), 66476.41, 58297.0)
('Error: ', tensor(35568.1758, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7403936032788724, 0.5639847829307894)
('Val: AUC, AUPR, Erros: ', 0.73815704439063, 0.5652482927991307, 4504.6255)
('Test: AUC, AUPR, Erros: ', 0.7310011617521047, 0.5441345511747948, 4497.845)
110((646, 331), (646, 331), 66304.46, 58297.0)
('Error: ', tensor(35376.6484, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7431751553535659, 0.5672885787546212)
('Val: AUC, AUPR, Erros: ', 0.7397451046237351, 0.567297801514179, 4487.807)
('Test: AUC, AUPR, Erros: ', 0.7333607285535861, 0.546512713799335, 4477.875)
120((646, 331), (646, 331), 66201.79, 58297.0)
('Error: ', tensor(35216.6406, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7457624330313672, 0.5703148566939141)
('Val: AUC, AUPR, Erros: ', 0.741048331324768, 0.5690244198284333, 4475.9243)
('Test: AUC, AUPR, Erros: ', 0.7355048424909291, 0.5490322211701784, 4461.386)
130((646, 331), (646, 331), 66465.16, 58297.0)
('Error: ', tensor(35098.9375, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7482240121513419, 0.5732391637767712)
('Val: AUC, AUPR, Erros: ', 0.7423353436262828, 0.5709035845118964, 4468.3286)
('Test: AUC, AUPR, Erros: ', 0.7376314182929207, 0.5517390356517686, 4448.682)
140((646, 331), (646, 331), 66446.38, 58297.0)
('Error: ', tensor(34971.4883, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7505291069105196, 0.5759949262283002)
('Val: AUC, AUPR, Erros: ', 0.7433145923437326, 0.5722467346286639, 4460.593)
('Test: AUC, AUPR, Erros: ', 0.7395728273032502, 0.5538488977023924, 4435.811)
150((646, 331), (646, 331), 65162.68, 58297.0)
('Error: ', tensor(34776.5586, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.752556758752916, 0.5784427984786458)
('Val: AUC, AUPR, Erros: ', 0.7441192933116114, 0.5735438441010869, 4441.8296)
('Test: AUC, AUPR, Erros: ', 0.7407466026287985, 0.5550866331756026, 4417.1914)
160((646, 331), (646, 331), 68170.7, 58297.0)
('Error: ', tensor(34883.9922, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7549004481805139, 0.5811662227333141)
('Val: AUC, AUPR, Erros: ', 0.7451666076748147, 0.5747254319237336, 4468.023)
('Test: AUC, AUPR, Erros: ', 0.7429944040303335, 0.5579997038622952, 4430.766)

Validation:  [0.7441192933116114, 0.5735438441010869, 4441.8296, 0.7407466026287985, 0.5550866331756026, 4417.1914]
Train: 0.7526 0.5784
Test: 0.7407 0.5551
5
[0.6077147348982682, 0.6088897227828776, 0.6054735205008175, 0.6054003105793535, 0.6113230144909414, 0.6129258889440676, 0.6129132997152816, 0.6229090582081424, 0.6260297005029998, 0.6261731768177161, 0.6269534239919254, 0.6271772292879179, 0.632878100105299, 0.6341231693231693, 0.633536296624613, 0.6392276599624338, 0.6412293810513676, 0.6450282024846168, 0.6486722420979769, 0.6510107044884157, 0.6515378303202941, 0.6549670822091413, 0.6562191685647735, 0.6589391916617244, 0.6602251082569104, 0.6654692882847881, 0.6683085844985032, 0.6698023576881755, 0.6722013246642053, 0.6730789789606667, 0.6790623010554551, 0.6821049695985731, 0.6855416924513926, 0.6885634370761393, 0.6927082074410128, 0.6938860434156291, 0.6947931173997768, 0.6976357102365718, 0.6976357102365718, 0.7001921387715834, 0.7010864043614597, 0.7039090363769123, 0.7050221423366353, 0.7103454731947966, 0.7129663820383996, 0.7129663820383996, 0.7138158955676043, 0.7138158955676043, 0.7166004815234907, 0.7182280226323193, 0.7182280226323193, 0.7205651863062722, 0.7205651863062722, 0.7205651863062722, 0.7205651863062722, 0.7205651863062722, 0.7205651863062722, 0.7205651863062722, 0.724102835802692, 0.724102835802692, 0.7257719363743047, 0.7279223253755074, 0.7279223253755074, 0.7279223253755074, 0.7279223253755074, 0.7279223253755074, 0.7279223253755074, 0.7298061791560668, 0.7298061791560668, 0.7298061791560668, 0.7359799982140489, 0.7359799982140489, 0.7359799982140489, 0.7381959073806439, 0.7381959073806439, 0.7381959073806439, 0.7381959073806439, 0.7381959073806439, 0.7407466026287985, 0.7407466026287985, 0.7407466026287985, 0.7407466026287985, 0.7407466026287985, 0.7407466026287985, 0.7407466026287985, 0.7407466026287985, 0.7407466026287985, 0.7407466026287985, 0.7407466026287985, 0.7407466026287985]
[0.16765467609466123, 0.17886599148568433, 0.1709802259398515, 0.18176003712391528, 0.19134276423772079, 0.19697851018513649, 0.2025365493151145, 0.2211401776456547, 0.22999670572616498, 0.23350258644469685, 0.23619764141463115, 0.23785383195599574, 0.25063627629916335, 0.25114400248011176, 0.2504296492318883, 0.26650346178625894, 0.26967443863724405, 0.2793104153145691, 0.28752732693035793, 0.2949105953781862, 0.2960952783065216, 0.3054843958257187, 0.3075891341916187, 0.31649350207310933, 0.31974965273477723, 0.33422541031124875, 0.34227240895246236, 0.3465557300799996, 0.3541599204703958, 0.3575321897986945, 0.3742200395979084, 0.3808147834622604, 0.38862782290930187, 0.39780834361981277, 0.4094456746101699, 0.41247560444625186, 0.4132822725654398, 0.42073696589417664, 0.42073696589417664, 0.428606877330033, 0.43092658872235845, 0.441138902414173, 0.44418797969021345, 0.4606829696052549, 0.46536152873330616, 0.46536152873330616, 0.4673777576434345, 0.4673777576434345, 0.4761775168668638, 0.4813087273158882, 0.4813087273158882, 0.48709606788471027, 0.48709606788471027, 0.48709606788471027, 0.48709606788471027, 0.48709606788471027, 0.48709606788471027, 0.48709606788471027, 0.4997583149296838, 0.4997583149296838, 0.5048985236817216, 0.5134286951596138, 0.5134286951596138, 0.5134286951596138, 0.5134286951596138, 0.5134286951596138, 0.5134286951596138, 0.5192701313317971, 0.5192701313317971, 0.5192701313317971, 0.5383021427598084, 0.5383021427598084, 0.5383021427598084, 0.5457038790515195, 0.5457038790515195, 0.5457038790515195, 0.5457038790515195, 0.5457038790515195, 0.5550866331756026, 0.5550866331756026, 0.5550866331756026, 0.5550866331756026, 0.5550866331756026, 0.5550866331756026, 0.5550866331756026, 0.5550866331756026, 0.5550866331756026, 0.5550866331756026, 0.5550866331756026, 0.5550866331756026]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  66164.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_0_6
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19833.0)
('VALIDATE SUM PROTEIN TEST: ', 2431.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 41293.65, 58772.0)
('Error: ', tensor(44056.8281, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.4959103463559227, 0.269922670720723)
('Val: AUC, AUPR, Erros: ', 0.4938904551129753, 0.24475385995091095, 5140.469)
('Test: AUC, AUPR, Erros: ', 0.492787410141226, 0.2686062619612883, 5538.5396)
10((646, 331), (646, 331), 52623.58, 58772.0)
('Error: ', tensor(42248.4453, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6485038710057932, 0.4013051887103084)
('Val: AUC, AUPR, Erros: ', 0.6170596813249754, 0.3325551104978686, 4998.382)
('Test: AUC, AUPR, Erros: ', 0.6472120937085984, 0.39739647882057716, 5310.6836)
20((646, 331), (646, 331), 76653.02, 58772.0)
('Error: ', tensor(43112.1953, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6866077799970489, 0.44950540708020625)
('Val: AUC, AUPR, Erros: ', 0.6591341788224159, 0.3751001114526259, 5247.0146)
('Test: AUC, AUPR, Erros: ', 0.6855681910138884, 0.44524148329749846, 5423.0396)
30((646, 331), (646, 331), 60783.05, 58772.0)
('Error: ', tensor(40421.5703, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7142737190048014, 0.5016411531981683)
('Val: AUC, AUPR, Erros: ', 0.6948018991065577, 0.4210271523372897, 4840.362)
('Test: AUC, AUPR, Erros: ', 0.7147088526399703, 0.5004550654915996, 5083.6885)
40((646, 331), (646, 331), 63037.957, 58772.0)
('Error: ', tensor(38931.7422, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7233309891499471, 0.5264485565893824)
('Val: AUC, AUPR, Erros: ', 0.7131614725308414, 0.45460465490430024, 4684.049)
('Test: AUC, AUPR, Erros: ', 0.7246014371719223, 0.5271524294832061, 4893.7085)
50((646, 331), (646, 331), 63322.715, 58772.0)
('Error: ', tensor(37554.6836, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7271402400578957, 0.5407240298160747)
('Val: AUC, AUPR, Erros: ', 0.7214283588294752, 0.47662307350483124, 4532.3926)
('Test: AUC, AUPR, Erros: ', 0.7295317013907698, 0.5430962667746686, 4712.4697)
60((646, 331), (646, 331), 63917.254, 58772.0)
('Error: ', tensor(36798.2969, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7306579351676191, 0.5492281640046466)
('Val: AUC, AUPR, Erros: ', 0.7255505814122927, 0.4880725436148018, 4460.7803)
('Test: AUC, AUPR, Erros: ', 0.7327553399747515, 0.5522211097552875, 4616.106)
70((646, 331), (646, 331), 68369.94, 58772.0)
('Error: ', tensor(36580.2539, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7347559998617195, 0.5559450473838112)
('Val: AUC, AUPR, Erros: ', 0.7280652555634946, 0.495251287844453, 4482.406)
('Test: AUC, AUPR, Erros: ', 0.7358395138235436, 0.5587815058823964, 4599.042)
80((646, 331), (646, 331), 67632.78, 58772.0)
('Error: ', tensor(36103.3281, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7383608456346933, 0.5613382612429967)
('Val: AUC, AUPR, Erros: ', 0.7299274484155422, 0.5003499554721433, 4441.219)
('Test: AUC, AUPR, Erros: ', 0.7380697861903447, 0.5632552925038755, 4546.474)
90((646, 331), (646, 331), 66984.52, 58772.0)
('Error: ', tensor(35767.7188, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7416257542260987, 0.5654005168676842)
('Val: AUC, AUPR, Erros: ', 0.7309129961781059, 0.5022905526876092, 4416.271)
('Test: AUC, AUPR, Erros: ', 0.740015434018408, 0.5665142143764113, 4510.1714)
100((646, 331), (646, 331), 67201.164, 58772.0)
('Error: ', tensor(35556.7266, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7447458615355782, 0.5693233389474908)
('Val: AUC, AUPR, Erros: ', 0.7306743236078473, 0.502514846386732, 4418.0835)
('Test: AUC, AUPR, Erros: ', 0.7415931804304661, 0.568945629532542, 4493.5664)
110((646, 331), (646, 331), 67217.305, 58772.0)
('Error: ', tensor(35360.7773, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7476340762118383, 0.5731101851762603)
('Val: AUC, AUPR, Erros: ', 0.7301705028072918, 0.5021855309094779, 4421.8525)
('Test: AUC, AUPR, Erros: ', 0.7432641727018369, 0.5712185867813414, 4477.7285)
120((646, 331), (646, 331), 67343.19, 58772.0)
('Error: ', tensor(35201.9609, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.75036256504981, 0.5766103137170985)
('Val: AUC, AUPR, Erros: ', 0.7297351396546362, 0.5016584299049895, 4426.8716)
('Test: AUC, AUPR, Erros: ', 0.7446630243029709, 0.5728751219373254, 4467.477)
130((646, 331), (646, 331), 67419.195, 58772.0)
('Error: ', tensor(35057.6523, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7528489022063671, 0.5799465513774001)
('Val: AUC, AUPR, Erros: ', 0.7292132780156818, 0.5014614430671112, 4432.661)
('Test: AUC, AUPR, Erros: ', 0.7455632735400618, 0.5742842306385287, 4460.8174)
140((646, 331), (646, 331), 67327.12, 58772.0)
('Error: ', tensor(34920.6875, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7551289724031228, 0.5828809058626795)
('Val: AUC, AUPR, Erros: ', 0.7282282401109308, 0.5005012950846401, 4437.182)
('Test: AUC, AUPR, Erros: ', 0.7472730340749419, 0.57602659811477, 4447.7817)
150((646, 331), (646, 331), 67453.625, 58772.0)
('Error: ', tensor(34807.2852, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7573137962111353, 0.5858127300376026)
('Val: AUC, AUPR, Erros: ', 0.7275365588741536, 0.5000730942327509, 4444.014)
('Test: AUC, AUPR, Erros: ', 0.7483208291228142, 0.5774083426010028, 4442.529)
160((646, 331), (646, 331), 71301.914, 58772.0)
('Error: ', tensor(35075.0625, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7595034696083658, 0.588750606617025)
('Val: AUC, AUPR, Erros: ', 0.7266903242169573, 0.49915600364225504, 4525.64)
('Test: AUC, AUPR, Erros: ', 0.7494944277082582, 0.5790205129414034, 4493.6436)

Validation:  [0.7309129961781059, 0.5022905526876092, 4416.271, 0.740015434018408, 0.5665142143764113, 4510.1714]
Train: 0.7416 0.5654
Test: 0.7400 0.5665
6
[0.537106576697324, 0.5496954303840877, 0.5574766955962713, 0.5587971174969777, 0.567057495075109, 0.5712779661678183, 0.5727124738368682, 0.5830674969143987, 0.5868498769610124, 0.5896495534929658, 0.5937353159212975, 0.5979054300717436, 0.6048451959489867, 0.6079796183491327, 0.6178983267932845, 0.6220103351529646, 0.6261277995585826, 0.6316849079865969, 0.6366695099998896, 0.6390778074826244, 0.6402965398302221, 0.6442544075528168, 0.6475499912105017, 0.6523563016194613, 0.6527638024767831, 0.6575427105703557, 0.6598968143081241, 0.6610072460101123, 0.6629455810572754, 0.6635033126209301, 0.6694112238732883, 0.672649648823435, 0.6774818466986444, 0.6807316840278659, 0.6860376444063412, 0.6877591604235944, 0.6886522642791528, 0.6923931809843518, 0.6923931809843518, 0.6951695782608366, 0.6961439906961008, 0.6986006294748638, 0.700127343142424, 0.7067075624469898, 0.7105373748115875, 0.7105373748115875, 0.7113677999539907, 0.7113677999539907, 0.7138039712762242, 0.7151043000777024, 0.7151043000777024, 0.7179094992395382, 0.7179094992395382, 0.7179094992395382, 0.7179094992395382, 0.7179094992395382, 0.7179094992395382, 0.7179094992395382, 0.7218216563755863, 0.7218216563755863, 0.7238527867623719, 0.725640200824412, 0.725640200824412, 0.725640200824412, 0.725640200824412, 0.725640200824412, 0.725640200824412, 0.728326670126408, 0.728326670126408, 0.728326670126408, 0.7349516141280354, 0.7349516141280354, 0.7349516141280354, 0.7376367578816845, 0.7376367578816845, 0.7376367578816845, 0.7376367578816845, 0.7376367578816845, 0.740015434018408, 0.740015434018408, 0.740015434018408, 0.740015434018408, 0.740015434018408, 0.740015434018408, 0.740015434018408, 0.740015434018408, 0.740015434018408, 0.740015434018408, 0.740015434018408, 0.740015434018408]
[0.11177170184799061, 0.12763415149103544, 0.13963185501936765, 0.15058597265202484, 0.16204083462337013, 0.16980212128724248, 0.16743548808522157, 0.18182168838619023, 0.1904481660700439, 0.19617169288701675, 0.20282128052513773, 0.21195850139929362, 0.22293586616575412, 0.22706166477267317, 0.2448753410863256, 0.25307799251082896, 0.2601601623078771, 0.2714279259344701, 0.28335003769396516, 0.2854694947941031, 0.2886495465306963, 0.2950963690041953, 0.3024415243572677, 0.3128407920093059, 0.3110713401723217, 0.3243741334891139, 0.32935423305595485, 0.33221450270444797, 0.3391811792194308, 0.34012394910567745, 0.3546097144089409, 0.36590156540170193, 0.37620081882328443, 0.38455217421638865, 0.4015563970554307, 0.4046589753379042, 0.4065422480440394, 0.4162332453328297, 0.4162332453328297, 0.42686581088214226, 0.4288322931164256, 0.4344467932703283, 0.44004622748046035, 0.4625044326989691, 0.4737474324943382, 0.4737474324943382, 0.474123218126525, 0.474123218126525, 0.4799955744966852, 0.4838864906090829, 0.4838864906090829, 0.4910145857608256, 0.4910145857608256, 0.4910145857608256, 0.4910145857608256, 0.4910145857608256, 0.4910145857608256, 0.4910145857608256, 0.5051008205271184, 0.5051008205271184, 0.5119816148303182, 0.5175360373723311, 0.5175360373723311, 0.5175360373723311, 0.5175360373723311, 0.5175360373723311, 0.5175360373723311, 0.5284553584100833, 0.5284553584100833, 0.5284553584100833, 0.5499444015202166, 0.5499444015202166, 0.5499444015202166, 0.5594498680101772, 0.5594498680101772, 0.5594498680101772, 0.5594498680101772, 0.5594498680101772, 0.5665142143764113, 0.5665142143764113, 0.5665142143764113, 0.5665142143764113, 0.5665142143764113, 0.5665142143764113, 0.5665142143764113, 0.5665142143764113, 0.5665142143764113, 0.5665142143764113, 0.5665142143764113, 0.5665142143764113]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  65457.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_0_7
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19889.0)
('VALIDATE SUM PROTEIN TEST: ', 2379.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 54017.0, 58713.0)
('Error: ', tensor(42683.1250, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5110916099197317, 0.2818760838963348)
('Val: AUC, AUPR, Erros: ', 0.5169507552649764, 0.2890441411728056, 5395.207)
('Test: AUC, AUPR, Erros: ', 0.5164935825009942, 0.263198243371711, 5045.6)
10((646, 331), (646, 331), 54866.15, 58713.0)
('Error: ', tensor(41584.5156, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6873469455039758, 0.46219218202223117)
('Val: AUC, AUPR, Erros: ', 0.6809449526160447, 0.4556286588437954, 5261.707)
('Test: AUC, AUPR, Erros: ', 0.6790740971777759, 0.41024237352271165, 4928.4624)
20((646, 331), (646, 331), 47481.94, 58713.0)
('Error: ', tensor(40245.3398, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7172075656068541, 0.5260043486204842)
('Val: AUC, AUPR, Erros: ', 0.7075394713782941, 0.5119310772316878, 5109.1387)
('Test: AUC, AUPR, Erros: ', 0.7096565732258382, 0.47065604494641555, 4739.513)
30((646, 331), (646, 331), 47896.51, 58713.0)
('Error: ', tensor(37913.9609, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7289136837717396, 0.5457564441609595)
('Val: AUC, AUPR, Erros: ', 0.7172954487222858, 0.5249023405096185, 4838.12)
('Test: AUC, AUPR, Erros: ', 0.7194236902757731, 0.48310680817650264, 4496.2686)
40((646, 331), (646, 331), 49860.44, 58713.0)
('Error: ', tensor(36390.3711, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7377565691213037, 0.5598642447906589)
('Val: AUC, AUPR, Erros: ', 0.7241129477046179, 0.5367204340230882, 4676.5303)
('Test: AUC, AUPR, Erros: ', 0.7258367113999655, 0.49360228026915187, 4369.966)
50((646, 331), (646, 331), 56319.7, 58713.0)
('Error: ', tensor(35475.2812, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7435886432623494, 0.5687495615107867)
('Val: AUC, AUPR, Erros: ', 0.7277562859719312, 0.5454861144366926, 4584.885)
('Test: AUC, AUPR, Erros: ', 0.7294638324897478, 0.5014674676221396, 4335.2593)
60((646, 331), (646, 331), 44471.055, 58713.0)
('Error: ', tensor(36382.0078, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7492027990541943, 0.5756720153050638)
('Val: AUC, AUPR, Erros: ', 0.7299423901445367, 0.5509755307386883, 4698.0635)
('Test: AUC, AUPR, Erros: ', 0.7310714585084216, 0.5050378526624233, 4366.9795)
70((646, 331), (646, 331), 54943.477, 58713.0)
('Error: ', tensor(34871.7539, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.752454558430235, 0.5807621883820712)
('Val: AUC, AUPR, Erros: ', 0.7310711489999124, 0.5540630003396491, 4542.7236)
('Test: AUC, AUPR, Erros: ', 0.7311843365945908, 0.5053468636117738, 4314.9385)
80((646, 331), (646, 331), 49298.664, 58713.0)
('Error: ', tensor(35227.3359, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7559883035670829, 0.5848669409547002)
('Val: AUC, AUPR, Erros: ', 0.7318131212073149, 0.5557858579896977, 4587.374)
('Test: AUC, AUPR, Erros: ', 0.731397627112873, 0.5049554488291492, 4321.3105)
90((646, 331), (646, 331), 53357.652, 58713.0)
('Error: ', tensor(34614.5078, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7584653931140459, 0.5888658991836585)
('Val: AUC, AUPR, Erros: ', 0.7322288087959794, 0.5567661577092042, 4535.4536)
('Test: AUC, AUPR, Erros: ', 0.7309944330324966, 0.5033480882629139, 4320.8003)
100((646, 331), (646, 331), 50676.926, 58713.0)
('Error: ', tensor(34758.3594, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7611479334978297, 0.5919920313251393)
('Val: AUC, AUPR, Erros: ', 0.7324815620455849, 0.5573935015905755, 4558.31)
('Test: AUC, AUPR, Erros: ', 0.7312430441354796, 0.5020867895220369, 4327.0596)
110((646, 331), (646, 331), 51673.066, 58713.0)
('Error: ', tensor(34506.5469, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7634159807439524, 0.5953118479730188)
('Val: AUC, AUPR, Erros: ', 0.7322900976462198, 0.557371847031233, 4545.8154)
('Test: AUC, AUPR, Erros: ', 0.7301296144274922, 0.49929396377967045, 4338.206)
120((646, 331), (646, 331), 51571.656, 58713.0)
('Error: ', tensor(34428.7188, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7654473465252912, 0.5979360931741196)
('Val: AUC, AUPR, Erros: ', 0.7328329590792073, 0.5579593532230531, 4544.7446)
('Test: AUC, AUPR, Erros: ', 0.7294982331136126, 0.49752518272153945, 4346.2505)
130((646, 331), (646, 331), 50937.56, 58713.0)
('Error: ', tensor(34386.0820, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7675245045709207, 0.6005501645563344)
('Val: AUC, AUPR, Erros: ', 0.7328127686283166, 0.5579081361666738, 4551.1514)
('Test: AUC, AUPR, Erros: ', 0.7289127205297603, 0.4953506673760435, 4357.2)
140((646, 331), (646, 331), 51878.14, 58713.0)
('Error: ', tensor(34203.8984, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7692538143160477, 0.6030016472853408)
('Val: AUC, AUPR, Erros: ', 0.7325027611524771, 0.5575007625347268, 4543.541)
('Test: AUC, AUPR, Erros: ', 0.7281012855155868, 0.49365472406772326, 4365.0796)
150((646, 331), (646, 331), 50746.703, 58713.0)
('Error: ', tensor(34246.7031, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7709640587105198, 0.6050733322004719)
('Val: AUC, AUPR, Erros: ', 0.7317452189012291, 0.556665045239668, 4559.5977)
('Test: AUC, AUPR, Erros: ', 0.727449557919286, 0.49135637026383583, 4376.4546)
160((646, 331), (646, 331), 51542.625, 58713.0)
('Error: ', tensor(34064.8516, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7727877861429245, 0.6073824387629534)
('Val: AUC, AUPR, Erros: ', 0.7318254954407362, 0.5568514687211883, 4550.6533)
('Test: AUC, AUPR, Erros: ', 0.7267536869813527, 0.48949960286147126, 4385.7964)

Validation:  [0.7322288087959794, 0.5567661577092042, 4535.4536, 0.7309944330324966, 0.5033480882629139, 4320.8003]
Train: 0.7585 0.5889
Test: 0.7310 0.5033
7
[0.5837612227872239, 0.5933935429069054, 0.5833320788417449, 0.5757471074169775, 0.5780026633070805, 0.5792283815315117, 0.5851682352301164, 0.5894859864213537, 0.5947979305285197, 0.5955708306506677, 0.598286475941164, 0.6020543513307637, 0.6058244147848123, 0.6074967092573414, 0.6129078159546361, 0.6192531724342853, 0.6255358624769837, 0.6289939705372091, 0.6318806191714823, 0.6355237577378193, 0.6362301046599561, 0.6395443592227403, 0.6422528768788669, 0.643210903468843, 0.6449742531848889, 0.6492486674692555, 0.6515371000267276, 0.6520350367381543, 0.6538154607219273, 0.65524093953135, 0.6623935734563118, 0.6662125024070903, 0.6708582571259504, 0.6748743377925677, 0.6790615983565902, 0.6808937307888101, 0.682014493032638, 0.6864346696673497, 0.6864346696673497, 0.688269458012222, 0.6892683794468089, 0.6918953708339812, 0.6925622399625826, 0.6982653263434726, 0.701548576447481, 0.701548576447481, 0.7029940999745589, 0.7029940999745589, 0.7057009782780749, 0.7069980851330387, 0.7069980851330387, 0.7099874566059383, 0.7099874566059383, 0.7099874566059383, 0.7099874566059383, 0.7099874566059383, 0.7099874566059383, 0.7099874566059383, 0.7137242551090426, 0.7137242551090426, 0.7153469566257507, 0.7170869827307222, 0.7170869827307222, 0.7170869827307222, 0.7170869827307222, 0.7170869827307222, 0.7170869827307222, 0.7192691696524156, 0.7192691696524156, 0.7192691696524156, 0.7261072077954466, 0.7261072077954466, 0.7261072077954466, 0.72857135694376, 0.72857135694376, 0.72857135694376, 0.72857135694376, 0.72857135694376, 0.7309944330324966, 0.7309944330324966, 0.7309944330324966, 0.7309944330324966, 0.7309944330324966, 0.7309944330324966, 0.7309944330324966, 0.7309944330324966, 0.7309944330324966, 0.7309944330324966, 0.7309944330324966, 0.7309944330324966]
[0.11210917633366775, 0.1340948067150567, 0.13433454834354086, 0.13368829283598901, 0.1392870588252945, 0.14326548316309873, 0.15378116051337243, 0.16396506180115228, 0.17383795107844763, 0.1754746585777327, 0.18112583292348367, 0.18892098969246018, 0.19607948154143634, 0.19946720019163539, 0.20970765928525395, 0.2210996407607064, 0.23203707741451943, 0.23825382116958535, 0.2430823194931203, 0.2501655348021405, 0.25161400242122883, 0.2574007390843366, 0.2626972217606829, 0.26450676863516287, 0.26930629543620277, 0.2783495974806658, 0.2839178421069447, 0.28466887772820193, 0.2887251776979415, 0.292040392699764, 0.3092536389967685, 0.31899902345558, 0.32880830360313995, 0.33856117605895236, 0.3494977744110912, 0.3538559139350474, 0.3561732357845964, 0.3666754190477588, 0.3666754190477588, 0.37104514252799803, 0.3733107765693678, 0.3816295857666711, 0.3826786424764166, 0.39822290895684676, 0.40692754203209636, 0.40692754203209636, 0.41091494615672186, 0.41091494615672186, 0.41831708447460675, 0.4214228866493754, 0.4214228866493754, 0.43021597840733616, 0.43021597840733616, 0.43021597840733616, 0.43021597840733616, 0.43021597840733616, 0.43021597840733616, 0.43021597840733616, 0.4435102945297891, 0.4435102945297891, 0.4488429888401195, 0.45454435641442775, 0.45454435641442775, 0.45454435641442775, 0.45454435641442775, 0.45454435641442775, 0.45454435641442775, 0.4626038935123177, 0.4626038935123177, 0.4626038935123177, 0.4846858972132585, 0.4846858972132585, 0.4846858972132585, 0.49399277757304505, 0.49399277757304505, 0.49399277757304505, 0.49399277757304505, 0.49399277757304505, 0.5033480882629139, 0.5033480882629139, 0.5033480882629139, 0.5033480882629139, 0.5033480882629139, 0.5033480882629139, 0.5033480882629139, 0.5033480882629139, 0.5033480882629139, 0.5033480882629139, 0.5033480882629139, 0.5033480882629139]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
647 81 331
Num Drug-SE:  64751.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_0_8
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((647, 3826), (81, 3826), (647, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 20108.0)
('VALIDATE SUM PROTEIN TEST: ', 2375.0)
(647, 3826) (647, 331)
0((647, 331), (647, 331), 52182.77, 57300.0)
('Error: ', tensor(42075.2188, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5179441535331573, 0.285267591050336)
('Val: AUC, AUPR, Erros: ', 0.5268521738799972, 0.33455755921178626, 5750.4043)
('Test: AUC, AUPR, Erros: ', 0.5229505288546327, 0.29947273972491767, 5409.0225)
10((647, 331), (647, 331), 59301.188, 57300.0)
('Error: ', tensor(41434.6562, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6630353742792217, 0.41098566828877525)
('Val: AUC, AUPR, Erros: ', 0.6456650470503917, 0.4404628162342025, 5603.346)
('Test: AUC, AUPR, Erros: ', 0.6544522387865181, 0.41275451749384684, 5313.525)
20((647, 331), (647, 331), 69933.1, 57300.0)
('Error: ', tensor(41035.9922, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6934176003463144, 0.46012274769913003)
('Val: AUC, AUPR, Erros: ', 0.6742249406267042, 0.48620540125126493, 5452.2227)
('Test: AUC, AUPR, Erros: ', 0.6852235396602153, 0.4619595900792519, 5240.518)
30((647, 331), (647, 331), 68746.75, 57300.0)
('Error: ', tensor(39707.6914, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7103938548601436, 0.49386224860445127)
('Val: AUC, AUPR, Erros: ', 0.6881834551155052, 0.5133479391149056, 5308.1074)
('Test: AUC, AUPR, Erros: ', 0.7012271322779903, 0.49179292296854216, 5082.7314)
40((647, 331), (647, 331), 66343.9, 57300.0)
('Error: ', tensor(37778.9180, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7200259876991817, 0.5192756825504731)
('Val: AUC, AUPR, Erros: ', 0.6946932829725398, 0.5315728275554549, 5112.1177)
('Test: AUC, AUPR, Erros: ', 0.709573348216613, 0.5115516911071764, 4859.901)
50((647, 331), (647, 331), 71112.27, 57300.0)
('Error: ', tensor(37047.8477, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7281129700498317, 0.535622173214181)
('Val: AUC, AUPR, Erros: ', 0.7003103678531275, 0.5434047557390405, 5004.0566)
('Test: AUC, AUPR, Erros: ', 0.7163676862387987, 0.5263360756112041, 4779.1074)
60((647, 331), (647, 331), 64364.4, 57300.0)
('Error: ', tensor(35752.8984, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7340678904066432, 0.5474122521384079)
('Val: AUC, AUPR, Erros: ', 0.704114354172984, 0.5517548120629772, 4931.371)
('Test: AUC, AUPR, Erros: ', 0.7208241294917428, 0.5360840736013174, 4650.5205)
70((647, 331), (647, 331), 64437.93, 57300.0)
('Error: ', tensor(35435.7031, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7382215796068452, 0.5541369569166406)
('Val: AUC, AUPR, Erros: ', 0.7070616973045177, 0.5571844695446586, 4902.129)
('Test: AUC, AUPR, Erros: ', 0.7235871190399868, 0.542106462080989, 4622.9272)
80((647, 331), (647, 331), 64629.93, 57300.0)
('Error: ', tensor(35167.1797, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7416179423592332, 0.5590607674727779)
('Val: AUC, AUPR, Erros: ', 0.7094629403977611, 0.5612354424182149, 4878.3594)
('Test: AUC, AUPR, Erros: ', 0.7255653256925966, 0.5464170943090897, 4601.1504)
90((647, 331), (647, 331), 64847.527, 57300.0)
('Error: ', tensor(34974.8359, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7445880653448304, 0.5629192613914203)
('Val: AUC, AUPR, Erros: ', 0.7114072138998455, 0.5638342661650912, 4860.4507)
('Test: AUC, AUPR, Erros: ', 0.7268295078812429, 0.5493265475419694, 4586.6655)
100((647, 331), (647, 331), 65114.74, 57300.0)
('Error: ', tensor(34803.9805, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7473849226128431, 0.5666939392901986)
('Val: AUC, AUPR, Erros: ', 0.7133576495564777, 0.5665365912590727, 4845.1626)
('Test: AUC, AUPR, Erros: ', 0.7281855401571258, 0.5517964366683554, 4574.792)
110((647, 331), (647, 331), 64526.31, 57300.0)
('Error: ', tensor(34608.7344, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7499232799617255, 0.5700618801225398)
('Val: AUC, AUPR, Erros: ', 0.7148207230193091, 0.5685463265121038, 4833.9556)
('Test: AUC, AUPR, Erros: ', 0.7294744638802713, 0.5541663856644551, 4557.4214)
120((647, 331), (647, 331), 64749.234, 57300.0)
('Error: ', tensor(34482.4766, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7523151523022699, 0.5734448733388475)
('Val: AUC, AUPR, Erros: ', 0.7163177452032863, 0.570640433606533, 4823.624)
('Test: AUC, AUPR, Erros: ', 0.7298400548875241, 0.5552636515884823, 4553.784)
130((647, 331), (647, 331), 64913.875, 57300.0)
('Error: ', tensor(34368.8633, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7545039283398832, 0.5764837634640564)
('Val: AUC, AUPR, Erros: ', 0.7173049979669908, 0.5717311623544002, 4817.497)
('Test: AUC, AUPR, Erros: ', 0.7304670888371521, 0.5571551190503957, 4548.13)
140((647, 331), (647, 331), 64729.004, 57300.0)
('Error: ', tensor(34235.1562, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7566328234670809, 0.5794763897602382)
('Val: AUC, AUPR, Erros: ', 0.7190694717088559, 0.5743156402294217, 4805.0195)
('Test: AUC, AUPR, Erros: ', 0.7310000647480897, 0.5582751848915797, 4541.3394)
150((647, 331), (647, 331), 64974.715, 57300.0)
('Error: ', tensor(34134.4375, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7587328315546155, 0.5824352152154707)
('Val: AUC, AUPR, Erros: ', 0.7203595164216768, 0.5759357134162637, 4796.3955)
('Test: AUC, AUPR, Erros: ', 0.7315538515546751, 0.5597083499702862, 4537.5244)
160((647, 331), (647, 331), 65115.203, 57300.0)
('Error: ', tensor(34042.0508, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7605649191194821, 0.5850039644244466)
('Val: AUC, AUPR, Erros: ', 0.7210183885716962, 0.5773268776540771, 4790.9478)
('Test: AUC, AUPR, Erros: ', 0.7318272631883678, 0.5602734233024174, 4534.924)

Validation:  [0.7210183885716962, 0.5773268776540771, 4790.9478, 0.7318272631883678, 0.5602734233024174, 4534.924]
Train: 0.7606 0.5850
Test: 0.7318 0.5603
8
[0.5894701443914332, 0.5903982340351377, 0.5843408978174602, 0.5849502222991663, 0.5885802644046197, 0.592908873621061, 0.5943681266322111, 0.5990212877362495, 0.6029115981146944, 0.604209856752919, 0.6060784160606978, 0.6065649737712897, 0.6112913767617543, 0.6139019288071169, 0.6199739515498827, 0.6242715468567741, 0.6292480450867568, 0.6348941872579277, 0.639056548511167, 0.6404822257853889, 0.6415238756909183, 0.6447489061219506, 0.648744715065954, 0.6516648908690755, 0.6529109339842366, 0.6576305618791988, 0.6593220245627194, 0.6599190549210096, 0.6610752434001599, 0.6623052557594885, 0.6680175298096309, 0.6705595807228053, 0.6741845023994694, 0.6771495604832524, 0.6795029697418249, 0.6809437297577119, 0.6817322905869857, 0.6852281562797673, 0.6852281562797673, 0.6880831184594105, 0.6889291949090405, 0.6920089807318581, 0.6934690267862533, 0.6990459547811385, 0.7028579986348041, 0.7028579986348041, 0.7036373078218525, 0.7036373078218525, 0.705835853781847, 0.7070809910213298, 0.7070809910213298, 0.7098833361205352, 0.7098833361205352, 0.7098833361205352, 0.7098833361205352, 0.7098833361205352, 0.7098833361205352, 0.7098833361205352, 0.7135562778587681, 0.7135562778587681, 0.7151911670614677, 0.7175196880617584, 0.7175196880617584, 0.7175196880617584, 0.7175196880617584, 0.7175196880617584, 0.7175196880617584, 0.7196431553124807, 0.7196431553124807, 0.7196431553124807, 0.7270572307074501, 0.7270572307074501, 0.7270572307074501, 0.7292960133806794, 0.7292960133806794, 0.7292960133806794, 0.7292960133806794, 0.7292960133806794, 0.7318272631883678, 0.7318272631883678, 0.7318272631883678, 0.7318272631883678, 0.7318272631883678, 0.7318272631883678, 0.7318272631883678, 0.7318272631883678, 0.7318272631883678, 0.7318272631883678, 0.7318272631883678, 0.7318272631883678]
[0.14257026632468695, 0.15762275856828684, 0.15983929585752193, 0.1687412480919802, 0.18406782232738914, 0.1875911843594153, 0.19257236046096926, 0.20161142749737632, 0.21137584864908301, 0.21592651047746395, 0.22261207632789798, 0.22427085670991836, 0.23472803315362534, 0.242227971946668, 0.25601092450244123, 0.2642706947008477, 0.2746824331872877, 0.29032270333412724, 0.29676586320462456, 0.3000061610461466, 0.3034283262775445, 0.3114356822847422, 0.32210840303346766, 0.3293484389325756, 0.3302174015683541, 0.341841771993841, 0.3468731998639701, 0.3466313348389355, 0.3485793642501366, 0.3531041510971413, 0.36809725687144584, 0.3727412150816485, 0.3837345617042692, 0.39217248246574427, 0.3950362478419601, 0.398835127392144, 0.40041774510603056, 0.4095817995822144, 0.4095817995822144, 0.41952514946212444, 0.422320416636481, 0.43316711109896555, 0.4367109533667173, 0.45579878369727495, 0.4665784567785691, 0.4665784567785691, 0.46829777184395566, 0.46829777184395566, 0.4740015199607382, 0.477280461205126, 0.477280461205126, 0.4859568166768099, 0.4859568166768099, 0.4859568166768099, 0.4859568166768099, 0.4859568166768099, 0.4859568166768099, 0.4859568166768099, 0.49877666029049517, 0.49877666029049517, 0.5030468728079189, 0.5115082629253455, 0.5115082629253455, 0.5115082629253455, 0.5115082629253455, 0.5115082629253455, 0.5115082629253455, 0.5173044506589991, 0.5173044506589991, 0.5173044506589991, 0.5442195550660202, 0.5442195550660202, 0.5442195550660202, 0.5507652254019751, 0.5507652254019751, 0.5507652254019751, 0.5507652254019751, 0.5507652254019751, 0.5602734233024174, 0.5602734233024174, 0.5602734233024174, 0.5602734233024174, 0.5602734233024174, 0.5602734233024174, 0.5602734233024174, 0.5602734233024174, 0.5602734233024174, 0.5602734233024174, 0.5602734233024174, 0.5602734233024174]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
647 80 331
Num Drug-SE:  65913.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_0_9
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((647, 3826), (80, 3826), (647, 331), (80, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 20149.0)
('VALIDATE SUM PROTEIN TEST: ', 2160.0)
(647, 3826) (647, 331)
0((647, 331), (647, 331), 44425.914, 57756.0)
('Error: ', tensor(43006.7500, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5050553167719429, 0.27824286337682047)
('Val: AUC, AUPR, Erros: ', 0.5082485961626089, 0.2734258856715419, 5245.9956)
('Test: AUC, AUPR, Erros: ', 0.5115483526637311, 0.3219427017385638, 5911.564)
10((647, 331), (647, 331), 63257.285, 57756.0)
('Error: ', tensor(41938.5859, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6588130538217644, 0.42478911498841926)
('Val: AUC, AUPR, Erros: ', 0.6447324318685445, 0.39442810357189845, 5159.873)
('Test: AUC, AUPR, Erros: ', 0.6461258270074736, 0.45656575076509764, 5601.693)
20((647, 331), (647, 331), 58218.84, 57756.0)
('Error: ', tensor(39899.7031, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7037840888893113, 0.5006407138068499)
('Val: AUC, AUPR, Erros: ', 0.6881568940326774, 0.46580087768895007, 4920.4175)
('Test: AUC, AUPR, Erros: ', 0.6821089757829399, 0.5204274101096769, 5408.127)
30((647, 331), (647, 331), 62001.887, 57756.0)
('Error: ', tensor(37698.8945, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7256253990107531, 0.5337306832341772)
('Val: AUC, AUPR, Erros: ', 0.7054422776751258, 0.49361791357072693, 4699.0586)
('Test: AUC, AUPR, Erros: ', 0.6995785367299638, 0.5456556689931535, 5123.852)
40((647, 331), (647, 331), 58535.723, 57756.0)
('Error: ', tensor(35880.9688, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7346619250357507, 0.5486662838673089)
('Val: AUC, AUPR, Erros: ', 0.7126048856051803, 0.506999612231813, 4518.9204)
('Test: AUC, AUPR, Erros: ', 0.7064753893750713, 0.5557708563176242, 4961.986)
50((647, 331), (647, 331), 50682.08, 57756.0)
('Error: ', tensor(35742.8945, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7413036207471542, 0.5594954847227231)
('Val: AUC, AUPR, Erros: ', 0.7170210720616809, 0.5154338243224912, 4491.4424)
('Test: AUC, AUPR, Erros: ', 0.7110848415541124, 0.5621875422739682, 5029.838)
60((647, 331), (647, 331), 49368.223, 57756.0)
('Error: ', tensor(35438.5781, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7457612123973055, 0.5661168466394101)
('Val: AUC, AUPR, Erros: ', 0.7207182346349821, 0.5201447801206142, 4467.3877)
('Test: AUC, AUPR, Erros: ', 0.7139989987067571, 0.5660150546505757, 5018.3604)
70((647, 331), (647, 331), 52275.695, 57756.0)
('Error: ', tensor(34936.7031, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7488467024683358, 0.570446304434959)
('Val: AUC, AUPR, Erros: ', 0.7233224146782278, 0.5234203765383189, 4435.718)
('Test: AUC, AUPR, Erros: ', 0.7162604425185692, 0.5688275604671109, 4941.164)
80((647, 331), (647, 331), 50837.363, 57756.0)
('Error: ', tensor(34893.8594, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7515830080022454, 0.5742504569686403)
('Val: AUC, AUPR, Erros: ', 0.7253369455026271, 0.5256681440994255, 4425.8145)
('Test: AUC, AUPR, Erros: ', 0.7177414170069083, 0.5703717277415247, 4954.6396)
90((647, 331), (647, 331), 52267.61, 57756.0)
('Error: ', tensor(34628.1328, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7537622551463075, 0.5774397398907587)
('Val: AUC, AUPR, Erros: ', 0.7269505288540203, 0.5275095175012581, 4410.745)
('Test: AUC, AUPR, Erros: ', 0.7187647494865723, 0.571583296478204, 4919.1704)
100((647, 331), (647, 331), 51105.426, 57756.0)
('Error: ', tensor(34613.3438, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7559102224838533, 0.5804304537007814)
('Val: AUC, AUPR, Erros: ', 0.7286881626907507, 0.5294636416756384, 4402.6104)
('Test: AUC, AUPR, Erros: ', 0.7199595049430749, 0.5724380268654146, 4933.4604)
110((647, 331), (647, 331), 51915.477, 57756.0)
('Error: ', tensor(34429.8828, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7577659745106781, 0.5831782431639688)
('Val: AUC, AUPR, Erros: ', 0.7297289062231718, 0.5307493724147647, 4393.812)
('Test: AUC, AUPR, Erros: ', 0.7210577266690508, 0.5734903253780738, 4911.591)
120((647, 331), (647, 331), 51676.38, 57756.0)
('Error: ', tensor(34351.6172, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7594751790550961, 0.585708527626902)
('Val: AUC, AUPR, Erros: ', 0.7309562701658692, 0.5321876632812049, 4386.4136)
('Test: AUC, AUPR, Erros: ', 0.7218524104304576, 0.5740243291769349, 4911.4546)
130((647, 331), (647, 331), 51565.18, 57756.0)
('Error: ', tensor(34268.6250, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7609027209274843, 0.5879127703341194)
('Val: AUC, AUPR, Erros: ', 0.7317036860633194, 0.5329892889950885, 4382.168)
('Test: AUC, AUPR, Erros: ', 0.7226769113924528, 0.5744194983863858, 4909.2734)
140((647, 331), (647, 331), 51641.098, 57756.0)
('Error: ', tensor(34180.3203, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7624267119558381, 0.5901103645839001)
('Val: AUC, AUPR, Erros: ', 0.7325682122561157, 0.5337722545687079, 4377.1606)
('Test: AUC, AUPR, Erros: ', 0.7235220030500189, 0.5748469823560984, 4904.4136)
150((647, 331), (647, 331), 51263.46, 57756.0)
('Error: ', tensor(34140.0664, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7639132227565761, 0.592188626519023)
('Val: AUC, AUPR, Erros: ', 0.733398336893848, 0.534479397805568, 4373.3164)
('Test: AUC, AUPR, Erros: ', 0.7241221273194667, 0.5748437188896037, 4909.9814)
160((647, 331), (647, 331), 51598.633, 57756.0)
('Error: ', tensor(34027.8359, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7652717839063818, 0.5941149986562335)
('Val: AUC, AUPR, Erros: ', 0.7339753502054498, 0.534877103123182, 4370.075)
('Test: AUC, AUPR, Erros: ', 0.7249558179875112, 0.5751023486184237, 4900.957)

Validation:  [0.7339753502054498, 0.534877103123182, 4370.075, 0.7249558179875112, 0.5751023486184237, 4900.957]
Train: 0.7653 0.5941
Test: 0.7250 0.5751
9
[0.5988999168246322, 0.5944023931111234, 0.6071695350961965, 0.6068835406124088, 0.6098117232880252, 0.6084424348697269, 0.6091802193157809, 0.611353680022972, 0.6112957172342889, 0.6125117049672723, 0.6133235254128565, 0.6155100504621325, 0.6184666091131956, 0.6191302370989593, 0.6222273207452677, 0.6257574117211196, 0.6317205842192554, 0.6366040266140535, 0.6397790661763219, 0.6433215441847155, 0.6438804770660562, 0.6469494131201425, 0.6495268228416804, 0.6521844179181107, 0.6539104364888559, 0.6571096742903605, 0.6579345085191057, 0.6576826039111396, 0.6582663018315935, 0.6590855245087017, 0.663855009824658, 0.6658155394920874, 0.6690075148579285, 0.6714901104115206, 0.6762438569948062, 0.6778715295787303, 0.6786373266612007, 0.6821842374021249, 0.6821842374021249, 0.6843273369255463, 0.6851436941713912, 0.6877434945826051, 0.6886856313805415, 0.69263354269471, 0.6962580853885303, 0.6962580853885303, 0.6972035435803037, 0.6972035435803037, 0.7001718437261526, 0.7013369424820011, 0.7013369424820011, 0.704379247927525, 0.704379247927525, 0.704379247927525, 0.704379247927525, 0.704379247927525, 0.704379247927525, 0.704379247927525, 0.7077833992094862, 0.7077833992094862, 0.7094664333088829, 0.7114335399372972, 0.7114335399372972, 0.7114335399372972, 0.7114335399372972, 0.7114335399372972, 0.7114335399372972, 0.7131896775568811, 0.7131896775568811, 0.7131896775568811, 0.7199778217034514, 0.7199778217034514, 0.7199778217034514, 0.7224125617387442, 0.7224125617387442, 0.7224125617387442, 0.7224125617387442, 0.7224125617387442, 0.7249558179875112, 0.7249558179875112, 0.7249558179875112, 0.7249558179875112, 0.7249558179875112, 0.7249558179875112, 0.7249558179875112, 0.7249558179875112, 0.7249558179875112, 0.7249558179875112, 0.7249558179875112, 0.7249558179875112]
[0.1802665910019634, 0.17923849900289512, 0.204886880040693, 0.21267234646385094, 0.22335952957350647, 0.22441580541543393, 0.23083157383602487, 0.24220362990583266, 0.24734436340650306, 0.2523052052149211, 0.2544178844518761, 0.26159022345119215, 0.2700703440341157, 0.27230678516616724, 0.2821930824165019, 0.2916034855311854, 0.30595919408454464, 0.31966367431910436, 0.32731987794730355, 0.33494132763058554, 0.3361728658858393, 0.34313401591055803, 0.3484936359645291, 0.3543653657846162, 0.35929641897147024, 0.36694825259774133, 0.368767339253288, 0.36709621065463727, 0.3685561131756783, 0.37126455062741404, 0.3861288072036224, 0.3921581735521612, 0.4018578244614843, 0.4083818253460535, 0.4219265778230674, 0.426359399509339, 0.42869552476850487, 0.43723297468893924, 0.43723297468893924, 0.4454186875413968, 0.44755639993137064, 0.454818111910711, 0.4575498926643024, 0.4698028301897069, 0.47988380088896004, 0.47988380088896004, 0.48193464899858834, 0.48193464899858834, 0.4919794468077683, 0.4952314338684338, 0.4952314338684338, 0.5057881341249816, 0.5057881341249816, 0.5057881341249816, 0.5057881341249816, 0.5057881341249816, 0.5057881341249816, 0.5057881341249816, 0.5167070995830035, 0.5167070995830035, 0.5224625769023221, 0.5296000174283184, 0.5296000174283184, 0.5296000174283184, 0.5296000174283184, 0.5296000174283184, 0.5296000174283184, 0.534693597306515, 0.534693597306515, 0.534693597306515, 0.5584774773558847, 0.5584774773558847, 0.5584774773558847, 0.566607431995073, 0.566607431995073, 0.566607431995073, 0.566607431995073, 0.566607431995073, 0.5751023486184237, 0.5751023486184237, 0.5751023486184237, 0.5751023486184237, 0.5751023486184237, 0.5751023486184237, 0.5751023486184237, 0.5751023486184237, 0.5751023486184237, 0.5751023486184237, 0.5751023486184237, 0.5751023486184237]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  65173.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_1_0
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19427.0)
('VALIDATE SUM PROTEIN TEST: ', 2525.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 33574.516, 58171.0)
('Error: ', tensor(45178.9375, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.49966968511186094, 0.27201647271639173)
('Val: AUC, AUPR, Erros: ', 0.5095173417851745, 0.29820243701590154, 5965.7783)
('Test: AUC, AUPR, Erros: ', 0.5077744206673879, 0.26354650131627, 5463.8247)
10((646, 331), (646, 331), 62138.223, 58171.0)
('Error: ', tensor(42255.5234, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.552043077324039, 0.3024896825715738)
('Val: AUC, AUPR, Erros: ', 0.5202034511564195, 0.2906893050550424, 5498.9097)
('Test: AUC, AUPR, Erros: ', 0.5162970608096237, 0.26304276677281435, 5193.3867)
20((646, 331), (646, 331), 71603.19, 58171.0)
('Error: ', tensor(41992.7031, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6634935726291084, 0.42181220658828883)
('Val: AUC, AUPR, Erros: ', 0.6441176911108331, 0.42072550079054827, 5424.1895)
('Test: AUC, AUPR, Erros: ', 0.6451413447725983, 0.3786795043654464, 5191.945)
30((646, 331), (646, 331), 58369.523, 58171.0)
('Error: ', tensor(39716.1758, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7100727175071913, 0.5115754862193447)
('Val: AUC, AUPR, Erros: ', 0.6949997919389702, 0.5076387755824041, 5200.186)
('Test: AUC, AUPR, Erros: ', 0.6992274579849675, 0.4772094491968329, 4878.6274)
40((646, 331), (646, 331), 63110.484, 58171.0)
('Error: ', tensor(37322.0391, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7213500565395329, 0.5340235433113053)
('Val: AUC, AUPR, Erros: ', 0.7046548741922047, 0.5255534602019173, 4904.1357)
('Test: AUC, AUPR, Erros: ', 0.7111592767484749, 0.5006800527552367, 4628.63)
50((646, 331), (646, 331), 68954.086, 58171.0)
('Error: ', tensor(36397.3516, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7292382909996875, 0.5497856739313829)
('Val: AUC, AUPR, Erros: ', 0.710467167495093, 0.5377083403184388, 4793.345)
('Test: AUC, AUPR, Erros: ', 0.7180033977440858, 0.5151203528443771, 4574.2393)
60((646, 331), (646, 331), 66542.82, 58171.0)
('Error: ', tensor(35720.4336, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7356002048263385, 0.559615390906538)
('Val: AUC, AUPR, Erros: ', 0.715219159425307, 0.547294126570641, 4732.787)
('Test: AUC, AUPR, Erros: ', 0.7238312041089232, 0.5259734676358592, 4496.5586)
70((646, 331), (646, 331), 65824.086, 58171.0)
('Error: ', tensor(35370.9805, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7403099866508231, 0.5658051149694985)
('Val: AUC, AUPR, Erros: ', 0.7178437476576192, 0.5510847035708402, 4713.0347)
('Test: AUC, AUPR, Erros: ', 0.7267070113990206, 0.5306725313340174, 4470.067)
80((646, 331), (646, 331), 65267.066, 58171.0)
('Error: ', tensor(35109.5859, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7440160821203967, 0.5709209551758072)
('Val: AUC, AUPR, Erros: ', 0.7206732353408806, 0.5548153204142195, 4692.886)
('Test: AUC, AUPR, Erros: ', 0.7289757320946891, 0.533774639876129, 4447.7363)
90((646, 331), (646, 331), 65012.18, 58171.0)
('Error: ', tensor(34914.4219, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7471002207787151, 0.5751322987087994)
('Val: AUC, AUPR, Erros: ', 0.722323382955776, 0.5563653568331535, 4684.4653)
('Test: AUC, AUPR, Erros: ', 0.7303740113975354, 0.5352875077665683, 4438.698)
100((646, 331), (646, 331), 65309.812, 58171.0)
('Error: ', tensor(34770.7344, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.749893773330033, 0.5791311054210725)
('Val: AUC, AUPR, Erros: ', 0.7241977688538197, 0.5580275829785696, 4677.855)
('Test: AUC, AUPR, Erros: ', 0.731386688750172, 0.5363899426532781, 4437.2837)
110((646, 331), (646, 331), 65338.62, 58171.0)
('Error: ', tensor(34623.6406, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7524770372957782, 0.5827272850087212)
('Val: AUC, AUPR, Erros: ', 0.7258357818343881, 0.5596775647107738, 4670.3467)
('Test: AUC, AUPR, Erros: ', 0.7328143871083962, 0.5379150015217251, 4430.1787)
120((646, 331), (646, 331), 65340.902, 58171.0)
('Error: ', tensor(34483.8789, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7548937667560316, 0.5860971397908382)
('Val: AUC, AUPR, Erros: ', 0.7276091598631161, 0.5611091616443205, 4662.518)
('Test: AUC, AUPR, Erros: ', 0.733838812617077, 0.5389986565184638, 4425.2065)
130((646, 331), (646, 331), 65670.234, 58171.0)
('Error: ', tensor(34377.2266, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7571579240506199, 0.5892289950861966)
('Val: AUC, AUPR, Erros: ', 0.7287586733323909, 0.5619033314969725, 4661.444)
('Test: AUC, AUPR, Erros: ', 0.7346575714958746, 0.539385124498694, 4427.151)
140((646, 331), (646, 331), 65945.48, 58171.0)
('Error: ', tensor(34280.1172, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7592094114856617, 0.5920470328591289)
('Val: AUC, AUPR, Erros: ', 0.7297501281913479, 0.5624859675655001, 4660.9565)
('Test: AUC, AUPR, Erros: ', 0.7353337519555687, 0.5398909173608104, 4428.9355)
150((646, 331), (646, 331), 66174.1, 58171.0)
('Error: ', tensor(34185.9570, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7612133642237517, 0.5947057651400266)
('Val: AUC, AUPR, Erros: ', 0.7310535763251217, 0.5634242779213386, 4657.427)
('Test: AUC, AUPR, Erros: ', 0.7359716995392258, 0.540292246493443, 4429.0103)
160((646, 331), (646, 331), 66367.6, 58171.0)
('Error: ', tensor(34095.5352, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.763148823928444, 0.5971760282529747)
('Val: AUC, AUPR, Erros: ', 0.7317063457800818, 0.5632690002392801, 4659.195)
('Test: AUC, AUPR, Erros: ', 0.7364792782786551, 0.5405920427879336, 4430.0044)

Validation:  [0.7310535763251217, 0.5634242779213386, 4657.427, 0.7359716995392258, 0.540292246493443, 4429.0103]
Train: 0.7612 0.5947
Test: 0.7360 0.5403
0
[0.5339813560672456, 0.5623984499841544, 0.5703321202934217, 0.572527190322664, 0.5810876937181738, 0.5839316033216501, 0.5869554693588546, 0.5978224688673367, 0.6020809038458174, 0.6040027325548288, 0.60930724883395, 0.6129363784491165, 0.6177381261776831, 0.6207514580961451, 0.6254379509131298, 0.629416821650497, 0.6348860455590101, 0.6397091987818884, 0.6440143124168, 0.6473149730607592, 0.6488218731141979, 0.6529233398862779, 0.654419075756689, 0.6561351176009463, 0.6582017238668025, 0.6620681324580058, 0.6643276793837491, 0.6643699683526211, 0.6661850384309056, 0.6668739971561204, 0.6732114384826715, 0.675252842989142, 0.6789785421687423, 0.6820624911758754, 0.6858368274908131, 0.6877522409388017, 0.6888507900590674, 0.6920502888566757, 0.6920502888566757, 0.6946023120659036, 0.6950390876697388, 0.6971518948980037, 0.6986743754926081, 0.7031986660018421, 0.706600084403862, 0.706600084403862, 0.7077455082325914, 0.7077455082325914, 0.7105950504389142, 0.7120333689646344, 0.7120333689646344, 0.7148698399102128, 0.7148698399102128, 0.7148698399102128, 0.7148698399102128, 0.7148698399102128, 0.7148698399102128, 0.7148698399102128, 0.718269819377935, 0.718269819377935, 0.7200069956786791, 0.721916147591489, 0.721916147591489, 0.721916147591489, 0.721916147591489, 0.721916147591489, 0.721916147591489, 0.7243921889719518, 0.7243921889719518, 0.7243921889719518, 0.7308422455054888, 0.7308422455054888, 0.7308422455054888, 0.7334703015686707, 0.7334703015686707, 0.7334703015686707, 0.7334703015686707, 0.7334703015686707, 0.7359716995392258, 0.7359716995392258, 0.7359716995392258, 0.7359716995392258, 0.7359716995392258, 0.7359716995392258, 0.7359716995392258, 0.7359716995392258, 0.7359716995392258, 0.7359716995392258, 0.7359716995392258, 0.7359716995392258]
[0.10776011463627942, 0.1339908650532381, 0.14335350362867158, 0.15073206791017563, 0.16197462559604614, 0.16580844989054488, 0.17121115149008798, 0.18883986821687634, 0.1943639440655205, 0.19920980348073453, 0.20907603880166098, 0.21652821348701273, 0.2258619668181853, 0.23174052708885373, 0.2382333138587723, 0.24645176229398025, 0.25532304401346895, 0.2700376263536923, 0.2777537721528703, 0.2837495867410744, 0.28746835149139477, 0.29574213657836057, 0.2978063264179913, 0.301512454227188, 0.3078681778496283, 0.31427102026283016, 0.3204486631047337, 0.32033651492018006, 0.32381415366732835, 0.3255633001268051, 0.34158334362849396, 0.34701790049960973, 0.35749880454526267, 0.3668720672300747, 0.37667238789352375, 0.381807319695035, 0.3848878385271215, 0.3914192736424631, 0.3914192736424631, 0.40184405923915234, 0.40132882868541503, 0.4088564489872315, 0.4148965726285431, 0.42999265693489397, 0.4387618098261896, 0.4387618098261896, 0.44148679163059845, 0.44148679163059845, 0.44970771090533657, 0.4543067938501508, 0.4543067938501508, 0.46294237719729997, 0.46294237719729997, 0.46294237719729997, 0.46294237719729997, 0.46294237719729997, 0.46294237719729997, 0.46294237719729997, 0.4741448899486769, 0.4741448899486769, 0.48055036899052916, 0.48808411338434043, 0.48808411338434043, 0.48808411338434043, 0.48808411338434043, 0.48808411338434043, 0.48808411338434043, 0.49730083869050185, 0.49730083869050185, 0.49730083869050185, 0.5211747260727406, 0.5211747260727406, 0.5211747260727406, 0.5310558088501748, 0.5310558088501748, 0.5310558088501748, 0.5310558088501748, 0.5310558088501748, 0.540292246493443, 0.540292246493443, 0.540292246493443, 0.540292246493443, 0.540292246493443, 0.540292246493443, 0.540292246493443, 0.540292246493443, 0.540292246493443, 0.540292246493443, 0.540292246493443, 0.540292246493443]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  66719.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_1_1
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19744.0)
('VALIDATE SUM PROTEIN TEST: ', 2691.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 34217.652, 58984.0)
('Error: ', tensor(45564.4102, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5235845402539485, 0.2998600896379176)
('Val: AUC, AUPR, Erros: ', 0.5322317773755826, 0.2595125649599311, 4892.077)
('Test: AUC, AUPR, Erros: ', 0.5140836443292255, 0.3078898790203096, 5945.1772)
10((646, 331), (646, 331), 57576.656, 58984.0)
('Error: ', tensor(42405.6875, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6345446646258066, 0.40404612813846974)
('Val: AUC, AUPR, Erros: ', 0.6308680979683405, 0.34950382466565033, 4765.7188)
('Test: AUC, AUPR, Erros: ', 0.6132027193508821, 0.39394260070312054, 5480.0195)
20((646, 331), (646, 331), 53836.484, 58984.0)
('Error: ', tensor(41574.0312, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6874709549791241, 0.48797105243595207)
('Val: AUC, AUPR, Erros: ', 0.6782302732725909, 0.4265434591412763, 4638.176)
('Test: AUC, AUPR, Erros: ', 0.6660837783828792, 0.4773308497456977, 5395.6577)
30((646, 331), (646, 331), 52876.02, 58984.0)
('Error: ', tensor(40047.6797, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7179572218848362, 0.5325718036019171)
('Val: AUC, AUPR, Erros: ', 0.7039431101062028, 0.46307819941091666, 4473.944)
('Test: AUC, AUPR, Erros: ', 0.6954638663052686, 0.5190349349760215, 5221.6294)
40((646, 331), (646, 331), 60045.69, 58984.0)
('Error: ', tensor(37265.2500, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7292198510348967, 0.5511370917066867)
('Val: AUC, AUPR, Erros: ', 0.7129863914439005, 0.4747293054202495, 4294.267)
('Test: AUC, AUPR, Erros: ', 0.7063013925992353, 0.5336127086475968, 4889.4775)
50((646, 331), (646, 331), 62795.06, 58984.0)
('Error: ', tensor(35924.6250, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7368058169060712, 0.5621505605186743)
('Val: AUC, AUPR, Erros: ', 0.7174290652953604, 0.4802308897007418, 4237.968)
('Test: AUC, AUPR, Erros: ', 0.7122520126007724, 0.5427216946699367, 4746.95)
60((646, 331), (646, 331), 70660.914, 58984.0)
('Error: ', tensor(36013.0859, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7413529460720935, 0.5688297075975709)
('Val: AUC, AUPR, Erros: ', 0.7205949776931765, 0.48555921557944265, 4393.519)
('Test: AUC, AUPR, Erros: ', 0.7166720794161495, 0.5492585394844485, 4763.33)
70((646, 331), (646, 331), 65775.586, 58984.0)
('Error: ', tensor(35344.4688, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7458086950590165, 0.5745270366741234)
('Val: AUC, AUPR, Erros: ', 0.7233140500259352, 0.48943005175479526, 4265.048)
('Test: AUC, AUPR, Erros: ', 0.7203400089974535, 0.5535506792959894, 4699.2627)
80((646, 331), (646, 331), 66737.63, 58984.0)
('Error: ', tensor(35234.8672, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7488487799575005, 0.5787350081857278)
('Val: AUC, AUPR, Erros: ', 0.7249127745157591, 0.4916141670495512, 4275.128)
('Test: AUC, AUPR, Erros: ', 0.723272209023939, 0.556672682710158, 4691.2905)
90((646, 331), (646, 331), 65816.914, 58984.0)
('Error: ', tensor(35012.3242, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7515974846884474, 0.5825519085474322)
('Val: AUC, AUPR, Erros: ', 0.7262802555502073, 0.4934178317524097, 4245.1206)
('Test: AUC, AUPR, Erros: ', 0.7256728571713216, 0.5588852936948472, 4673.0986)
100((646, 331), (646, 331), 66227.09, 58984.0)
('Error: ', tensor(34906.3125, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7538173217475205, 0.5858007009068418)
('Val: AUC, AUPR, Erros: ', 0.7276549566989804, 0.49539599167195764, 4240.7725)
('Test: AUC, AUPR, Erros: ', 0.727763758696375, 0.5610315703904108, 4664.9326)
110((646, 331), (646, 331), 66160.25, 58984.0)
('Error: ', tensor(34785.2305, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.755727654050694, 0.58865593362067)
('Val: AUC, AUPR, Erros: ', 0.7284349288430506, 0.49641856601078466, 4230.946)
('Test: AUC, AUPR, Erros: ', 0.7293501359445016, 0.5624688046677069, 4656.9673)
120((646, 331), (646, 331), 66537.516, 58984.0)
('Error: ', tensor(34704.2891, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7574809866257215, 0.5912654812217687)
('Val: AUC, AUPR, Erros: ', 0.7288874063169598, 0.49720526865997045, 4232.6533)
('Test: AUC, AUPR, Erros: ', 0.7306584569082564, 0.5635422663957426, 4653.737)
130((646, 331), (646, 331), 66593.195, 58984.0)
('Error: ', tensor(34607.8047, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.759159671983937, 0.593681737190386)
('Val: AUC, AUPR, Erros: ', 0.729627528757876, 0.4983308841040646, 4226.5317)
('Test: AUC, AUPR, Erros: ', 0.7316387733860259, 0.5642653155317305, 4650.2646)
140((646, 331), (646, 331), 66542.266, 58984.0)
('Error: ', tensor(34510.2305, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7607168866160254, 0.5959103344147082)
('Val: AUC, AUPR, Erros: ', 0.7302917361823035, 0.4992618168891767, 4216.6787)
('Test: AUC, AUPR, Erros: ', 0.7328974206260725, 0.5654362530849739, 4642.495)
150((646, 331), (646, 331), 66718.28, 58984.0)
('Error: ', tensor(34432.7812, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7623031389331167, 0.597984523099198)
('Val: AUC, AUPR, Erros: ', 0.7302759169627462, 0.4995168587444315, 4216.7334)
('Test: AUC, AUPR, Erros: ', 0.7335755538726935, 0.5657450828548177, 4641.9014)
160((646, 331), (646, 331), 66652.375, 58984.0)
('Error: ', tensor(34342.0195, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7637734001475545, 0.5999893565720382)
('Val: AUC, AUPR, Erros: ', 0.7306399157160758, 0.5001528879280334, 4208.954)
('Test: AUC, AUPR, Erros: ', 0.7345513058845488, 0.5664747349680772, 4636.6724)

Validation:  [0.7306399157160758, 0.5001528879280334, 4208.954, 0.7345513058845488, 0.5664747349680772, 4636.6724]
Train: 0.7638 0.6000
Test: 0.7346 0.5665
1
[0.6095585085998964, 0.602708830548926, 0.5943392784323825, 0.5913826060791163, 0.5979334772965127, 0.6000565094634422, 0.5983144345233274, 0.60715964809896, 0.608180615524377, 0.6106128573762457, 0.6118039025398408, 0.6146997047976022, 0.6150670338654507, 0.6171610652403969, 0.6233384462471673, 0.62868187201483, 0.6347752891007943, 0.6385888830784723, 0.6419311855706489, 0.6463420997908824, 0.6468467448164263, 0.6504113193734138, 0.6537457728884903, 0.6573749814203245, 0.6585905531221962, 0.66175646069474, 0.6639189755121259, 0.6646629920040561, 0.6661241536274471, 0.6670237150000039, 0.6724116143635315, 0.6751758279488864, 0.679446308024842, 0.6822922822340973, 0.6862706723898463, 0.6879862019634287, 0.6889576819414793, 0.6920219021728651, 0.6920219021728651, 0.6946589195003903, 0.6958294002482593, 0.6981299744147962, 0.6994898226895245, 0.7044872064059118, 0.70759182415533, 0.70759182415533, 0.7085338157736762, 0.7085338157736762, 0.710819452994584, 0.7124137964968186, 0.7124137964968186, 0.715046200063765, 0.715046200063765, 0.715046200063765, 0.715046200063765, 0.715046200063765, 0.715046200063765, 0.715046200063765, 0.7179535720337058, 0.7179535720337058, 0.7195759965043707, 0.7214741426402986, 0.7214741426402986, 0.7214741426402986, 0.7214741426402986, 0.7214741426402986, 0.7214741426402986, 0.723238080928145, 0.723238080928145, 0.723238080928145, 0.7303068988817829, 0.7303068988817829, 0.7303068988817829, 0.7320199053699341, 0.7320199053699341, 0.7320199053699341, 0.7320199053699341, 0.7320199053699341, 0.7345513058845488, 0.7345513058845488, 0.7345513058845488, 0.7345513058845488, 0.7345513058845488, 0.7345513058845488, 0.7345513058845488, 0.7345513058845488, 0.7345513058845488, 0.7345513058845488, 0.7345513058845488, 0.7345513058845488]
[0.15918450162807193, 0.17509663170456197, 0.17550221766739993, 0.1760088470247769, 0.1929856930136362, 0.19638285066548572, 0.1970771373441681, 0.2138704072696536, 0.21908762076514965, 0.2238932528519928, 0.22842931764867794, 0.23508061606208586, 0.23723750917758551, 0.24205329081947044, 0.2598836051727793, 0.2715846138089108, 0.2849109638727796, 0.29675942213694095, 0.303213909861219, 0.31371465393914394, 0.31506920374006975, 0.32430435395567336, 0.3345349673971823, 0.3439922029022475, 0.34516850843288527, 0.3498071250411742, 0.3548173152369696, 0.3561269181449175, 0.36010015243253535, 0.3631471497028425, 0.3773158523421284, 0.38461426351663386, 0.3969912813219587, 0.404503829509422, 0.416692233589394, 0.42174972909263114, 0.4241409101337556, 0.4321280901691894, 0.4321280901691894, 0.44100503157862475, 0.44425178198463144, 0.4521790036115699, 0.45474669654889216, 0.46961673930833214, 0.47696357553977525, 0.47696357553977525, 0.47967823430743173, 0.47967823430743173, 0.48681523808981614, 0.49234632487430996, 0.49234632487430996, 0.5002438760952649, 0.5002438760952649, 0.5002438760952649, 0.5002438760952649, 0.5002438760952649, 0.5002438760952649, 0.5002438760952649, 0.5097687358950503, 0.5097687358950503, 0.5150292814403825, 0.522208439480964, 0.522208439480964, 0.522208439480964, 0.522208439480964, 0.522208439480964, 0.522208439480964, 0.5262979403424819, 0.5262979403424819, 0.5262979403424819, 0.5532797065231723, 0.5532797065231723, 0.5532797065231723, 0.5571228106666569, 0.5571228106666569, 0.5571228106666569, 0.5571228106666569, 0.5571228106666569, 0.5664747349680772, 0.5664747349680772, 0.5664747349680772, 0.5664747349680772, 0.5664747349680772, 0.5664747349680772, 0.5664747349680772, 0.5664747349680772, 0.5664747349680772, 0.5664747349680772, 0.5664747349680772, 0.5664747349680772]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  66071.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_1_2
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19810.0)
('VALIDATE SUM PROTEIN TEST: ', 2208.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 35072.637, 59882.0)
('Error: ', tensor(46005.0703, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.4830019928824217, 0.2725145315207737)
('Val: AUC, AUPR, Erros: ', 0.48071784309803123, 0.2501484450836323, 5317.235)
('Test: AUC, AUPR, Erros: ', 0.48167567108553333, 0.22171691399353274, 4881.923)
10((646, 331), (646, 331), 58590.695, 59882.0)
('Error: ', tensor(42900.7422, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.615406096750188, 0.3795134205648916)
('Val: AUC, AUPR, Erros: ', 0.6154110882394883, 0.3493232877927478, 5077.4463)
('Test: AUC, AUPR, Erros: ', 0.6059404319178163, 0.30400451999571565, 4788.744)
20((646, 331), (646, 331), 58847.902, 59882.0)
('Error: ', tensor(42449.8867, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6686633039213119, 0.4509666261376306)
('Val: AUC, AUPR, Erros: ', 0.669797107455137, 0.4235321398054285, 5025.1904)
('Test: AUC, AUPR, Erros: ', 0.6588193817924215, 0.3725411275057493, 4744.949)
30((646, 331), (646, 331), 65844.15, 59882.0)
('Error: ', tensor(41221.8203, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7043162330094689, 0.5002840691198602)
('Val: AUC, AUPR, Erros: ', 0.705503771840646, 0.46994981224613286, 4925.5117)
('Test: AUC, AUPR, Erros: ', 0.6919946435918864, 0.41632543972526437, 4711.542)
40((646, 331), (646, 331), 58864.234, 59882.0)
('Error: ', tensor(38999.6836, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7186664725149504, 0.528073982315078)
('Val: AUC, AUPR, Erros: ', 0.7177250566148455, 0.4928090225278009, 4624.9404)
('Test: AUC, AUPR, Erros: ', 0.7044489412084307, 0.4402536492952569, 4406.537)
50((646, 331), (646, 331), 67597.48, 59882.0)
('Error: ', tensor(37334.9961, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7286870598602617, 0.5484594583233388)
('Val: AUC, AUPR, Erros: ', 0.7266907745023921, 0.5120609242665553, 4498.716)
('Test: AUC, AUPR, Erros: ', 0.7129696006625675, 0.45924639105635323, 4388.608)
60((646, 331), (646, 331), 71164.9, 59882.0)
('Error: ', tensor(36799.6523, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7338747457338551, 0.5601387480128417)
('Val: AUC, AUPR, Erros: ', 0.7307382989725169, 0.5229770568428735, 4478.8877)
('Test: AUC, AUPR, Erros: ', 0.716787599468142, 0.47193375413807487, 4435.9688)
70((646, 331), (646, 331), 69490.11, 59882.0)
('Error: ', tensor(36334.3750, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7381402514354032, 0.5676711717573266)
('Val: AUC, AUPR, Erros: ', 0.7329936515832437, 0.5285738630146156, 4429.4214)
('Test: AUC, AUPR, Erros: ', 0.7198629176479635, 0.47899637972543807, 4387.3887)
80((646, 331), (646, 331), 67813.695, 59882.0)
('Error: ', tensor(35978.6367, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7417255496984496, 0.5731621005124603)
('Val: AUC, AUPR, Erros: ', 0.7349120772317749, 0.5321131692068648, 4386.946)
('Test: AUC, AUPR, Erros: ', 0.7217467289199575, 0.48253581313256955, 4337.61)
90((646, 331), (646, 331), 67503.195, 59882.0)
('Error: ', tensor(35768.9766, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7446790157714995, 0.5775755462897094)
('Val: AUC, AUPR, Erros: ', 0.7361126653475025, 0.5336703785244554, 4375.054)
('Test: AUC, AUPR, Erros: ', 0.7235976207016246, 0.4857220999287595, 4319.2285)
100((646, 331), (646, 331), 67395.87, 59882.0)
('Error: ', tensor(35596.4922, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7472989548098997, 0.5814924318655768)
('Val: AUC, AUPR, Erros: ', 0.7373882229434465, 0.5351331690289888, 4364.47)
('Test: AUC, AUPR, Erros: ', 0.724712581861327, 0.48683336415990974, 4307.397)
110((646, 331), (646, 331), 67365.8, 59882.0)
('Error: ', tensor(35439.1094, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7498340133736798, 0.5852638411400773)
('Val: AUC, AUPR, Erros: ', 0.7382921514511207, 0.5358015080870493, 4359.082)
('Test: AUC, AUPR, Erros: ', 0.7260632172682131, 0.4890457739953743, 4296.1084)
120((646, 331), (646, 331), 67200.18, 59882.0)
('Error: ', tensor(35293.8906, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7520383256774058, 0.588470801815875)
('Val: AUC, AUPR, Erros: ', 0.7388903182737823, 0.5357086064121361, 4352.8438)
('Test: AUC, AUPR, Erros: ', 0.7269764892549421, 0.489899576279464, 4285.5103)
130((646, 331), (646, 331), 67035.42, 59882.0)
('Error: ', tensor(35158.3945, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7540579043812233, 0.5914699293795128)
('Val: AUC, AUPR, Erros: ', 0.7393240326070226, 0.5353200254209857, 4349.0723)
('Test: AUC, AUPR, Erros: ', 0.7277896394501342, 0.490657419584128, 4274.428)
140((646, 331), (646, 331), 67231.46, 59882.0)
('Error: ', tensor(35056.3398, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7559519969770686, 0.594272274327935)
('Val: AUC, AUPR, Erros: ', 0.7395715680933701, 0.53485280138852, 4352.008)
('Test: AUC, AUPR, Erros: ', 0.7287641590046092, 0.4918082765875402, 4271.1147)
150((646, 331), (646, 331), 67849.43, 59882.0)
('Error: ', tensor(34999.4258, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7576315827174864, 0.5967544175994245)
('Val: AUC, AUPR, Erros: ', 0.7397914019247399, 0.5341495204654416, 4362.0815)
('Test: AUC, AUPR, Erros: ', 0.7291843633901796, 0.49208089416169454, 4281.378)
160((646, 331), (646, 331), 67801.72, 59882.0)
('Error: ', tensor(34889.8711, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7593774261660363, 0.5992323438746152)
('Val: AUC, AUPR, Erros: ', 0.7399687862467514, 0.5333141138089628, 4360.6514)
('Test: AUC, AUPR, Erros: ', 0.7296629280812834, 0.4926439336771282, 4275.2)

Validation:  [0.7393240326070226, 0.5353200254209857, 4349.0723, 0.7277896394501342, 0.490657419584128, 4274.428]
Train: 0.7541 0.5915
Test: 0.7278 0.4907
2
[0.5781522713335534, 0.5951560918580298, 0.593853585412085, 0.5858455147432825, 0.582698150597178, 0.5855004499173693, 0.5827354632115347, 0.5892578489141583, 0.5956494914210386, 0.5963346280571151, 0.6004684385672118, 0.6014059107450593, 0.6038846619569693, 0.6078045433254577, 0.6122556331850947, 0.6153033273900317, 0.6185729496683635, 0.622680101830137, 0.627296829779736, 0.6309343943242829, 0.6315570721656151, 0.6346856302171503, 0.6378651568868496, 0.6409902318627256, 0.6431643459358416, 0.6500840566496383, 0.6521103329667937, 0.6526822976374563, 0.6541539176972697, 0.6553140491176855, 0.6613919795387873, 0.664635569301257, 0.6675441380616219, 0.6693409974590336, 0.6735695513451672, 0.6757855887080064, 0.6769866018069832, 0.6810716425715128, 0.6810716425715128, 0.6841256065292196, 0.6858093309097391, 0.6876881284851956, 0.6888507457070004, 0.694201812741071, 0.6980428871029497, 0.6980428871029497, 0.6989975659660159, 0.6989975659660159, 0.7018030695025486, 0.7029019864803983, 0.7029019864803983, 0.7047588349520981, 0.7047588349520981, 0.7047588349520981, 0.7047588349520981, 0.7047588349520981, 0.7047588349520981, 0.7047588349520981, 0.7085306645067174, 0.7085306645067174, 0.7100957397605466, 0.7123518954415852, 0.7123518954415852, 0.7123518954415852, 0.7123518954415852, 0.7123518954415852, 0.7123518954415852, 0.7148561237853628, 0.7148561237853628, 0.7148561237853628, 0.7220973819758272, 0.7220973819758272, 0.7220973819758272, 0.7245704586903428, 0.7245704586903428, 0.7245704586903428, 0.7245704586903428, 0.7245704586903428, 0.7277896394501342, 0.7277896394501342, 0.7277896394501342, 0.7277896394501342, 0.7277896394501342, 0.7277896394501342, 0.7277896394501342, 0.7277896394501342, 0.7277896394501342, 0.7277896394501342, 0.7277896394501342, 0.7277896394501342]
[0.15654588097407574, 0.15682363129887514, 0.15390429791801377, 0.1502389758526998, 0.14782583000470656, 0.15778487218567153, 0.1544386292975931, 0.1652282783526191, 0.17787399568564405, 0.1791469872402453, 0.19272200247070528, 0.19424774166423225, 0.197600678249497, 0.20395976859101428, 0.2127096287046567, 0.2163369501708633, 0.2206129784847704, 0.2328108062733044, 0.24283287807721915, 0.250730345980855, 0.25204632820177003, 0.2543195661406773, 0.2607118109823389, 0.2672326459565557, 0.27063535986530796, 0.2868515781073545, 0.29035118389989606, 0.2901535858919416, 0.2914575658131984, 0.29342967529750685, 0.3080040840574253, 0.315147429771555, 0.32057394802455885, 0.32504153502860117, 0.3349165907160202, 0.3397312318856046, 0.34271105560299636, 0.3528516214163966, 0.3528516214163966, 0.3639459908604695, 0.3682711725980682, 0.3719166042060361, 0.3737882816137258, 0.38863286072284303, 0.39921955456395664, 0.39921955456395664, 0.4003656627901513, 0.4003656627901513, 0.40772779711376417, 0.41096273850692844, 0.41096273850692844, 0.41257955757981324, 0.41257955757981324, 0.41257955757981324, 0.41257955757981324, 0.41257955757981324, 0.41257955757981324, 0.41257955757981324, 0.4237458730369674, 0.4237458730369674, 0.42708981592798706, 0.43500953473225923, 0.43500953473225923, 0.43500953473225923, 0.43500953473225923, 0.43500953473225923, 0.43500953473225923, 0.4450543960472712, 0.4450543960472712, 0.4450543960472712, 0.46989625484647973, 0.46989625484647973, 0.46989625484647973, 0.47742837614176864, 0.47742837614176864, 0.47742837614176864, 0.47742837614176864, 0.47742837614176864, 0.490657419584128, 0.490657419584128, 0.490657419584128, 0.490657419584128, 0.490657419584128, 0.490657419584128, 0.490657419584128, 0.490657419584128, 0.490657419584128, 0.490657419584128, 0.490657419584128, 0.490657419584128]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
647 81 331
Num Drug-SE:  65591.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_1_3
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((647, 3826), (81, 3826), (647, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19638.0)
('VALIDATE SUM PROTEIN TEST: ', 2625.0)
(647, 3826) (647, 331)
0((647, 331), (647, 331), 31802.523, 58754.0)
('Error: ', tensor(46026.1055, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5017885750939399, 0.27863811375814745)
('Val: AUC, AUPR, Erros: ', 0.4887060876383782, 0.27418791399282505, 5728.3374)
('Test: AUC, AUPR, Erros: ', 0.5083855648294223, 0.26372802829085507, 5396.881)
10((647, 331), (647, 331), 58214.805, 58754.0)
('Error: ', tensor(42407.5391, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6189833286479299, 0.37191049699275613)
('Val: AUC, AUPR, Erros: ', 0.6128156852025477, 0.3684392229231483, 5268.79)
('Test: AUC, AUPR, Erros: ', 0.6238710074449718, 0.35607502044289996, 5072.884)
20((647, 331), (647, 331), 55716.203, 58754.0)
('Error: ', tensor(42119.2344, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.664196047779285, 0.43598635809586855)
('Val: AUC, AUPR, Erros: ', 0.6572618798079994, 0.4346886459064719, 5235.0)
('Test: AUC, AUPR, Erros: ', 0.6696995328972275, 0.4273763588739388, 5024.4634)
30((647, 331), (647, 331), 54610.453, 58754.0)
('Error: ', tensor(41440.6250, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.693494392910724, 0.4828960171466005)
('Val: AUC, AUPR, Erros: ', 0.6872404868354551, 0.4841570563898396, 5152.049)
('Test: AUC, AUPR, Erros: ', 0.6984404466189256, 0.47322529495903753, 4935.6875)
40((647, 331), (647, 331), 49379.426, 58754.0)
('Error: ', tensor(40433.8438, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7132855837276593, 0.5168695950885331)
('Val: AUC, AUPR, Erros: ', 0.7078431375905194, 0.5183455207801778, 5028.1636)
('Test: AUC, AUPR, Erros: ', 0.7168972838596861, 0.5028443618649894, 4789.9644)
50((647, 331), (647, 331), 46340.46, 58754.0)
('Error: ', tensor(39236.3359, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7230509146089618, 0.5354091593110651)
('Val: AUC, AUPR, Erros: ', 0.7168618620382311, 0.5345426451088195, 4882.045)
('Test: AUC, AUPR, Erros: ', 0.7245667429674081, 0.5154507207164226, 4636.459)
60((647, 331), (647, 331), 46874.21, 58754.0)
('Error: ', tensor(37797.8945, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7296986926412763, 0.5491451285211797)
('Val: AUC, AUPR, Erros: ', 0.7221896652336386, 0.5455230925841252, 4708.951)
('Test: AUC, AUPR, Erros: ', 0.7288999796561623, 0.5238366601201299, 4477.801)
70((647, 331), (647, 331), 49389.35, 58754.0)
('Error: ', tensor(36545.5117, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7356879554792262, 0.5601088655960753)
('Val: AUC, AUPR, Erros: ', 0.7258435649464603, 0.5536572442283829, 4567.588)
('Test: AUC, AUPR, Erros: ', 0.7325412534612973, 0.5314467662931072, 4356.127)
80((647, 331), (647, 331), 50529.6, 58754.0)
('Error: ', tensor(35937.2500, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7406441435069276, 0.5675491730455244)
('Val: AUC, AUPR, Erros: ', 0.728310742812763, 0.558289893549176, 4508.0986)
('Test: AUC, AUPR, Erros: ', 0.7349599272091601, 0.535927321109897, 4305.25)
90((647, 331), (647, 331), 51209.445, 58754.0)
('Error: ', tensor(35573.9219, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7448498893811506, 0.5730658846796688)
('Val: AUC, AUPR, Erros: ', 0.7297115705419261, 0.5604238447342303, 4480.506)
('Test: AUC, AUPR, Erros: ', 0.7368091682855988, 0.5386286626086937, 4280.3804)
100((647, 331), (647, 331), 51497.945, 58754.0)
('Error: ', tensor(35338.6484, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7484157743085493, 0.5775934987353922)
('Val: AUC, AUPR, Erros: ', 0.730635746841735, 0.5620081742451983, 4466.1045)
('Test: AUC, AUPR, Erros: ', 0.7383419565809988, 0.5405140292226267, 4267.512)
110((647, 331), (647, 331), 51751.42, 58754.0)
('Error: ', tensor(35147.5938, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7514488715463676, 0.5815099031225838)
('Val: AUC, AUPR, Erros: ', 0.7307012281102303, 0.5624721521520876, 4459.591)
('Test: AUC, AUPR, Erros: ', 0.7394415211619482, 0.5413112483974776, 4260.411)
120((647, 331), (647, 331), 51667.152, 58754.0)
('Error: ', tensor(35017.6719, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7539967147154307, 0.5848612525548463)
('Val: AUC, AUPR, Erros: ', 0.7302980813036226, 0.562703861826811, 4459.2505)
('Test: AUC, AUPR, Erros: ', 0.7405269163793289, 0.5420615141265968, 4256.092)
130((647, 331), (647, 331), 51802.953, 58754.0)
('Error: ', tensor(34876.3320, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7564841456826921, 0.5880731220381513)
('Val: AUC, AUPR, Erros: ', 0.7304459749010508, 0.5633220538468613, 4454.4746)
('Test: AUC, AUPR, Erros: ', 0.7410929879459064, 0.5422586522473525, 4253.8506)
140((647, 331), (647, 331), 51493.547, 58754.0)
('Error: ', tensor(34792.0469, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7587014320718535, 0.5910128992811443)
('Val: AUC, AUPR, Erros: ', 0.7298028335220819, 0.5627178349348314, 4459.7534)
('Test: AUC, AUPR, Erros: ', 0.7416672938532246, 0.5418051160175559, 4256.2983)
150((647, 331), (647, 331), 51444.414, 58754.0)
('Error: ', tensor(34691.7812, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7607733183141602, 0.5937006274021713)
('Val: AUC, AUPR, Erros: ', 0.7291209660865938, 0.5623636689483242, 4462.417)
('Test: AUC, AUPR, Erros: ', 0.7420326400919117, 0.5416103645022827, 4257.419)
160((647, 331), (647, 331), 51402.01, 58754.0)
('Error: ', tensor(34593.8047, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7627870671360159, 0.5963680149352845)
('Val: AUC, AUPR, Erros: ', 0.7287543843797603, 0.5624154431207236, 4463.3413)
('Test: AUC, AUPR, Erros: ', 0.7425791418268937, 0.5412852700508595, 4258.4917)

Validation:  [0.7304459749010508, 0.5633220538468613, 4454.4746, 0.7410929879459064, 0.5422586522473525, 4253.8506]
Train: 0.7565 0.5881
Test: 0.7411 0.5423
3
[0.5599212463619243, 0.5507900015981384, 0.5458455721613615, 0.557826347887248, 0.5639400922222032, 0.565674063605187, 0.5756088986193795, 0.5786906809082566, 0.5842289805656993, 0.5873211380661507, 0.5913457627230314, 0.596876660309813, 0.6011501308628487, 0.6039380860214966, 0.6102782246305516, 0.6156330029590468, 0.6237492276300656, 0.6321394307734418, 0.6353238489297401, 0.6398113202912267, 0.6402265821776699, 0.6433003891005221, 0.648599037146796, 0.6522604716028713, 0.6537114017741199, 0.6582097175705086, 0.6600532950819542, 0.6605812916235225, 0.6629587837121814, 0.6635244584290632, 0.6695148037696322, 0.6728540453049725, 0.6775505721261297, 0.6808225165770811, 0.6852081953494854, 0.6865727730510547, 0.6876353728230694, 0.6921004387493006, 0.6921004387493006, 0.6942246389735507, 0.6955458755590351, 0.6976986137134537, 0.6992407228094714, 0.7057172669029337, 0.7100498270941661, 0.7100498270941661, 0.710750705723011, 0.710750705723011, 0.7137950816565639, 0.715346898070557, 0.715346898070557, 0.7185064852938052, 0.7185064852938052, 0.7185064852938052, 0.7185064852938052, 0.7185064852938052, 0.7185064852938052, 0.7185064852938052, 0.7223521878272936, 0.7223521878272936, 0.7238698176726635, 0.725926108806812, 0.725926108806812, 0.725926108806812, 0.725926108806812, 0.725926108806812, 0.725926108806812, 0.7286798854387682, 0.7286798854387682, 0.7286798854387682, 0.7361840359642329, 0.7361840359642329, 0.7361840359642329, 0.7384742236498836, 0.7384742236498836, 0.7384742236498836, 0.7384742236498836, 0.7384742236498836, 0.7410929879459064, 0.7410929879459064, 0.7410929879459064, 0.7410929879459064, 0.7410929879459064, 0.7410929879459064, 0.7410929879459064, 0.7410929879459064, 0.7410929879459064, 0.7410929879459064, 0.7410929879459064, 0.7410929879459064]
[0.12674121521946696, 0.1286181119117548, 0.1274118602287404, 0.1422684241955316, 0.1479890628099222, 0.14817441989458274, 0.16169065012108796, 0.16783171817150366, 0.17578648423953674, 0.18046807231329662, 0.18778465528750468, 0.19775442649491587, 0.20327573601320603, 0.2065858193938527, 0.21723497016913795, 0.22757725919324812, 0.23938707114430532, 0.25420336302231916, 0.25893372945060733, 0.26610515891751196, 0.2671873591407279, 0.2726090703052402, 0.2833800904514305, 0.28988282519175507, 0.2924128164733702, 0.30124006899954925, 0.30548612439140466, 0.3059950033081681, 0.31087718985318713, 0.3130263485693674, 0.3285478633296782, 0.33531773326290315, 0.34720952924237203, 0.35517722660613327, 0.3666404145368579, 0.37009647993455985, 0.37213211832404414, 0.3821983365527415, 0.3821983365527415, 0.3888568311551036, 0.39212898935342305, 0.3978019707399508, 0.40410210997844614, 0.42514770528206924, 0.43707258035143093, 0.43707258035143093, 0.43834829666678254, 0.43834829666678254, 0.44859286326595116, 0.45399155177667594, 0.45399155177667594, 0.46527267226440977, 0.46527267226440977, 0.46527267226440977, 0.46527267226440977, 0.46527267226440977, 0.46527267226440977, 0.46527267226440977, 0.4775184964574443, 0.4775184964574443, 0.482017013599061, 0.4895419938052207, 0.4895419938052207, 0.4895419938052207, 0.4895419938052207, 0.4895419938052207, 0.4895419938052207, 0.5002782637211928, 0.5002782637211928, 0.5002782637211928, 0.5254971556573107, 0.5254971556573107, 0.5254971556573107, 0.5328387482110399, 0.5328387482110399, 0.5328387482110399, 0.5328387482110399, 0.5328387482110399, 0.5422586522473525, 0.5422586522473525, 0.5422586522473525, 0.5422586522473525, 0.5422586522473525, 0.5422586522473525, 0.5422586522473525, 0.5422586522473525, 0.5422586522473525, 0.5422586522473525, 0.5422586522473525, 0.5422586522473525]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
647 80 331
Num Drug-SE:  65706.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_1_4
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((647, 3826), (80, 3826), (647, 331), (80, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19757.0)
('VALIDATE SUM PROTEIN TEST: ', 2380.0)
(647, 3826) (647, 331)
0((647, 331), (647, 331), 64129.188, 58389.0)
('Error: ', tensor(42589.7070, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5229010742530203, 0.2887376473385826)
('Val: AUC, AUPR, Erros: ', 0.5236152606846238, 0.2844700228659688, 5288.376)
('Test: AUC, AUPR, Erros: ', 0.5175131637033638, 0.28868731435235034, 5306.823)
10((647, 331), (647, 331), 63714.355, 58389.0)
('Error: ', tensor(42239.1836, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6344756413646455, 0.39803846204679816)
('Val: AUC, AUPR, Erros: ', 0.6303364346990893, 0.38658966410957435, 5245.892)
('Test: AUC, AUPR, Erros: ', 0.6155216773166532, 0.3880945369386861, 5269.5845)
20((647, 331), (647, 331), 64875.113, 58389.0)
('Error: ', tensor(41482.6484, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7066018206361742, 0.509963582635814)
('Val: AUC, AUPR, Erros: ', 0.7028453757773695, 0.502404385328202, 5155.1455)
('Test: AUC, AUPR, Erros: ', 0.6912063131659513, 0.5025525339472481, 5179.052)
30((647, 331), (647, 331), 69353.04, 58389.0)
('Error: ', tensor(39678.9062, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7297305287147013, 0.5450065678809402)
('Val: AUC, AUPR, Erros: ', 0.7224718921394802, 0.5343497077619923, 4947.4185)
('Test: AUC, AUPR, Erros: ', 0.7141657333009518, 0.5365987064097989, 4968.612)
40((647, 331), (647, 331), 37291.125, 58389.0)
('Error: ', tensor(41016.0547, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7375036939957278, 0.5554891795035053)
('Val: AUC, AUPR, Erros: ', 0.7257335469664941, 0.5406707304343418, 5077.308)
('Test: AUC, AUPR, Erros: ', 0.7217498891404228, 0.5469962184800767, 5139.868)
50((647, 331), (647, 331), 52245.645, 58389.0)
('Error: ', tensor(36478.3398, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.745454931730868, 0.5650309908625804)
('Val: AUC, AUPR, Erros: ', 0.7325600380524508, 0.5483748320116609, 4546.2)
('Test: AUC, AUPR, Erros: ', 0.7272076778065699, 0.5534966679969928, 4593.061)
60((647, 331), (647, 331), 51537.19, 58389.0)
('Error: ', tensor(35736.8906, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7488239042891189, 0.5704430245230012)
('Val: AUC, AUPR, Erros: ', 0.7344085904707796, 0.5509906580559959, 4469.2666)
('Test: AUC, AUPR, Erros: ', 0.7287125238661805, 0.5563432601370306, 4519.5146)
70((647, 331), (647, 331), 51897.33, 58389.0)
('Error: ', tensor(35314.8008, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7511480393463754, 0.5746563654552291)
('Val: AUC, AUPR, Erros: ', 0.735533515977431, 0.5526178522858287, 4434.3613)
('Test: AUC, AUPR, Erros: ', 0.7290508883275965, 0.5577773451694065, 4486.475)
80((647, 331), (647, 331), 51975.445, 58389.0)
('Error: ', tensor(35058.9102, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7532459376982508, 0.5785928609024347)
('Val: AUC, AUPR, Erros: ', 0.7358907958559853, 0.5531291830436731, 4421.6675)
('Test: AUC, AUPR, Erros: ', 0.7287878578136961, 0.5584145386846524, 4474.37)
90((647, 331), (647, 331), 51937.184, 58389.0)
('Error: ', tensor(34873.7891, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7554216975426411, 0.5822594758319379)
('Val: AUC, AUPR, Erros: ', 0.7361116577209975, 0.5533797664527944, 4416.8667)
('Test: AUC, AUPR, Erros: ', 0.7284429355974056, 0.5587717822021447, 4470.032)
100((647, 331), (647, 331), 52104.117, 58389.0)
('Error: ', tensor(34700.4766, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7575656894239857, 0.5856460469799298)
('Val: AUC, AUPR, Erros: ', 0.7360130413510823, 0.5530913183898827, 4414.8584)
('Test: AUC, AUPR, Erros: ', 0.7278758021277094, 0.5588848189876194, 4467.041)
110((647, 331), (647, 331), 52053.6, 58389.0)
('Error: ', tensor(34568.2422, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7597044261897618, 0.5888171802304888)
('Val: AUC, AUPR, Erros: ', 0.7357434979650557, 0.5524260022144719, 4417.1665)
('Test: AUC, AUPR, Erros: ', 0.7272067399656063, 0.5586781720292483, 4468.0776)
120((647, 331), (647, 331), 51926.266, 58389.0)
('Error: ', tensor(34451.7500, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7619236811422844, 0.5918980024937084)
('Val: AUC, AUPR, Erros: ', 0.7353214734337894, 0.5515836251851713, 4421.2686)
('Test: AUC, AUPR, Erros: ', 0.7263683065782283, 0.5582367705554667, 4471.2144)
130((647, 331), (647, 331), 51587.18, 58389.0)
('Error: ', tensor(34357.4570, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7643388908509189, 0.5949965708072512)
('Val: AUC, AUPR, Erros: ', 0.7344156147717027, 0.5500721006606641, 4430.3086)
('Test: AUC, AUPR, Erros: ', 0.7252183138645039, 0.5573403380496295, 4478.267)
140((647, 331), (647, 331), 51503.83, 58389.0)
('Error: ', tensor(34242.3242, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7667945785061266, 0.597959303298042)
('Val: AUC, AUPR, Erros: ', 0.7331296189292674, 0.5481851303922578, 4439.023)
('Test: AUC, AUPR, Erros: ', 0.7236820733111922, 0.5561880629521216, 4484.835)
150((647, 331), (647, 331), 51284.543, 58389.0)
('Error: ', tensor(34139.9453, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7694472524026483, 0.6009329658357795)
('Val: AUC, AUPR, Erros: ', 0.7315145714095177, 0.5460242249121207, 4450.546)
('Test: AUC, AUPR, Erros: ', 0.7220213067339671, 0.5547712121290627, 4494.086)
160((647, 331), (647, 331), 51315.605, 58389.0)
('Error: ', tensor(34013.6992, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7721299989058155, 0.6037930110737041)
('Val: AUC, AUPR, Erros: ', 0.7292820439367473, 0.5433353707251719, 4463.4526)
('Test: AUC, AUPR, Erros: ', 0.7196961208422987, 0.5528904057326995, 4503.641)

Validation:  [0.7360130413510823, 0.5530913183898827, 4414.8584, 0.7278758021277094, 0.5588848189876194, 4467.041]
Train: 0.7576 0.5856
Test: 0.7279 0.5589
4
[0.5232091665113472, 0.5426370649579304, 0.5419973494268291, 0.5488187733195408, 0.5557332869654774, 0.5538569934390757, 0.5586468565365404, 0.5692643616063389, 0.5745580666445191, 0.5748654605118636, 0.5784692219215147, 0.584105984170877, 0.5885813869113252, 0.5899674492408624, 0.5964132974011697, 0.6023102070447203, 0.6066391267190858, 0.611140200465885, 0.6177179936957076, 0.6204482654850816, 0.6210075521158746, 0.624550336046982, 0.6287624322048198, 0.63326511070036, 0.6347917846205161, 0.6422022443756511, 0.6436172151364637, 0.6450247714690357, 0.6483849473453241, 0.6499081020628777, 0.6570676284002824, 0.660671138520673, 0.6642562638967955, 0.6671838413075137, 0.672550273740266, 0.6746598922282838, 0.6759047491178001, 0.6803733923753603, 0.6803733923753603, 0.6825331791698472, 0.6840919075859117, 0.6865599533003925, 0.6881331608775488, 0.6932039788920236, 0.6977992557865524, 0.6977992557865524, 0.6981318235105645, 0.6981318235105645, 0.7015150486811954, 0.7025911566111043, 0.7025911566111043, 0.7058219992853121, 0.7058219992853121, 0.7058219992853121, 0.7058219992853121, 0.7058219992853121, 0.7058219992853121, 0.7058219992853121, 0.7090789675672657, 0.7090789675672657, 0.7110053588338001, 0.7128655119911977, 0.7128655119911977, 0.7128655119911977, 0.7128655119911977, 0.7128655119911977, 0.7128655119911977, 0.7151567398080222, 0.7151567398080222, 0.7151567398080222, 0.7227112588136899, 0.7227112588136899, 0.7227112588136899, 0.7252436866378142, 0.7252436866378142, 0.7252436866378142, 0.7252436866378142, 0.7252436866378142, 0.7278758021277094, 0.7278758021277094, 0.7278758021277094, 0.7278758021277094, 0.7278758021277094, 0.7278758021277094, 0.7278758021277094, 0.7278758021277094, 0.7278758021277094, 0.7278758021277094, 0.7278758021277094, 0.7278758021277094]
[0.12128737318393405, 0.14618186503326402, 0.15360320789177095, 0.15780915502951598, 0.16664729514498594, 0.1667749534730634, 0.17329988976693572, 0.19304477584816115, 0.19829714276837757, 0.200577027354157, 0.20484338741045188, 0.21664188318940636, 0.22174973320727115, 0.2227037251603245, 0.2361568988011795, 0.25117326952410807, 0.2552351174124148, 0.2621730182605968, 0.27585794444117706, 0.28278788423770795, 0.28332932752981865, 0.28770100324587267, 0.29567798096804787, 0.30465472891465684, 0.3078256417355334, 0.327259667225436, 0.32870679687840537, 0.33224583645142475, 0.34143538853243116, 0.3448048533684011, 0.3615485336114903, 0.3717631621072481, 0.3786062487645949, 0.38507470878994193, 0.3995456949769975, 0.4036687312347473, 0.40792915056523016, 0.41739638141701846, 0.41739638141701846, 0.42194274668184034, 0.4261733498008963, 0.43316258760982124, 0.43873935971361505, 0.45319857459254403, 0.46801999296278707, 0.46801999296278707, 0.46720471743442626, 0.46720471743442626, 0.4751783608905932, 0.47626296642991844, 0.47626296642991844, 0.485590681742409, 0.485590681742409, 0.485590681742409, 0.485590681742409, 0.485590681742409, 0.485590681742409, 0.485590681742409, 0.49596448852234776, 0.49596448852234776, 0.5024134353627842, 0.5081903212036107, 0.5081903212036107, 0.5081903212036107, 0.5081903212036107, 0.5081903212036107, 0.5081903212036107, 0.515889398769091, 0.515889398769091, 0.515889398769091, 0.5418510071408309, 0.5418510071408309, 0.5418510071408309, 0.5502996640651118, 0.5502996640651118, 0.5502996640651118, 0.5502996640651118, 0.5502996640651118, 0.5588848189876194, 0.5588848189876194, 0.5588848189876194, 0.5588848189876194, 0.5588848189876194, 0.5588848189876194, 0.5588848189876194, 0.5588848189876194, 0.5588848189876194, 0.5588848189876194, 0.5588848189876194, 0.5588848189876194]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  65207.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_1_5
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19460.0)
('VALIDATE SUM PROTEIN TEST: ', 2506.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 33452.027, 58005.0)
('Error: ', tensor(45101.5469, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.4841219629063863, 0.25966409339182656)
('Val: AUC, AUPR, Erros: ', 0.480735109462362, 0.2734319193567124, 5949.367)
('Test: AUC, AUPR, Erros: ', 0.47774600564048536, 0.25375934021132623, 5606.6997)
10((646, 331), (646, 331), 59277.01, 58005.0)
('Error: ', tensor(42137.0430, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5889426968256669, 0.3273589409157891)
('Val: AUC, AUPR, Erros: ', 0.590453848375825, 0.34683131187160204, 5472.9263)
('Test: AUC, AUPR, Erros: ', 0.5820527390744541, 0.3218069433308829, 5253.2617)
20((646, 331), (646, 331), 53369.484, 58005.0)
('Error: ', tensor(41914.0039, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6440153700239529, 0.3937278935860992)
('Val: AUC, AUPR, Erros: ', 0.6333601907395663, 0.39981383026410355, 5472.856)
('Test: AUC, AUPR, Erros: ', 0.6324764424986125, 0.3822590175751684, 5225.369)
30((646, 331), (646, 331), 50317.32, 58005.0)
('Error: ', tensor(41438.2422, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6784298660221346, 0.45374300681535085)
('Val: AUC, AUPR, Erros: ', 0.6667475922275855, 0.455442989120261, 5429.2295)
('Test: AUC, AUPR, Erros: ', 0.6680583433053151, 0.4415324090486401, 5168.816)
40((646, 331), (646, 331), 49337.305, 58005.0)
('Error: ', tensor(40402.6523, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7041149863817584, 0.5001794347771518)
('Val: AUC, AUPR, Erros: ', 0.6928545335607498, 0.5014522648678377, 5303.259)
('Test: AUC, AUPR, Erros: ', 0.6963340258453771, 0.4915983894697538, 5041.809)
50((646, 331), (646, 331), 44304.277, 58005.0)
('Error: ', tensor(39659.2617, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7183733450821866, 0.5290892328306482)
('Val: AUC, AUPR, Erros: ', 0.7091493347211528, 0.5313759203412981, 5227.6064)
('Test: AUC, AUPR, Erros: ', 0.7134240862627206, 0.5213253190163507, 4945.213)
60((646, 331), (646, 331), 39894.51, 58005.0)
('Error: ', tensor(39184.2227, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7253790446840518, 0.5440826707534909)
('Val: AUC, AUPR, Erros: ', 0.7161177835032807, 0.5448764468059445, 5182.353)
('Test: AUC, AUPR, Erros: ', 0.7219457458008312, 0.5362133696269692, 4878.27)
70((646, 331), (646, 331), 46870.81, 58005.0)
('Error: ', tensor(37038.3047, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7301813515528205, 0.5513714107557464)
('Val: AUC, AUPR, Erros: ', 0.7210437070056415, 0.5513053895711593, 4888.2803)
('Test: AUC, AUPR, Erros: ', 0.7270229204213692, 0.543617154338229, 4615.256)
80((646, 331), (646, 331), 46232.184, 58005.0)
('Error: ', tensor(36502.0625, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7349525222038803, 0.5570206540158298)
('Val: AUC, AUPR, Erros: ', 0.7244748468244488, 0.55656675525005, 4831.302)
('Test: AUC, AUPR, Erros: ', 0.7297433358679825, 0.5467466586202687, 4553.762)
90((646, 331), (646, 331), 50215.0, 58005.0)
('Error: ', tensor(35697.5859, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7391283910622115, 0.5616002765793764)
('Val: AUC, AUPR, Erros: ', 0.7270400705705954, 0.5601192837506785, 4725.966)
('Test: AUC, AUPR, Erros: ', 0.7318751793338722, 0.5492520700080257, 4470.1455)
100((646, 331), (646, 331), 51244.047, 58005.0)
('Error: ', tensor(35379.2305, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7427781543019514, 0.5653680129582428)
('Val: AUC, AUPR, Erros: ', 0.7289611446548394, 0.5624165967483739, 4692.638)
('Test: AUC, AUPR, Erros: ', 0.7336565972793665, 0.5514545138599013, 4441.4424)
110((646, 331), (646, 331), 51243.664, 58005.0)
('Error: ', tensor(35186.3086, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7460288099944021, 0.5688978328291007)
('Val: AUC, AUPR, Erros: ', 0.7302611926074557, 0.564222519013106, 4681.115)
('Test: AUC, AUPR, Erros: ', 0.7345877915752262, 0.5517643049803195, 4432.8438)
120((646, 331), (646, 331), 51951.004, 58005.0)
('Error: ', tensor(34971.3203, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7489199418174933, 0.5722564574140694)
('Val: AUC, AUPR, Erros: ', 0.7314693240176016, 0.5656192404519724, 4661.3716)
('Test: AUC, AUPR, Erros: ', 0.7361782469607967, 0.55372660129667, 4416.7583)
130((646, 331), (646, 331), 51128.555, 58005.0)
('Error: ', tensor(34903.4141, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7516842445704869, 0.5752306076061902)
('Val: AUC, AUPR, Erros: ', 0.7326643885606544, 0.5673303264165075, 4666.134)
('Test: AUC, AUPR, Erros: ', 0.7362080400516575, 0.5533060097890453, 4423.99)
140((646, 331), (646, 331), 51879.13, 58005.0)
('Error: ', tensor(34706.9688, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7542852127761209, 0.5782619256557949)
('Val: AUC, AUPR, Erros: ', 0.7331748797328407, 0.568340522090219, 4651.3237)
('Test: AUC, AUPR, Erros: ', 0.7364280203385801, 0.5532060859051044, 4416.1763)
150((646, 331), (646, 331), 51292.527, 58005.0)
('Error: ', tensor(34648.2188, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7565402375623991, 0.5809713554610572)
('Val: AUC, AUPR, Erros: ', 0.7334110346464957, 0.5683705306694816, 4656.5117)
('Test: AUC, AUPR, Erros: ', 0.7367045278374674, 0.5537587475759432, 4419.446)
160((646, 331), (646, 331), 51360.49, 58005.0)
('Error: ', tensor(34531.8320, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7589400979301185, 0.5837382290996576)
('Val: AUC, AUPR, Erros: ', 0.7333611216604148, 0.5683848960754998, 4654.953)
('Test: AUC, AUPR, Erros: ', 0.7369057400703611, 0.5540962523499656, 4417.883)

Validation:  [0.7331748797328407, 0.568340522090219, 4651.3237, 0.7364280203385801, 0.5532060859051044, 4416.1763]
Train: 0.7543 0.5783
Test: 0.7364 0.5532
5
[0.556076656394453, 0.5436524807751763, 0.5402888741749656, 0.5400665774840994, 0.5497160787914399, 0.5536366241329777, 0.5588186884413031, 0.5683313766210939, 0.5768106166635091, 0.5777210886611736, 0.5827719775843844, 0.5871741444851089, 0.59551855570479, 0.5982795968355873, 0.6030689918067902, 0.6071344337419113, 0.6132742861981879, 0.6209327117166167, 0.6245547752837647, 0.6274928445979353, 0.628403137676745, 0.6330460497340648, 0.6368639413362136, 0.6407539326790732, 0.6431712693359559, 0.6476528485890501, 0.6507459534008613, 0.6521183178435873, 0.6537352739417638, 0.6550352520243551, 0.6620174591940612, 0.6650683742072967, 0.6708000048547095, 0.6746999067659137, 0.6801943878752459, 0.6828037364158288, 0.6840518740074566, 0.6879542604129784, 0.6879542604129784, 0.6905747889397164, 0.6919992670415333, 0.6947232232980168, 0.6964970930402804, 0.702395135740331, 0.7064028211903444, 0.7064028211903444, 0.7079415210039939, 0.7079415210039939, 0.7109530020747916, 0.7121094127988987, 0.7121094127988987, 0.7150116055844844, 0.7150116055844844, 0.7150116055844844, 0.7150116055844844, 0.7150116055844844, 0.7150116055844844, 0.7150116055844844, 0.718462869384545, 0.718462869384545, 0.7201871147790356, 0.722186712371051, 0.722186712371051, 0.722186712371051, 0.722186712371051, 0.722186712371051, 0.722186712371051, 0.7244080618775842, 0.7244080618775842, 0.7244080618775842, 0.7315545835600897, 0.7315545835600897, 0.7315545835600897, 0.7340296826013376, 0.7340296826013376, 0.7340296826013376, 0.7340296826013376, 0.7340296826013376, 0.7364280203385801, 0.7364280203385801, 0.7364280203385801, 0.7364280203385801, 0.7364280203385801, 0.7364280203385801, 0.7364280203385801, 0.7364280203385801, 0.7364280203385801, 0.7364280203385801, 0.7364280203385801, 0.7364280203385801]
[0.12577204356128277, 0.13122865712846693, 0.1330416284617755, 0.13557989051019473, 0.14546362501512414, 0.15079335274282912, 0.1603174752866396, 0.169626078658009, 0.18212176125387036, 0.18350425373423526, 0.1918982170916769, 0.1999698785440586, 0.21383047669125366, 0.21859193424649798, 0.2234175104626379, 0.22962458317264656, 0.2392698030639398, 0.2549032471936684, 0.2587045201036732, 0.26416954991303093, 0.2657564808810452, 0.2760754674028628, 0.2836625493891305, 0.29115565537876, 0.296185328926047, 0.302988971127246, 0.3099257861632128, 0.31267898416778617, 0.31669568850541585, 0.3208776782125218, 0.33831764108763557, 0.345126116577934, 0.3614987880671014, 0.3721936016891834, 0.3859402311153816, 0.3924778985244267, 0.39541527937994864, 0.4042123974362207, 0.4042123974362207, 0.411442136737114, 0.41513175930002555, 0.4227637145476655, 0.4284197041422096, 0.4455672799115837, 0.4560588470880822, 0.4560588470880822, 0.4597785583189628, 0.4597785583189628, 0.467239315811418, 0.47011290651292764, 0.47011290651292764, 0.47711902211314305, 0.47711902211314305, 0.47711902211314305, 0.47711902211314305, 0.47711902211314305, 0.47711902211314305, 0.47711902211314305, 0.4887178482006066, 0.4887178482006066, 0.49451191980009834, 0.5017482526191781, 0.5017482526191781, 0.5017482526191781, 0.5017482526191781, 0.5017482526191781, 0.5017482526191781, 0.5099270486712775, 0.5099270486712775, 0.5099270486712775, 0.5354114157491783, 0.5354114157491783, 0.5354114157491783, 0.5445668489308816, 0.5445668489308816, 0.5445668489308816, 0.5445668489308816, 0.5445668489308816, 0.5532060859051044, 0.5532060859051044, 0.5532060859051044, 0.5532060859051044, 0.5532060859051044, 0.5532060859051044, 0.5532060859051044, 0.5532060859051044, 0.5532060859051044, 0.5532060859051044, 0.5532060859051044, 0.5532060859051044]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  65249.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_1_6
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19683.0)
('VALIDATE SUM PROTEIN TEST: ', 2677.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 57002.01, 57548.0)
('Error: ', tensor(42036.8242, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5243357383475669, 0.28575178687327774)
('Val: AUC, AUPR, Erros: ', 0.5139974036093411, 0.29406647293615995, 5479.506)
('Test: AUC, AUPR, Erros: ', 0.5243489754536557, 0.3031224861323422, 5497.5654)
10((646, 331), (646, 331), 59997.094, 57548.0)
('Error: ', tensor(41733.4375, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6647406473784712, 0.4297428500794078)
('Val: AUC, AUPR, Erros: ', 0.656824430947238, 0.4313493669086544, 5428.581)
('Test: AUC, AUPR, Erros: ', 0.6537129234441271, 0.4367934099681398, 5447.5093)
20((646, 331), (646, 331), 67714.03, 57548.0)
('Error: ', tensor(40878.4688, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7169217096550694, 0.5194311648202117)
('Val: AUC, AUPR, Erros: ', 0.7029793598491157, 0.5121672523029603, 5296.7163)
('Test: AUC, AUPR, Erros: ', 0.7046660844674089, 0.5239326751394482, 5307.998)
30((646, 331), (646, 331), 69898.79, 57548.0)
('Error: ', tensor(38676.1641, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7296546447616422, 0.5434498358872973)
('Val: AUC, AUPR, Erros: ', 0.7151360149786924, 0.5364784108469945, 5027.067)
('Test: AUC, AUPR, Erros: ', 0.716815773685939, 0.5470598326208478, 5025.374)
40((646, 331), (646, 331), 73598.59, 57548.0)
('Error: ', tensor(36824.5938, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7374707137265877, 0.5552617501409629)
('Val: AUC, AUPR, Erros: ', 0.7219748454731292, 0.547190132477031, 4808.0557)
('Test: AUC, AUPR, Erros: ', 0.7239309953901751, 0.5578288833384698, 4783.0024)
50((646, 331), (646, 331), 67557.64, 57548.0)
('Error: ', tensor(35422.6289, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7432023768467958, 0.5627179899949091)
('Val: AUC, AUPR, Erros: ', 0.7268268322806843, 0.553516446834186, 4677.9834)
('Test: AUC, AUPR, Erros: ', 0.7281865811361052, 0.5632520070999322, 4645.867)
60((646, 331), (646, 331), 66539.305, 57548.0)
('Error: ', tensor(35061.4648, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7471527109153745, 0.5680374885481638)
('Val: AUC, AUPR, Erros: ', 0.7301081490393084, 0.5571927649586929, 4650.3213)
('Test: AUC, AUPR, Erros: ', 0.7314607996365468, 0.5675857446974191, 4616.384)
70((646, 331), (646, 331), 66062.04, 57548.0)
('Error: ', tensor(34820.7539, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7500237787651884, 0.5723561763242967)
('Val: AUC, AUPR, Erros: ', 0.7324956399136415, 0.5598642438225989, 4631.397)
('Test: AUC, AUPR, Erros: ', 0.7336363514670599, 0.5703400341037235, 4600.628)
80((646, 331), (646, 331), 65855.08, 57548.0)
('Error: ', tensor(34640.5547, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7522903650722439, 0.5761324412460995)
('Val: AUC, AUPR, Erros: ', 0.7343960399595411, 0.5618918238533687, 4618.449)
('Test: AUC, AUPR, Erros: ', 0.735074505264833, 0.5722237730303958, 4591.4316)
90((646, 331), (646, 331), 65620.836, 57548.0)
('Error: ', tensor(34483.2656, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7542928699753636, 0.5794681972708481)
('Val: AUC, AUPR, Erros: ', 0.7358186991339166, 0.5632088079024975, 4608.779)
('Test: AUC, AUPR, Erros: ', 0.7362846276224874, 0.5738257039885726, 4583.299)
100((646, 331), (646, 331), 65507.496, 57548.0)
('Error: ', tensor(34358.6602, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7559794062550478, 0.5822753411552128)
('Val: AUC, AUPR, Erros: ', 0.7372420911703901, 0.5645943784320149, 4599.555)
('Test: AUC, AUPR, Erros: ', 0.7369451431447089, 0.5745707596054281, 4580.4424)
110((646, 331), (646, 331), 65481.363, 57548.0)
('Error: ', tensor(34249.7305, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.75761716389837, 0.5848831788012381)
('Val: AUC, AUPR, Erros: ', 0.7383520261571367, 0.5655558420821883, 4593.7104)
('Test: AUC, AUPR, Erros: ', 0.7377322027469504, 0.5754121418454485, 4577.8174)
120((646, 331), (646, 331), 65482.355, 57548.0)
('Error: ', tensor(34150.9961, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7591994580672485, 0.5873230498711738)
('Val: AUC, AUPR, Erros: ', 0.7395983178067465, 0.5666428791603083, 4586.402)
('Test: AUC, AUPR, Erros: ', 0.7383656060488382, 0.5759623520659762, 4576.123)
130((646, 331), (646, 331), 65469.113, 57548.0)
('Error: ', tensor(34059.3555, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7607708745857635, 0.5894895304980509)
('Val: AUC, AUPR, Erros: ', 0.7407085152603841, 0.567437915052132, 4581.5454)
('Test: AUC, AUPR, Erros: ', 0.7385356248119896, 0.5757099143312765, 4579.485)
140((646, 331), (646, 331), 65507.395, 57548.0)
('Error: ', tensor(33974.4141, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7623060770614097, 0.5916001932110893)
('Val: AUC, AUPR, Erros: ', 0.7414115208976002, 0.5677338864987743, 4579.4814)
('Test: AUC, AUPR, Erros: ', 0.7389223952443942, 0.5762098908069502, 4578.3276)
150((646, 331), (646, 331), 65518.418, 57548.0)
('Error: ', tensor(33890.2773, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7638926175813183, 0.5936404267126819)
('Val: AUC, AUPR, Erros: ', 0.742386960350347, 0.568223906332683, 4575.878)
('Test: AUC, AUPR, Erros: ', 0.7392554066965554, 0.5763507783713713, 4579.6504)
160((646, 331), (646, 331), 65731.55, 57548.0)
('Error: ', tensor(33824.6758, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.765457334640058, 0.5955918010933626)
('Val: AUC, AUPR, Erros: ', 0.7430785060695435, 0.5684604951658915, 4575.1274)
('Test: AUC, AUPR, Erros: ', 0.7390714988661452, 0.5757561402295353, 4586.7075)

Validation:  [0.7430785060695435, 0.5684604951658915, 4575.1274, 0.7390714988661452, 0.5757561402295353, 4586.7075]
Train: 0.7655 0.5956
Test: 0.7391 0.5758
6
[0.559159377579131, 0.5708359283837667, 0.5710318250968721, 0.5695313269029196, 0.5802326239228753, 0.580861361819051, 0.5836156855980963, 0.594316123405438, 0.6032276858876078, 0.6048844518333205, 0.6080236145944413, 0.6109032790063085, 0.6148869637751463, 0.6177525730202047, 0.6277395948945368, 0.6314986193898307, 0.6353561320197602, 0.6401737749643749, 0.6442373110309543, 0.6479252488512144, 0.6485272820209189, 0.6518200985622111, 0.6553720073838387, 0.6599778409812403, 0.6621340570863236, 0.6675396208275912, 0.669749555295948, 0.6709459908519175, 0.6736759341982888, 0.674420556770809, 0.6799344606242212, 0.6830783593457579, 0.6865747644749214, 0.6893005187807735, 0.6934635398368503, 0.6949658660722112, 0.6959155230213553, 0.6986201127997824, 0.6986201127997824, 0.7007338405745572, 0.7017094941844738, 0.7041890822707858, 0.7055702530272998, 0.7104582418435459, 0.7132758747105697, 0.7132758747105697, 0.7140859111182344, 0.7140859111182344, 0.7161443933435041, 0.7172540350811989, 0.7172540350811989, 0.7197960450511004, 0.7197960450511004, 0.7197960450511004, 0.7197960450511004, 0.7197960450511004, 0.7197960450511004, 0.7197960450511004, 0.7232449310537987, 0.7232449310537987, 0.724957627495203, 0.7265509898891506, 0.7265509898891506, 0.7265509898891506, 0.7265509898891506, 0.7265509898891506, 0.7265509898891506, 0.7284455993774908, 0.7284455993774908, 0.7284455993774908, 0.7345853410454478, 0.7345853410454478, 0.7345853410454478, 0.7367998508639447, 0.7367998508639447, 0.7367998508639447, 0.7367998508639447, 0.7367998508639447, 0.7390714988661452, 0.7390714988661452, 0.7390714988661452, 0.7390714988661452, 0.7390714988661452, 0.7390714988661452, 0.7390714988661452, 0.7390714988661452, 0.7390714988661452, 0.7390714988661452, 0.7390714988661452, 0.7390714988661452]
[0.15723944391977274, 0.16410237107856127, 0.1714564957309139, 0.16994930126563063, 0.18682526617755255, 0.18957244312965682, 0.1918173888381977, 0.21001154627834495, 0.22424601076363265, 0.22707277511397564, 0.2338159574815504, 0.2382763601665221, 0.2482545295814989, 0.2535288158409599, 0.2732967908901101, 0.2809029046384583, 0.28766442193271385, 0.2987842664907783, 0.3071221274286245, 0.3125574031800137, 0.3140032963455352, 0.3230591755417272, 0.33128399275427745, 0.34312003691405557, 0.34799110174495096, 0.36337660622434154, 0.36985068296801227, 0.37316342207418984, 0.38133953282410726, 0.3827723652916476, 0.3970657623237872, 0.4038966463005602, 0.41411122569419423, 0.4220283627351298, 0.43354141307662, 0.43729101132195247, 0.4390481755907858, 0.4438794152791101, 0.4438794152791101, 0.44999173944879195, 0.4516077360114788, 0.4602362551920756, 0.465383723051447, 0.48193414897003106, 0.49006290133279384, 0.49006290133279384, 0.49260566338031075, 0.49260566338031075, 0.49918035053699, 0.5014595600118581, 0.5014595600118581, 0.5094297828799987, 0.5094297828799987, 0.5094297828799987, 0.5094297828799987, 0.5094297828799987, 0.5094297828799987, 0.5094297828799987, 0.5213659028967412, 0.5213659028967412, 0.5263335314999757, 0.5320481670509626, 0.5320481670509626, 0.5320481670509626, 0.5320481670509626, 0.5320481670509626, 0.5320481670509626, 0.5389577223351424, 0.5389577223351424, 0.5389577223351424, 0.5603805416035683, 0.5603805416035683, 0.5603805416035683, 0.5680617488030926, 0.5680617488030926, 0.5680617488030926, 0.5680617488030926, 0.5680617488030926, 0.5757561402295353, 0.5757561402295353, 0.5757561402295353, 0.5757561402295353, 0.5757561402295353, 0.5757561402295353, 0.5757561402295353, 0.5757561402295353, 0.5757561402295353, 0.5757561402295353, 0.5757561402295353, 0.5757561402295353]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  65947.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_1_7
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 20164.0)
('VALIDATE SUM PROTEIN TEST: ', 2283.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 49792.543, 58288.0)
('Error: ', tensor(42725.7969, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5117484129612093, 0.27656676500019967)
('Val: AUC, AUPR, Erros: ', 0.5068337231144227, 0.25979852176610724, 5172.4053)
('Test: AUC, AUPR, Erros: ', 0.514521307975732, 0.29270301294338524, 5544.037)
10((646, 331), (646, 331), 65924.29, 58288.0)
('Error: ', tensor(41879.5938, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6599650980502034, 0.4034139306139367)
('Val: AUC, AUPR, Erros: ', 0.6506826808013122, 0.38174049763101525, 5128.9907)
('Test: AUC, AUPR, Erros: ', 0.6533438268278084, 0.4142050686473807, 5386.6807)
20((646, 331), (646, 331), 65162.75, 58288.0)
('Error: ', tensor(41097.4688, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6952945182253487, 0.47115000236445853)
('Val: AUC, AUPR, Erros: ', 0.6852070097632835, 0.44829989825263117, 5035.8145)
('Test: AUC, AUPR, Erros: ', 0.6854072798962196, 0.4757859841798525, 5294.979)
30((646, 331), (646, 331), 59636.746, 58288.0)
('Error: ', tensor(39086.9492, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7114116648743347, 0.5126236359986922)
('Val: AUC, AUPR, Erros: ', 0.7012472367638772, 0.4887621407330219, 4784.7466)
('Test: AUC, AUPR, Erros: ', 0.7010556820577797, 0.5160313295763979, 5065.033)
40((646, 331), (646, 331), 60521.934, 58288.0)
('Error: ', tensor(37546.7070, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.720779379676045, 0.5339751306235638)
('Val: AUC, AUPR, Erros: ', 0.7101730946471471, 0.5077315416640362, 4616.315)
('Test: AUC, AUPR, Erros: ', 0.7091361207017195, 0.5337954816906819, 4881.9707)
50((646, 331), (646, 331), 59597.703, 58288.0)
('Error: ', tensor(35994.6211, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7269235590813234, 0.5473143448913983)
('Val: AUC, AUPR, Erros: ', 0.7153055074385285, 0.5174941642513458, 4465.1294)
('Test: AUC, AUPR, Erros: ', 0.7145438896726082, 0.5447205163561646, 4714.895)
60((646, 331), (646, 331), 66444.375, 58288.0)
('Error: ', tensor(35860.3438, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.733964215041497, 0.5570368559392213)
('Val: AUC, AUPR, Erros: ', 0.7209379243912739, 0.5245523465234757, 4494.709)
('Test: AUC, AUPR, Erros: ', 0.7197331941563444, 0.5513865239263191, 4697.682)
70((646, 331), (646, 331), 65253.02, 58288.0)
('Error: ', tensor(35524.4883, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7379629037380131, 0.5622562850016812)
('Val: AUC, AUPR, Erros: ', 0.7238411487969858, 0.5278797200837035, 4459.8213)
('Test: AUC, AUPR, Erros: ', 0.7230215429824507, 0.5549648584918312, 4667.248)
80((646, 331), (646, 331), 65201.37, 58288.0)
('Error: ', tensor(35314.3359, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7413103743463219, 0.5665863866584672)
('Val: AUC, AUPR, Erros: ', 0.7259266217649467, 0.5301960259592126, 4446.8506)
('Test: AUC, AUPR, Erros: ', 0.7254618101538391, 0.557175249240175, 4652.202)
90((646, 331), (646, 331), 65441.8, 58288.0)
('Error: ', tensor(35169.5156, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7440580958774928, 0.5702246471119474)
('Val: AUC, AUPR, Erros: ', 0.727412254022682, 0.5318111223088406, 4440.3306)
('Test: AUC, AUPR, Erros: ', 0.7274930414232473, 0.558682650304686, 4642.0396)
100((646, 331), (646, 331), 65802.93, 58288.0)
('Error: ', tensor(35044.6172, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.746671271617567, 0.5738098912812277)
('Val: AUC, AUPR, Erros: ', 0.7287706679568101, 0.5335391988691652, 4435.8833)
('Test: AUC, AUPR, Erros: ', 0.7293600400007723, 0.5601552863412332, 4634.8823)
110((646, 331), (646, 331), 66155.58, 58288.0)
('Error: ', tensor(34932.0039, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7491080958038991, 0.577203269806075)
('Val: AUC, AUPR, Erros: ', 0.7299665932939801, 0.5347786698408928, 4431.9893)
('Test: AUC, AUPR, Erros: ', 0.7308948577541254, 0.5612129421135832, 4629.481)
120((646, 331), (646, 331), 66442.78, 58288.0)
('Error: ', tensor(34819.8359, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7515016657937084, 0.5804749722162471)
('Val: AUC, AUPR, Erros: ', 0.7311170512068498, 0.5361769535344705, 4427.2383)
('Test: AUC, AUPR, Erros: ', 0.7325174383002376, 0.5621212555524291, 4624.117)
130((646, 331), (646, 331), 66756.53, 58288.0)
('Error: ', tensor(34713.0312, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7538618333970986, 0.58366993917611)
('Val: AUC, AUPR, Erros: ', 0.73211523214802, 0.5369681114549295, 4425.628)
('Test: AUC, AUPR, Erros: ', 0.7342367293740292, 0.5635643270867933, 4617.8345)
140((646, 331), (646, 331), 66629.79, 58288.0)
('Error: ', tensor(34572.2266, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7562544103909836, 0.5867988542152046)
('Val: AUC, AUPR, Erros: ', 0.7329779733578625, 0.537603655841755, 4417.579)
('Test: AUC, AUPR, Erros: ', 0.735607795056689, 0.5641528687741872, 4611.6504)
150((646, 331), (646, 331), 66912.19, 58288.0)
('Error: ', tensor(34486.3047, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7582858520571212, 0.5893643334612718)
('Val: AUC, AUPR, Erros: ', 0.7342955371723785, 0.5391050074903759, 4412.1055)
('Test: AUC, AUPR, Erros: ', 0.7366722380547706, 0.5646729467338574, 4610.372)
160((646, 331), (646, 331), 66870.766, 58288.0)
('Error: ', tensor(34382.6055, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7601000957606113, 0.5917908877747886)
('Val: AUC, AUPR, Erros: ', 0.7348197170489633, 0.5392361265242164, 4407.6016)
('Test: AUC, AUPR, Erros: ', 0.7384617952648082, 0.5659459284497546, 4601.2656)

Validation:  [0.7348197170489633, 0.5392361265242164, 4407.6016, 0.7384617952648082, 0.5659459284497546, 4601.2656]
Train: 0.7601 0.5918
Test: 0.7385 0.5659
7
[0.5911021177965791, 0.6121135354598727, 0.6182611898592695, 0.6137939448812872, 0.6114241264751579, 0.610276484006079, 0.6162168330475897, 0.6213443648954198, 0.6278121807417597, 0.6280077896308349, 0.632039933615365, 0.6329409172822826, 0.6337880965663898, 0.6342839596618094, 0.6399213221392014, 0.6441147913300285, 0.6470560653194244, 0.6497992418322501, 0.6540799423096155, 0.6578762569933676, 0.657923733030009, 0.6614368814448264, 0.6632880359322406, 0.6660981598428949, 0.667543024702944, 0.6706023110668314, 0.6715921765947611, 0.6719520541718818, 0.6730576675110733, 0.6739378041348217, 0.6789601532490637, 0.6822465576709262, 0.6851262071660342, 0.6872264057583556, 0.6901112560430313, 0.6918625709763383, 0.692403831884463, 0.695433514868707, 0.695433514868707, 0.6977895887204065, 0.6983871648064143, 0.700662617232253, 0.7015617898219738, 0.7064177446358727, 0.710411069132214, 0.710411069132214, 0.7112383875472035, 0.7112383875472035, 0.7140824035152086, 0.7156937281127209, 0.7156937281127209, 0.7185101267599285, 0.7185101267599285, 0.7185101267599285, 0.7185101267599285, 0.7185101267599285, 0.7185101267599285, 0.7185101267599285, 0.72205483439123, 0.72205483439123, 0.7234041534506305, 0.72534286442329, 0.72534286442329, 0.72534286442329, 0.72534286442329, 0.72534286442329, 0.72534286442329, 0.7274622305160949, 0.7274622305160949, 0.7274622305160949, 0.7338038753421341, 0.7338038753421341, 0.7338038753421341, 0.7360040184836305, 0.7360040184836305, 0.7360040184836305, 0.7360040184836305, 0.7360040184836305, 0.7384617952648082, 0.7384617952648082, 0.7384617952648082, 0.7384617952648082, 0.7384617952648082, 0.7384617952648082, 0.7384617952648082, 0.7384617952648082, 0.7384617952648082, 0.7384617952648082, 0.7384617952648082, 0.7384617952648082]
[0.14489300053739845, 0.16590391806334506, 0.18396259202536402, 0.18933508933899784, 0.19044873524680334, 0.1937321097302066, 0.20910910333856375, 0.2234458403761842, 0.2377510696725018, 0.23878580347084635, 0.24804141395954993, 0.2511773585446714, 0.2546869568345552, 0.2569783983159849, 0.27347610463039096, 0.28403818479488074, 0.2909407982946586, 0.29819855216474545, 0.3077357004473511, 0.3179126017333147, 0.31779075305552784, 0.32720634929571357, 0.33155628054704006, 0.34002531886657794, 0.34420012974953296, 0.3534527617206401, 0.3563325744035758, 0.3573448084093074, 0.3602593993149974, 0.36317025249070645, 0.3785463185782565, 0.388723251124815, 0.39552054693726907, 0.4000164495093896, 0.40784427925617484, 0.4131018379944317, 0.4141825007376629, 0.4214089224198727, 0.4214089224198727, 0.4303800413356083, 0.43137864667746206, 0.43810786209058605, 0.4401936091420622, 0.4564446613535129, 0.4693077744027206, 0.4693077744027206, 0.47168403418546556, 0.47168403418546556, 0.48101433885965045, 0.48639509815413584, 0.48639509815413584, 0.4950870530761946, 0.4950870530761946, 0.4950870530761946, 0.4950870530761946, 0.4950870530761946, 0.4950870530761946, 0.4950870530761946, 0.5085001769268036, 0.5085001769268036, 0.5125494911970927, 0.5192098301765902, 0.5192098301765902, 0.5192098301765902, 0.5192098301765902, 0.5192098301765902, 0.5192098301765902, 0.5271798693613416, 0.5271798693613416, 0.5271798693613416, 0.5501898734626848, 0.5501898734626848, 0.5501898734626848, 0.5572791227660248, 0.5572791227660248, 0.5572791227660248, 0.5572791227660248, 0.5572791227660248, 0.5659459284497546, 0.5659459284497546, 0.5659459284497546, 0.5659459284497546, 0.5659459284497546, 0.5659459284497546, 0.5659459284497546, 0.5659459284497546, 0.5659459284497546, 0.5659459284497546, 0.5659459284497546, 0.5659459284497546]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
647 81 331
Num Drug-SE:  64603.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_1_8
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((647, 3826), (81, 3826), (647, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19895.0)
('VALIDATE SUM PROTEIN TEST: ', 2196.0)
(647, 3826) (647, 331)
0((647, 331), (647, 331), 32363.31, 57642.0)
('Error: ', tensor(45108.9453, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5091630062954259, 0.27109145069578944)
('Val: AUC, AUPR, Erros: ', 0.5007551242311894, 0.30974369679555974, 6400.5596)
('Test: AUC, AUPR, Erros: ', 0.5088376369676757, 0.26046273587641816, 5469.7783)
10((647, 331), (647, 331), 58469.535, 57642.0)
('Error: ', tensor(41898.0078, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6166330474072166, 0.3583562587521141)
('Val: AUC, AUPR, Erros: ', 0.597804885441312, 0.39344251528160445, 5717.2886)
('Test: AUC, AUPR, Erros: ', 0.610708622382276, 0.34291117410209176, 5132.0464)
20((647, 331), (647, 331), 62289.195, 57642.0)
('Error: ', tensor(41544.3359, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6645817833234492, 0.43118821379881345)
('Val: AUC, AUPR, Erros: ', 0.6381189469229769, 0.45548262036533493, 5636.168)
('Test: AUC, AUPR, Erros: ', 0.6559247980019662, 0.4092725020364476, 5101.875)
30((647, 331), (647, 331), 64073.727, 57642.0)
('Error: ', tensor(40778.4883, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6966052387821571, 0.4819184436154773)
('Val: AUC, AUPR, Erros: ', 0.6668193188339666, 0.49786200995216356, 5530.0474)
('Test: AUC, AUPR, Erros: ', 0.6852775973514909, 0.45280791153809696, 5020.62)
40((647, 331), (647, 331), 72579.29, 57642.0)
('Error: ', tensor(39450.9883, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7170944053556415, 0.5179269404119243)
('Val: AUC, AUPR, Erros: ', 0.6849496475085441, 0.5259940001720832, 5300.359)
('Test: AUC, AUPR, Erros: ', 0.7033441082504649, 0.4841644667021444, 4906.727)
50((647, 331), (647, 331), 66081.84, 57642.0)
('Error: ', tensor(36741.8711, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7318927985406449, 0.5453562151958139)
('Val: AUC, AUPR, Erros: ', 0.6963998055562227, 0.5453333806105436, 5072.01)
('Test: AUC, AUPR, Erros: ', 0.7145842996442577, 0.5084746606261652, 4593.2007)
60((647, 331), (647, 331), 49957.367, 57642.0)
('Error: ', tensor(36789.7539, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7435322842315442, 0.5588056266278243)
('Val: AUC, AUPR, Erros: ', 0.7030065910478018, 0.5551454712193169, 5251.3516)
('Test: AUC, AUPR, Erros: ', 0.7220209754454197, 0.5204138231964788, 4559.7617)
70((647, 331), (647, 331), 50987.52, 57642.0)
('Error: ', tensor(35856.5664, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7485233743893038, 0.566705481204222)
('Val: AUC, AUPR, Erros: ', 0.7058140908801065, 0.5581305808733702, 5152.9834)
('Test: AUC, AUPR, Erros: ', 0.7253075881205, 0.5257955877234369, 4472.904)
80((647, 331), (647, 331), 51361.777, 57642.0)
('Error: ', tensor(35354.0742, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7517389236143901, 0.5719963586612685)
('Val: AUC, AUPR, Erros: ', 0.7078058940977039, 0.5595036977804401, 5110.032)
('Test: AUC, AUPR, Erros: ', 0.7274161295190151, 0.5290131001260797, 4431.3213)
90((647, 331), (647, 331), 51676.195, 57642.0)
('Error: ', tensor(35024.6133, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7540617317117466, 0.5760967212635407)
('Val: AUC, AUPR, Erros: ', 0.7092233362345317, 0.5600965272045106, 5085.8345)
('Test: AUC, AUPR, Erros: ', 0.7289030499902841, 0.5312854163284259, 4407.0645)
100((647, 331), (647, 331), 51790.137, 57642.0)
('Error: ', tensor(34802.3984, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7558992566351473, 0.5795164729657404)
('Val: AUC, AUPR, Erros: ', 0.7102885071968214, 0.5603650843720627, 5074.3936)
('Test: AUC, AUPR, Erros: ', 0.7299890610406956, 0.532923471673175, 4392.897)
110((647, 331), (647, 331), 51567.32, 57642.0)
('Error: ', tensor(34657.1445, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7575638468346055, 0.5826409161376043)
('Val: AUC, AUPR, Erros: ', 0.7111330192530808, 0.5603661494697523, 5073.4683)
('Test: AUC, AUPR, Erros: ', 0.7311657970622218, 0.5346852379961804, 4384.2354)
120((647, 331), (647, 331), 51695.746, 57642.0)
('Error: ', tensor(34499.7461, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.759056318163864, 0.5854701498848496)
('Val: AUC, AUPR, Erros: ', 0.7117274640241746, 0.5599547147554531, 5067.9546)
('Test: AUC, AUPR, Erros: ', 0.7320481328683703, 0.5360067110063744, 4375.2036)
130((647, 331), (647, 331), 51752.69, 57642.0)
('Error: ', tensor(34367.4961, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7604644983507645, 0.5881372983344417)
('Val: AUC, AUPR, Erros: ', 0.7122340215329093, 0.5595895605073804, 5065.2456)
('Test: AUC, AUPR, Erros: ', 0.7329116484537639, 0.5372092869534937, 4368.0435)
140((647, 331), (647, 331), 51563.832, 57642.0)
('Error: ', tensor(34265.3945, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7620517274815996, 0.5907819457939885)
('Val: AUC, AUPR, Erros: ', 0.7126530594668365, 0.5590704674819627, 5068.5537)
('Test: AUC, AUPR, Erros: ', 0.7337640043466351, 0.5382924095065946, 4363.998)
150((647, 331), (647, 331), 51506.082, 57642.0)
('Error: ', tensor(34141.4922, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.763643422609458, 0.593414756253871)
('Val: AUC, AUPR, Erros: ', 0.7129661735733682, 0.5584088791682295, 5070.07)
('Test: AUC, AUPR, Erros: ', 0.7346107586817813, 0.5392941023635447, 4358.602)
160((647, 331), (647, 331), 51427.48, 57642.0)
('Error: ', tensor(34056.7344, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.76521865030506, 0.5957720950478285)
('Val: AUC, AUPR, Erros: ', 0.7129650970107168, 0.5575758100075909, 5073.247)
('Test: AUC, AUPR, Erros: ', 0.7353993516233119, 0.540049895262244, 4355.809)

Validation:  [0.7122340215329093, 0.5595895605073804, 5065.2456, 0.7329116484537639, 0.5372092869534937, 4368.0435]
Train: 0.7605 0.5881
Test: 0.7329 0.5372
8
[0.5953335534145896, 0.588121884162132, 0.5855513377623376, 0.5823375284439414, 0.5847196444599638, 0.5889952165211411, 0.5920679858757109, 0.5984294800691661, 0.6012111979013121, 0.6023351495398943, 0.6077002057514618, 0.6090165180920929, 0.6135949720223112, 0.6144557903606209, 0.6199062792724876, 0.624226271137619, 0.6284935652599499, 0.6314489474237661, 0.6347651014380209, 0.6349381742157636, 0.6357663453318233, 0.6401536517454465, 0.6429229945702315, 0.6476392660701404, 0.6486520694633974, 0.6534693910521567, 0.6559728656813202, 0.6574592170441708, 0.6592827596007717, 0.6604717802410969, 0.6670105686286073, 0.6698122594451388, 0.6742448946129135, 0.6766515556316801, 0.6806246711058198, 0.6821427155453818, 0.6833404891080347, 0.6872542013179616, 0.6872542013179616, 0.6893210509689708, 0.6905652945747021, 0.6927925256094885, 0.6940938649330775, 0.6988069012184799, 0.7023900426560811, 0.7023900426560811, 0.7035111300437356, 0.7035111300437356, 0.7064192761441657, 0.7078427151904885, 0.7078427151904885, 0.7111423679878052, 0.7111423679878052, 0.7111423679878052, 0.7111423679878052, 0.7111423679878052, 0.7111423679878052, 0.7111423679878052, 0.7147302506733453, 0.7147302506733453, 0.7163958553524177, 0.7187141407820702, 0.7187141407820702, 0.7187141407820702, 0.7187141407820702, 0.7187141407820702, 0.7187141407820702, 0.7209713313921047, 0.7209713313921047, 0.7209713313921047, 0.7278382252815759, 0.7278382252815759, 0.7278382252815759, 0.7302517946693474, 0.7302517946693474, 0.7302517946693474, 0.7302517946693474, 0.7302517946693474, 0.7329116484537639, 0.7329116484537639, 0.7329116484537639, 0.7329116484537639, 0.7329116484537639, 0.7329116484537639, 0.7329116484537639, 0.7329116484537639, 0.7329116484537639, 0.7329116484537639, 0.7329116484537639, 0.7329116484537639]
[0.13960309547444272, 0.1499519256818131, 0.15384833148451904, 0.15476264844474127, 0.16222396314212473, 0.16988030360964385, 0.1765570875564714, 0.18834508039907943, 0.19629283554659607, 0.19826822223136154, 0.21254800791751172, 0.2162570936465003, 0.22645680127377898, 0.2309604206677959, 0.23743499209157803, 0.24466142364669088, 0.25450112941226305, 0.26177450764927085, 0.269819622055786, 0.267830972282584, 0.2711091464147014, 0.28251560926301145, 0.2889902759948719, 0.2996325012033383, 0.30111567624358504, 0.3120378925745359, 0.31869670691001295, 0.3222544151984073, 0.32561721253493414, 0.32922090101345464, 0.3443032279379056, 0.34991428380024203, 0.3619067321261048, 0.3679496994156305, 0.3775962874868818, 0.3816596264806166, 0.38550105739914203, 0.3945646641449393, 0.3945646641449393, 0.39931604545215754, 0.4031665803600425, 0.41046609831264036, 0.4145563286098718, 0.42811046753758036, 0.4374958209581958, 0.4374958209581958, 0.44015721945177133, 0.44015721945177133, 0.4500299624402469, 0.45355565427087047, 0.45355565427087047, 0.4644904480362473, 0.4644904480362473, 0.4644904480362473, 0.4644904480362473, 0.4644904480362473, 0.4644904480362473, 0.4644904480362473, 0.47647879492010914, 0.47647879492010914, 0.4810545922408859, 0.4889467622147626, 0.4889467622147626, 0.4889467622147626, 0.4889467622147626, 0.4889467622147626, 0.4889467622147626, 0.4967334675205002, 0.4967334675205002, 0.4967334675205002, 0.5198369337010562, 0.5198369337010562, 0.5198369337010562, 0.5276902808154574, 0.5276902808154574, 0.5276902808154574, 0.5276902808154574, 0.5276902808154574, 0.5372092869534937, 0.5372092869534937, 0.5372092869534937, 0.5372092869534937, 0.5372092869534937, 0.5372092869534937, 0.5372092869534937, 0.5372092869534937, 0.5372092869534937, 0.5372092869534937, 0.5372092869534937, 0.5372092869534937]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
647 80 331
Num Drug-SE:  65906.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_1_9
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((647, 3826), (80, 3826), (647, 331), (80, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19566.0)
('VALIDATE SUM PROTEIN TEST: ', 2552.0)
(647, 3826) (647, 331)
0((647, 331), (647, 331), 39591.207, 57601.0)
('Error: ', tensor(43613.1562, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5103769364108821, 0.268972231860047)
('Val: AUC, AUPR, Erros: ', 0.5172275082796203, 0.2654550042714761, 5327.3906)
('Test: AUC, AUPR, Erros: ', 0.5125673418922825, 0.31733433947564993, 6136.949)
10((647, 331), (647, 331), 56047.504, 57601.0)
('Error: ', tensor(41674.9336, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6419993580847375, 0.3791974518507288)
('Val: AUC, AUPR, Erros: ', 0.6567268434688089, 0.39286932779196493, 5112.8193)
('Test: AUC, AUPR, Erros: ', 0.6198162887241656, 0.4126459040530616, 5719.836)
20((647, 331), (647, 331), 56835.48, 57601.0)
('Error: ', tensor(41139.3516, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6791938629749263, 0.4292412088764971)
('Val: AUC, AUPR, Erros: ', 0.685201392521661, 0.4350247951087581, 5050.9775)
('Test: AUC, AUPR, Erros: ', 0.6538680316376919, 0.4538375702241111, 5647.624)
30((647, 331), (647, 331), 39156.06, 57601.0)
('Error: ', tensor(41496.0586, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7048514174043218, 0.48573303684016966)
('Val: AUC, AUPR, Erros: ', 0.7004320459185565, 0.4698528114855127, 5070.538)
('Test: AUC, AUPR, Erros: ', 0.6767364748535667, 0.4961189190334038, 5889.156)
40((647, 331), (647, 331), 72855.57, 57601.0)
('Error: ', tensor(40517.7500, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7178120777394392, 0.49654764471476237)
('Val: AUC, AUPR, Erros: ', 0.7129575989690403, 0.48200295739185, 5032.3354)
('Test: AUC, AUPR, Erros: ', 0.6873048287147415, 0.5013566147825941, 5414.0537)
50((647, 331), (647, 331), 65622.555, 57601.0)
('Error: ', tensor(37992.4492, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7280374953537523, 0.5252994335803309)
('Val: AUC, AUPR, Erros: ', 0.7200880555837814, 0.5006978230117143, 4724.8765)
('Test: AUC, AUPR, Erros: ', 0.6976273254788427, 0.5235184104689271, 5196.451)
60((647, 331), (647, 331), 66454.93, 57601.0)
('Error: ', tensor(36985.1367, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7349647185245223, 0.5417208605355249)
('Val: AUC, AUPR, Erros: ', 0.7255563409769238, 0.5125307036829103, 4625.335)
('Test: AUC, AUPR, Erros: ', 0.7032203268278585, 0.5345767378270765, 5086.977)
70((647, 331), (647, 331), 66837.945, 57601.0)
('Error: ', tensor(36272.8125, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7404298449987974, 0.5528284348199641)
('Val: AUC, AUPR, Erros: ', 0.7299582117476687, 0.5213063179069909, 4559.292)
('Test: AUC, AUPR, Erros: ', 0.706943815851474, 0.5425099327058887, 5019.6787)
80((647, 331), (647, 331), 67175.15, 57601.0)
('Error: ', tensor(35787.7812, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7446494119435013, 0.5597207356819883)
('Val: AUC, AUPR, Erros: ', 0.7330698869721408, 0.5264037156976941, 4518.792)
('Test: AUC, AUPR, Erros: ', 0.7091174289696385, 0.5476528944768047, 4980.3906)
90((647, 331), (647, 331), 66502.52, 57601.0)
('Error: ', tensor(35359.0664, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7479988718192763, 0.5650581716896628)
('Val: AUC, AUPR, Erros: ', 0.7351408067870788, 0.5298328829067487, 4480.3105)
('Test: AUC, AUPR, Erros: ', 0.7104414519683292, 0.5513912393626569, 4955.153)
100((647, 331), (647, 331), 66063.414, 57601.0)
('Error: ', tensor(35049.7539, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7508761544538689, 0.5694055663938816)
('Val: AUC, AUPR, Erros: ', 0.736540405459398, 0.5321414601504441, 4455.8315)
('Test: AUC, AUPR, Erros: ', 0.7112095810763474, 0.5538111283919638, 4940.647)
110((647, 331), (647, 331), 66225.875, 57601.0)
('Error: ', tensor(34838.3320, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7534433185968392, 0.5730887661773778)
('Val: AUC, AUPR, Erros: ', 0.7375447880875616, 0.5337107449295939, 4445.279)
('Test: AUC, AUPR, Erros: ', 0.7117891328453467, 0.5556496294118647, 4931.3364)
120((647, 331), (647, 331), 65936.33, 57601.0)
('Error: ', tensor(34634.3828, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7557188575425595, 0.5763614407436004)
('Val: AUC, AUPR, Erros: ', 0.7382998783772055, 0.5350182801060501, 4432.1006)
('Test: AUC, AUPR, Erros: ', 0.7120557096328342, 0.5568443468741375, 4925.884)
130((647, 331), (647, 331), 66116.875, 57601.0)
('Error: ', tensor(34488.9453, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7578410478626337, 0.5794488442921428)
('Val: AUC, AUPR, Erros: ', 0.7387989172634074, 0.5358528201303131, 4428.728)
('Test: AUC, AUPR, Erros: ', 0.7123264899834126, 0.5577717496076148, 4922.6343)
140((647, 331), (647, 331), 65772.45, 57601.0)
('Error: ', tensor(34320.2031, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7599102412271668, 0.5824206886332474)
('Val: AUC, AUPR, Erros: ', 0.7391194591582979, 0.5363425222211985, 4420.6978)
('Test: AUC, AUPR, Erros: ', 0.7124684637533778, 0.5582344548325091, 4921.11)
150((647, 331), (647, 331), 65844.37, 57601.0)
('Error: ', tensor(34197.2500, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7618926840485545, 0.5852050948289632)
('Val: AUC, AUPR, Erros: ', 0.7393689317385488, 0.5367947597980993, 4419.176)
('Test: AUC, AUPR, Erros: ', 0.7124761321919559, 0.5584438764688814, 4921.7354)
160((647, 331), (647, 331), 65967.92, 57601.0)
('Error: ', tensor(34088.2812, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7638210945711383, 0.5878468410207555)
('Val: AUC, AUPR, Erros: ', 0.7394682665614862, 0.5369722033440416, 4420.068)
('Test: AUC, AUPR, Erros: ', 0.7124823199428263, 0.558337557488211, 4923.6743)

Validation:  [0.7393689317385488, 0.5367947597980993, 4419.176, 0.7124761321919559, 0.5584438764688814, 4921.7354]
Train: 0.7619 0.5852
Test: 0.7125 0.5584
9
[0.5669501754385965, 0.5757501611205181, 0.5832714828609782, 0.5784206381302679, 0.5796149110935018, 0.5849969451522391, 0.5904204371221005, 0.5939949821583081, 0.5970415584415584, 0.5968188469643619, 0.5993782206101252, 0.601097133987121, 0.6036917365099929, 0.6036508906815853, 0.6062973080126725, 0.6115094306998663, 0.614034697997628, 0.6184984781929498, 0.6216548817407112, 0.6225568209998733, 0.6229863903160233, 0.6271124860843893, 0.6293629626752526, 0.633040369016562, 0.634331993545223, 0.6399146345773253, 0.6409979130279317, 0.6418571465411679, 0.6444725419376087, 0.6457353723893059, 0.6518248622761782, 0.6539739659359937, 0.6570588760955183, 0.6598368399312696, 0.663891561179021, 0.6651587306270546, 0.6658973748447705, 0.6703687677298377, 0.6703687677298377, 0.6727942409124202, 0.6734612091046979, 0.676314989561057, 0.6775085117987714, 0.6822507029896128, 0.685581136766046, 0.685581136766046, 0.6867305884651519, 0.6867305884651519, 0.6890875535645419, 0.6902601676387803, 0.6902601676387803, 0.6931055189474267, 0.6931055189474267, 0.6931055189474267, 0.6931055189474267, 0.6931055189474267, 0.6931055189474267, 0.6931055189474267, 0.6965210416087568, 0.6965210416087568, 0.6985517938138504, 0.700083186597615, 0.700083186597615, 0.700083186597615, 0.700083186597615, 0.700083186597615, 0.700083186597615, 0.7021270696958029, 0.7021270696958029, 0.7021270696958029, 0.7082343223633065, 0.7082343223633065, 0.7082343223633065, 0.7102653397859681, 0.7102653397859681, 0.7102653397859681, 0.7102653397859681, 0.7102653397859681, 0.7124761321919559, 0.7124761321919559, 0.7124761321919559, 0.7124761321919559, 0.7124761321919559, 0.7124761321919559, 0.7124761321919559, 0.7124761321919559, 0.7124761321919559, 0.7124761321919559, 0.7124761321919559, 0.7124761321919559]
[0.14765285142595275, 0.1829119082644297, 0.19497917062925813, 0.20043451861016537, 0.20619641863360524, 0.21636868282549207, 0.23139239058686395, 0.2426581818348882, 0.24999764919091086, 0.25113268857921595, 0.2576733379674655, 0.2619470081408568, 0.2683039023166543, 0.26896844640344, 0.27895461767183444, 0.29185819294628834, 0.2978990490157225, 0.3093702348399066, 0.3163683367300628, 0.3194888537890208, 0.32072225193679194, 0.33093501423287575, 0.3361353535020931, 0.34442286239278946, 0.34813350869328313, 0.3628204679556563, 0.3641202790795771, 0.36586019192726216, 0.3733583414971986, 0.37768498529285965, 0.39216869909702756, 0.3951477111044388, 0.4027655661456434, 0.4106159917806336, 0.42083964696837073, 0.42457119546633926, 0.4243466096049555, 0.43535549116059885, 0.43535549116059885, 0.4432662484528594, 0.44327611610702056, 0.45221570073238243, 0.4552635481172598, 0.46851430321123905, 0.4771908714487191, 0.4771908714487191, 0.4803026050322196, 0.4803026050322196, 0.48664123831311196, 0.4902775629052801, 0.4902775629052801, 0.49856009288504843, 0.49856009288504843, 0.49856009288504843, 0.49856009288504843, 0.49856009288504843, 0.49856009288504843, 0.49856009288504843, 0.508707812678416, 0.508707812678416, 0.5151004379306858, 0.5207005462171502, 0.5207005462171502, 0.5207005462171502, 0.5207005462171502, 0.5207005462171502, 0.5207005462171502, 0.5270723680222485, 0.5270723680222485, 0.5270723680222485, 0.5453416717652529, 0.5453416717652529, 0.5453416717652529, 0.5513952753997102, 0.5513952753997102, 0.5513952753997102, 0.5513952753997102, 0.5513952753997102, 0.5584438764688814, 0.5584438764688814, 0.5584438764688814, 0.5584438764688814, 0.5584438764688814, 0.5584438764688814, 0.5584438764688814, 0.5584438764688814, 0.5584438764688814, 0.5584438764688814, 0.5584438764688814, 0.5584438764688814]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  66173.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_2_0
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 20038.0)
('VALIDATE SUM PROTEIN TEST: ', 2215.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 66452.84, 59503.0)
('Error: ', tensor(43192.4102, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.49158354520290065, 0.2673646376631893)
('Val: AUC, AUPR, Erros: ', 0.48754063068136183, 0.23777551891151005, 5141.621)
('Test: AUC, AUPR, Erros: ', 0.4855500021698599, 0.2349760562533336, 5116.7847)
10((646, 331), (646, 331), 62573.734, 59503.0)
('Error: ', tensor(42062.5312, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7213568451505218, 0.5015627396914424)
('Val: AUC, AUPR, Erros: ', 0.711327870942682, 0.4581688779995665, 4984.941)
('Test: AUC, AUPR, Erros: ', 0.7181083183645256, 0.45760018445530826, 4955.6484)
20((646, 331), (646, 331), 66682.234, 59503.0)
('Error: ', tensor(38646.3359, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.741169477398977, 0.5456876859760652)
('Val: AUC, AUPR, Erros: ', 0.7268043720425117, 0.490065071541988, 4639.332)
('Test: AUC, AUPR, Erros: ', 0.7337635933535144, 0.4948627550944721, 4603.6157)
30((646, 331), (646, 331), 58071.2, 59503.0)
('Error: ', tensor(36577.1250, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7492042513099613, 0.5686907500467271)
('Val: AUC, AUPR, Erros: ', 0.7328232671305609, 0.5103169126219969, 4354.7163)
('Test: AUC, AUPR, Erros: ', 0.7387577994925878, 0.5188719285137823, 4318.4033)
40((646, 331), (646, 331), 49767.016, 59503.0)
('Error: ', tensor(36475.9492, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7539698195862575, 0.5796367507243639)
('Val: AUC, AUPR, Erros: ', 0.7366910417473733, 0.5240459626388936, 4294.998)
('Test: AUC, AUPR, Erros: ', 0.7419773133144464, 0.5310777002786179, 4259.0923)
50((646, 331), (646, 331), 51568.938, 59503.0)
('Error: ', tensor(35684.5430, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7555303461109308, 0.5850831338375997)
('Val: AUC, AUPR, Erros: ', 0.7382521326161773, 0.5296761600429616, 4237.584)
('Test: AUC, AUPR, Erros: ', 0.7427957301325505, 0.5350581944955661, 4202.8096)
60((646, 331), (646, 331), 52964.09, 59503.0)
('Error: ', tensor(35237.3125, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7573054002228508, 0.5896370348798672)
('Val: AUC, AUPR, Erros: ', 0.7388778395622988, 0.5323568941268801, 4217.547)
('Test: AUC, AUPR, Erros: ', 0.7431035376011413, 0.5368529497076477, 4181.051)
70((646, 331), (646, 331), 52980.965, 59503.0)
('Error: ', tensor(35032.0938, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7593594341195589, 0.5938467960633566)
('Val: AUC, AUPR, Erros: ', 0.7392538827585096, 0.5332731195421814, 4213.563)
('Test: AUC, AUPR, Erros: ', 0.7433169766340701, 0.5379286230237583, 4173.6978)
80((646, 331), (646, 331), 52676.734, 59503.0)
('Error: ', tensor(34870.3359, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7616733258266524, 0.5980137355563563)
('Val: AUC, AUPR, Erros: ', 0.7393719160434595, 0.5329903302686432, 4215.444)
('Test: AUC, AUPR, Erros: ', 0.7430512004312625, 0.5381939669190441, 4171.7104)
90((646, 331), (646, 331), 52558.445, 59503.0)
('Error: ', tensor(34699.0273, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7643784612039232, 0.6022381504604148)
('Val: AUC, AUPR, Erros: ', 0.7393091552767633, 0.5320066833321186, 4221.0034)
('Test: AUC, AUPR, Erros: ', 0.7425113966029746, 0.5377124273184608, 4172.8623)
100((646, 331), (646, 331), 50956.457, 59503.0)
('Error: ', tensor(34710.9688, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7680081410651403, 0.606961310925522)
('Val: AUC, AUPR, Erros: ', 0.7389202359911328, 0.5298585144347112, 4233.0522)
('Test: AUC, AUPR, Erros: ', 0.7412060565219103, 0.5361155831234877, 4185.156)
110((646, 331), (646, 331), 52940.195, 59503.0)
('Error: ', tensor(34268.0781, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7721533264479175, 0.6115601665113609)
('Val: AUC, AUPR, Erros: ', 0.7387345052423655, 0.527157430017419, 4249.8125)
('Test: AUC, AUPR, Erros: ', 0.7398252403017497, 0.5346319048791, 4186.6475)
120((646, 331), (646, 331), 53037.95, 59503.0)
('Error: ', tensor(34123.1836, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7759901301766476, 0.6155871468649978)
('Val: AUC, AUPR, Erros: ', 0.7382384762697591, 0.5246079854651378, 4265.806)
('Test: AUC, AUPR, Erros: ', 0.7381080734643848, 0.5326104368801221, 4197.6)
130((646, 331), (646, 331), 52378.21, 59503.0)
('Error: ', tensor(34035.3516, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7793621966699191, 0.6192273158182602)
('Val: AUC, AUPR, Erros: ', 0.737307895919781, 0.5206995428434354, 4287.4067)
('Test: AUC, AUPR, Erros: ', 0.7362306421884633, 0.5304013138745776, 4209.214)
140((646, 331), (646, 331), 53053.16, 59503.0)
('Error: ', tensor(33821.5820, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7823973885247265, 0.6226537170449754)
('Val: AUC, AUPR, Erros: ', 0.7364071539286569, 0.5177677840373062, 4310.599)
('Test: AUC, AUPR, Erros: ', 0.734481567616966, 0.5281594440776312, 4221.5454)
150((646, 331), (646, 331), 53355.35, 59503.0)
('Error: ', tensor(33665.2695, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7849136884288457, 0.6257206570024849)
('Val: AUC, AUPR, Erros: ', 0.7353174825048631, 0.5145820046446432, 4335.7495)
('Test: AUC, AUPR, Erros: ', 0.7326447346804728, 0.5262891900136056, 4232.622)
160((646, 331), (646, 331), 53148.52, 59503.0)
('Error: ', tensor(33552.6953, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7872910097019069, 0.6286782894568276)
('Val: AUC, AUPR, Erros: ', 0.7340756535706261, 0.5116120608739808, 4357.1084)
('Test: AUC, AUPR, Erros: ', 0.731050676687375, 0.5244626390481533, 4242.3135)

Validation:  [0.7392538827585096, 0.5332731195421814, 4213.563, 0.7433169766340701, 0.5379286230237583, 4173.6978]
Train: 0.7594 0.5938
Test: 0.7433 0.5379
0
[0.5735989304812834, 0.5949020167427702, 0.5985087763383579, 0.5916016755888693, 0.5931868599105261, 0.5938259003046809, 0.5955414939742285, 0.5952236738999175, 0.5989874503257616, 0.6013951518354048, 0.6067288461354433, 0.6097025270961941, 0.6144188630358641, 0.6167142578318933, 0.6226861074111248, 0.6288318891157848, 0.6340240112426164, 0.6387835389625596, 0.6432153602474031, 0.6458396344089011, 0.6460300732909632, 0.6499982678644108, 0.652411653468305, 0.6578171979460955, 0.6608252873358081, 0.6649380580945258, 0.6662235532219998, 0.6667646233181683, 0.6685641216023922, 0.6692324652982706, 0.6761043087086976, 0.6785177812459741, 0.6823597589382664, 0.684967557346069, 0.6896255967658718, 0.6920389796426707, 0.693069326717249, 0.6969732603820065, 0.6969732603820065, 0.6990936306668915, 0.7000795303123717, 0.7024430677837917, 0.704041245158595, 0.7097943926506574, 0.7140571671014868, 0.7140571671014868, 0.714900919690311, 0.714900919690311, 0.71736791356047, 0.7182462919958967, 0.7182462919958967, 0.7212951617257637, 0.7212951617257637, 0.7212951617257637, 0.7212951617257637, 0.7212951617257637, 0.7212951617257637, 0.7212951617257637, 0.7249410173356043, 0.7249410173356043, 0.7269094183124162, 0.7292655487958368, 0.7292655487958368, 0.7292655487958368, 0.7292655487958368, 0.7292655487958368, 0.7292655487958368, 0.731582899976693, 0.731582899976693, 0.731582899976693, 0.7381026777396531, 0.7381026777396531, 0.7381026777396531, 0.7407480025370824, 0.7407480025370824, 0.7407480025370824, 0.7407480025370824, 0.7407480025370824, 0.7433169766340701, 0.7433169766340701, 0.7433169766340701, 0.7433169766340701, 0.7433169766340701, 0.7433169766340701, 0.7433169766340701, 0.7433169766340701, 0.7433169766340701, 0.7433169766340701, 0.7433169766340701, 0.7433169766340701]
[0.09904756407582932, 0.13433133888039187, 0.13998853310163906, 0.1401371941567359, 0.1457913413998427, 0.14824731166485342, 0.1568161086494555, 0.15974896493641202, 0.16841860770236972, 0.17298398515982583, 0.18328224061364842, 0.19234089548485478, 0.19832234262479737, 0.20328492554206593, 0.21796209249753098, 0.23177072790987688, 0.24347950105282995, 0.25337589060971094, 0.2625169269439167, 0.27086695110558734, 0.2671335984085189, 0.2758354238641558, 0.2799609177191792, 0.29290660602669827, 0.3012689154405676, 0.3066743506184386, 0.30959727896398687, 0.3110046839252541, 0.31536085043004347, 0.3167235419410394, 0.33645567033235424, 0.3426433924396863, 0.3525742808490757, 0.3582467835592885, 0.37161185255903245, 0.3779010355726822, 0.3804176364887681, 0.38848932609984793, 0.38848932609984793, 0.3962816657000755, 0.39908805334110803, 0.4045478490132535, 0.41125828247079066, 0.43090677019409845, 0.44404882285039204, 0.44404882285039204, 0.44566734559686105, 0.44566734559686105, 0.45237412771631624, 0.45431320162669026, 0.45431320162669026, 0.463122457560869, 0.463122457560869, 0.463122457560869, 0.463122457560869, 0.463122457560869, 0.463122457560869, 0.463122457560869, 0.474969930494875, 0.474969930494875, 0.4817951140942034, 0.4897665752785535, 0.4897665752785535, 0.4897665752785535, 0.4897665752785535, 0.4897665752785535, 0.4897665752785535, 0.4981036301725462, 0.4981036301725462, 0.4981036301725462, 0.5196148280641089, 0.5196148280641089, 0.5196148280641089, 0.5288868979936385, 0.5288868979936385, 0.5288868979936385, 0.5288868979936385, 0.5288868979936385, 0.5379286230237583, 0.5379286230237583, 0.5379286230237583, 0.5379286230237583, 0.5379286230237583, 0.5379286230237583, 0.5379286230237583, 0.5379286230237583, 0.5379286230237583, 0.5379286230237583, 0.5379286230237583, 0.5379286230237583]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  65984.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_2_1
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19592.0)
('VALIDATE SUM PROTEIN TEST: ', 2390.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 24700.404, 59249.0)
('Error: ', tensor(48407.6953, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.50961544710755, 0.283652125887213)
('Val: AUC, AUPR, Erros: ', 0.5096962010692592, 0.26131859049825756, 5680.8833)
('Test: AUC, AUPR, Erros: ', 0.5032686999498417, 0.25490869066087923, 5536.9985)
10((646, 331), (646, 331), 59414.156, 59249.0)
('Error: ', tensor(42733.8477, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.549664610886954, 0.31352895965110794)
('Val: AUC, AUPR, Erros: ', 0.5451377223833435, 0.289567351265807, 5135.7163)
('Test: AUC, AUPR, Erros: ', 0.5507835518274802, 0.287230055000889, 5050.39)
20((646, 331), (646, 331), 61023.832, 59249.0)
('Error: ', tensor(42453.1016, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.630621249627331, 0.423778870803687)
('Val: AUC, AUPR, Erros: ', 0.6252081735810797, 0.3926659481781899, 5111.1855)
('Test: AUC, AUPR, Erros: ', 0.6217213490000064, 0.39007862714911756, 5030.168)
30((646, 331), (646, 331), 66072.336, 59249.0)
('Error: ', tensor(42016.7773, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6788864673519084, 0.4870939728942346)
('Val: AUC, AUPR, Erros: ', 0.6735749576092793, 0.45139586365847595, 5087.4546)
('Test: AUC, AUPR, Erros: ', 0.6648095588656202, 0.4507990117955496, 5016.2188)
40((646, 331), (646, 331), 68039.41, 59249.0)
('Error: ', tensor(40970.5742, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7044820439436783, 0.5190984322901709)
('Val: AUC, AUPR, Erros: ', 0.6975542592656017, 0.4804037889416751, 4979.4126)
('Test: AUC, AUPR, Erros: ', 0.692560216241386, 0.4827703373851886, 4909.5796)
50((646, 331), (646, 331), 72848.18, 59249.0)
('Error: ', tensor(39320.4492, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7194258000983603, 0.5361244611400946)
('Val: AUC, AUPR, Erros: ', 0.7112899138073501, 0.495272853321546, 4829.2227)
('Test: AUC, AUPR, Erros: ', 0.7122014444590881, 0.5022515645646747, 4751.379)
60((646, 331), (646, 331), 72543.55, 59249.0)
('Error: ', tensor(37562.2930, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7254382515429391, 0.5446609422136386)
('Val: AUC, AUPR, Erros: ', 0.7150883971910968, 0.5013237800949645, 4658.6753)
('Test: AUC, AUPR, Erros: ', 0.7212428037007996, 0.5136084869882651, 4542.416)
70((646, 331), (646, 331), 70627.2, 59249.0)
('Error: ', tensor(36725.8281, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7303270087378547, 0.5517493763914318)
('Val: AUC, AUPR, Erros: ', 0.7185373355995168, 0.5070564588915587, 4579.202)
('Test: AUC, AUPR, Erros: ', 0.7260091237558599, 0.521147116233977, 4435.1006)
80((646, 331), (646, 331), 68929.445, 59249.0)
('Error: ', tensor(36322.9844, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7345268746304989, 0.5576245216260967)
('Val: AUC, AUPR, Erros: ', 0.7212452080133749, 0.5107344332278356, 4541.1177)
('Test: AUC, AUPR, Erros: ', 0.728053064280012, 0.5246734486401721, 4391.493)
90((646, 331), (646, 331), 68158.72, 59249.0)
('Error: ', tensor(36078.7461, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7379812238291723, 0.5624208451251743)
('Val: AUC, AUPR, Erros: ', 0.7240887872342398, 0.5142680919857842, 4518.397)
('Test: AUC, AUPR, Erros: ', 0.7301993515953408, 0.527617694232752, 4369.653)
100((646, 331), (646, 331), 67701.64, 59249.0)
('Error: ', tensor(35859.4727, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7413677488990054, 0.5672877786601307)
('Val: AUC, AUPR, Erros: ', 0.7255560097392555, 0.5155403649129691, 4504.93)
('Test: AUC, AUPR, Erros: ', 0.7320760471751517, 0.5300534639573563, 4354.2896)
110((646, 331), (646, 331), 67718.76, 59249.0)
('Error: ', tensor(35681.6680, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7446019011434278, 0.5719204834704242)
('Val: AUC, AUPR, Erros: ', 0.7275474897933579, 0.5179857654467175, 4496.842)
('Test: AUC, AUPR, Erros: ', 0.7339199312841344, 0.5327279436948378, 4345.81)
120((646, 331), (646, 331), 68057.31, 59249.0)
('Error: ', tensor(35517.1250, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7480112710845378, 0.5768561149463579)
('Val: AUC, AUPR, Erros: ', 0.7289860189853143, 0.5196110773348884, 4496.976)
('Test: AUC, AUPR, Erros: ', 0.7351396467735891, 0.5347160878002185, 4348.5703)
130((646, 331), (646, 331), 68285.36, 59249.0)
('Error: ', tensor(35339.9570, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7515538925020113, 0.5817230342032154)
('Val: AUC, AUPR, Erros: ', 0.730210176230538, 0.5206130987532838, 4497.6836)
('Test: AUC, AUPR, Erros: ', 0.73731289548121, 0.537289220309362, 4341.3926)
140((646, 331), (646, 331), 68596.37, 59249.0)
('Error: ', tensor(35187.6016, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7547739388842163, 0.5862522707307566)
('Val: AUC, AUPR, Erros: ', 0.7308483464503386, 0.5207768204225545, 4506.3867)
('Test: AUC, AUPR, Erros: ', 0.7387667102575174, 0.5398109319921233, 4343.784)
150((646, 331), (646, 331), 69240.07, 59249.0)
('Error: ', tensor(35113.9727, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.757151626039736, 0.5893530674968103)
('Val: AUC, AUPR, Erros: ', 0.7323449776041103, 0.5219572893308966, 4510.44)
('Test: AUC, AUPR, Erros: ', 0.73924872048946, 0.54040812083587, 4359.338)
160((646, 331), (646, 331), 68078.88, 59249.0)
('Error: ', tensor(34850.1094, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7599723336161974, 0.593308011709666)
('Val: AUC, AUPR, Erros: ', 0.7330657454943945, 0.5222261241771561, 4485.019)
('Test: AUC, AUPR, Erros: ', 0.7405823424069456, 0.5416088167876609, 4331.6406)

Validation:  [0.7330657454943945, 0.5222261241771561, 4485.019, 0.7405823424069456, 0.5416088167876609, 4331.6406]
Train: 0.7600 0.5933
Test: 0.7406 0.5416
1
[0.5392487539726804, 0.5558494923526079, 0.5520448082483398, 0.5553482527777331, 0.5570116168753793, 0.5591190314835988, 0.5638249165655078, 0.5735409470230977, 0.5778760818716635, 0.5796706557023695, 0.5856810005035111, 0.5893411320732881, 0.5951896828926214, 0.5976788253134593, 0.6078709498840924, 0.6159183568133342, 0.623257166007063, 0.6279903927868823, 0.6353845580408045, 0.6391772414476204, 0.6395272255988337, 0.6436554115211067, 0.6481444183849636, 0.6500682234789554, 0.6523381569060013, 0.6565644136115549, 0.6589748466938897, 0.6600884184474773, 0.6614170110275859, 0.6624832703907214, 0.6686769048187559, 0.6730696580178258, 0.6766671144648357, 0.6799675234225837, 0.6848364553507635, 0.6869245226153513, 0.6879072712313303, 0.6917109636649981, 0.6917109636649981, 0.694724192230048, 0.6960246094343465, 0.6982155585632946, 0.69941191773493, 0.7043238134116913, 0.7085564700247693, 0.7085564700247693, 0.709694450852929, 0.709694450852929, 0.7127670587974467, 0.7141091922247881, 0.7141091922247881, 0.7173296150173525, 0.7173296150173525, 0.7173296150173525, 0.7173296150173525, 0.7173296150173525, 0.7173296150173525, 0.7173296150173525, 0.7212063044592683, 0.7212063044592683, 0.723737335625229, 0.7256847143100169, 0.7256847143100169, 0.7256847143100169, 0.7256847143100169, 0.7256847143100169, 0.7256847143100169, 0.7279914394920988, 0.7279914394920988, 0.7279914394920988, 0.7356936326735793, 0.7356936326735793, 0.7356936326735793, 0.7378426049904577, 0.7378426049904577, 0.7378426049904577, 0.7378426049904577, 0.7378426049904577, 0.7405823424069456, 0.7405823424069456, 0.7405823424069456, 0.7405823424069456, 0.7405823424069456, 0.7405823424069456, 0.7405823424069456, 0.7405823424069456, 0.7405823424069456, 0.7405823424069456, 0.7405823424069456, 0.7405823424069456]
[0.12059063606266038, 0.12654221842036134, 0.1316070448580199, 0.1369165739755445, 0.13872162273678404, 0.14015740507661828, 0.1466421931350284, 0.15645198281603473, 0.16172896886445942, 0.16365659547552036, 0.17321674064454076, 0.1793898965228513, 0.18817820172330801, 0.193432459265842, 0.21136917192042953, 0.22595781345983174, 0.2385304903758942, 0.24668055440275194, 0.2589358097256041, 0.26688959309570015, 0.26713417970930964, 0.2759643344578287, 0.2848619844475616, 0.28706292876690265, 0.29324160879620337, 0.30307852266769686, 0.30780448821119677, 0.30956601863835187, 0.31148651664714955, 0.3139359000375119, 0.3294550401254131, 0.3409588730472022, 0.3489238193499598, 0.3569351664065316, 0.3687647627813459, 0.37409946819111417, 0.37688024685429417, 0.38677337214148744, 0.38677337214148744, 0.3957879245403724, 0.398753324600796, 0.4042190941829612, 0.40802234027212586, 0.422867163604701, 0.4356036742349106, 0.4356036742349106, 0.4387302610433978, 0.4387302610433978, 0.4477247698026093, 0.4516467562943726, 0.4516467562943726, 0.4610206508519903, 0.4610206508519903, 0.4610206508519903, 0.4610206508519903, 0.4610206508519903, 0.4610206508519903, 0.4610206508519903, 0.47404307794841966, 0.47404307794841966, 0.4833523861014331, 0.48937037950636325, 0.48937037950636325, 0.48937037950636325, 0.48937037950636325, 0.48937037950636325, 0.48937037950636325, 0.4987323545562696, 0.4987323545562696, 0.4987323545562696, 0.5251541893444389, 0.5251541893444389, 0.5251541893444389, 0.5319914280427022, 0.5319914280427022, 0.5319914280427022, 0.5319914280427022, 0.5319914280427022, 0.5416088167876609, 0.5416088167876609, 0.5416088167876609, 0.5416088167876609, 0.5416088167876609, 0.5416088167876609, 0.5416088167876609, 0.5416088167876609, 0.5416088167876609, 0.5416088167876609, 0.5416088167876609, 0.5416088167876609]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  65127.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_2_2
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19268.0)
('VALIDATE SUM PROTEIN TEST: ', 2661.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 36719.21, 58203.0)
('Error: ', tensor(44509.5312, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5170373157729451, 0.2802526571845095)
('Val: AUC, AUPR, Erros: ', 0.5134264629816637, 0.2933947365467169, 5898.298)
('Test: AUC, AUPR, Erros: ', 0.5155078642336131, 0.2657417491151731, 5335.4014)
10((646, 331), (646, 331), 55249.676, 58203.0)
('Error: ', tensor(42273.2188, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6066343608343691, 0.34634523105006015)
('Val: AUC, AUPR, Erros: ', 0.5992847182963095, 0.35556553131867735, 5534.756)
('Test: AUC, AUPR, Erros: ', 0.6008652744156999, 0.3261320794180876, 5121.4194)
20((646, 331), (646, 331), 55069.21, 58203.0)
('Error: ', tensor(42015.7891, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6454788870020234, 0.39775891831903104)
('Val: AUC, AUPR, Erros: ', 0.6369570857991593, 0.404511143634648, 5503.9756)
('Test: AUC, AUPR, Erros: ', 0.6343468086020505, 0.3696043092699982, 5092.609)
30((646, 331), (646, 331), 43603.387, 58203.0)
('Error: ', tensor(42547.9727, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6629672952720842, 0.43371727576499053)
('Val: AUC, AUPR, Erros: ', 0.6541688010387889, 0.43983078993031155, 5623.197)
('Test: AUC, AUPR, Erros: ', 0.6479006044753667, 0.39982099344237365, 5127.2393)
40((646, 331), (646, 331), 59821.344, 58203.0)
('Error: ', tensor(40200.5938, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6952219532433259, 0.48212816383954155)
('Val: AUC, AUPR, Erros: ', 0.6849204575085315, 0.48807507436930553, 5259.5645)
('Test: AUC, AUPR, Erros: ', 0.6771421660632138, 0.43691183203606554, 4916.6807)
50((646, 331), (646, 331), 23072.834, 58203.0)
('Error: ', tensor(46038.3750, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7093576925012894, 0.508612438799845)
('Val: AUC, AUPR, Erros: ', 0.699170156118867, 0.5122178688328654, 6156.504)
('Test: AUC, AUPR, Erros: ', 0.689967419763373, 0.45966147404676083, 5518.8423)
60((646, 331), (646, 331), 73432.51, 58203.0)
('Error: ', tensor(37632.2773, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7235271773172351, 0.5370973871537243)
('Val: AUC, AUPR, Erros: ', 0.7108588546834815, 0.5394388852430063, 4905.022)
('Test: AUC, AUPR, Erros: ', 0.7035000714754713, 0.48569545731542985, 4751.862)
70((646, 331), (646, 331), 68249.03, 58203.0)
('Error: ', tensor(36351.0625, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7293090015930135, 0.5481001923869043)
('Val: AUC, AUPR, Erros: ', 0.7156043836114527, 0.5484049403310942, 4777.2314)
('Test: AUC, AUPR, Erros: ', 0.708418229519024, 0.49527272466633376, 4607.815)
80((646, 331), (646, 331), 68016.95, 58203.0)
('Error: ', tensor(35955.4844, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7339653055563369, 0.5557369116144828)
('Val: AUC, AUPR, Erros: ', 0.7184729662368612, 0.5542767583631154, 4743.515)
('Test: AUC, AUPR, Erros: ', 0.7123046374639475, 0.5021059992068833, 4585.3125)
90((646, 331), (646, 331), 64909.31, 58203.0)
('Error: ', tensor(35475.2734, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7377334523848991, 0.5614853859475903)
('Val: AUC, AUPR, Erros: ', 0.7205779327049606, 0.5582591674077875, 4706.2876)
('Test: AUC, AUPR, Erros: ', 0.7149190986555263, 0.5066632062962851, 4527.6567)
100((646, 331), (646, 331), 65279.918, 58203.0)
('Error: ', tensor(35307.0156, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7408822745254701, 0.5660826683811999)
('Val: AUC, AUPR, Erros: ', 0.7219695557099994, 0.5609065064384857, 4699.2173)
('Test: AUC, AUPR, Erros: ', 0.716849168774111, 0.5095320672487375, 4524.774)
110((646, 331), (646, 331), 64920.703, 58203.0)
('Error: ', tensor(35127.1016, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7435412673468388, 0.5698138746939935)
('Val: AUC, AUPR, Erros: ', 0.7230793943207389, 0.5629209234054535, 4689.647)
('Test: AUC, AUPR, Erros: ', 0.7184933551632, 0.5116966106752965, 4511.13)
120((646, 331), (646, 331), 65007.695, 58203.0)
('Error: ', tensor(34991.3477, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7459373062391939, 0.5732441816898173)
('Val: AUC, AUPR, Erros: ', 0.7239436065174321, 0.5642861947722351, 4684.9956)
('Test: AUC, AUPR, Erros: ', 0.719619602196663, 0.5130974568733391, 4507.7114)
130((646, 331), (646, 331), 64857.03, 58203.0)
('Error: ', tensor(34856.2656, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7480628640368874, 0.5762876090343523)
('Val: AUC, AUPR, Erros: ', 0.724602415858239, 0.5653757410228865, 4679.8535)
('Test: AUC, AUPR, Erros: ', 0.7208912439337717, 0.5146142919878227, 4498.8794)
140((646, 331), (646, 331), 65174.934, 58203.0)
('Error: ', tensor(34754.4727, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7501402907114318, 0.5792998584751288)
('Val: AUC, AUPR, Erros: ', 0.7253776580826019, 0.5665555052858828, 4677.1177)
('Test: AUC, AUPR, Erros: ', 0.7218330360296507, 0.5156279911984404, 4499.729)
150((646, 331), (646, 331), 65257.473, 58203.0)
('Error: ', tensor(34644.4609, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7521174705852636, 0.5821483642053431)
('Val: AUC, AUPR, Erros: ', 0.7260040947528179, 0.5675011531950753, 4673.6797)
('Test: AUC, AUPR, Erros: ', 0.7227861209885535, 0.5164122262663803, 4496.9175)
160((646, 331), (646, 331), 67536.695, 58203.0)
('Error: ', tensor(34710.3984, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.754048230140723, 0.5849569040014252)
('Val: AUC, AUPR, Erros: ', 0.726510353750526, 0.5683482835505649, 4691.621)
('Test: AUC, AUPR, Erros: ', 0.7236644079778652, 0.5172385818753695, 4532.8643)

Validation:  [0.7260040947528179, 0.5675011531950753, 4673.6797, 0.7227861209885535, 0.5164122262663803, 4496.9175]
Train: 0.7521 0.5821
Test: 0.7228 0.5164
2
[0.5593483369145901, 0.5821041958450046, 0.5819233652176293, 0.5784781272771689, 0.5812750017333903, 0.5836854878661163, 0.583948044152466, 0.593949157635206, 0.5956752667502792, 0.5984710168119807, 0.6019471774172356, 0.6032223425372252, 0.6040452338651541, 0.6073052090498914, 0.6130740309233209, 0.6193002988202443, 0.6220005355844564, 0.6274633257105777, 0.6307627931467444, 0.6353059480386842, 0.6359996726883611, 0.6387349178039179, 0.6418454355353781, 0.6460978473734513, 0.6470860602201369, 0.6508138866197429, 0.6528947548993419, 0.6534335457518001, 0.6546319830161905, 0.6555786101035499, 0.6613878410696666, 0.6639263934102417, 0.6676555280199247, 0.6706598912937707, 0.6741324316043384, 0.6757203149021029, 0.6765147543573, 0.6805856941615233, 0.6805856941615233, 0.6826047438413118, 0.6837602644637873, 0.6859743775177491, 0.6871677161167783, 0.691336080159902, 0.6938399117616754, 0.6938399117616754, 0.6951757797334355, 0.6951757797334355, 0.6977415401119109, 0.6990006651967958, 0.6990006651967958, 0.701982630876586, 0.701982630876586, 0.701982630876586, 0.701982630876586, 0.701982630876586, 0.701982630876586, 0.701982630876586, 0.7048283131672823, 0.7048283131672823, 0.706105130434519, 0.7080350678604836, 0.7080350678604836, 0.7080350678604836, 0.7080350678604836, 0.7080350678604836, 0.7080350678604836, 0.710401203361571, 0.710401203361571, 0.710401203361571, 0.7173987706061304, 0.7173987706061304, 0.7173987706061304, 0.7199298326540137, 0.7199298326540137, 0.7199298326540137, 0.7199298326540137, 0.7199298326540137, 0.7227861209885535, 0.7227861209885535, 0.7227861209885535, 0.7227861209885535, 0.7227861209885535, 0.7227861209885535, 0.7227861209885535, 0.7227861209885535, 0.7227861209885535, 0.7227861209885535, 0.7227861209885535, 0.7227861209885535]
[0.12576215493027165, 0.14584520704299989, 0.15136705059398142, 0.151396430536201, 0.16070500292592194, 0.1665665122619187, 0.1728046521875141, 0.18789923297373853, 0.19252903213010097, 0.1974422762246295, 0.2062408342573147, 0.20886678935388395, 0.21177634565655457, 0.21736902962194113, 0.23088588652718414, 0.2434510108248806, 0.24724192403333198, 0.2588186742455813, 0.2651732326468883, 0.27405559943943403, 0.2755963909841739, 0.27928429816128286, 0.28655301248845366, 0.29602156809132796, 0.29927712413557395, 0.30643731321145906, 0.31066779948723466, 0.3113126237688597, 0.3126614784481196, 0.31515067575212874, 0.3302070612890027, 0.3359038108554734, 0.3462960295966576, 0.35366172931189976, 0.36279934875412206, 0.3675279398610153, 0.3688413016014872, 0.37854612400518545, 0.37854612400518545, 0.3850506042884582, 0.3875396768830471, 0.3951507599859998, 0.39864920796583825, 0.4107996880523666, 0.4166288718126828, 0.4166288718126828, 0.4205644693122722, 0.4205644693122722, 0.4283621165539231, 0.4317935449829491, 0.4317935449829491, 0.44220487003449743, 0.44220487003449743, 0.44220487003449743, 0.44220487003449743, 0.44220487003449743, 0.44220487003449743, 0.44220487003449743, 0.4516249903355658, 0.4516249903355658, 0.45559305755516627, 0.46272429632901585, 0.46272429632901585, 0.46272429632901585, 0.46272429632901585, 0.46272429632901585, 0.46272429632901585, 0.47097113549842057, 0.47097113549842057, 0.47097113549842057, 0.49725847689990044, 0.49725847689990044, 0.49725847689990044, 0.5057053184003545, 0.5057053184003545, 0.5057053184003545, 0.5057053184003545, 0.5057053184003545, 0.5164122262663803, 0.5164122262663803, 0.5164122262663803, 0.5164122262663803, 0.5164122262663803, 0.5164122262663803, 0.5164122262663803, 0.5164122262663803, 0.5164122262663803, 0.5164122262663803, 0.5164122262663803, 0.5164122262663803]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
647 81 331
Num Drug-SE:  65271.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_2_3
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((647, 3826), (81, 3826), (647, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19318.0)
('VALIDATE SUM PROTEIN TEST: ', 2714.0)
(647, 3826) (647, 331)
0((647, 331), (647, 331), 42828.47, 57490.0)
('Error: ', tensor(43035.7383, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.525163107492254, 0.2820775612600737)
('Val: AUC, AUPR, Erros: ', 0.525665195067453, 0.30182137370905326, 5638.426)
('Test: AUC, AUPR, Erros: ', 0.524335276323891, 0.3043341667757069, 5738.1006)
10((647, 331), (647, 331), 57917.434, 57490.0)
('Error: ', tensor(41674.1562, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6508584904366489, 0.38059394155874743)
('Val: AUC, AUPR, Erros: ', 0.6307660779192705, 0.38453584713412525, 5400.45)
('Test: AUC, AUPR, Erros: ', 0.6382909634156744, 0.39488312094004135, 5487.155)
20((647, 331), (647, 331), 49893.22, 57490.0)
('Error: ', tensor(41414.6484, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6794295913107107, 0.4269926774802478)
('Val: AUC, AUPR, Erros: ', 0.6552592172374149, 0.4227515273171937, 5414.525)
('Test: AUC, AUPR, Erros: ', 0.6649412756986564, 0.4365673419739698, 5500.184)
30((647, 331), (647, 331), 56098.492, 57490.0)
('Error: ', tensor(40015.5625, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7048422342690478, 0.4785125090384054)
('Val: AUC, AUPR, Erros: ', 0.6767037892646077, 0.4634032001864296, 5229.203)
('Test: AUC, AUPR, Erros: ', 0.689704862681054, 0.48338393201260393, 5295.79)
40((647, 331), (647, 331), 57659.574, 57490.0)
('Error: ', tensor(38422.0977, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7178517719900086, 0.5116154728481156)
('Val: AUC, AUPR, Erros: ', 0.6871019303418764, 0.48946692379474743, 5055.7334)
('Test: AUC, AUPR, Erros: ', 0.7020922497186005, 0.512213245257924, 5096.524)
50((647, 331), (647, 331), 59771.168, 57490.0)
('Error: ', tensor(36864.9102, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7268757813351936, 0.5356672902102723)
('Val: AUC, AUPR, Erros: ', 0.693801730627471, 0.5076176458784433, 4895.4194)
('Test: AUC, AUPR, Erros: ', 0.7103977762774609, 0.5344221428235854, 4902.4424)
60((647, 331), (647, 331), 45307.477, 57490.0)
('Error: ', tensor(36802.0742, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7329750901271292, 0.5497315060610014)
('Val: AUC, AUPR, Erros: ', 0.6971832907678008, 0.5180268841309194, 4977.87)
('Test: AUC, AUPR, Erros: ', 0.7149045301681076, 0.5460203747093169, 4977.102)
70((647, 331), (647, 331), 49814.55, 57490.0)
('Error: ', tensor(35654.9336, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7379091880771411, 0.5576254962031629)
('Val: AUC, AUPR, Erros: ', 0.6996250090103477, 0.5224847165801786, 4851.8467)
('Test: AUC, AUPR, Erros: ', 0.7176614714839218, 0.5512814315158422, 4827.8755)
80((647, 331), (647, 331), 50137.83, 57490.0)
('Error: ', tensor(35286.6367, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7421523586955325, 0.5634266583161646)
('Val: AUC, AUPR, Erros: ', 0.7014659100038441, 0.5254994693299817, 4826.9434)
('Test: AUC, AUPR, Erros: ', 0.7196897828988151, 0.5552592513789106, 4793.063)
90((647, 331), (647, 331), 50640.062, 57490.0)
('Error: ', tensor(35010.5117, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7457282967835375, 0.5680053922688623)
('Val: AUC, AUPR, Erros: ', 0.7027149059403085, 0.5267758758730927, 4811.458)
('Test: AUC, AUPR, Erros: ', 0.7212587650516711, 0.5578899379238245, 4768.4844)
100((647, 331), (647, 331), 50754.754, 57490.0)
('Error: ', tensor(34821.2461, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7490042192998387, 0.5722214190080362)
('Val: AUC, AUPR, Erros: ', 0.7035874008525587, 0.5275853600926605, 4805.0835)
('Test: AUC, AUPR, Erros: ', 0.7221290823686759, 0.5594631669365551, 4757.085)
110((647, 331), (647, 331), 51224.754, 57490.0)
('Error: ', tensor(34620.9844, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7520209421922049, 0.5761821046798182)
('Val: AUC, AUPR, Erros: ', 0.7048225160065227, 0.5285788180294808, 4794.2847)
('Test: AUC, AUPR, Erros: ', 0.7231419211530465, 0.5611426746583423, 4741.3174)
120((647, 331), (647, 331), 51096.938, 57490.0)
('Error: ', tensor(34499.7578, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7546035259173027, 0.5797108777581647)
('Val: AUC, AUPR, Erros: ', 0.7058859125039834, 0.5291894301960802, 4792.911)
('Test: AUC, AUPR, Erros: ', 0.7237474356299819, 0.5621517305584629, 4736.6455)
130((647, 331), (647, 331), 51267.37, 57490.0)
('Error: ', tensor(34353.7773, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7571239164793152, 0.5831890921376564)
('Val: AUC, AUPR, Erros: ', 0.7065889020409448, 0.5291233187770653, 4790.284)
('Test: AUC, AUPR, Erros: ', 0.7244796178464823, 0.5635309619008355, 4727.959)
140((647, 331), (647, 331), 50768.9, 57490.0)
('Error: ', tensor(34281.2656, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.759512545609181, 0.5865111252793178)
('Val: AUC, AUPR, Erros: ', 0.7075531734210206, 0.5293556908483026, 4794.7617)
('Test: AUC, AUPR, Erros: ', 0.7246917201264274, 0.5639984866922132, 4730.891)
150((647, 331), (647, 331), 50503.07, 57490.0)
('Error: ', tensor(34198.9531, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7618882937843765, 0.5896431092806371)
('Val: AUC, AUPR, Erros: ', 0.7085352691851333, 0.5296138892430222, 4797.0)
('Test: AUC, AUPR, Erros: ', 0.7253995899169076, 0.5654382175934627, 4728.535)
160((647, 331), (647, 331), 50681.715, 57490.0)
('Error: ', tensor(34069.4531, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7641190879188475, 0.5925328120535421)
('Val: AUC, AUPR, Erros: ', 0.7095559809734533, 0.5297493014718543, 4792.548)
('Test: AUC, AUPR, Erros: ', 0.7260282045752879, 0.5667493832068522, 4719.0347)

Validation:  [0.7065889020409448, 0.5291233187770653, 4790.284, 0.7244796178464823, 0.5635309619008355, 4727.959]
Train: 0.7571 0.5832
Test: 0.7245 0.5635
3
[0.5404000299647913, 0.5394061929397445, 0.5523390543014136, 0.5563706714528127, 0.5670590488555743, 0.5708998925589217, 0.5705019435720351, 0.578106698762627, 0.5880356007363946, 0.5887578403725472, 0.5914215250171063, 0.595724693010836, 0.6014210344993617, 0.6013785408392565, 0.6077241836995309, 0.6098676331673215, 0.6150258510471085, 0.6198165621096172, 0.6239236312989609, 0.6252399333377199, 0.6262428337372435, 0.6300262976721688, 0.6322526622552158, 0.6360687264530714, 0.6380659742622671, 0.644364568334146, 0.6446574619829715, 0.6457203306431987, 0.6485646202247031, 0.6496258018247592, 0.6563825194226558, 0.6601741468185405, 0.6636980607519687, 0.6663250847971643, 0.6706491070730565, 0.6720948371045086, 0.6732146529218546, 0.6767671264389366, 0.6767671264389366, 0.679836444334168, 0.6807679709890624, 0.6825525832277342, 0.6841787866486735, 0.6903362169893839, 0.6944609994967201, 0.6944609994967201, 0.6949578747131497, 0.6949578747131497, 0.6977938033898291, 0.6991087908258738, 0.6991087908258738, 0.7027071276379007, 0.7027071276379007, 0.7027071276379007, 0.7027071276379007, 0.7027071276379007, 0.7027071276379007, 0.7027071276379007, 0.7063928438778132, 0.7063928438778132, 0.7076820516784782, 0.7097189440883909, 0.7097189440883909, 0.7097189440883909, 0.7097189440883909, 0.7097189440883909, 0.7097189440883909, 0.7120694934939149, 0.7120694934939149, 0.7120694934939149, 0.7194793583322244, 0.7194793583322244, 0.7194793583322244, 0.7217796429452432, 0.7217796429452432, 0.7217796429452432, 0.7217796429452432, 0.7217796429452432, 0.7244796178464823, 0.7244796178464823, 0.7244796178464823, 0.7244796178464823, 0.7244796178464823, 0.7244796178464823, 0.7244796178464823, 0.7244796178464823, 0.7244796178464823, 0.7244796178464823, 0.7244796178464823, 0.7244796178464823]
[0.15015618543426254, 0.14275412336134477, 0.15521014833193614, 0.17057799139542115, 0.19229820043025675, 0.19404048190530349, 0.19241414084541097, 0.2045511645463974, 0.22034036114172453, 0.22390949093612642, 0.22908211235375622, 0.23923365733522384, 0.2491528266005473, 0.24967733011717289, 0.2625666757353041, 0.2596700797010199, 0.2705263600454604, 0.2817939648132153, 0.29096869814759724, 0.29159920883769824, 0.29518843567702585, 0.3052223868160921, 0.30938724025976194, 0.3167791995363358, 0.3226952501183412, 0.33808422073912364, 0.33857534093808517, 0.3401730126370386, 0.3473110600874211, 0.35040468525888957, 0.36883528466592913, 0.3787486972582458, 0.3874279352847366, 0.39431518598205556, 0.40381040341146834, 0.40665883884253173, 0.40995813498811035, 0.4184847243889898, 0.4184847243889898, 0.427781638267571, 0.4293647496963826, 0.43262598771831845, 0.4374625222335066, 0.4564169768840539, 0.467121105817057, 0.467121105817057, 0.4677985112231905, 0.4677985112231905, 0.47602208444260213, 0.48037783749237023, 0.48037783749237023, 0.4921045807121537, 0.4921045807121537, 0.4921045807121537, 0.4921045807121537, 0.4921045807121537, 0.4921045807121537, 0.4921045807121537, 0.5040385572752177, 0.5040385572752177, 0.506739696497925, 0.5137234312178224, 0.5137234312178224, 0.5137234312178224, 0.5137234312178224, 0.5137234312178224, 0.5137234312178224, 0.5215793547132558, 0.5215793547132558, 0.5215793547132558, 0.5473566832632767, 0.5473566832632767, 0.5473566832632767, 0.5541847852166735, 0.5541847852166735, 0.5541847852166735, 0.5541847852166735, 0.5541847852166735, 0.5635309619008355, 0.5635309619008355, 0.5635309619008355, 0.5635309619008355, 0.5635309619008355, 0.5635309619008355, 0.5635309619008355, 0.5635309619008355, 0.5635309619008355, 0.5635309619008355, 0.5635309619008355, 0.5635309619008355]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
647 80 331
Num Drug-SE:  65411.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_2_4
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((647, 3826), (80, 3826), (647, 331), (80, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19235.0)
('VALIDATE SUM PROTEIN TEST: ', 2611.0)
(647, 3826) (647, 331)
0((647, 331), (647, 331), 49241.05, 57774.0)
('Error: ', tensor(42509.7930, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5260743767647734, 0.2922114047059333)
('Val: AUC, AUPR, Erros: ', 0.5345976608171141, 0.3081569523237053, 5463.6265)
('Test: AUC, AUPR, Erros: ', 0.5224996470042307, 0.3114536951294918, 5522.592)
10((647, 331), (647, 331), 63702.34, 57774.0)
('Error: ', tensor(41859.0820, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6702284048946625, 0.42449302490531565)
('Val: AUC, AUPR, Erros: ', 0.6576574884553249, 0.4223717684186369, 5351.196)
('Test: AUC, AUPR, Erros: ', 0.6444480646822366, 0.41778582754161336, 5383.6846)
20((647, 331), (647, 331), 71527.26, 57774.0)
('Error: ', tensor(41373.1992, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7066336579866966, 0.48801148576770204)
('Val: AUC, AUPR, Erros: ', 0.689199686640042, 0.4761328737217474, 5285.1006)
('Test: AUC, AUPR, Erros: ', 0.676243996596314, 0.4699605896715289, 5310.406)
30((647, 331), (647, 331), 56596.43, 57774.0)
('Error: ', tensor(38707.3828, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.724700321640725, 0.5305338338953974)
('Val: AUC, AUPR, Erros: ', 0.7038091547412517, 0.5110879918923446, 5004.192)
('Test: AUC, AUPR, Erros: ', 0.6897298769149495, 0.5013050183545898, 5075.124)
40((647, 331), (647, 331), 32088.736, 57774.0)
('Error: ', tensor(40995.5078, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7366276606949423, 0.551755200353797)
('Val: AUC, AUPR, Erros: ', 0.7097722869479848, 0.5254161778977333, 5358.323)
('Test: AUC, AUPR, Erros: ', 0.6961105894554378, 0.5138702755318039, 5475.8706)
50((647, 331), (647, 331), 46415.96, 57774.0)
('Error: ', tensor(36251.5234, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.744222444576539, 0.5634748479954939)
('Val: AUC, AUPR, Erros: ', 0.7174199941272288, 0.5354740822410009, 4774.5537)
('Test: AUC, AUPR, Erros: ', 0.7017240334911907, 0.5218236207235224, 4903.464)
60((647, 331), (647, 331), 51670.92, 57774.0)
('Error: ', tensor(35105.7266, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.748518456063716, 0.5702480110661675)
('Val: AUC, AUPR, Erros: ', 0.7212474441297004, 0.5404771427960733, 4650.2705)
('Test: AUC, AUPR, Erros: ', 0.7041768980542034, 0.525346212444127, 4792.3647)
70((647, 331), (647, 331), 51325.473, 57774.0)
('Error: ', tensor(34877.6016, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7519476281553049, 0.575265166931)
('Val: AUC, AUPR, Erros: ', 0.723498656996194, 0.5432232089856708, 4637.149)
('Test: AUC, AUPR, Erros: ', 0.7054091640863526, 0.5266579498560592, 4788.8027)
80((647, 331), (647, 331), 52128.246, 57774.0)
('Error: ', tensor(34617.7812, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7546761968635878, 0.5793465879611572)
('Val: AUC, AUPR, Erros: ', 0.7250698180621875, 0.5449155973611173, 4618.0947)
('Test: AUC, AUPR, Erros: ', 0.7062155489488822, 0.5269440466432327, 4778.2734)
90((647, 331), (647, 331), 52233.406, 57774.0)
('Error: ', tensor(34461.5938, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7570626100669646, 0.5829000249990037)
('Val: AUC, AUPR, Erros: ', 0.7264148315775865, 0.5461303322940803, 4609.828)
('Test: AUC, AUPR, Erros: ', 0.7068457607961687, 0.5267271324485832, 4777.6226)
100((647, 331), (647, 331), 51960.23, 57774.0)
('Error: ', tensor(34352.9375, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7592573595581218, 0.5861805242551581)
('Val: AUC, AUPR, Erros: ', 0.7274543002109891, 0.5470969224340779, 4606.723)
('Test: AUC, AUPR, Erros: ', 0.7073387040391397, 0.5262206407370759, 4781.208)
110((647, 331), (647, 331), 51780.594, 57774.0)
('Error: ', tensor(34253.0195, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7612857899699598, 0.5892163324431824)
('Val: AUC, AUPR, Erros: ', 0.7283514282451788, 0.5478526984596481, 4603.816)
('Test: AUC, AUPR, Erros: ', 0.707885339330165, 0.5257342519301511, 4784.0537)
120((647, 331), (647, 331), 51864.383, 57774.0)
('Error: ', tensor(34143.9219, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7630397587565364, 0.5918191118736807)
('Val: AUC, AUPR, Erros: ', 0.7290572747686628, 0.5486055001180242, 4599.0225)
('Test: AUC, AUPR, Erros: ', 0.7082436268219969, 0.5250759353055908, 4785.208)
130((647, 331), (647, 331), 51869.4, 57774.0)
('Error: ', tensor(34049.4258, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7646505463691133, 0.5942239032490291)
('Val: AUC, AUPR, Erros: ', 0.7294520721546705, 0.5488716616969582, 4596.861)
('Test: AUC, AUPR, Erros: ', 0.7087670765156193, 0.524730098361218, 4786.3228)
140((647, 331), (647, 331), 51797.06, 57774.0)
('Error: ', tensor(33971.6992, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7661103561278542, 0.5964170395274292)
('Val: AUC, AUPR, Erros: ', 0.7299790027501802, 0.5492825106244251, 4595.094)
('Test: AUC, AUPR, Erros: ', 0.7089804687904729, 0.5239709449687249, 4789.831)
150((647, 331), (647, 331), 51868.473, 57774.0)
('Error: ', tensor(33886.4727, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7675021068108298, 0.5984339867287004)
('Val: AUC, AUPR, Erros: ', 0.7301432774967015, 0.5495779345966803, 4593.0947)
('Test: AUC, AUPR, Erros: ', 0.7093869377118248, 0.5236234719575246, 4790.5244)
160((647, 331), (647, 331), 51638.445, 57774.0)
('Error: ', tensor(33839.2578, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7687374446982198, 0.6002123748755362)
('Val: AUC, AUPR, Erros: ', 0.7299400931198476, 0.5491424568962278, 4596.763)
('Test: AUC, AUPR, Erros: ', 0.7094308176623121, 0.522784266784764, 4796.3916)

Validation:  [0.7301432774967015, 0.5495779345966803, 4593.0947, 0.7093869377118248, 0.5236234719575246, 4790.5244]
Train: 0.7675 0.5984
Test: 0.7094 0.5236
4
[0.5623672762695844, 0.5560091413340608, 0.5620055061070687, 0.5661485973465473, 0.5699113702173132, 0.5728217541192395, 0.5765379725047193, 0.5766115826047333, 0.5801693521466256, 0.5796085743597408, 0.5839458321600435, 0.5879987090609723, 0.5921426038915512, 0.5935904802708032, 0.6007190451731294, 0.6011538706120272, 0.6066910815761399, 0.611289766971816, 0.6153751051329941, 0.619445360714628, 0.6201698290871839, 0.6219132753973005, 0.6238893192237598, 0.6261922189489121, 0.6278316683270372, 0.6323290872788329, 0.6342495258435071, 0.6350157313734109, 0.6361006584876734, 0.6377702587769737, 0.6444829987568623, 0.6470656510358949, 0.6498229207209171, 0.652935918112146, 0.6568285473390383, 0.6586627695520525, 0.6595294345692244, 0.6636785777000078, 0.6636785777000078, 0.6660158366678979, 0.6670651600464085, 0.6697145236123737, 0.670355196566085, 0.6756716568742265, 0.6798507153630403, 0.6798507153630403, 0.6809135851016455, 0.6809135851016455, 0.6839277592315465, 0.6853657741265857, 0.6853657741265857, 0.6879995910881638, 0.6879995910881638, 0.6879995910881638, 0.6879995910881638, 0.6879995910881638, 0.6879995910881638, 0.6879995910881638, 0.6920311824923513, 0.6920311824923513, 0.6937261596488902, 0.6956794020505457, 0.6956794020505457, 0.6956794020505457, 0.6956794020505457, 0.6956794020505457, 0.6956794020505457, 0.6978589984491916, 0.6978589984491916, 0.6978589984491916, 0.7048818098970587, 0.7048818098970587, 0.7048818098970587, 0.7068659781684294, 0.7068659781684294, 0.7068659781684294, 0.7068659781684294, 0.7068659781684294, 0.7093869377118248, 0.7093869377118248, 0.7093869377118248, 0.7093869377118248, 0.7093869377118248, 0.7093869377118248, 0.7093869377118248, 0.7093869377118248, 0.7093869377118248, 0.7093869377118248, 0.7093869377118248, 0.7093869377118248]
[0.14680724912390403, 0.15143291201690268, 0.1633251819848687, 0.172417955581231, 0.18166353693439416, 0.18719149810783944, 0.19521311416888254, 0.19962150857874483, 0.20748920993461784, 0.20781441418607466, 0.215096666995149, 0.2223139026274359, 0.22926465607113902, 0.23261598228871289, 0.24761806428603303, 0.24969812215739065, 0.25990731332509354, 0.2698105268205754, 0.27710455696477915, 0.2853252209942628, 0.2865355896466532, 0.2901799627488272, 0.2943430410093054, 0.29940631199569623, 0.30263144941516773, 0.31217699068521, 0.31564498489935183, 0.3171205839600369, 0.31946202530608203, 0.3240227440171835, 0.3397204480547424, 0.3459365189384219, 0.3527395444536482, 0.35947432637322063, 0.368686056069379, 0.3729141170671213, 0.3744657351604723, 0.3832635073030433, 0.3832635073030433, 0.39095296523675077, 0.393257546244268, 0.4005587494863415, 0.40177452194813723, 0.4178422113264877, 0.43008234561696257, 0.43008234561696257, 0.43253871980299347, 0.43253871980299347, 0.44141370555820936, 0.4457827925391217, 0.4457827925391217, 0.45177539285500595, 0.45177539285500595, 0.45177539285500595, 0.45177539285500595, 0.45177539285500595, 0.45177539285500595, 0.45177539285500595, 0.46542686761056107, 0.46542686761056107, 0.46983479086232316, 0.47620277538893496, 0.47620277538893496, 0.47620277538893496, 0.47620277538893496, 0.47620277538893496, 0.47620277538893496, 0.4842133608442633, 0.4842133608442633, 0.4842133608442633, 0.5081102579174596, 0.5081102579174596, 0.5081102579174596, 0.5147303374721122, 0.5147303374721122, 0.5147303374721122, 0.5147303374721122, 0.5147303374721122, 0.5236234719575246, 0.5236234719575246, 0.5236234719575246, 0.5236234719575246, 0.5236234719575246, 0.5236234719575246, 0.5236234719575246, 0.5236234719575246, 0.5236234719575246, 0.5236234719575246, 0.5236234719575246, 0.5236234719575246]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  65455.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_2_5
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19733.0)
('VALIDATE SUM PROTEIN TEST: ', 2797.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 67267.37, 57958.0)
('Error: ', tensor(42653.2969, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.503273765308106, 0.27300786007982125)
('Val: AUC, AUPR, Erros: ', 0.5037690649397519, 0.280911879794666, 5416.458)
('Test: AUC, AUPR, Erros: ', 0.508144678602517, 0.28475896061037004, 5432.731)
10((646, 331), (646, 331), 64500.03, 57958.0)
('Error: ', tensor(41770.2227, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6990616361216075, 0.4911556648701128)
('Val: AUC, AUPR, Erros: ', 0.6939993917456652, 0.4908362968779055, 5312.424)
('Test: AUC, AUPR, Erros: ', 0.691665993655755, 0.4946446211712559, 5329.9434)
20((646, 331), (646, 331), 87105.336, 57958.0)
('Error: ', tensor(41092.3359, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7333109136256729, 0.5350384376344194)
('Val: AUC, AUPR, Erros: ', 0.7223303158171896, 0.5251847488269374, 5214.099)
('Test: AUC, AUPR, Erros: ', 0.7158447583928121, 0.5189619530297853, 5252.972)
30((646, 331), (646, 331), 36111.47, 57958.0)
('Error: ', tensor(41475.3828, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7436887271136745, 0.554186589198405)
('Val: AUC, AUPR, Erros: ', 0.7313938086118683, 0.5453459072701942, 5334.625)
('Test: AUC, AUPR, Erros: ', 0.7192511984601233, 0.5390824615886304, 5366.703)
40((646, 331), (646, 331), 49617.785, 57958.0)
('Error: ', tensor(36866.3828, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7513841154220137, 0.5693450678920109)
('Val: AUC, AUPR, Erros: ', 0.7388239746638601, 0.5582449478586744, 4755.089)
('Test: AUC, AUPR, Erros: ', 0.7255545205897761, 0.5484657513640473, 4795.42)
50((646, 331), (646, 331), 54626.633, 57958.0)
('Error: ', tensor(34690.6406, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7544747683687962, 0.5773361203072609)
('Val: AUC, AUPR, Erros: ', 0.7406412103859255, 0.5619989338431004, 4512.4414)
('Test: AUC, AUPR, Erros: ', 0.7269243481452503, 0.5496673040312864, 4586.723)
60((646, 331), (646, 331), 60714.973, 57958.0)
('Error: ', tensor(34386.7734, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7559964004325046, 0.5811154930225224)
('Val: AUC, AUPR, Erros: ', 0.7408826968387506, 0.5640716801281714, 4486.0757)
('Test: AUC, AUPR, Erros: ', 0.7283382131976742, 0.5529283816248267, 4561.6826)
70((646, 331), (646, 331), 67880.086, 57958.0)
('Error: ', tensor(34582.0586, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.758257105789308, 0.5854321334115357)
('Val: AUC, AUPR, Erros: ', 0.7412698077910479, 0.5653687705043839, 4532.9126)
('Test: AUC, AUPR, Erros: ', 0.7288007778445333, 0.5545084121359657, 4611.002)
80((646, 331), (646, 331), 66566.74, 57958.0)
('Error: ', tensor(34305.2344, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7604259640578901, 0.5896239144816288)
('Val: AUC, AUPR, Erros: ', 0.7413401594649957, 0.5653394846366421, 4524.3403)
('Test: AUC, AUPR, Erros: ', 0.7282835159537564, 0.5545236676182868, 4608.248)
90((646, 331), (646, 331), 65562.49, 57958.0)
('Error: ', tensor(34062.2734, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.762857153255238, 0.5932901332521687)
('Val: AUC, AUPR, Erros: ', 0.7416152587693292, 0.5649432162439576, 4513.59)
('Test: AUC, AUPR, Erros: ', 0.7278046250083341, 0.5545438576822272, 4598.438)
100((646, 331), (646, 331), 66221.77, 57958.0)
('Error: ', tensor(33956.7734, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7655726184713354, 0.5969838814718288)
('Val: AUC, AUPR, Erros: ', 0.7420160172532524, 0.5645906603015098, 4523.7217)
('Test: AUC, AUPR, Erros: ', 0.7271068829312817, 0.5543088228408675, 4610.709)
110((646, 331), (646, 331), 66029.83, 57958.0)
('Error: ', tensor(33791.6367, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7683978747797362, 0.6005019447282105)
('Val: AUC, AUPR, Erros: ', 0.7422607579041978, 0.5637720134585259, 4527.2695)
('Test: AUC, AUPR, Erros: ', 0.72595740860978, 0.5537265043014239, 4615.2725)
120((646, 331), (646, 331), 66503.61, 57958.0)
('Error: ', tensor(33672.4688, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7716446648319973, 0.6041395966487257)
('Val: AUC, AUPR, Erros: ', 0.7423514145267985, 0.5625994695753769, 4542.5435)
('Test: AUC, AUPR, Erros: ', 0.7242378605510066, 0.5527321748812852, 4632.0615)
130((646, 331), (646, 331), 66348.27, 57958.0)
('Error: ', tensor(33507.0430, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7749501791912197, 0.6076562296516979)
('Val: AUC, AUPR, Erros: ', 0.7428247357372795, 0.5617155103634137, 4547.3696)
('Test: AUC, AUPR, Erros: ', 0.7221165674512531, 0.5515298993908062, 4644.137)
140((646, 331), (646, 331), 66366.8, 57958.0)
('Error: ', tensor(33361.9141, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7780770812899678, 0.6111383442327256)
('Val: AUC, AUPR, Erros: ', 0.7431288386455178, 0.5604226628166172, 4560.723)
('Test: AUC, AUPR, Erros: ', 0.7196852093500408, 0.5500186194350446, 4665.2783)
150((646, 331), (646, 331), 66372.21, 57958.0)
('Error: ', tensor(33224.2188, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7808163960000296, 0.614479063022094)
('Val: AUC, AUPR, Erros: ', 0.743155617334414, 0.558596159201886, 4578.3896)
('Test: AUC, AUPR, Erros: ', 0.7166190524395876, 0.5482056139175112, 4689.505)
160((646, 331), (646, 331), 66368.05, 57958.0)
('Error: ', tensor(33092.2109, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7833628807854099, 0.6176697629621961)
('Val: AUC, AUPR, Erros: ', 0.7430020704740234, 0.5567592911904381, 4597.2583)
('Test: AUC, AUPR, Erros: ', 0.7142763252827968, 0.5466591792921061, 4711.377)

Validation:  [0.7408826968387506, 0.5640716801281714, 4486.0757, 0.7283382131976742, 0.5529283816248267, 4561.6826]
Train: 0.7560 0.5811
Test: 0.7283 0.5529
5
[0.5669826779026217, 0.5806957716492549, 0.5755283769941355, 0.572718065689413, 0.5814496365971844, 0.5845725410691772, 0.5895775492567967, 0.5927036545239149, 0.5953147801969134, 0.5977999672704777, 0.6009590405338427, 0.6036538331463219, 0.6050143891361183, 0.6054365090963305, 0.6100783132364617, 0.6153210063023007, 0.6188784090107061, 0.6243073704275146, 0.62782250815166, 0.6298834503124513, 0.6308547794228477, 0.6364519496580502, 0.6391715340510138, 0.6425949663781708, 0.6442657878376989, 0.6490620150774533, 0.6508728778551058, 0.6516476080338677, 0.6545105093517888, 0.6555791868071817, 0.6626071523395446, 0.6654441773939422, 0.669683146975591, 0.6720569640558272, 0.6763693947566063, 0.678301116458694, 0.6793435580092194, 0.6828435497606153, 0.6828435497606153, 0.6852968381811133, 0.6862657969221335, 0.689086348966422, 0.6907720773283398, 0.6955494193219702, 0.6995373881307223, 0.6995373881307223, 0.7006668726841055, 0.7006668726841055, 0.7038905302981759, 0.7049450355997823, 0.7049450355997823, 0.7075870594867882, 0.7075870594867882, 0.7075870594867882, 0.7075870594867882, 0.7075870594867882, 0.7075870594867882, 0.7075870594867882, 0.7110890681821097, 0.7110890681821097, 0.7129590083359576, 0.7147679672005044, 0.7147679672005044, 0.7147679672005044, 0.7147679672005044, 0.7147679672005044, 0.7147679672005044, 0.7167834803398094, 0.7167834803398094, 0.7167834803398094, 0.7234304468357547, 0.7234304468357547, 0.7234304468357547, 0.7258949988938199, 0.7258949988938199, 0.7258949988938199, 0.7258949988938199, 0.7258949988938199, 0.7283382131976742, 0.7283382131976742, 0.7283382131976742, 0.7283382131976742, 0.7283382131976742, 0.7283382131976742, 0.7283382131976742, 0.7283382131976742, 0.7283382131976742, 0.7283382131976742, 0.7283382131976742, 0.7283382131976742]
[0.15553033450012127, 0.17679715039257932, 0.18057385832858117, 0.17731777458340092, 0.19398969835927996, 0.2004462957642681, 0.20866611565913265, 0.21238051984518252, 0.2186811801486589, 0.22530577943354338, 0.23078311336092094, 0.23913107226365277, 0.24003290032034133, 0.24110417436320977, 0.2494443341768226, 0.26083923884923954, 0.27004594843574914, 0.2853287836020334, 0.2901026870713943, 0.2952314146300899, 0.29764091411774746, 0.3108439424430671, 0.31596327332922136, 0.32297159276711107, 0.32500840417172716, 0.3328901935384516, 0.33725618501461563, 0.3389571359736774, 0.3469958375877198, 0.3498876256445419, 0.3672383353336576, 0.3737235473060464, 0.3832366074615329, 0.39030098086513354, 0.40102384208973496, 0.40606051261206766, 0.40861238925724946, 0.4179475406236829, 0.4179475406236829, 0.4252508861246075, 0.4278562947210557, 0.436194490018011, 0.44108374902545777, 0.45427889202814975, 0.4662522693330096, 0.4662522693330096, 0.46961634899776866, 0.46961634899776866, 0.478685726728418, 0.4813931051681321, 0.4813931051681321, 0.48888463363810014, 0.48888463363810014, 0.48888463363810014, 0.48888463363810014, 0.48888463363810014, 0.48888463363810014, 0.48888463363810014, 0.4998538198722059, 0.4998538198722059, 0.5056982295381327, 0.5113000444539196, 0.5113000444539196, 0.5113000444539196, 0.5113000444539196, 0.5113000444539196, 0.5113000444539196, 0.5162317666515056, 0.5162317666515056, 0.5162317666515056, 0.5376352216761838, 0.5376352216761838, 0.5376352216761838, 0.5448902686538082, 0.5448902686538082, 0.5448902686538082, 0.5448902686538082, 0.5448902686538082, 0.5529283816248267, 0.5529283816248267, 0.5529283816248267, 0.5529283816248267, 0.5529283816248267, 0.5529283816248267, 0.5529283816248267, 0.5529283816248267, 0.5529283816248267, 0.5529283816248267, 0.5529283816248267, 0.5529283816248267]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  66226.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_2_6
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 20482.0)
('VALIDATE SUM PROTEIN TEST: ', 2113.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 47923.84, 58773.0)
('Error: ', tensor(43183.0703, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.49223168846454246, 0.2743158391459281)
('Val: AUC, AUPR, Erros: ', 0.5020870845483031, 0.25461597113570006, 5034.1665)
('Test: AUC, AUPR, Erros: ', 0.49258172788618504, 0.277149691611948, 5460.9614)
10((646, 331), (646, 331), 59965.727, 58773.0)
('Error: ', tensor(42204., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6527274987555651, 0.4188258059524391)
('Val: AUC, AUPR, Erros: ', 0.6574121162738589, 0.39473727798723607, 4991.234)
('Test: AUC, AUPR, Erros: ', 0.645006964261225, 0.4177206920955884, 5331.084)
20((646, 331), (646, 331), 66059.12, 58773.0)
('Error: ', tensor(41456.3086, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6937353221747335, 0.4827812956143403)
('Val: AUC, AUPR, Erros: ', 0.7010719202954769, 0.46235086105230333, 4937.185)
('Test: AUC, AUPR, Erros: ', 0.6844465874634814, 0.4793138012676447, 5237.7695)
30((646, 331), (646, 331), 77903.414, 58773.0)
('Error: ', tensor(40939.4062, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7144168686851455, 0.5202841976458021)
('Val: AUC, AUPR, Erros: ', 0.7215793807879911, 0.5000302501874225, 4950.5503)
('Test: AUC, AUPR, Erros: ', 0.7050084756785668, 0.5146045738918282, 5174.0215)
40((646, 331), (646, 331), 76345.62, 58773.0)
('Error: ', tensor(38258.3516, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7265082256773349, 0.5438873908602263)
('Val: AUC, AUPR, Erros: ', 0.7326382999363772, 0.5232652579466253, 4614.9927)
('Test: AUC, AUPR, Erros: ', 0.7166106484820459, 0.5359547416714101, 4859.249)
50((646, 331), (646, 331), 70207.85, 58773.0)
('Error: ', tensor(36564.8516, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7349010397075291, 0.5546287798579608)
('Val: AUC, AUPR, Erros: ', 0.7387189168325836, 0.5309308949310978, 4382.206)
('Test: AUC, AUPR, Erros: ', 0.7244511623323359, 0.5451007664404758, 4660.75)
60((646, 331), (646, 331), 68728.93, 58773.0)
('Error: ', tensor(35946.1211, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7404546147566253, 0.5629217996250933)
('Val: AUC, AUPR, Erros: ', 0.7425408643432738, 0.5370334377633134, 4307.5923)
('Test: AUC, AUPR, Erros: ', 0.7290622882908462, 0.5516163901971285, 4599.624)
70((646, 331), (646, 331), 67859.484, 58773.0)
('Error: ', tensor(35631.7344, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7444699922065207, 0.5691347932380515)
('Val: AUC, AUPR, Erros: ', 0.7450042407554779, 0.5414603920230064, 4273.572)
('Test: AUC, AUPR, Erros: ', 0.7322748645584721, 0.5563702422479696, 4572.6016)
80((646, 331), (646, 331), 67094.44, 58773.0)
('Error: ', tensor(35384.5000, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7475360355751243, 0.5740297725019358)
('Val: AUC, AUPR, Erros: ', 0.7468031734076059, 0.544772628539272, 4246.914)
('Test: AUC, AUPR, Erros: ', 0.7345485682796681, 0.5597976401497821, 4551.8105)
90((646, 331), (646, 331), 66621.2, 58773.0)
('Error: ', tensor(35195.3047, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7497723655556383, 0.5778585602811872)
('Val: AUC, AUPR, Erros: ', 0.7478424294994384, 0.5466819369438927, 4229.973)
('Test: AUC, AUPR, Erros: ', 0.7360344233582419, 0.5621875716867681, 4536.9326)
100((646, 331), (646, 331), 66456.95, 58773.0)
('Error: ', tensor(35052.6641, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7515338936870524, 0.5810400652184966)
('Val: AUC, AUPR, Erros: ', 0.7483127385680528, 0.547948816429556, 4221.5605)
('Test: AUC, AUPR, Erros: ', 0.7370979050075517, 0.5640926084493301, 4526.442)
110((646, 331), (646, 331), 66404.19, 58773.0)
('Error: ', tensor(34934.1523, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7530921139354584, 0.5838503552965174)
('Val: AUC, AUPR, Erros: ', 0.748705970703271, 0.5487963869051007, 4215.8247)
('Test: AUC, AUPR, Erros: ', 0.737882395484063, 0.5654818038769842, 4518.786)
120((646, 331), (646, 331), 66275.91, 58773.0)
('Error: ', tensor(34821.6992, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7545576401213756, 0.586385266248471)
('Val: AUC, AUPR, Erros: ', 0.7489553425006136, 0.5490681469781663, 4211.527)
('Test: AUC, AUPR, Erros: ', 0.7384898111438079, 0.5664980975112447, 4512.0137)
130((646, 331), (646, 331), 66311.91, 58773.0)
('Error: ', tensor(34727.4453, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7559650061983265, 0.5887691024434838)
('Val: AUC, AUPR, Erros: ', 0.7491302507090267, 0.5494873535280685, 4209.4253)
('Test: AUC, AUPR, Erros: ', 0.7390336295834237, 0.5674090290379137, 4507.1523)
140((646, 331), (646, 331), 66292.7, 58773.0)
('Error: ', tensor(34636.6250, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7572889650173936, 0.5909892771179592)
('Val: AUC, AUPR, Erros: ', 0.7492883599079859, 0.5495824248666057, 4208.172)
('Test: AUC, AUPR, Erros: ', 0.7395714975883515, 0.5682180463849158, 4502.3477)
150((646, 331), (646, 331), 66463.664, 58773.0)
('Error: ', tensor(34565.6172, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.758553812002854, 0.5930556215128073)
('Val: AUC, AUPR, Erros: ', 0.7492683527672731, 0.5494259414421357, 4211.16)
('Test: AUC, AUPR, Erros: ', 0.7399224727325575, 0.5687645627288096, 4500.3477)
160((646, 331), (646, 331), 66517.59, 58773.0)
('Error: ', tensor(34484.6484, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7598519706675472, 0.5951170418515632)
('Val: AUC, AUPR, Erros: ', 0.7491020057712461, 0.5490634137606474, 4213.3687)
('Test: AUC, AUPR, Erros: ', 0.7402953192764821, 0.5694222478623265, 4497.0312)

Validation:  [0.7492883599079859, 0.5495824248666057, 4208.172, 0.7395714975883515, 0.5682180463849158, 4502.3477]
Train: 0.7573 0.5910
Test: 0.7396 0.5682
6
[0.6315669413542654, 0.6213623384572244, 0.6235779886299802, 0.6210152290410791, 0.6181374560816496, 0.616041037772537, 0.6170418989704874, 0.6206165149989946, 0.6248832716066802, 0.6242251797648426, 0.6241492833678794, 0.6253109533387251, 0.6308605110804786, 0.633780521932026, 0.6341008607991672, 0.6371435973251753, 0.6401701814416426, 0.6443799275065676, 0.6481695931639802, 0.6492973198664014, 0.6503686807757263, 0.6544706311697325, 0.6570360331163161, 0.659887544197397, 0.6617599391933707, 0.6674315390851522, 0.6697130636350307, 0.6708108496414735, 0.6722445335391312, 0.6733326061687442, 0.6784737287101354, 0.6817239121181577, 0.6850711681092645, 0.687518098276359, 0.6913168769750945, 0.6926120775915594, 0.6937312801615961, 0.6965219573543876, 0.6965219573543876, 0.6992765840691335, 0.6999468465107552, 0.7021781826265739, 0.7034178682351953, 0.7085304401807272, 0.7111109160707347, 0.7111109160707347, 0.7118634479345989, 0.7118634479345989, 0.7142672848569002, 0.7160858183979555, 0.7160858183979555, 0.7192316793653565, 0.7192316793653565, 0.7192316793653565, 0.7192316793653565, 0.7192316793653565, 0.7192316793653565, 0.7192316793653565, 0.7222629214108718, 0.7222629214108718, 0.7238771430016452, 0.7257512895065261, 0.7257512895065261, 0.7257512895065261, 0.7257512895065261, 0.7257512895065261, 0.7257512895065261, 0.7278364394846442, 0.7278364394846442, 0.7278364394846442, 0.7349357311324093, 0.7349357311324093, 0.7349357311324093, 0.7370662733011634, 0.7370662733011634, 0.7370662733011634, 0.7370662733011634, 0.7370662733011634, 0.7395714975883515, 0.7395714975883515, 0.7395714975883515, 0.7395714975883515, 0.7395714975883515, 0.7395714975883515, 0.7395714975883515, 0.7395714975883515, 0.7395714975883515, 0.7395714975883515, 0.7395714975883515, 0.7395714975883515]
[0.16555643278320006, 0.18374181762589867, 0.186541425015229, 0.19052273313718077, 0.19475992901097428, 0.19736257990937436, 0.21082604402825728, 0.22468732106719558, 0.2407132820515282, 0.24091786390787365, 0.24262798026496163, 0.24510349120837, 0.2571631045217415, 0.26434897824318826, 0.26592607624286396, 0.2731509967710478, 0.2823128124818896, 0.29445716527185983, 0.302690345548752, 0.30931361316718864, 0.3120404616214689, 0.3212682533495028, 0.32847042281791783, 0.3377592933085496, 0.3429475493207871, 0.3563338529223602, 0.3610413296062952, 0.3638721880103798, 0.36626982753468496, 0.3702474506293852, 0.3813749974425318, 0.3892080329777352, 0.3985870378991467, 0.4060569944610134, 0.41770389788574136, 0.4217599391487971, 0.4244982564756796, 0.42911606521912626, 0.42911606521912626, 0.43886353622027513, 0.43958445617831, 0.44737598868658524, 0.4507400600378165, 0.4679322954210806, 0.4736938276130889, 0.4736938276130889, 0.47543332405534494, 0.47543332405534494, 0.48317047011374303, 0.48889794031427514, 0.48889794031427514, 0.49829569466880563, 0.49829569466880563, 0.49829569466880563, 0.49829569466880563, 0.49829569466880563, 0.49829569466880563, 0.49829569466880563, 0.5074942278356359, 0.5074942278356359, 0.5119778640469772, 0.5192608729282839, 0.5192608729282839, 0.5192608729282839, 0.5192608729282839, 0.5192608729282839, 0.5192608729282839, 0.5268316905965396, 0.5268316905965396, 0.5268316905965396, 0.5520260248198269, 0.5520260248198269, 0.5520260248198269, 0.5591715299990824, 0.5591715299990824, 0.5591715299990824, 0.5591715299990824, 0.5591715299990824, 0.5682180463849158, 0.5682180463849158, 0.5682180463849158, 0.5682180463849158, 0.5682180463849158, 0.5682180463849158, 0.5682180463849158, 0.5682180463849158, 0.5682180463849158, 0.5682180463849158, 0.5682180463849158, 0.5682180463849158]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  64748.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_2_7
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 20135.0)
('VALIDATE SUM PROTEIN TEST: ', 2048.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 45846.844, 58066.0)
('Error: ', tensor(42997.0625, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5050828425877282, 0.270930966796052)
('Val: AUC, AUPR, Erros: ', 0.4997443002320225, 0.3025333355281162, 5894.532)
('Test: AUC, AUPR, Erros: ', 0.5077341278951303, 0.250664133829859, 5049.005)
10((646, 331), (646, 331), 58923.484, 58066.0)
('Error: ', tensor(41830.6016, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.654142948736796, 0.39788287892388174)
('Val: AUC, AUPR, Erros: ', 0.6350207954207365, 0.4156277630512408, 5644.6885)
('Test: AUC, AUPR, Erros: ', 0.6602307885762096, 0.38209651202718353, 4975.24)
20((646, 331), (646, 331), 56020.637, 58066.0)
('Error: ', tensor(41028.5391, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6833304422498805, 0.44600993255068877)
('Val: AUC, AUPR, Erros: ', 0.6616071419184799, 0.45797377853072085, 5576.6445)
('Test: AUC, AUPR, Erros: ', 0.6934087244426993, 0.4364153912714407, 4857.092)
30((646, 331), (646, 331), 40289.734, 58066.0)
('Error: ', tensor(42099.4219, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7070782124293467, 0.49601990417703457)
('Val: AUC, AUPR, Erros: ', 0.6858011805601549, 0.5068537522722938, 5837.123)
('Test: AUC, AUPR, Erros: ', 0.7172952802225705, 0.482841638668734, 4911.8965)
40((646, 331), (646, 331), 61499.7, 58066.0)
('Error: ', tensor(38548.4492, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7218067045109801, 0.522536305266641)
('Val: AUC, AUPR, Erros: ', 0.7036568342285174, 0.5365929345381909, 5221.929)
('Test: AUC, AUPR, Erros: ', 0.7296826296487624, 0.5088444227676516, 4583.964)
50((646, 331), (646, 331), 31626.035, 58066.0)
('Error: ', tensor(41874.2734, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7313229162691814, 0.5419860889984238)
('Val: AUC, AUPR, Erros: ', 0.7128689020511964, 0.5573273611458232, 5869.9624)
('Test: AUC, AUPR, Erros: ', 0.7383904160874125, 0.526309557325055, 4849.762)
60((646, 331), (646, 331), 60308.953, 58066.0)
('Error: ', tensor(35752.4766, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.736478918316318, 0.5515977757484327)
('Val: AUC, AUPR, Erros: ', 0.7189436564932123, 0.566839145576957, 4876.848)
('Test: AUC, AUPR, Erros: ', 0.7403401643654638, 0.531982333773795, 4256.0127)
70((646, 331), (646, 331), 65523.46, 58066.0)
('Error: ', tensor(35533.3008, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7414800048718979, 0.559761991284185)
('Val: AUC, AUPR, Erros: ', 0.7240102118269431, 0.574124788078611, 4813.098)
('Test: AUC, AUPR, Erros: ', 0.7437545528140856, 0.5378065471754512, 4262.329)
80((646, 331), (646, 331), 66371.38, 58066.0)
('Error: ', tensor(35279.0391, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7445723755322011, 0.5653888732044313)
('Val: AUC, AUPR, Erros: ', 0.7268885072660773, 0.5788687513749872, 4781.2856)
('Test: AUC, AUPR, Erros: ', 0.7456965056677458, 0.5426092159642684, 4241.493)
90((646, 331), (646, 331), 65250.934, 58066.0)
('Error: ', tensor(35048.0977, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7469932732090581, 0.5689600310692893)
('Val: AUC, AUPR, Erros: ', 0.7291702378098845, 0.5817355077515197, 4763.353)
('Test: AUC, AUPR, Erros: ', 0.7470664260417048, 0.5446270297053736, 4213.288)
100((646, 331), (646, 331), 64109.574, 58066.0)
('Error: ', tensor(34829.5781, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7492262530045022, 0.5724007486530136)
('Val: AUC, AUPR, Erros: ', 0.7306466509181551, 0.5838302531973196, 4751.221)
('Test: AUC, AUPR, Erros: ', 0.7478292698416674, 0.5463815040281897, 4190.1885)
110((646, 331), (646, 331), 66611.71, 58066.0)
('Error: ', tensor(34883.3672, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7511446169012359, 0.5753122606013823)
('Val: AUC, AUPR, Erros: ', 0.7321055828368558, 0.5857646526880227, 4744.3057)
('Test: AUC, AUPR, Erros: ', 0.7486361836254929, 0.5478554032820839, 4213.6846)
120((646, 331), (646, 331), 64311.81, 58066.0)
('Error: ', tensor(34615.1211, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7530306533038374, 0.5780210299994886)
('Val: AUC, AUPR, Erros: ', 0.7334818725222114, 0.5875012341716837, 4731.585)
('Test: AUC, AUPR, Erros: ', 0.7493256790617606, 0.5489656218492976, 4177.7295)
130((646, 331), (646, 331), 65269.188, 58066.0)
('Error: ', tensor(34578.8984, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7546189441553597, 0.5804464631291785)
('Val: AUC, AUPR, Erros: ', 0.7345140643249954, 0.5889288444877829, 4724.7427)
('Test: AUC, AUPR, Erros: ', 0.749741171092666, 0.5501878536748266, 4183.8765)
140((646, 331), (646, 331), 65649.12, 58066.0)
('Error: ', tensor(34514.0312, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7561885520932197, 0.5827565565165684)
('Val: AUC, AUPR, Erros: ', 0.7353488018042453, 0.5898678488391422, 4719.796)
('Test: AUC, AUPR, Erros: ', 0.7501651276831036, 0.550543856996192, 4184.914)
150((646, 331), (646, 331), 64886.22, 58066.0)
('Error: ', tensor(34376.9062, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7576757435873716, 0.5849296835207791)
('Val: AUC, AUPR, Erros: ', 0.736394381287446, 0.5910351013578985, 4712.571)
('Test: AUC, AUPR, Erros: ', 0.7505040148926285, 0.5513848835312958, 4171.2354)
160((646, 331), (646, 331), 65825.77, 58066.0)
('Error: ', tensor(34355.7852, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7591542029546953, 0.5870682904968021)
('Val: AUC, AUPR, Erros: ', 0.7371084588062881, 0.5921597052201683, 4707.8174)
('Test: AUC, AUPR, Erros: ', 0.7506526818512662, 0.5515717755063554, 4180.9927)

Validation:  [0.7371084588062881, 0.5921597052201683, 4707.8174, 0.7506526818512662, 0.5515717755063554, 4180.9927]
Train: 0.7592 0.5871
Test: 0.7507 0.5516
7
[0.6398112043273334, 0.6266638494314539, 0.615091290304843, 0.6098371699300636, 0.6106937651209597, 0.6068493107458961, 0.6092746990325197, 0.6215397829240581, 0.6249684968914542, 0.6260702626999489, 0.6287495834866341, 0.6304434555958947, 0.634273388080374, 0.635538777816367, 0.6385054364787962, 0.6439378811429015, 0.6470267800860917, 0.6511101125328019, 0.6536790097454942, 0.6583658847746702, 0.658805481565158, 0.6631820063600805, 0.6671029080929389, 0.6703340079120886, 0.6711558352900637, 0.6759937072167691, 0.6780033483014271, 0.6786839757193479, 0.681000825567554, 0.6817471737652621, 0.6865158309190669, 0.6897722816636138, 0.6946110868360384, 0.6967400323681057, 0.7007332360592855, 0.7026855997648743, 0.7036582752014543, 0.707766393396565, 0.707766393396565, 0.709907986877034, 0.710870623137152, 0.7131814399210282, 0.7145871529305529, 0.7195084404866329, 0.7236383875639886, 0.7236383875639886, 0.7243916130476508, 0.7243916130476508, 0.7270943859573993, 0.7285206861511498, 0.7285206861511498, 0.7303469715787541, 0.7303469715787541, 0.7303469715787541, 0.7303469715787541, 0.7303469715787541, 0.7303469715787541, 0.7303469715787541, 0.7335492179239618, 0.7335492179239618, 0.734879448935728, 0.7368068223560126, 0.7368068223560126, 0.7368068223560126, 0.7368068223560126, 0.7368068223560126, 0.7368068223560126, 0.7391871638637446, 0.7391871638637446, 0.7391871638637446, 0.7458107570322764, 0.7458107570322764, 0.7458107570322764, 0.7482102553659963, 0.7482102553659963, 0.7482102553659963, 0.7482102553659963, 0.7482102553659963, 0.7506526818512662, 0.7506526818512662, 0.7506526818512662, 0.7506526818512662, 0.7506526818512662, 0.7506526818512662, 0.7506526818512662, 0.7506526818512662, 0.7506526818512662, 0.7506526818512662, 0.7506526818512662, 0.7506526818512662]
[0.17640794078044258, 0.17077684423223916, 0.16072088797920292, 0.15940236776143946, 0.1659950452023165, 0.16682180430389287, 0.17290518390124604, 0.19563380491431248, 0.20356984866678407, 0.20833691778563812, 0.21726245023145618, 0.2227012551532088, 0.231747339345307, 0.2340236137455467, 0.24117873103695792, 0.25306317483751384, 0.2581298500813046, 0.2705888439876116, 0.2738476949987986, 0.28677925136497173, 0.2876453174256846, 0.299309350441056, 0.30841140479536583, 0.3144750071807467, 0.31548314386785514, 0.32500371033014436, 0.33087578810039014, 0.3326211304950466, 0.33973114808186866, 0.3421398490535534, 0.3553689676881262, 0.3646805817854311, 0.3786798583043923, 0.3847382407409953, 0.3935307286140982, 0.3997947731990712, 0.4028128708230312, 0.4137727131166836, 0.4137727131166836, 0.419107913926564, 0.42107531865759606, 0.428897920219721, 0.4342386919215043, 0.4490699757442026, 0.461419217908442, 0.461419217908442, 0.4631421914958975, 0.4631421914958975, 0.472013547892249, 0.4759318158884689, 0.4759318158884689, 0.4792708808147945, 0.4792708808147945, 0.4792708808147945, 0.4792708808147945, 0.4792708808147945, 0.4792708808147945, 0.4792708808147945, 0.49126044229085775, 0.49126044229085775, 0.4950646607140709, 0.502247242640049, 0.502247242640049, 0.502247242640049, 0.502247242640049, 0.502247242640049, 0.502247242640049, 0.5118828497237519, 0.5118828497237519, 0.5118828497237519, 0.5349420292673918, 0.5349420292673918, 0.5349420292673918, 0.5430914524115524, 0.5430914524115524, 0.5430914524115524, 0.5430914524115524, 0.5430914524115524, 0.5515717755063554, 0.5515717755063554, 0.5515717755063554, 0.5515717755063554, 0.5515717755063554, 0.5515717755063554, 0.5515717755063554, 0.5515717755063554, 0.5515717755063554, 0.5515717755063554, 0.5515717755063554, 0.5515717755063554]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
647 81 331
Num Drug-SE:  65539.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_2_8
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((647, 3826), (81, 3826), (647, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19549.0)
('VALIDATE SUM PROTEIN TEST: ', 2460.0)
(647, 3826) (647, 331)
0((647, 331), (647, 331), 35130.527, 57379.0)
('Error: ', tensor(44324.7422, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.4957616632287648, 0.2632901621063521)
('Val: AUC, AUPR, Erros: ', 0.4866385329170827, 0.2681200709603674, 5665.881)
('Test: AUC, AUPR, Erros: ', 0.4898960136974204, 0.2961449731485406, 6206.504)
10((647, 331), (647, 331), 57711.07, 57379.0)
('Error: ', tensor(41710.1172, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.633860691722469, 0.3641687123084616)
('Val: AUC, AUPR, Erros: ', 0.6260901388896867, 0.36530669132491395, 5285.3584)
('Test: AUC, AUPR, Erros: ', 0.6311888306204472, 0.4072605451828814, 5669.8096)
20((647, 331), (647, 331), 56158.67, 57379.0)
('Error: ', tensor(40784.9922, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6972347684958865, 0.4763621163629574)
('Val: AUC, AUPR, Erros: ', 0.6889092285344522, 0.47591794994920755, 5177.394)
('Test: AUC, AUPR, Erros: ', 0.6820723748187818, 0.5026257530376004, 5571.675)
30((647, 331), (647, 331), 45862.098, 57379.0)
('Error: ', tensor(39642.5156, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7181705151376822, 0.5194037380481352)
('Val: AUC, AUPR, Erros: ', 0.7109986732203282, 0.5160650203361937, 5064.2344)
('Test: AUC, AUPR, Erros: ', 0.7042371630706865, 0.5444438154226485, 5515.3257)
40((647, 331), (647, 331), 41194.938, 57379.0)
('Error: ', tensor(38694.4922, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7279748254829385, 0.5382817435540306)
('Val: AUC, AUPR, Erros: ', 0.720693682043052, 0.533398078629023, 4959.379)
('Test: AUC, AUPR, Erros: ', 0.7147116316635496, 0.5629410165724393, 5427.4385)
50((647, 331), (647, 331), 38253.82, 57379.0)
('Error: ', tensor(37747.2031, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7340613018237426, 0.5489438666987254)
('Val: AUC, AUPR, Erros: ', 0.7246771099117476, 0.540679762644797, 4864.323)
('Test: AUC, AUPR, Erros: ', 0.7199843112812119, 0.5714781413773422, 5327.077)
60((647, 331), (647, 331), 57510.67, 57379.0)
('Error: ', tensor(35136.9062, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7386955563467906, 0.5560697992004735)
('Val: AUC, AUPR, Erros: ', 0.7289882189642543, 0.5480249137292916, 4503.2163)
('Test: AUC, AUPR, Erros: ', 0.7239391076386588, 0.5771635438884644, 4836.274)
70((647, 331), (647, 331), 47685.07, 57379.0)
('Error: ', tensor(35376.4609, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.744384596610191, 0.5623309259232192)
('Val: AUC, AUPR, Erros: ', 0.7309353255959239, 0.5511248217124294, 4578.2715)
('Test: AUC, AUPR, Erros: ', 0.7278117381342113, 0.5807644535587054, 4959.8354)
80((647, 331), (647, 331), 54720.61, 57379.0)
('Error: ', tensor(34677.9883, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7475379940072071, 0.5663767690205919)
('Val: AUC, AUPR, Erros: ', 0.732576887826033, 0.5535259362340514, 4486.8267)
('Test: AUC, AUPR, Erros: ', 0.7298733916385707, 0.5829339158037148, 4821.448)
90((647, 331), (647, 331), 48429.47, 57379.0)
('Error: ', tensor(34958.5742, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7518268353221881, 0.5714704408553125)
('Val: AUC, AUPR, Erros: ', 0.7336125448459787, 0.5554012784762109, 4555.5225)
('Test: AUC, AUPR, Erros: ', 0.7325996194547735, 0.5855795621028597, 4920.687)
100((647, 331), (647, 331), 52491.055, 57379.0)
('Error: ', tensor(34437.7188, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7541871955389934, 0.5751051687028416)
('Val: AUC, AUPR, Erros: ', 0.7342676196307041, 0.5565843578935405, 4497.08)
('Test: AUC, AUPR, Erros: ', 0.7338970778783874, 0.5871513553920531, 4830.2144)
110((647, 331), (647, 331), 50904.863, 57379.0)
('Error: ', tensor(34434.1133, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7568823024445122, 0.5786811112569049)
('Val: AUC, AUPR, Erros: ', 0.7346703883538612, 0.557523681528141, 4515.407)
('Test: AUC, AUPR, Erros: ', 0.7352333523619088, 0.5884007727226026, 4853.12)
120((647, 331), (647, 331), 50823.49, 57379.0)
('Error: ', tensor(34306.3828, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7591684659131546, 0.5819732922950791)
('Val: AUC, AUPR, Erros: ', 0.7350118060590081, 0.5582656600492222, 4514.9907)
('Test: AUC, AUPR, Erros: ', 0.7361920646897975, 0.5894828551340755, 4847.5894)
130((647, 331), (647, 331), 51080.797, 57379.0)
('Error: ', tensor(34180.7852, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7612662181654075, 0.5847997323315762)
('Val: AUC, AUPR, Erros: ', 0.7349169392070845, 0.5583293864958268, 4513.8105)
('Test: AUC, AUPR, Erros: ', 0.7374216845335528, 0.5906819632201679, 4836.968)
140((647, 331), (647, 331), 50586.168, 57379.0)
('Error: ', tensor(34115.1992, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7634082431955856, 0.5875854224188801)
('Val: AUC, AUPR, Erros: ', 0.7347757928111931, 0.5586766764959428, 4521.1255)
('Test: AUC, AUPR, Erros: ', 0.7380205294412012, 0.5910836418683693, 4843.3403)
150((647, 331), (647, 331), 50697.543, 57379.0)
('Error: ', tensor(34007.6484, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7653369375607852, 0.5900379692161566)
('Val: AUC, AUPR, Erros: ', 0.7346210164061499, 0.5586023260095472, 4522.128)
('Test: AUC, AUPR, Erros: ', 0.7386807934127486, 0.5917725068160425, 4837.2803)
160((647, 331), (647, 331), 50756.4, 57379.0)
('Error: ', tensor(33911.6328, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7673279848229986, 0.592448226120197)
('Val: AUC, AUPR, Erros: ', 0.7341646543023868, 0.5582145835101515, 4525.21)
('Test: AUC, AUPR, Erros: ', 0.7392629423223903, 0.5920738770982392, 4833.04)

Validation:  [0.732576887826033, 0.5535259362340514, 4486.8267, 0.7298733916385707, 0.5829339158037148, 4821.448]
Train: 0.7475 0.5664
Test: 0.7299 0.5829
8
[0.5966468807590684, 0.5900427484099676, 0.58159877192799, 0.5797766805481899, 0.5841680277927708, 0.585532428050451, 0.5897093505642461, 0.595647467595458, 0.6028850756873254, 0.60262674090303, 0.6030243697834423, 0.6061149518390175, 0.6070329035248578, 0.609349422928273, 0.615999274654787, 0.6187680791780433, 0.62388639601343, 0.6294918694535006, 0.6331648283435382, 0.6354116604842316, 0.6362398768870521, 0.6401733759638618, 0.6435522745491999, 0.6471789955529588, 0.6478734850336783, 0.6527528718742794, 0.6554477081889015, 0.6562843270371951, 0.6584811825735613, 0.6594463593159269, 0.6655361084076172, 0.6680289423554082, 0.6729256934240095, 0.6762435509540382, 0.6802026809532395, 0.6817383503271652, 0.6831973071326833, 0.6864481787934288, 0.6864481787934288, 0.6892923439921329, 0.6905050755079567, 0.6931942337892985, 0.6945302817430983, 0.6997967655429073, 0.7027959348030135, 0.7027959348030135, 0.7038354508085105, 0.7038354508085105, 0.7067604713644522, 0.7083085252474811, 0.7083085252474811, 0.710749005752558, 0.710749005752558, 0.710749005752558, 0.710749005752558, 0.710749005752558, 0.710749005752558, 0.710749005752558, 0.713826957616257, 0.713826957616257, 0.7153050098361913, 0.7169068473832743, 0.7169068473832743, 0.7169068473832743, 0.7169068473832743, 0.7169068473832743, 0.7169068473832743, 0.7190564466669915, 0.7190564466669915, 0.7190564466669915, 0.7252343125786065, 0.7252343125786065, 0.7252343125786065, 0.7273924152172111, 0.7273924152172111, 0.7273924152172111, 0.7273924152172111, 0.7273924152172111, 0.7298733916385707, 0.7298733916385707, 0.7298733916385707, 0.7298733916385707, 0.7298733916385707, 0.7298733916385707, 0.7298733916385707, 0.7298733916385707, 0.7298733916385707, 0.7298733916385707, 0.7298733916385707, 0.7298733916385707]
[0.17996536487511883, 0.18167028511702532, 0.18951567080756804, 0.19061869326402786, 0.19708910657875559, 0.20129208242148688, 0.21166189115402817, 0.2343484076214858, 0.24596872807900458, 0.24506723755224596, 0.2519788138790013, 0.25776444660980985, 0.2603405412877018, 0.26642699036102757, 0.27987713696247235, 0.2839273464779213, 0.29606269757773873, 0.3136376377837787, 0.3229305436550158, 0.3290806708079065, 0.33025928193850373, 0.3356256640171361, 0.34432163645046554, 0.35324139765418666, 0.35381786544208543, 0.3650843330924259, 0.3736645956591948, 0.3760210554310433, 0.38083982446974385, 0.3828399450172398, 0.39724216740244417, 0.40233660906775537, 0.41821626189145306, 0.4283246792795836, 0.4374773420846231, 0.44140189191603846, 0.4446722418604286, 0.4518906978573547, 0.4518906978573547, 0.4606695943551287, 0.4635507272621326, 0.4721225512807501, 0.47622398660060133, 0.49049641102285796, 0.4986371026372416, 0.4986371026372416, 0.5013918963141999, 0.5013918963141999, 0.5103857913842341, 0.5151515553633406, 0.5151515553633406, 0.5223443985636345, 0.5223443985636345, 0.5223443985636345, 0.5223443985636345, 0.5223443985636345, 0.5223443985636345, 0.5223443985636345, 0.5307521651354835, 0.5307521651354835, 0.5347955930554384, 0.539571446340451, 0.539571446340451, 0.539571446340451, 0.539571446340451, 0.539571446340451, 0.539571446340451, 0.547264918465631, 0.547264918465631, 0.547264918465631, 0.5674353886821301, 0.5674353886821301, 0.5674353886821301, 0.574218441011541, 0.574218441011541, 0.574218441011541, 0.574218441011541, 0.574218441011541, 0.5829339158037148, 0.5829339158037148, 0.5829339158037148, 0.5829339158037148, 0.5829339158037148, 0.5829339158037148, 0.5829339158037148, 0.5829339158037148, 0.5829339158037148, 0.5829339158037148, 0.5829339158037148, 0.5829339158037148]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
647 80 331
Num Drug-SE:  66238.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_2_9
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((647, 3826), (80, 3826), (647, 331), (80, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19794.0)
('VALIDATE SUM PROTEIN TEST: ', 2634.0)
(647, 3826) (647, 331)
0((647, 331), (647, 331), 45927.168, 58869.0)
('Error: ', tensor(43466.0195, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5110540419997859, 0.2841721610911874)
('Val: AUC, AUPR, Erros: ', 0.5054699823515579, 0.2559861622820401, 5043.02)
('Test: AUC, AUPR, Erros: ', 0.5165422226830492, 0.29132523097910656, 5424.701)
10((647, 331), (647, 331), 61128.32, 58869.0)
('Error: ', tensor(42189.0664, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6435228237773941, 0.38421568560628133)
('Val: AUC, AUPR, Erros: ', 0.6456098672276492, 0.35359512340377036, 4986.0894)
('Test: AUC, AUPR, Erros: ', 0.64382614303071, 0.38639735692137755, 5255.7446)
20((647, 331), (647, 331), 67849.27, 58869.0)
('Error: ', tensor(41839.8789, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6727964860059006, 0.4254330327548944)
('Val: AUC, AUPR, Erros: ', 0.6761120308720076, 0.3948344310458872, 4991.974)
('Test: AUC, AUPR, Erros: ', 0.6731159320718971, 0.429797039297792, 5209.115)
30((647, 331), (647, 331), 64647.594, 58869.0)
('Error: ', tensor(40892.0117, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6938827715069662, 0.46565714269953107)
('Val: AUC, AUPR, Erros: ', 0.6979005544643397, 0.4372002922400232, 4856.725)
('Test: AUC, AUPR, Erros: ', 0.693176166984235, 0.46979433706080764, 5094.9946)
40((647, 331), (647, 331), 61437.05, 58869.0)
('Error: ', tensor(39694.9492, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7093167774835629, 0.5023541744537834)
('Val: AUC, AUPR, Erros: ', 0.7132914824549892, 0.47616352304199583, 4692.064)
('Test: AUC, AUPR, Erros: ', 0.7076798458760176, 0.5043400935131448, 4949.749)
50((647, 331), (647, 331), 64102.086, 58869.0)
('Error: ', tensor(38722.0859, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7191143201189308, 0.5257979099158092)
('Val: AUC, AUPR, Erros: ', 0.7228244958499848, 0.5013258705376228, 4594.7495)
('Test: AUC, AUPR, Erros: ', 0.7160502514259158, 0.5251339763564727, 4831.589)
60((647, 331), (647, 331), 72381.05, 58869.0)
('Error: ', tensor(37842.9844, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7255082808541158, 0.5406729337987058)
('Val: AUC, AUPR, Erros: ', 0.7278875755012618, 0.5134214602970656, 4562.8906)
('Test: AUC, AUPR, Erros: ', 0.7217074863132376, 0.5374764789781588, 4725.093)
70((647, 331), (647, 331), 73209.625, 58869.0)
('Error: ', tensor(37149.2383, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7310896540814041, 0.5512778875216806)
('Val: AUC, AUPR, Erros: ', 0.7323943819758856, 0.5225791127800687, 4499.098)
('Test: AUC, AUPR, Erros: ', 0.7262132712349312, 0.5459009065598898, 4647.106)
80((647, 331), (647, 331), 70306.13, 58869.0)
('Error: ', tensor(36399.0469, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7351472115741873, 0.5581741651546291)
('Val: AUC, AUPR, Erros: ', 0.7351407360715652, 0.5279240062714603, 4399.8506)
('Test: AUC, AUPR, Erros: ', 0.7291902761277955, 0.5509360884281811, 4563.0396)
90((647, 331), (647, 331), 67926.89, 58869.0)
('Error: ', tensor(35926.8086, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.738751089771627, 0.5631508267680361)
('Val: AUC, AUPR, Erros: ', 0.7373801096572016, 0.5310125906382803, 4334.464)
('Test: AUC, AUPR, Erros: ', 0.7316830020734584, 0.5540080496978773, 4514.041)
100((647, 331), (647, 331), 67319.74, 58869.0)
('Error: ', tensor(35685.7031, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7418918530678016, 0.5672692778896379)
('Val: AUC, AUPR, Erros: ', 0.7390253063726812, 0.5329524274358861, 4313.578)
('Test: AUC, AUPR, Erros: ', 0.7337918332549771, 0.5562704769030177, 4492.6006)
110((647, 331), (647, 331), 66730.555, 58869.0)
('Error: ', tensor(35484.8242, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7445750071431967, 0.5707848944342313)
('Val: AUC, AUPR, Erros: ', 0.7399926098218952, 0.534453591358803, 4297.0156)
('Test: AUC, AUPR, Erros: ', 0.7354697800471564, 0.558099789912167, 4476.5547)
120((647, 331), (647, 331), 66421.32, 58869.0)
('Error: ', tensor(35330.6719, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.746844002800636, 0.5738720114955517)
('Val: AUC, AUPR, Erros: ', 0.7405486485196903, 0.5353568630668185, 4288.9287)
('Test: AUC, AUPR, Erros: ', 0.7366948299319602, 0.5595173500631452, 4465.3535)
130((647, 331), (647, 331), 66274.15, 58869.0)
('Error: ', tensor(35201.3555, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7489620621271195, 0.5767025978124843)
('Val: AUC, AUPR, Erros: ', 0.7411914034542234, 0.5361054975300894, 4281.921)
('Test: AUC, AUPR, Erros: ', 0.7373001706275484, 0.5602800810696715, 4460.271)
140((647, 331), (647, 331), 66567.65, 58869.0)
('Error: ', tensor(35114.8945, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7508753003163782, 0.5793103515178959)
('Val: AUC, AUPR, Erros: ', 0.7417404301175959, 0.536847151644282, 4283.962)
('Test: AUC, AUPR, Erros: ', 0.7381293324762843, 0.5612851116071373, 4457.041)
150((647, 331), (647, 331), 66075.0, 58869.0)
('Error: ', tensor(34979.9844, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7527462844234132, 0.5817098713619147)
('Val: AUC, AUPR, Erros: ', 0.7422321881112965, 0.5376002420043282, 4273.1504)
('Test: AUC, AUPR, Erros: ', 0.73828580597546, 0.5613671580683705, 4452.7104)
160((647, 331), (647, 331), 66055.94, 58869.0)
('Error: ', tensor(34888.1719, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7543832335181279, 0.5838760021862689)
('Val: AUC, AUPR, Erros: ', 0.7426997538418617, 0.5383127498379818, 4270.8604)
('Test: AUC, AUPR, Erros: ', 0.7386791199670801, 0.5617768297362338, 4450.2114)

Validation:  [0.7426997538418617, 0.5383127498379818, 4270.8604, 0.7386791199670801, 0.5617768297362338, 4450.2114]
Train: 0.7544 0.5839
Test: 0.7387 0.5618
9
[0.5171850180155747, 0.5584766677897575, 0.5639385541028469, 0.571896008954493, 0.5743589300930932, 0.5757846949780203, 0.5784575535191945, 0.5920897085955866, 0.5959943715821616, 0.598238039167517, 0.6058594017834384, 0.6081123845474782, 0.6109106409536949, 0.6142773235449236, 0.6211280185173206, 0.6263737967093791, 0.6318093970947232, 0.6359292986074888, 0.6394385506975898, 0.6439526790135655, 0.6444377788228287, 0.6480243512902544, 0.6521481549332402, 0.6570217251837419, 0.6591525248347279, 0.6642612928012832, 0.667309518663507, 0.6683746611198027, 0.6711962875916304, 0.6720082470288422, 0.6769199321849739, 0.67824877140889, 0.6823287637291865, 0.6853857728482712, 0.6899652647214868, 0.6917377257794206, 0.6923227616441135, 0.6958088982633339, 0.6958088982633339, 0.6969230306479901, 0.6983018534278977, 0.700613732843611, 0.7022002143554069, 0.7071229121567087, 0.7110851964568106, 0.7110851964568106, 0.7120848126644186, 0.7120848126644186, 0.7143420210988886, 0.7154017213603124, 0.7154017213603124, 0.7182102377894404, 0.7182102377894404, 0.7182102377894404, 0.7182102377894404, 0.7182102377894404, 0.7182102377894404, 0.7182102377894404, 0.722075674926399, 0.722075674926399, 0.7240297677727219, 0.7259534946711425, 0.7259534946711425, 0.7259534946711425, 0.7259534946711425, 0.7259534946711425, 0.7259534946711425, 0.7280017416070172, 0.7280017416070172, 0.7280017416070172, 0.7341920836477542, 0.7341920836477542, 0.7341920836477542, 0.7364162465959674, 0.7364162465959674, 0.7364162465959674, 0.7364162465959674, 0.7364162465959674, 0.7386791199670801, 0.7386791199670801, 0.7386791199670801, 0.7386791199670801, 0.7386791199670801, 0.7386791199670801, 0.7386791199670801, 0.7386791199670801, 0.7386791199670801, 0.7386791199670801, 0.7386791199670801, 0.7386791199670801]
[0.10183110348730978, 0.14441843831444587, 0.1551230226672497, 0.16894081968535418, 0.1682461083320166, 0.17235489748973737, 0.1813086261688498, 0.20311673464820335, 0.21101111842130454, 0.21456346921962993, 0.22995644245398766, 0.2327368747548504, 0.23683203398287253, 0.24234400961760316, 0.2579942703533396, 0.2720482191923086, 0.278201705733944, 0.2877583074028005, 0.29493489837812925, 0.30381839345190953, 0.30331986659822907, 0.3104409190564644, 0.31991590659235547, 0.33119923405040375, 0.3364090424095114, 0.3500180112648891, 0.35757544618332027, 0.35903727622980747, 0.3702452118570525, 0.3719323580727676, 0.38372578791181755, 0.38429516506958605, 0.39553465360862894, 0.402780287939159, 0.41569614465719695, 0.42058444304333276, 0.4222658455273905, 0.43164093348295207, 0.43164093348295207, 0.4322435085180323, 0.4359898502902076, 0.44243918466025145, 0.44823305954385234, 0.4632681734187969, 0.47570211652410144, 0.47570211652410144, 0.4777933727290899, 0.4777933727290899, 0.4826394361896509, 0.4853777001193867, 0.4853777001193867, 0.4940817594769039, 0.4940817594769039, 0.4940817594769039, 0.4940817594769039, 0.4940817594769039, 0.4940817594769039, 0.4940817594769039, 0.5069942181362194, 0.5069942181362194, 0.5137849372164615, 0.5201124196532213, 0.5201124196532213, 0.5201124196532213, 0.5201124196532213, 0.5201124196532213, 0.5201124196532213, 0.527316337708525, 0.527316337708525, 0.527316337708525, 0.5471210926023492, 0.5471210926023492, 0.5471210926023492, 0.5538989147156124, 0.5538989147156124, 0.5538989147156124, 0.5538989147156124, 0.5538989147156124, 0.5617768297362338, 0.5617768297362338, 0.5617768297362338, 0.5617768297362338, 0.5617768297362338, 0.5617768297362338, 0.5617768297362338, 0.5617768297362338, 0.5617768297362338, 0.5617768297362338, 0.5617768297362338, 0.5617768297362338]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  64258.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_3_0
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19582.0)
('VALIDATE SUM PROTEIN TEST: ', 2474.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 40814.582, 56994.0)
('Error: ', tensor(43028.7266, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.500723670615496, 0.26737727615438)
('Val: AUC, AUPR, Erros: ', 0.5106269198463456, 0.32904516442852544, 6323.846)
('Test: AUC, AUPR, Erros: ', 0.5118107471791136, 0.2792948394743848, 5467.004)
10((646, 331), (646, 331), 58008.277, 56994.0)
('Error: ', tensor(41535.9062, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6302001973890199, 0.3679033134484157)
('Val: AUC, AUPR, Erros: ', 0.6251652543896866, 0.42824008383674417, 5893.0176)
('Test: AUC, AUPR, Erros: ', 0.6244929445723163, 0.3683354028078636, 5263.1807)
20((646, 331), (646, 331), 59384.96, 56994.0)
('Error: ', tensor(41143.0664, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6631240125639897, 0.4106042707699821)
('Val: AUC, AUPR, Erros: ', 0.653082400736126, 0.46643998558706734, 5822.458)
('Test: AUC, AUPR, Erros: ', 0.6530470357338204, 0.40605874444880496, 5216.3594)
30((646, 331), (646, 331), 68890.99, 56994.0)
('Error: ', tensor(40906.2344, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6895709760239441, 0.4576142553818453)
('Val: AUC, AUPR, Erros: ', 0.6759845893490243, 0.507359812064474, 5657.441)
('Test: AUC, AUPR, Erros: ', 0.6768199709657217, 0.4471493451127537, 5186.2607)
40((646, 331), (646, 331), 60093.44, 56994.0)
('Error: ', tensor(39377.4141, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7111117686089581, 0.5014551958723626)
('Val: AUC, AUPR, Erros: ', 0.6945741096098386, 0.5442984433469613, 5584.787)
('Test: AUC, AUPR, Erros: ', 0.6951451336426446, 0.4840509005741244, 5014.2065)
50((646, 331), (646, 331), 62731.723, 56994.0)
('Error: ', tensor(37643.1211, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7231635747044203, 0.5275199833875204)
('Val: AUC, AUPR, Erros: ', 0.703603354453566, 0.5632566646033921, 5327.06)
('Test: AUC, AUPR, Erros: ', 0.7037587726261948, 0.5026915013441482, 4828.0938)
60((646, 331), (646, 331), 69293.914, 56994.0)
('Error: ', tensor(36708.9570, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7301860290116915, 0.540651738261914)
('Val: AUC, AUPR, Erros: ', 0.7090416992774646, 0.572500932830251, 5121.691)
('Test: AUC, AUPR, Erros: ', 0.7092610985461676, 0.5125199214290408, 4749.7783)
70((646, 331), (646, 331), 68440.234, 56994.0)
('Error: ', tensor(35877.2773, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7348965937643812, 0.5496226509561257)
('Val: AUC, AUPR, Erros: ', 0.7123080615165636, 0.5784189346599673, 5036.288)
('Test: AUC, AUPR, Erros: ', 0.7126320401307682, 0.5193592553681259, 4680.961)
80((646, 331), (646, 331), 65550.37, 56994.0)
('Error: ', tensor(35257.8359, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7386798479776223, 0.5558670274551029)
('Val: AUC, AUPR, Erros: ', 0.7148348029013452, 0.5823034629168676, 5006.5586)
('Test: AUC, AUPR, Erros: ', 0.7152832167593797, 0.5242518460235664, 4625.0596)
90((646, 331), (646, 331), 64642.664, 56994.0)
('Error: ', tensor(34963.5078, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7418389958413847, 0.5602981936758098)
('Val: AUC, AUPR, Erros: ', 0.716872807225545, 0.5851248236311746, 4991.65)
('Test: AUC, AUPR, Erros: ', 0.7172276258803756, 0.5273915816441854, 4605.2686)
100((646, 331), (646, 331), 63780.273, 56994.0)
('Error: ', tensor(34741.1328, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7443549516226814, 0.5636303137895162)
('Val: AUC, AUPR, Erros: ', 0.7184659657851593, 0.5873100347257669, 4983.302)
('Test: AUC, AUPR, Erros: ', 0.7186199445243127, 0.5293807505450723, 4588.8184)
110((646, 331), (646, 331), 63469.418, 56994.0)
('Error: ', tensor(34586.2500, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7465384909304735, 0.566496963937764)
('Val: AUC, AUPR, Erros: ', 0.7197040599926221, 0.5890181940820023, 4975.4907)
('Test: AUC, AUPR, Erros: ', 0.7195117962601829, 0.5304409907586617, 4581.576)
120((646, 331), (646, 331), 63407.66, 56994.0)
('Error: ', tensor(34467.7383, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7484641652853494, 0.5690378401895305)
('Val: AUC, AUPR, Erros: ', 0.7206644263751358, 0.5902978540205389, 4968.681)
('Test: AUC, AUPR, Erros: ', 0.7201841738786601, 0.5312339033859832, 4577.4224)
130((646, 331), (646, 331), 63447.723, 56994.0)
('Error: ', tensor(34367.8203, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7502293175473025, 0.5713998215197661)
('Val: AUC, AUPR, Erros: ', 0.7215369274119445, 0.5915796660385381, 4962.0957)
('Test: AUC, AUPR, Erros: ', 0.7208032200542733, 0.5319587706651987, 4574.6304)
140((646, 331), (646, 331), 63545.8, 56994.0)
('Error: ', tensor(34280.8906, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7518531095248684, 0.5736191624964783)
('Val: AUC, AUPR, Erros: ', 0.7224946233958114, 0.5930327002132625, 4954.229)
('Test: AUC, AUPR, Erros: ', 0.7211662154405207, 0.5320319589834166, 4575.2417)
150((646, 331), (646, 331), 62888.555, 56994.0)
('Error: ', tensor(34155.3359, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.753363285746932, 0.5757327901711913)
('Val: AUC, AUPR, Erros: ', 0.7232022822200783, 0.5941347872043257, 4952.2285)
('Test: AUC, AUPR, Erros: ', 0.7215247034483023, 0.5321827796970048, 4567.974)
160((646, 331), (646, 331), 63593.035, 56994.0)
('Error: ', tensor(34110.8711, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7548405785367914, 0.5778409140320386)
('Val: AUC, AUPR, Erros: ', 0.7239707936685771, 0.5952540340010091, 4943.1562)
('Test: AUC, AUPR, Erros: ', 0.7217731691648436, 0.5318907119666911, 4576.578)

Validation:  [0.7239707936685771, 0.5952540340010091, 4943.1562, 0.7217731691648436, 0.5318907119666911, 4576.578]
Train: 0.7548 0.5778
Test: 0.7218 0.5319
0
[0.520994194779361, 0.5582624430608506, 0.5651333682660877, 0.5659236185989783, 0.5717769439486386, 0.5706933653225333, 0.5762522047036926, 0.5785770598800496, 0.5882360479032154, 0.5891501680870331, 0.5926181693497815, 0.5955106086190441, 0.5973039290615432, 0.6002928532012105, 0.6084390868365632, 0.6117673383927673, 0.6138507334080824, 0.6206215088825127, 0.6253110302925362, 0.6285650920974186, 0.6292479575248277, 0.6323456642045835, 0.6350691535250299, 0.639140825231506, 0.6414072710109469, 0.6461627864646815, 0.6479255030633628, 0.6490638762079816, 0.6516058071846679, 0.6527876129250052, 0.658472257157801, 0.6606841144960869, 0.6638790019639171, 0.6662178480338724, 0.6698135433242833, 0.6718531983813043, 0.6720806745221989, 0.6753895867832335, 0.6753895867832335, 0.6781152831668693, 0.6789363019439602, 0.6808116166259156, 0.6822929721071627, 0.6872407883938048, 0.6909110292812668, 0.6909110292812668, 0.6928323262266, 0.6928323262266, 0.6955645829109669, 0.697202225872788, 0.697202225872788, 0.7000071812960336, 0.7000071812960336, 0.7000071812960336, 0.7000071812960336, 0.7000071812960336, 0.7000071812960336, 0.7000071812960336, 0.7033392961936721, 0.7033392961936721, 0.7052290318591345, 0.707420823065143, 0.707420823065143, 0.707420823065143, 0.707420823065143, 0.707420823065143, 0.707420823065143, 0.7096344914265347, 0.7096344914265347, 0.7096344914265347, 0.7168071394299254, 0.7168071394299254, 0.7168071394299254, 0.7192609991267994, 0.7192609991267994, 0.7192609991267994, 0.7192609991267994, 0.7192609991267994, 0.7217731691648436, 0.7217731691648436, 0.7217731691648436, 0.7217731691648436, 0.7217731691648436, 0.7217731691648436, 0.7217731691648436, 0.7217731691648436, 0.7217731691648436, 0.7217731691648436, 0.7217731691648436, 0.7217731691648436]
[0.11493359285103649, 0.14635903796402427, 0.15089882797902301, 0.1556698386762407, 0.16459953632860674, 0.1664301264066453, 0.1774184624600897, 0.18343569302149815, 0.19830613159134036, 0.20063806273386525, 0.20655760108438065, 0.21239720996017686, 0.21643756997751873, 0.2215208335956066, 0.23731693432803502, 0.24418466367916664, 0.2481176920445456, 0.26285198435885027, 0.27195688385317857, 0.2788577836166719, 0.27992031196182815, 0.28481747810164176, 0.2912635315810376, 0.2998818748918226, 0.30578317569354474, 0.3170221963777503, 0.31997906866635595, 0.3223424198283175, 0.32879337768561234, 0.33239366414748917, 0.3458889833037016, 0.34995512419071173, 0.3569753902697518, 0.36147569169915633, 0.3700133144176924, 0.375752208839282, 0.3751049550603831, 0.3829444256371861, 0.3829444256371861, 0.3925095012062069, 0.39388674826807163, 0.3991975148829713, 0.40317521468250633, 0.41802322849291057, 0.4282796053866504, 0.4282796053866504, 0.4331269935553243, 0.4331269935553243, 0.44171888916775526, 0.44628364010356253, 0.44628364010356253, 0.4545712105109682, 0.4545712105109682, 0.4545712105109682, 0.4545712105109682, 0.4545712105109682, 0.4545712105109682, 0.4545712105109682, 0.46496980697065204, 0.46496980697065204, 0.47136014436734663, 0.47946975254276425, 0.47946975254276425, 0.47946975254276425, 0.47946975254276425, 0.47946975254276425, 0.47946975254276425, 0.487669617393115, 0.487669617393115, 0.487669617393115, 0.5140157172827725, 0.5140157172827725, 0.5140157172827725, 0.5223317816905342, 0.5223317816905342, 0.5223317816905342, 0.5223317816905342, 0.5223317816905342, 0.5318907119666911, 0.5318907119666911, 0.5318907119666911, 0.5318907119666911, 0.5318907119666911, 0.5318907119666911, 0.5318907119666911, 0.5318907119666911, 0.5318907119666911, 0.5318907119666911, 0.5318907119666911, 0.5318907119666911]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  66426.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_3_1
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19753.0)
('VALIDATE SUM PROTEIN TEST: ', 2587.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 44389.113, 57776.0)
('Error: ', tensor(43008.7266, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.49831130903773946, 0.26577693617032955)
('Val: AUC, AUPR, Erros: ', 0.5066803542388008, 0.24099784200943614, 4945.7363)
('Test: AUC, AUPR, Erros: ', 0.5012369929465192, 0.3196673741317617, 6214.0806)
10((646, 331), (646, 331), 57318.195, 57776.0)
('Error: ', tensor(41822.4688, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.630129109597033, 0.37349297594804015)
('Val: AUC, AUPR, Erros: ', 0.6263690576046862, 0.3359821335199487, 4895.8335)
('Test: AUC, AUPR, Erros: ', 0.6179871973641033, 0.42334576788420747, 5895.4277)
20((646, 331), (646, 331), 56863.973, 57776.0)
('Error: ', tensor(41388.2148, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6662145736517819, 0.41546972346024647)
('Val: AUC, AUPR, Erros: ', 0.6641783846712022, 0.37945634971324693, 4842.9707)
('Test: AUC, AUPR, Erros: ', 0.6521066198832346, 0.4644301609428655, 5844.791)
30((646, 331), (646, 331), 48367.29, 57776.0)
('Error: ', tensor(40973.2812, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6909168565450844, 0.4637899742858488)
('Val: AUC, AUPR, Erros: ', 0.6901162964270153, 0.43140676557874647, 4735.336)
('Test: AUC, AUPR, Erros: ', 0.6738766804175752, 0.5048405950416127, 5901.86)
40((646, 331), (646, 331), 58773.395, 57776.0)
('Error: ', tensor(39025.3320, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7112758183701392, 0.5038848379779289)
('Val: AUC, AUPR, Erros: ', 0.7098830228547247, 0.47174741747710247, 4587.6655)
('Test: AUC, AUPR, Erros: ', 0.6929477445316505, 0.5417011073676796, 5519.2153)
50((646, 331), (646, 331), 58414.785, 57776.0)
('Error: ', tensor(37549.8281, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7239802667713761, 0.5293304624469284)
('Val: AUC, AUPR, Erros: ', 0.7212890264619395, 0.49464890300354897, 4421.8335)
('Test: AUC, AUPR, Erros: ', 0.7042105916476677, 0.5618158682900749, 5337.625)
60((646, 331), (646, 331), 42727.49, 57776.0)
('Error: ', tensor(37843.7422, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7317795001917047, 0.5459516228045573)
('Val: AUC, AUPR, Erros: ', 0.7272684344082575, 0.5094503710737741, 4347.141)
('Test: AUC, AUPR, Erros: ', 0.7108311655573956, 0.5748921901530931, 5575.451)
70((646, 331), (646, 331), 49776.074, 57776.0)
('Error: ', tensor(35982.7891, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7373671473121708, 0.5541871070326071)
('Val: AUC, AUPR, Erros: ', 0.7310830823997386, 0.5155509232080243, 4197.068)
('Test: AUC, AUPR, Erros: ', 0.7155159773547648, 0.5811823044297997, 5257.2085)
80((646, 331), (646, 331), 50340.637, 57776.0)
('Error: ', tensor(35497.2656, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7417391405834693, 0.5607217746000507)
('Val: AUC, AUPR, Erros: ', 0.7333015788762971, 0.5198622440010465, 4159.3716)
('Test: AUC, AUPR, Erros: ', 0.7185785522110678, 0.5855566551930155, 5198.7915)
90((646, 331), (646, 331), 51584.82, 57776.0)
('Error: ', tensor(35122.5859, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.745119556188942, 0.5656533752535957)
('Val: AUC, AUPR, Erros: ', 0.7346107852576127, 0.5227396333169794, 4139.5483)
('Test: AUC, AUPR, Erros: ', 0.7210480343924429, 0.589134938166681, 5144.4565)
100((646, 331), (646, 331), 51651.926, 57776.0)
('Error: ', tensor(34938.4492, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.747870462949152, 0.5695776220688775)
('Val: AUC, AUPR, Erros: ', 0.7354445778544303, 0.5245236190950786, 4129.6025)
('Test: AUC, AUPR, Erros: ', 0.722827691174603, 0.5916868605810859, 5128.053)
110((646, 331), (646, 331), 51933.07, 57776.0)
('Error: ', tensor(34776.4023, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7502315199955528, 0.5729457743972468)
('Val: AUC, AUPR, Erros: ', 0.7360963598966699, 0.525694175247153, 4123.1353)
('Test: AUC, AUPR, Erros: ', 0.7242890103388032, 0.5937913811269055, 5111.0137)
120((646, 331), (646, 331), 52151.176, 57776.0)
('Error: ', tensor(34641.7500, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7523063910617555, 0.5759069689791363)
('Val: AUC, AUPR, Erros: ', 0.7362453021143747, 0.5263442631793469, 4120.426)
('Test: AUC, AUPR, Erros: ', 0.7255091406249751, 0.5956162908940839, 5097.706)
130((646, 331), (646, 331), 52066.027, 57776.0)
('Error: ', tensor(34547.3281, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7541409255855249, 0.5785106547857158)
('Val: AUC, AUPR, Erros: ', 0.7364637656250452, 0.526789740273891, 4118.1377)
('Test: AUC, AUPR, Erros: ', 0.7267246207890694, 0.5973716096028382, 5091.8027)
140((646, 331), (646, 331), 52140.797, 57776.0)
('Error: ', tensor(34449.0742, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7558532768523605, 0.5809436550178599)
('Val: AUC, AUPR, Erros: ', 0.7368503900712939, 0.52726230396679, 4115.7783)
('Test: AUC, AUPR, Erros: ', 0.7278750056097469, 0.598894367777457, 5083.198)
150((646, 331), (646, 331), 52070.58, 57776.0)
('Error: ', tensor(34370.6953, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7574067316272833, 0.5831640593865645)
('Val: AUC, AUPR, Erros: ', 0.7370745072620495, 0.5275275283405465, 4114.2695)
('Test: AUC, AUPR, Erros: ', 0.7289229858939931, 0.6002078755460103, 5078.7334)
160((646, 331), (646, 331), 51891.277, 57776.0)
('Error: ', tensor(34307.3008, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7588830546078765, 0.5852322723508722)
('Val: AUC, AUPR, Erros: ', 0.7372771442628981, 0.5276354844297155, 4113.3486)
('Test: AUC, AUPR, Erros: ', 0.7301204162002488, 0.6016457689628748, 5076.2686)

Validation:  [0.7372771442628981, 0.5276354844297155, 4113.3486, 0.7301204162002488, 0.6016457689628748, 5076.2686]
Train: 0.7589 0.5852
Test: 0.7301 0.6016
1
[0.5556475190589081, 0.5852187818694023, 0.5985805043943359, 0.5954789478067841, 0.598849463339925, 0.5992913231197278, 0.5991978590467455, 0.6047649527747244, 0.608791279399481, 0.6101653585077409, 0.6129432207152149, 0.6128361595579104, 0.6176367723416614, 0.6178109215152572, 0.6229423881071762, 0.6274309599228675, 0.6315009296105869, 0.6345597790856161, 0.6379759306632258, 0.6408522949724083, 0.6415639344729543, 0.6454323503283325, 0.6470679554489371, 0.6515520458293811, 0.6530486626508304, 0.6579417712805906, 0.6596070369956283, 0.6605265734429187, 0.6626746116728944, 0.6634995710230949, 0.6691784590146276, 0.6724985262881109, 0.676533203895855, 0.6792324660415137, 0.6842102094082457, 0.6851471328013288, 0.6863110495459807, 0.6899241332973078, 0.6899241332973078, 0.6911709635780253, 0.6926101327711589, 0.6950765687133732, 0.6966033308011865, 0.7010369911308548, 0.7042241945870935, 0.7042241945870935, 0.7050802803644172, 0.7050802803644172, 0.7077266820805242, 0.7087630148144068, 0.7087630148144068, 0.7114311933445541, 0.7114311933445541, 0.7114311933445541, 0.7114311933445541, 0.7114311933445541, 0.7114311933445541, 0.7114311933445541, 0.715072225662418, 0.715072225662418, 0.7161706072463612, 0.717671366354778, 0.717671366354778, 0.717671366354778, 0.717671366354778, 0.717671366354778, 0.717671366354778, 0.7198643933543006, 0.7198643933543006, 0.7198643933543006, 0.7257511504462233, 0.7257511504462233, 0.7257511504462233, 0.7278540014577286, 0.7278540014577286, 0.7278540014577286, 0.7278540014577286, 0.7278540014577286, 0.7301204162002488, 0.7301204162002488, 0.7301204162002488, 0.7301204162002488, 0.7301204162002488, 0.7301204162002488, 0.7301204162002488, 0.7301204162002488, 0.7301204162002488, 0.7301204162002488, 0.7301204162002488, 0.7301204162002488]
[0.15913555250758504, 0.20614167648543005, 0.2258338469889183, 0.22780016720614613, 0.23517949631829022, 0.23881317322256984, 0.2405481662206342, 0.258453789540377, 0.2695327481382104, 0.27678907811026876, 0.2818439891463311, 0.2814828169937146, 0.29209414435818626, 0.2923278866834952, 0.30848325141682736, 0.3191284346297957, 0.3298848030000814, 0.3392682274515678, 0.3468668811667334, 0.35292607332638837, 0.3548097053726264, 0.36655875816734573, 0.36815252174037405, 0.37900270332724995, 0.3835036547347097, 0.3969148058536822, 0.4017127569607427, 0.40360206110150887, 0.40971732351739887, 0.41173890060770013, 0.42656806105793155, 0.43538818957770486, 0.447490143392989, 0.45468297567668936, 0.46881362727449005, 0.4702149125181735, 0.47342950686079754, 0.48237387118257186, 0.48237387118257186, 0.4850883140079776, 0.48880955009670224, 0.4951674980695846, 0.4999322144374037, 0.5127793417636912, 0.5223148772686245, 0.5223148772686245, 0.5245927740939536, 0.5245927740939536, 0.5330134393453858, 0.5355422465709627, 0.5355422465709627, 0.5437581399336835, 0.5437581399336835, 0.5437581399336835, 0.5437581399336835, 0.5437581399336835, 0.5437581399336835, 0.5437581399336835, 0.5554371817520305, 0.5554371817520305, 0.5575216963533342, 0.561743521805271, 0.561743521805271, 0.561743521805271, 0.561743521805271, 0.561743521805271, 0.561743521805271, 0.5691505684184498, 0.5691505684184498, 0.5691505684184498, 0.5880972301924554, 0.5880972301924554, 0.5880972301924554, 0.5945932850376654, 0.5945932850376654, 0.5945932850376654, 0.5945932850376654, 0.5945932850376654, 0.6016457689628748, 0.6016457689628748, 0.6016457689628748, 0.6016457689628748, 0.6016457689628748, 0.6016457689628748, 0.6016457689628748, 0.6016457689628748, 0.6016457689628748, 0.6016457689628748, 0.6016457689628748, 0.6016457689628748]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  65004.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_3_2
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19837.0)
('VALIDATE SUM PROTEIN TEST: ', 2303.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 38657.79, 58522.0)
('Error: ', tensor(44355.1562, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.4985891086151698, 0.27604030756537723)
('Val: AUC, AUPR, Erros: ', 0.5071962447931265, 0.3047997174297886, 5921.297)
('Test: AUC, AUPR, Erros: ', 0.4856630906925112, 0.23836473644346937, 5016.4434)
10((646, 331), (646, 331), 59210.758, 58522.0)
('Error: ', tensor(42279.8633, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6125337974712277, 0.3521242153695543)
('Val: AUC, AUPR, Erros: ', 0.6038723307446271, 0.3699752383223901, 5555.053)
('Test: AUC, AUPR, Erros: ', 0.6071156511789577, 0.3085283238522842, 4924.6094)
20((646, 331), (646, 331), 51564.246, 58522.0)
('Error: ', tensor(42379.2734, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6357390480609477, 0.37205856327718123)
('Val: AUC, AUPR, Erros: ', 0.614872620437689, 0.3773901762648908, 5611.741)
('Test: AUC, AUPR, Erros: ', 0.6348848430361589, 0.3305952913218876, 4875.1025)
30((646, 331), (646, 331), 52504.703, 58522.0)
('Error: ', tensor(41972.1094, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6602909891095317, 0.4053777361647751)
('Val: AUC, AUPR, Erros: ', 0.6322384186479355, 0.4011635936791216, 5563.2925)
('Test: AUC, AUPR, Erros: ', 0.6616241127194157, 0.36441615724132637, 4834.538)
40((646, 331), (646, 331), 50258.062, 58522.0)
('Error: ', tensor(41593.8984, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6801897077172182, 0.4435730562885866)
('Val: AUC, AUPR, Erros: ', 0.6452160782888072, 0.4277369613281957, 5540.881)
('Test: AUC, AUPR, Erros: ', 0.6835354811074579, 0.40429768985947934, 4772.5815)
50((646, 331), (646, 331), 47193.766, 58522.0)
('Error: ', tensor(41061.8789, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.697709554774151, 0.47985850672187247)
('Val: AUC, AUPR, Erros: ', 0.6583585354876811, 0.45543818632570954, 5510.1904)
('Test: AUC, AUPR, Erros: ', 0.7016086875070471, 0.4417706459710081, 4688.2495)
60((646, 331), (646, 331), 46518.99, 58522.0)
('Error: ', tensor(40087.2344, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7083698167110332, 0.5040603050735756)
('Val: AUC, AUPR, Erros: ', 0.666816409223583, 0.4736257396853355, 5419.963)
('Test: AUC, AUPR, Erros: ', 0.7133087659558426, 0.46610356305902856, 4568.7603)
70((646, 331), (646, 331), 50337.504, 58522.0)
('Error: ', tensor(38423.9844, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7171822828433759, 0.5236940790006872)
('Val: AUC, AUPR, Erros: ', 0.6744480902848784, 0.4895556926699584, 5233.562)
('Test: AUC, AUPR, Erros: ', 0.7213452635039136, 0.4840796580761614, 4407.429)
80((646, 331), (646, 331), 48596.64, 58522.0)
('Error: ', tensor(37633.1016, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7226036497902548, 0.536453483732995)
('Val: AUC, AUPR, Erros: ', 0.6782546144253065, 0.4989351978214587, 5181.142)
('Test: AUC, AUPR, Erros: ', 0.7257857245534045, 0.4958757443698026, 4308.464)
90((646, 331), (646, 331), 49393.125, 58522.0)
('Error: ', tensor(36901.0977, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7273743640527729, 0.5469017599254096)
('Val: AUC, AUPR, Erros: ', 0.6817961408804956, 0.5069297979310663, 5118.46)
('Test: AUC, AUPR, Erros: ', 0.7294068535260803, 0.5059378400705072, 4237.462)
100((646, 331), (646, 331), 50551.273, 58522.0)
('Error: ', tensor(36374.0352, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7310712394537159, 0.5538589564038415)
('Val: AUC, AUPR, Erros: ', 0.68453540384867, 0.5132875391115623, 5071.5254)
('Test: AUC, AUPR, Erros: ', 0.731887544159605, 0.5131889094268764, 4193.777)
110((646, 331), (646, 331), 51424.48, 58522.0)
('Error: ', tensor(36018.7148, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7343774345889209, 0.5588950487231192)
('Val: AUC, AUPR, Erros: ', 0.6868269849073743, 0.5179865235712147, 5038.505)
('Test: AUC, AUPR, Erros: ', 0.7336099321059044, 0.5183641510506904, 4167.2446)
120((646, 331), (646, 331), 51325.293, 58522.0)
('Error: ', tensor(35826.3242, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7371676141613961, 0.562504396247396)
('Val: AUC, AUPR, Erros: ', 0.6882999515367035, 0.520762358742067, 5025.078)
('Test: AUC, AUPR, Erros: ', 0.7348135740351076, 0.5218395499387716, 4150.249)
130((646, 331), (646, 331), 51918.01, 58522.0)
('Error: ', tensor(35598.6992, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7396986911865614, 0.5656836586176595)
('Val: AUC, AUPR, Erros: ', 0.6895965608564744, 0.5230940561654549, 5005.392)
('Test: AUC, AUPR, Erros: ', 0.7357565737235557, 0.5240673814342551, 4136.2695)
140((646, 331), (646, 331), 52640.164, 58522.0)
('Error: ', tensor(35417.4805, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7418292753222637, 0.5681960041312234)
('Val: AUC, AUPR, Erros: ', 0.6906790320520493, 0.5247491095516, 4988.2354)
('Test: AUC, AUPR, Erros: ', 0.7365087522230916, 0.5255460467324533, 4128.0674)
150((646, 331), (646, 331), 51806.305, 58522.0)
('Error: ', tensor(35368.0117, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7438701348066662, 0.5707037440450904)
('Val: AUC, AUPR, Erros: ', 0.6916570204917357, 0.5263633303431884, 4989.907)
('Test: AUC, AUPR, Erros: ', 0.7370523934046429, 0.5265313448352773, 4121.242)
160((646, 331), (646, 331), 53083.133, 58522.0)
('Error: ', tensor(35165.5547, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7456435408251173, 0.5729321413911644)
('Val: AUC, AUPR, Erros: ', 0.6924535158132852, 0.5275145720672443, 4970.734)
('Test: AUC, AUPR, Erros: ', 0.7374883756163593, 0.527288054655945, 4117.879)

Validation:  [0.6924535158132852, 0.5275145720672443, 4970.734, 0.7374883756163593, 0.527288054655945, 4117.879]
Train: 0.7456 0.5729
Test: 0.7375 0.5273
2
[0.5078804705263356, 0.5064028498037125, 0.5076325715060443, 0.5147520316429384, 0.5283075889323441, 0.5356520665373649, 0.5484342000079366, 0.5665131775278828, 0.5726726010958564, 0.5759068683756898, 0.5797526750804853, 0.5809120062753783, 0.5843102723231139, 0.5884088287952628, 0.5941475825912654, 0.6010847114258695, 0.6077965147053446, 0.6129077528515079, 0.6201783862832886, 0.621880288380392, 0.6224425218069829, 0.6265999533823349, 0.6320226930903072, 0.6360982482999055, 0.6372414977461978, 0.6440961514185116, 0.647265441462377, 0.6491996014806067, 0.652350632676992, 0.6542741153919215, 0.6615871339161841, 0.6662842772301194, 0.6693716005275062, 0.6726579900032703, 0.677670244813102, 0.6796937799424154, 0.6810926969381297, 0.6850914527836736, 0.6850914527836736, 0.6881277518380187, 0.6897817878611402, 0.6921730494838778, 0.6933866887592118, 0.6991033333872727, 0.7036663746948926, 0.7036663746948926, 0.7049162608907454, 0.7049162608907454, 0.7081051133515877, 0.7098687164187373, 0.7098687164187373, 0.7125950731857371, 0.7125950731857371, 0.7125950731857371, 0.7125950731857371, 0.7125950731857371, 0.7125950731857371, 0.7125950731857371, 0.716971386920715, 0.716971386920715, 0.7190913721092868, 0.7211451885286911, 0.7211451885286911, 0.7211451885286911, 0.7211451885286911, 0.7211451885286911, 0.7211451885286911, 0.7238689899410082, 0.7238689899410082, 0.7238689899410082, 0.7318833169186202, 0.7318833169186202, 0.7318833169186202, 0.7345335987317719, 0.7345335987317719, 0.7345335987317719, 0.7345335987317719, 0.7345335987317719, 0.7374883756163593, 0.7374883756163593, 0.7374883756163593, 0.7374883756163593, 0.7374883756163593, 0.7374883756163593, 0.7374883756163593, 0.7374883756163593, 0.7374883756163593, 0.7374883756163593, 0.7374883756163593, 0.7374883756163593]
[0.09884612304686408, 0.09793348043923873, 0.10047552793309572, 0.1071775970324995, 0.11720210771288089, 0.12161040692746292, 0.13584213791756203, 0.14897200504085756, 0.15463604081046206, 0.15841731456728367, 0.16501807619125936, 0.16619511841262918, 0.16960846612187438, 0.17432776240997738, 0.1832829611969759, 0.19585376723970105, 0.20367986910425565, 0.2152220757955535, 0.22627356192796258, 0.2272696884503545, 0.2279045128022858, 0.23597357913339628, 0.2496625745511366, 0.25589372569352997, 0.2562670812255505, 0.26899758481100877, 0.2746025744033901, 0.2784796213593832, 0.28678130237322186, 0.29103653027623166, 0.30467913764348753, 0.3170814671744565, 0.3209609320954422, 0.3277216632464648, 0.3397384387199818, 0.34322044656282424, 0.3471978912323731, 0.3552273958048187, 0.3552273958048187, 0.367126841203121, 0.37206540320195103, 0.3773375089711734, 0.3809285473383517, 0.3979229334474552, 0.4113532070926503, 0.4113532070926503, 0.4136590379289921, 0.4136590379289921, 0.4226185896120791, 0.42905618406229923, 0.42905618406229923, 0.4359117129441943, 0.4359117129441943, 0.4359117129441943, 0.4359117129441943, 0.4359117129441943, 0.4359117129441943, 0.4359117129441943, 0.45100899808520356, 0.45100899808520356, 0.45768795612188495, 0.46449135974531697, 0.46449135974531697, 0.46449135974531697, 0.46449135974531697, 0.46449135974531697, 0.46449135974531697, 0.4744267419932398, 0.4744267419932398, 0.4744267419932398, 0.5063979398891759, 0.5063979398891759, 0.5063979398891759, 0.5159348405068283, 0.5159348405068283, 0.5159348405068283, 0.5159348405068283, 0.5159348405068283, 0.527288054655945, 0.527288054655945, 0.527288054655945, 0.527288054655945, 0.527288054655945, 0.527288054655945, 0.527288054655945, 0.527288054655945, 0.527288054655945, 0.527288054655945, 0.527288054655945, 0.527288054655945]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
647 81 331
Num Drug-SE:  66552.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_3_3
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((647, 3826), (81, 3826), (647, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19874.0)
('VALIDATE SUM PROTEIN TEST: ', 2503.0)
(647, 3826) (647, 331)
0((647, 331), (647, 331), 36702.42, 58648.0)
('Error: ', tensor(44821.9688, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5163894787308819, 0.2824633575077535)
('Val: AUC, AUPR, Erros: ', 0.5297956594538655, 0.2550059621043783, 4952.612)
('Test: AUC, AUPR, Erros: ', 0.5302678861844328, 0.31636831089408735, 5978.627)
10((647, 331), (647, 331), 61489.18, 58648.0)
('Error: ', tensor(42245.3125, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.654316972463738, 0.42014456210083523)
('Val: AUC, AUPR, Erros: ', 0.6631399834868998, 0.3856947773340881, 4843.0884)
('Test: AUC, AUPR, Erros: ', 0.6393579642385518, 0.433660957011121, 5530.3223)
20((647, 331), (647, 331), 68624.51, 58648.0)
('Error: ', tensor(41044.4141, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7100171975615353, 0.5114995868772767)
('Val: AUC, AUPR, Erros: ', 0.7158868711283934, 0.48005435710854955, 4764.269)
('Test: AUC, AUPR, Erros: ', 0.6816349166407746, 0.5066665099601296, 5365.8755)
30((647, 331), (647, 331), 67698.45, 58648.0)
('Error: ', tensor(38240.2617, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7300494290805934, 0.5468651305871314)
('Val: AUC, AUPR, Erros: ', 0.7346090449096033, 0.5165913889716056, 4434.0586)
('Test: AUC, AUPR, Erros: ', 0.6923521446547762, 0.5275479214635505, 5085.249)
40((647, 331), (647, 331), 63471.062, 58648.0)
('Error: ', tensor(36050.9648, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7411724679995964, 0.562320517463217)
('Val: AUC, AUPR, Erros: ', 0.7445847857818968, 0.5318763974524212, 4151.9116)
('Test: AUC, AUPR, Erros: ', 0.6992953295900304, 0.5359134452204957, 4909.195)
50((647, 331), (647, 331), 79383.78, 58648.0)
('Error: ', tensor(37267.6992, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7443659237065519, 0.5697922893830479)
('Val: AUC, AUPR, Erros: ', 0.7475344924088649, 0.539203414259542, 4445.856)
('Test: AUC, AUPR, Erros: ', 0.7003448546572194, 0.5394228359474831, 5075.3804)
60((647, 331), (647, 331), 63232.426, 58648.0)
('Error: ', tensor(35035.8438, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7496786417524801, 0.5754517395298127)
('Val: AUC, AUPR, Erros: ', 0.752214909787136, 0.5434255598052735, 4038.6357)
('Test: AUC, AUPR, Erros: ', 0.7036573441246297, 0.5414013395410482, 4864.405)
70((647, 331), (647, 331), 70104.336, 58648.0)
('Error: ', tensor(35394.0703, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7516195597983141, 0.5792903577841896)
('Val: AUC, AUPR, Erros: ', 0.7535028809424362, 0.5460891333252994, 4139.8774)
('Test: AUC, AUPR, Erros: ', 0.7046962763775129, 0.5429518917461809, 4900.1455)
80((647, 331), (647, 331), 64502.95, 58648.0)
('Error: ', tensor(34766.4375, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7542314693116061, 0.5829360430954411)
('Val: AUC, AUPR, Erros: ', 0.7554734630501715, 0.5479878987728893, 4023.7334)
('Test: AUC, AUPR, Erros: ', 0.7059693713893426, 0.5441066766696764, 4854.3413)
90((647, 331), (647, 331), 67318.03, 58648.0)
('Error: ', tensor(34847.9883, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7558793467893057, 0.5859706379965481)
('Val: AUC, AUPR, Erros: ', 0.7563212628587591, 0.5492672562994063, 4059.2095)
('Test: AUC, AUPR, Erros: ', 0.7067629157120866, 0.5452594911323124, 4864.322)
100((647, 331), (647, 331), 65920.01, 58648.0)
('Error: ', tensor(34630.7891, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7575036263379076, 0.5885417394119716)
('Val: AUC, AUPR, Erros: ', 0.7572501169276602, 0.5502340929855725, 4026.9119)
('Test: AUC, AUPR, Erros: ', 0.7073523392467156, 0.5457525446305408, 4851.284)
110((647, 331), (647, 331), 65387.918, 58648.0)
('Error: ', tensor(34496.2617, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.758972356642458, 0.5910063005014116)
('Val: AUC, AUPR, Erros: ', 0.757955161948093, 0.5509838921788582, 4012.513)
('Test: AUC, AUPR, Erros: ', 0.7077603165044586, 0.5462939340430215, 4846.6133)
120((647, 331), (647, 331), 66065.4, 58648.0)
('Error: ', tensor(34456.5898, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7602137370399881, 0.5931889695314312)
('Val: AUC, AUPR, Erros: ', 0.7582257623877334, 0.5512580989530185, 4018.6343)
('Test: AUC, AUPR, Erros: ', 0.7079933885314202, 0.5465638972466991, 4847.725)
130((647, 331), (647, 331), 65606.9, 58648.0)
('Error: ', tensor(34343.7227, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7614151641107266, 0.595165764174332)
('Val: AUC, AUPR, Erros: ', 0.7587384623452906, 0.5514642968542045, 4007.5825)
('Test: AUC, AUPR, Erros: ', 0.7081517721838559, 0.5465404694142844, 4844.8906)
140((647, 331), (647, 331), 65766.2, 58648.0)
('Error: ', tensor(34280.8047, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7624947060465949, 0.5969962764308789)
('Val: AUC, AUPR, Erros: ', 0.7589555360915877, 0.5515111245102593, 4007.4604)
('Test: AUC, AUPR, Erros: ', 0.7082964514246057, 0.5464487550684183, 4845.014)
150((647, 331), (647, 331), 66177.3, 58648.0)
('Error: ', tensor(34242.1953, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7635096704984472, 0.5986479866762215)
('Val: AUC, AUPR, Erros: ', 0.7590019365772361, 0.5512144491026818, 4012.2014)
('Test: AUC, AUPR, Erros: ', 0.7081375792848396, 0.5460608892075584, 4848.011)
160((647, 331), (647, 331), 65772.79, 58648.0)
('Error: ', tensor(34142.3438, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7646084187276256, 0.600316744796135)
('Val: AUC, AUPR, Erros: ', 0.7593083165994495, 0.5511016328695648, 4004.426)
('Test: AUC, AUPR, Erros: ', 0.7085751434841197, 0.5459002042048322, 4845.1914)

Validation:  [0.7593083165994495, 0.5511016328695648, 4004.426, 0.7085751434841197, 0.5459002042048322, 4845.1914]
Train: 0.7646 0.6003
Test: 0.7086 0.5459
3
[0.5862192303761748, 0.5894241686942416, 0.5881596699909957, 0.5919504194519659, 0.5947770806807459, 0.5947390868844831, 0.59133083390297, 0.5944003008635488, 0.5981041974424258, 0.5993179208234778, 0.6003660137343039, 0.6033173349060383, 0.6040632320875043, 0.6049632939138191, 0.606736996399718, 0.6088569400681112, 0.6155250679171145, 0.6185272424832218, 0.6213352118027716, 0.6233368821842104, 0.6239784291818077, 0.6274353897980964, 0.6289958923728802, 0.6319601156119272, 0.6333878931069341, 0.638763642884073, 0.639786079014875, 0.6410317921088158, 0.6434452380006946, 0.6441795603793736, 0.6487766631843517, 0.6506283402475317, 0.6538824610150078, 0.6559803489669501, 0.659576589454069, 0.6612486758866691, 0.6620649147893025, 0.665922161064405, 0.665922161064405, 0.6685022982154831, 0.6697783802322768, 0.6713595486273503, 0.6726140572304942, 0.6780652644682276, 0.6820171980659356, 0.6820171980659356, 0.6825858626810852, 0.6825858626810852, 0.6852430653655425, 0.6864463660398635, 0.6864463660398635, 0.6890168128528704, 0.6890168128528704, 0.6890168128528704, 0.6890168128528704, 0.6890168128528704, 0.6890168128528704, 0.6890168128528704, 0.6919747675352718, 0.6919747675352718, 0.6932323322069851, 0.6950415649857778, 0.6950415649857778, 0.6950415649857778, 0.6950415649857778, 0.6950415649857778, 0.6950415649857778, 0.6973635370489206, 0.6973635370489206, 0.6973635370489206, 0.7037198067217518, 0.7037198067217518, 0.7037198067217518, 0.706130442823548, 0.706130442823548, 0.706130442823548, 0.706130442823548, 0.706130442823548, 0.7085751434841197, 0.7085751434841197, 0.7085751434841197, 0.7085751434841197, 0.7085751434841197, 0.7085751434841197, 0.7085751434841197, 0.7085751434841197, 0.7085751434841197, 0.7085751434841197, 0.7085751434841197, 0.7085751434841197]
[0.17617240719659027, 0.19073035537260397, 0.20517911280260587, 0.21997251565456027, 0.23100854006812296, 0.23548832173727358, 0.23245985694131882, 0.24082911332228546, 0.2500567479386283, 0.25356082297747107, 0.2568412425248707, 0.26402382861976437, 0.26629956276085603, 0.2691315901617465, 0.27414954006725645, 0.2786110903750245, 0.2929880075383781, 0.30148272281776667, 0.30774297278295504, 0.3128113433586186, 0.3150099556219613, 0.3233172023392848, 0.3251610775957223, 0.33158909258746283, 0.3349306399506882, 0.3488507073326114, 0.35069389460806133, 0.3530763944428057, 0.35948301380997966, 0.3621369981749206, 0.3738911388962206, 0.37753783138433483, 0.3860021854193587, 0.3913459050023561, 0.40187006626451865, 0.40595530472848185, 0.4075349451227656, 0.41688903890606893, 0.41688903890606893, 0.42551148262967875, 0.4282822086968599, 0.4334166576590448, 0.43688505784775494, 0.4532433790988972, 0.46534862318708486, 0.46534862318708486, 0.4667399598157386, 0.4667399598157386, 0.47490249759475917, 0.47804145279270804, 0.47804145279270804, 0.48512377584905475, 0.48512377584905475, 0.48512377584905475, 0.48512377584905475, 0.48512377584905475, 0.48512377584905475, 0.48512377584905475, 0.4945639549171437, 0.4945639549171437, 0.4973073877332011, 0.5030658302117721, 0.5030658302117721, 0.5030658302117721, 0.5030658302117721, 0.5030658302117721, 0.5030658302117721, 0.5107125099803902, 0.5107125099803902, 0.5107125099803902, 0.5299490667076343, 0.5299490667076343, 0.5299490667076343, 0.5376380590748804, 0.5376380590748804, 0.5376380590748804, 0.5376380590748804, 0.5376380590748804, 0.5459002042048322, 0.5459002042048322, 0.5459002042048322, 0.5459002042048322, 0.5459002042048322, 0.5459002042048322, 0.5459002042048322, 0.5459002042048322, 0.5459002042048322, 0.5459002042048322, 0.5459002042048322, 0.5459002042048322]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
647 80 331
Num Drug-SE:  65037.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_3_4
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((647, 3826), (80, 3826), (647, 331), (80, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19628.0)
('VALIDATE SUM PROTEIN TEST: ', 2266.0)
(647, 3826) (647, 331)
0((647, 331), (647, 331), 60428.33, 58681.0)
('Error: ', tensor(42590.2227, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5197517050135254, 0.29018107833910395)
('Val: AUC, AUPR, Erros: ', 0.5243460582784409, 0.31351859119580255, 5559.793)
('Test: AUC, AUPR, Erros: ', 0.5199218784692865, 0.25286294560277117, 4874.5854)
10((647, 331), (647, 331), 57570.516, 58681.0)
('Error: ', tensor(41670.6406, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6963207059289906, 0.5033312674615694)
('Val: AUC, AUPR, Erros: ', 0.689885964101442, 0.5198061610823712, 5458.014)
('Test: AUC, AUPR, Erros: ', 0.7075168606934052, 0.48109713561939754, 4738.0376)
20((647, 331), (647, 331), 77811.734, 58681.0)
('Error: ', tensor(38882.9492, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7324677098498673, 0.5467373835399926)
('Val: AUC, AUPR, Erros: ', 0.7190630979722257, 0.5545975583137799, 5034.0713)
('Test: AUC, AUPR, Erros: ', 0.7388637583545893, 0.5202682915020366, 4587.6157)
30((647, 331), (647, 331), 40485.508, 58681.0)
('Error: ', tensor(40045.6992, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7446236459084898, 0.5574700594087038)
('Val: AUC, AUPR, Erros: ', 0.7254708179156586, 0.559332132372315, 5351.207)
('Test: AUC, AUPR, Erros: ', 0.7453822760496001, 0.5268578451297972, 4416.3496)
40((647, 331), (647, 331), 70073.055, 58681.0)
('Error: ', tensor(35788.9180, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7516231984817625, 0.5728286230859824)
('Val: AUC, AUPR, Erros: ', 0.7313083348884608, 0.5695790490912183, 4729.298)
('Test: AUC, AUPR, Erros: ', 0.7516080367798942, 0.5394716366028793, 4183.2754)
50((647, 331), (647, 331), 70476.86, 58681.0)
('Error: ', tensor(35571.8164, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7534731968663058, 0.57843032897629)
('Val: AUC, AUPR, Erros: ', 0.732364183708337, 0.5718390302992262, 4724.016)
('Test: AUC, AUPR, Erros: ', 0.7524259323159282, 0.5414150854502577, 4179.47)
60((647, 331), (647, 331), 68907.3, 58681.0)
('Error: ', tensor(35199.2070, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7551481627799642, 0.5829500894748506)
('Val: AUC, AUPR, Erros: ', 0.7332395449484608, 0.5731619463995574, 4701.084)
('Test: AUC, AUPR, Erros: ', 0.7532787904419909, 0.5426743078138894, 4135.6836)
70((647, 331), (647, 331), 68664.03, 58681.0)
('Error: ', tensor(34958.9531, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7575380451930348, 0.5877811396287743)
('Val: AUC, AUPR, Erros: ', 0.7342847918461325, 0.574142535696484, 4691.894)
('Test: AUC, AUPR, Erros: ', 0.7542007841189532, 0.5435726064434503, 4121.5933)
80((647, 331), (647, 331), 68589.6, 58681.0)
('Error: ', tensor(34750.3750, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.760104208393539, 0.5922907613530083)
('Val: AUC, AUPR, Erros: ', 0.7352539235832498, 0.5747548964501099, 4686.4736)
('Test: AUC, AUPR, Erros: ', 0.7548623448089435, 0.5435364934873944, 4115.036)
90((647, 331), (647, 331), 68341.28, 58681.0)
('Error: ', tensor(34548.5781, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7626325002742186, 0.5962987253955827)
('Val: AUC, AUPR, Erros: ', 0.7361021410851888, 0.5751184567127678, 4681.237)
('Test: AUC, AUPR, Erros: ', 0.7556328469592992, 0.5434753874489084, 4105.591)
100((647, 331), (647, 331), 68251.664, 58681.0)
('Error: ', tensor(34375.6406, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7653442647648092, 0.6000546513574975)
('Val: AUC, AUPR, Erros: ', 0.737006477335096, 0.5753410932930516, 4679.29)
('Test: AUC, AUPR, Erros: ', 0.7563118342175303, 0.5431317513380842, 4101.517)
110((647, 331), (647, 331), 68251.47, 58681.0)
('Error: ', tensor(34221.4766, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7681149831390194, 0.603579771815733)
('Val: AUC, AUPR, Erros: ', 0.7379023313764441, 0.5753169559496952, 4680.9546)
('Test: AUC, AUPR, Erros: ', 0.75685450490158, 0.5426741273458355, 4101.263)
120((647, 331), (647, 331), 68304.305, 58681.0)
('Error: ', tensor(34078.6055, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7708358254634013, 0.6069261895642667)
('Val: AUC, AUPR, Erros: ', 0.7385853017714232, 0.5750557926621223, 4684.024)
('Test: AUC, AUPR, Erros: ', 0.7573639564342362, 0.5421986056562891, 4101.823)
130((647, 331), (647, 331), 68106.91, 58681.0)
('Error: ', tensor(33922.8125, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7734476104741721, 0.6100538811602213)
('Val: AUC, AUPR, Erros: ', 0.7391005665940911, 0.5745497178791574, 4687.078)
('Test: AUC, AUPR, Erros: ', 0.7574851058741029, 0.5412819609823916, 4100.8975)
140((647, 331), (647, 331), 68001.68, 58681.0)
('Error: ', tensor(33788.4570, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.775877807351845, 0.6129375126552667)
('Val: AUC, AUPR, Erros: ', 0.7394080256920026, 0.5737307094099171, 4692.819)
('Test: AUC, AUPR, Erros: ', 0.7577307352688973, 0.5406998160493679, 4100.8066)
150((647, 331), (647, 331), 67861.97, 58681.0)
('Error: ', tensor(33655.7188, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7782810366352424, 0.6157174479571528)
('Val: AUC, AUPR, Erros: ', 0.7396733286493923, 0.5727892596073701, 4700.988)
('Test: AUC, AUPR, Erros: ', 0.7574382128474947, 0.5396025958724702, 4103.68)
160((647, 331), (647, 331), 67856.77, 58681.0)
('Error: ', tensor(33544.8906, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.780466774189209, 0.6183180167011009)
('Val: AUC, AUPR, Erros: ', 0.7397159543467344, 0.5718291162992776, 4709.993)
('Test: AUC, AUPR, Erros: ', 0.757297400859792, 0.5390736323867639, 4107.0166)

Validation:  [0.737006477335096, 0.5753410932930516, 4679.29, 0.7563118342175303, 0.5431317513380842, 4101.517]
Train: 0.7653 0.6001
Test: 0.7563 0.5431
4
[0.590740471341286, 0.6213009884535725, 0.6269019599628194, 0.6214177856621856, 0.6213127778407647, 0.6169008851545936, 0.6160864935123481, 0.6240963338832161, 0.6281081729238969, 0.6289957170125726, 0.6313790823091434, 0.6352021565464807, 0.6388917260598084, 0.6407271688503469, 0.6492217820162342, 0.6532660912815582, 0.6583137817334853, 0.6593630890220469, 0.6611595056435546, 0.6644713073392277, 0.6647417856266051, 0.6684530256478268, 0.6695765696571101, 0.6720208619422136, 0.6740463038812126, 0.6790993656226169, 0.6811841314910674, 0.6823056457332141, 0.683327761260605, 0.6840289325660528, 0.6908487275009395, 0.6932362957467809, 0.6973808491248787, 0.7008564692141777, 0.7052166560598315, 0.7066449353727399, 0.7075803474171719, 0.710806692861009, 0.710806692861009, 0.7140098155656732, 0.7147770306864345, 0.7172236183872822, 0.7184334147822943, 0.7240944761870778, 0.7282503178252113, 0.7282503178252113, 0.7287577979431685, 0.7287577979431685, 0.7307766087541577, 0.731958566996264, 0.731958566996264, 0.7348366023575261, 0.7348366023575261, 0.7348366023575261, 0.7348366023575261, 0.7348366023575261, 0.7348366023575261, 0.7348366023575261, 0.7383938702657831, 0.7383938702657831, 0.7400459776967339, 0.7414754622243026, 0.7414754622243026, 0.7414754622243026, 0.7414754622243026, 0.7414754622243026, 0.7414754622243026, 0.7437293862341267, 0.7437293862341267, 0.7437293862341267, 0.7511543042595487, 0.7511543042595487, 0.7511543042595487, 0.7536490709446125, 0.7536490709446125, 0.7536490709446125, 0.7536490709446125, 0.7536490709446125, 0.7563118342175303, 0.7563118342175303, 0.7563118342175303, 0.7563118342175303, 0.7563118342175303, 0.7563118342175303, 0.7563118342175303, 0.7563118342175303, 0.7563118342175303, 0.7563118342175303, 0.7563118342175303, 0.7563118342175303]
[0.12980325927005212, 0.14427717914117022, 0.15501475580650387, 0.15966769653116467, 0.16385144571299873, 0.15957459753629472, 0.1629800026915083, 0.17844484771413552, 0.18925376604941382, 0.1894793360909225, 0.19525868726798468, 0.20411371699869718, 0.21048168807928133, 0.2157182531981668, 0.23409194302754258, 0.24341630632845818, 0.2522522274828166, 0.2532342926247585, 0.25697589915281616, 0.2661822449156323, 0.26678254797085355, 0.2758434171134956, 0.279232909181484, 0.2862482604944106, 0.29123479866175755, 0.3039064579798215, 0.3078802420136597, 0.3114570529630416, 0.3130240664324241, 0.31515447695127546, 0.3349793933343329, 0.34155972918334065, 0.35382405448424675, 0.3631324321260923, 0.3769876729315559, 0.3806287660743511, 0.3825437385561653, 0.3894401583720251, 0.3894401583720251, 0.40126875449104993, 0.40346047939626906, 0.4112851083798556, 0.4147355447178397, 0.43439431367529135, 0.4454316609624487, 0.4454316609624487, 0.44657408652657593, 0.44657408652657593, 0.4519522322549237, 0.45599532090759476, 0.45599532090759476, 0.4650741432153868, 0.4650741432153868, 0.4650741432153868, 0.4650741432153868, 0.4650741432153868, 0.4650741432153868, 0.4650741432153868, 0.4780172488516675, 0.4780172488516675, 0.48391392696146196, 0.488681403234575, 0.488681403234575, 0.488681403234575, 0.488681403234575, 0.488681403234575, 0.488681403234575, 0.49660193192408614, 0.49660193192408614, 0.49660193192408614, 0.5248741922932064, 0.5248741922932064, 0.5248741922932064, 0.5329743409359322, 0.5329743409359322, 0.5329743409359322, 0.5329743409359322, 0.5329743409359322, 0.5431317513380842, 0.5431317513380842, 0.5431317513380842, 0.5431317513380842, 0.5431317513380842, 0.5431317513380842, 0.5431317513380842, 0.5431317513380842, 0.5431317513380842, 0.5431317513380842, 0.5431317513380842, 0.5431317513380842]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  66118.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_3_5
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19364.0)
('VALIDATE SUM PROTEIN TEST: ', 2749.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 54560.06, 58247.0)
('Error: ', tensor(42397.9297, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5307690396060039, 0.3043233925813427)
('Val: AUC, AUPR, Erros: ', 0.5270080590637563, 0.2820374658481973, 5065.8257)
('Test: AUC, AUPR, Erros: ', 0.5367720712164754, 0.33057133678875483, 5592.1016)
10((646, 331), (646, 331), 59910.305, 58247.0)
('Error: ', tensor(41813.6641, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6621729480978007, 0.43935842890259025)
('Val: AUC, AUPR, Erros: ', 0.6602232861680802, 0.41199766478869626, 5022.121)
('Test: AUC, AUPR, Erros: ', 0.6534242632351633, 0.45374024673236607, 5493.1987)
20((646, 331), (646, 331), 65662.52, 58247.0)
('Error: ', tensor(41103.4727, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.693399338831651, 0.48519656602502853)
('Val: AUC, AUPR, Erros: ', 0.6935912284737256, 0.46235091019088037, 4968.3877)
('Test: AUC, AUPR, Erros: ', 0.6830477980669553, 0.4976935020913458, 5377.831)
30((646, 331), (646, 331), 69996.94, 58247.0)
('Error: ', tensor(40078.8281, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7109917820943815, 0.5138157878062041)
('Val: AUC, AUPR, Erros: ', 0.7118948226600657, 0.49202882161964573, 4870.948)
('Test: AUC, AUPR, Erros: ', 0.6986707081198582, 0.5239236535482882, 5233.7773)
40((646, 331), (646, 331), 74061.12, 58247.0)
('Error: ', tensor(38529.1367, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7236478968896057, 0.5348906117327675)
('Val: AUC, AUPR, Erros: ', 0.7237865778487815, 0.5127278660633807, 4714.656)
('Test: AUC, AUPR, Erros: ', 0.7091374751017496, 0.5420308676235595, 5035.3813)
50((646, 331), (646, 331), 72280.16, 58247.0)
('Error: ', tensor(36862.7539, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7334348740472971, 0.5499272779497694)
('Val: AUC, AUPR, Erros: ', 0.732498921051894, 0.5266343920667393, 4513.5537)
('Test: AUC, AUPR, Erros: ', 0.7169312429289774, 0.5533577412135879, 4852.8945)
60((646, 331), (646, 331), 70052.81, 58247.0)
('Error: ', tensor(36008.7305, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7400849796434672, 0.5597401545449124)
('Val: AUC, AUPR, Erros: ', 0.7383903822929958, 0.535811596635847, 4405.2666)
('Test: AUC, AUPR, Erros: ', 0.721820687788048, 0.5596198074348575, 4772.5386)
70((646, 331), (646, 331), 68337.17, 58247.0)
('Error: ', tensor(35522.8984, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7445184270731615, 0.566369180522491)
('Val: AUC, AUPR, Erros: ', 0.742041335243061, 0.5414546395064237, 4347.143)
('Test: AUC, AUPR, Erros: ', 0.724867165729543, 0.5635118412926174, 4736.839)
80((646, 331), (646, 331), 66827.35, 58247.0)
('Error: ', tensor(35192.1602, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7478739035575594, 0.5713845845220035)
('Val: AUC, AUPR, Erros: ', 0.7448500834065322, 0.5453266005417979, 4306.2173)
('Test: AUC, AUPR, Erros: ', 0.7270673211662664, 0.5659494213370757, 4714.7285)
90((646, 331), (646, 331), 66094.37, 58247.0)
('Error: ', tensor(34972.0312, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7505421116554664, 0.5755015405661651)
('Val: AUC, AUPR, Erros: ', 0.7465114501643673, 0.5477451551677417, 4286.5674)
('Test: AUC, AUPR, Erros: ', 0.7285503124095684, 0.5677487695107558, 4703.021)
100((646, 331), (646, 331), 65858.78, 58247.0)
('Error: ', tensor(34815.7344, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7527342809944433, 0.5790276511353731)
('Val: AUC, AUPR, Erros: ', 0.7479432898843549, 0.5495301980199847, 4277.751)
('Test: AUC, AUPR, Erros: ', 0.729735088116362, 0.5692202678848124, 4695.5396)
110((646, 331), (646, 331), 65930.65, 58247.0)
('Error: ', tensor(34692.5234, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7547744317417362, 0.5822617347572526)
('Val: AUC, AUPR, Erros: ', 0.7488844996994688, 0.5504992737440106, 4274.1426)
('Test: AUC, AUPR, Erros: ', 0.7307233811257209, 0.5703952258619904, 4691.416)
120((646, 331), (646, 331), 65783.27, 58247.0)
('Error: ', tensor(34570.9141, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7565286153585273, 0.5850523556320303)
('Val: AUC, AUPR, Erros: ', 0.7495131621370463, 0.5510514251886446, 4271.8994)
('Test: AUC, AUPR, Erros: ', 0.7314140187127784, 0.5710919438604739, 4688.061)
130((646, 331), (646, 331), 65954.81, 58247.0)
('Error: ', tensor(34474.9609, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7582524792118656, 0.5877500806418119)
('Val: AUC, AUPR, Erros: ', 0.7502011032745515, 0.5516279364499868, 4273.2534)
('Test: AUC, AUPR, Erros: ', 0.7329180125618524, 0.5731454378203111, 4679.4263)
140((646, 331), (646, 331), 65791.516, 58247.0)
('Error: ', tensor(34358.5078, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7599812045142572, 0.5903219175500292)
('Val: AUC, AUPR, Erros: ', 0.7506222994574402, 0.5518207466630174, 4269.939)
('Test: AUC, AUPR, Erros: ', 0.733440283843073, 0.5732175725385028, 4677.7896)
150((646, 331), (646, 331), 66071.17, 58247.0)
('Error: ', tensor(34282.1523, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7615686401912608, 0.592680817195741)
('Val: AUC, AUPR, Erros: ', 0.7510623160850474, 0.551848100041048, 4275.389)
('Test: AUC, AUPR, Erros: ', 0.733946368829906, 0.5736538646365584, 4678.725)
160((646, 331), (646, 331), 66231.086, 58247.0)
('Error: ', tensor(34191.8867, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7633319889932458, 0.5950965878517758)
('Val: AUC, AUPR, Erros: ', 0.7512850939503212, 0.5515401286513293, 4280.554)
('Test: AUC, AUPR, Erros: ', 0.7350366328107254, 0.5745060239388395, 4675.814)

Validation:  [0.7506222994574402, 0.5518207466630174, 4269.939, 0.733440283843073, 0.5732175725385028, 4677.7896]
Train: 0.7600 0.5903
Test: 0.7334 0.5732
5
[0.5684537847090148, 0.5783777056277056, 0.5884811053777259, 0.5914031295207561, 0.5950107642259601, 0.5993339281214458, 0.6016702723525154, 0.6130798238357018, 0.6140336150034972, 0.6139128385655137, 0.6170148552379784, 0.6200612915705414, 0.6213580852734477, 0.6239076675083114, 0.6253592524819991, 0.6289617247466354, 0.6326455889779984, 0.6368367064077711, 0.6396350022894507, 0.6427997970964823, 0.6437102950340917, 0.6475602868624855, 0.650019833505991, 0.6544254667502393, 0.6557490968904565, 0.6607606435365456, 0.6630673283309106, 0.6632294871907956, 0.665047092210053, 0.6661331010090799, 0.6716404966298808, 0.6740642304826189, 0.678137133785049, 0.6809048095465297, 0.6846563012409783, 0.686503540161094, 0.687942703760022, 0.6918957488808716, 0.6918957488808716, 0.6941737427147894, 0.6950554568555907, 0.697263464108597, 0.6983744807769301, 0.7029988369303677, 0.7059485094106084, 0.7059485094106084, 0.7068695142714688, 0.7068695142714688, 0.7095124404160891, 0.71059566764464, 0.71059566764464, 0.7134636996404996, 0.7134636996404996, 0.7134636996404996, 0.7134636996404996, 0.7134636996404996, 0.7134636996404996, 0.7134636996404996, 0.7168069616224296, 0.7168069616224296, 0.7190340601580761, 0.7209278266329854, 0.7209278266329854, 0.7209278266329854, 0.7209278266329854, 0.7209278266329854, 0.7209278266329854, 0.7228755362479226, 0.7228755362479226, 0.7228755362479226, 0.7290675733080507, 0.7290675733080507, 0.7290675733080507, 0.7311346005565063, 0.7311346005565063, 0.7311346005565063, 0.7311346005565063, 0.7311346005565063, 0.733440283843073, 0.733440283843073, 0.733440283843073, 0.733440283843073, 0.733440283843073, 0.733440283843073, 0.733440283843073, 0.733440283843073, 0.733440283843073, 0.733440283843073, 0.733440283843073, 0.733440283843073]
[0.1439814229755368, 0.16882745779542, 0.1819041017313784, 0.1923055737210159, 0.197238924376807, 0.20595754324629842, 0.21459423784546316, 0.23450694079070905, 0.2436807951533364, 0.24217916366465211, 0.25249004011265475, 0.26212969742968273, 0.26659778554258345, 0.2722710513624881, 0.27612680704752285, 0.28533969864350833, 0.2930172674328076, 0.3050083382579704, 0.30960974248234574, 0.3181420949399921, 0.32029142246709896, 0.32977488165157465, 0.3365911725234477, 0.34846117034224433, 0.3517122392354549, 0.36472632581796194, 0.3707757082299531, 0.36968713459436453, 0.3750433178452538, 0.378385647390714, 0.3927559305085197, 0.3976741735763747, 0.40951296084191613, 0.41771737029055944, 0.42673978044878513, 0.4318257198056311, 0.4356162943483188, 0.4455045227190586, 0.4455045227190586, 0.45184103600461933, 0.4533674466990908, 0.46030476492119426, 0.4639097964109195, 0.47659793426091773, 0.48383508429851807, 0.48383508429851807, 0.48604500677267887, 0.48604500677267887, 0.4943667675463792, 0.4975253973075726, 0.4975253973075726, 0.5066392136075497, 0.5066392136075497, 0.5066392136075497, 0.5066392136075497, 0.5066392136075497, 0.5066392136075497, 0.5066392136075497, 0.5178904979089538, 0.5178904979089538, 0.525367471256045, 0.5316822923702742, 0.5316822923702742, 0.5316822923702742, 0.5316822923702742, 0.5316822923702742, 0.5316822923702742, 0.5376131680959422, 0.5376131680959422, 0.5376131680959422, 0.5585213289584441, 0.5585213289584441, 0.5585213289584441, 0.5653514448746669, 0.5653514448746669, 0.5653514448746669, 0.5653514448746669, 0.5653514448746669, 0.5732175725385028, 0.5732175725385028, 0.5732175725385028, 0.5732175725385028, 0.5732175725385028, 0.5732175725385028, 0.5732175725385028, 0.5732175725385028, 0.5732175725385028, 0.5732175725385028, 0.5732175725385028, 0.5732175725385028]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  66738.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_3_6
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19992.0)
('VALIDATE SUM PROTEIN TEST: ', 2530.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 61859.816, 59948.0)
('Error: ', tensor(43128.6133, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5264179648777139, 0.2871723658718928)
('Val: AUC, AUPR, Erros: ', 0.5221436509309374, 0.2344159653580589, 4840.6323)
('Test: AUC, AUPR, Erros: ', 0.5324047048095818, 0.26321494414129354, 5100.6426)
10((646, 331), (646, 331), 63113.656, 59948.0)
('Error: ', tensor(42564.8281, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.679895183020595, 0.49443181647656237)
('Val: AUC, AUPR, Erros: ', 0.6720446991585802, 0.42602713342935855, 4795.196)
('Test: AUC, AUPR, Erros: ', 0.6829163362269323, 0.4733934895051358, 5043.0317)
20((646, 331), (646, 331), 63575.05, 59948.0)
('Error: ', tensor(41186.0859, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7222510559767654, 0.5451396567940207)
('Val: AUC, AUPR, Erros: ', 0.717297346149899, 0.47580618950391207, 4650.1304)
('Test: AUC, AUPR, Erros: ', 0.7244222285304407, 0.52283598708491, 4882.1475)
30((646, 331), (646, 331), 53971.367, 59948.0)
('Error: ', tensor(39979.3828, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7355038872345098, 0.5564415327187715)
('Val: AUC, AUPR, Erros: ', 0.730528251076499, 0.4862152486268524, 4401.4736)
('Test: AUC, AUPR, Erros: ', 0.7364331810950491, 0.5322856078072251, 4668.1064)
40((646, 331), (646, 331), 52556.664, 59948.0)
('Error: ', tensor(37937.5703, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7439440975699348, 0.5672490297603772)
('Val: AUC, AUPR, Erros: ', 0.7364467676447962, 0.491328168446744, 4181.8936)
('Test: AUC, AUPR, Erros: ', 0.7423489099332299, 0.5376812203422314, 4421.8955)
50((646, 331), (646, 331), 53425.05, 59948.0)
('Error: ', tensor(36556.5234, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7485297352932829, 0.5754696392980786)
('Val: AUC, AUPR, Erros: ', 0.7392694333012682, 0.49577739002313426, 4069.321)
('Test: AUC, AUPR, Erros: ', 0.7458062259958413, 0.5427625571102753, 4275.485)
60((646, 331), (646, 331), 53360.65, 59948.0)
('Error: ', tensor(35993.9531, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7511460967099061, 0.5812655690269496)
('Val: AUC, AUPR, Erros: ', 0.74087957462516, 0.498769371553962, 4031.766)
('Test: AUC, AUPR, Erros: ', 0.7478405148820543, 0.545913285611886, 4222.373)
70((646, 331), (646, 331), 53655.305, 59948.0)
('Error: ', tensor(35646.1797, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7531663401053976, 0.5859686740907826)
('Val: AUC, AUPR, Erros: ', 0.7417190785722771, 0.501089462354179, 4017.6052)
('Test: AUC, AUPR, Erros: ', 0.7490363579213843, 0.547786550064828, 4198.0947)
80((646, 331), (646, 331), 53935.145, 59948.0)
('Error: ', tensor(35390.8477, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7550881645678766, 0.5901861153198147)
('Val: AUC, AUPR, Erros: ', 0.7420874505329476, 0.5024945709538999, 4011.4521)
('Test: AUC, AUPR, Erros: ', 0.7498132520500014, 0.5488728533009193, 4185.4106)
90((646, 331), (646, 331), 53687.85, 59948.0)
('Error: ', tensor(35229.5664, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7574067788547273, 0.5942159322230222)
('Val: AUC, AUPR, Erros: ', 0.7423415474087899, 0.5034906496603819, 4006.75)
('Test: AUC, AUPR, Erros: ', 0.750508600726233, 0.5492513508035769, 4180.1807)
100((646, 331), (646, 331), 53338.703, 59948.0)
('Error: ', tensor(35090.5117, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7598317825422055, 0.598079351211302)
('Val: AUC, AUPR, Erros: ', 0.7423317205445537, 0.5039315239955666, 4004.4644)
('Test: AUC, AUPR, Erros: ', 0.7509548185009569, 0.5492831898185113, 4177.9565)
110((646, 331), (646, 331), 53098.203, 59948.0)
('Error: ', tensor(34952.9648, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7625403530818223, 0.6018059966879541)
('Val: AUC, AUPR, Erros: ', 0.742291298093824, 0.5041395867179451, 4003.1985)
('Test: AUC, AUPR, Erros: ', 0.7512222769920742, 0.5487847299103632, 4178.302)
120((646, 331), (646, 331), 52414.227, 59948.0)
('Error: ', tensor(34856.7188, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7655955656268029, 0.6057117772790626)
('Val: AUC, AUPR, Erros: ', 0.7417220937667373, 0.5040123880032397, 4003.1013)
('Test: AUC, AUPR, Erros: ', 0.7512869587080842, 0.5478707694271113, 4182.3594)
130((646, 331), (646, 331), 52169.168, 59948.0)
('Error: ', tensor(34730.2383, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7688552905059429, 0.6094825764880675)
('Val: AUC, AUPR, Erros: ', 0.7404181831301913, 0.5030773782054289, 4007.748)
('Test: AUC, AUPR, Erros: ', 0.7513001922355605, 0.5468815506503351, 4186.146)
140((646, 331), (646, 331), 51912.492, 59948.0)
('Error: ', tensor(34601.9375, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7720233985320627, 0.6130437574322769)
('Val: AUC, AUPR, Erros: ', 0.7383993259155885, 0.501736659995613, 4015.5828)
('Test: AUC, AUPR, Erros: ', 0.7509565876301164, 0.5455856418743337, 4191.575)
150((646, 331), (646, 331), 52928.53, 59948.0)
('Error: ', tensor(34375.7344, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7744216460562585, 0.6158846837469981)
('Val: AUC, AUPR, Erros: ', 0.736908080619076, 0.5008042780131254, 4025.4468)
('Test: AUC, AUPR, Erros: ', 0.7504059434206748, 0.5444062165378223, 4194.415)
160((646, 331), (646, 331), 51741.82, 59948.0)
('Error: ', tensor(34361.9180, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7772473050145411, 0.6188128551640275)
('Val: AUC, AUPR, Erros: ', 0.7348640771538009, 0.4984033610206485, 4034.2698)
('Test: AUC, AUPR, Erros: ', 0.7492469615298635, 0.5421415382938668, 4206.0005)

Validation:  [0.7417220937667373, 0.5040123880032397, 4003.1013, 0.7512869587080842, 0.5478707694271113, 4182.3594]
Train: 0.7656 0.6057
Test: 0.7513 0.5479
6
[0.5717439019545527, 0.5938343606757291, 0.5772015132308668, 0.5740785677694196, 0.5872420642256484, 0.5897792166185821, 0.5926136672369516, 0.599801006637544, 0.6071517241873976, 0.6061592261272398, 0.6099093671890967, 0.6150023878767634, 0.6219074407897255, 0.6241217042172585, 0.6324719170142781, 0.6390405029961574, 0.6423778928975212, 0.6501612780479772, 0.6541834989676758, 0.6582347412377347, 0.6588628965383394, 0.6621049996364712, 0.6664969431152556, 0.6682176411906274, 0.6695882463396657, 0.673623768620444, 0.6758158973036452, 0.6765357369934889, 0.6789144722954323, 0.6797082532789229, 0.6847227180792452, 0.6882997394011741, 0.6920649243692535, 0.6944601255044438, 0.6987648748603934, 0.7011524289299256, 0.701849190760454, 0.7050622124993116, 0.7050622124993116, 0.707422326588268, 0.7086839244745861, 0.7119738951202507, 0.7137388837946956, 0.7196330906061773, 0.7238086970410571, 0.7238086970410571, 0.7242893827547869, 0.7242893827547869, 0.7268018762703756, 0.7280604872678667, 0.7280604872678667, 0.7305345275421598, 0.7305345275421598, 0.7305345275421598, 0.7305345275421598, 0.7305345275421598, 0.7305345275421598, 0.7305345275421598, 0.7338891164529976, 0.7338891164529976, 0.7354264281257362, 0.7374930890846894, 0.7374930890846894, 0.7374930890846894, 0.7374930890846894, 0.7374930890846894, 0.7374930890846894, 0.7394040608639634, 0.7394040608639634, 0.7394040608639634, 0.7462523060343325, 0.7462523060343325, 0.7462523060343325, 0.7487410689741367, 0.7487410689741367, 0.7487410689741367, 0.7487410689741367, 0.7487410689741367, 0.7512869587080842, 0.7512869587080842, 0.7512869587080842, 0.7512869587080842, 0.7512869587080842, 0.7512869587080842, 0.7512869587080842, 0.7512869587080842, 0.7512869587080842, 0.7512869587080842, 0.7512869587080842, 0.7512869587080842]
[0.13723116231116977, 0.14251413223809495, 0.13933392674838918, 0.13665378898940952, 0.155210647645147, 0.157640390943875, 0.16429042814117634, 0.1761988403944074, 0.18957505530532934, 0.18687620377437433, 0.19494008828130127, 0.20462399904622466, 0.216472428613435, 0.22031450102488798, 0.2336892274940127, 0.24706917065934603, 0.25202441330660547, 0.26937846305613095, 0.27607371513333606, 0.2837738133726977, 0.28525235762330464, 0.2915221854595212, 0.3008369887223067, 0.30292379095810074, 0.30615292703471997, 0.3127827606915526, 0.3192224500590572, 0.3211764411379608, 0.32726682425610715, 0.3300454868112571, 0.34316368977536027, 0.3513969542666641, 0.3615024690136105, 0.3678387736771531, 0.3805296371559982, 0.3882188465177026, 0.38896980626207683, 0.396399525509312, 0.396399525509312, 0.40261827875520106, 0.40552344607905955, 0.41767841375477305, 0.4240562292935728, 0.4423114394096405, 0.45583636092015084, 0.45583636092015084, 0.45686230210248335, 0.45686230210248335, 0.4638007546088275, 0.46736227981032424, 0.46736227981032424, 0.47335334883176444, 0.47335334883176444, 0.47335334883176444, 0.47335334883176444, 0.47335334883176444, 0.47335334883176444, 0.47335334883176444, 0.48469398822433396, 0.48469398822433396, 0.4896879595502748, 0.49749542157874904, 0.49749542157874904, 0.49749542157874904, 0.49749542157874904, 0.49749542157874904, 0.49749542157874904, 0.5044416062337764, 0.5044416062337764, 0.5044416062337764, 0.5297171868050323, 0.5297171868050323, 0.5297171868050323, 0.5390470023490612, 0.5390470023490612, 0.5390470023490612, 0.5390470023490612, 0.5390470023490612, 0.5478707694271113, 0.5478707694271113, 0.5478707694271113, 0.5478707694271113, 0.5478707694271113, 0.5478707694271113, 0.5478707694271113, 0.5478707694271113, 0.5478707694271113, 0.5478707694271113, 0.5478707694271113, 0.5478707694271113]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  65239.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_3_7
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19823.0)
('VALIDATE SUM PROTEIN TEST: ', 2121.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 41241.82, 59069.0)
('Error: ', tensor(44220.7227, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5174345449904726, 0.2846811905042141)
('Val: AUC, AUPR, Erros: ', 0.519067636499559, 0.29367971190687253, 5705.617)
('Test: AUC, AUPR, Erros: ', 0.5144155387104249, 0.2353015970942753, 4785.8174)
10((646, 331), (646, 331), 60807.406, 59069.0)
('Error: ', tensor(42488.4609, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6522456132012548, 0.3978616914550369)
('Val: AUC, AUPR, Erros: ', 0.6440891266224676, 0.3980147173658879, 5442.1377)
('Test: AUC, AUPR, Erros: ', 0.6564947288668829, 0.3387561398517105, 4798.041)
20((646, 331), (646, 331), 65568.97, 59069.0)
('Error: ', tensor(42080.7500, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.695184236155513, 0.4740842211134081)
('Val: AUC, AUPR, Erros: ', 0.6788047503924353, 0.46119773786839224, 5386.348)
('Test: AUC, AUPR, Erros: ', 0.6999919634074745, 0.4109344994055524, 4810.2246)
30((646, 331), (646, 331), 68953.39, 59069.0)
('Error: ', tensor(41114.7852, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7149813966473118, 0.5116230961647817)
('Val: AUC, AUPR, Erros: ', 0.6958051082534756, 0.49419316349173786, 5271.3184)
('Test: AUC, AUPR, Erros: ', 0.7211159171879982, 0.45061188890344533, 4744.1934)
40((646, 331), (646, 331), 74075.875, 59069.0)
('Error: ', tensor(39713.5039, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7228177504901594, 0.5268679192828709)
('Val: AUC, AUPR, Erros: ', 0.7017920225039784, 0.5063838698822176, 5112.9766)
('Test: AUC, AUPR, Erros: ', 0.7292650023787842, 0.4637727434961244, 4658.6504)
50((646, 331), (646, 331), 78866.99, 59069.0)
('Error: ', tensor(38583.9570, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7300418107037314, 0.5435302902777773)
('Val: AUC, AUPR, Erros: ', 0.7067835416455523, 0.5197543358508574, 5008.87)
('Test: AUC, AUPR, Erros: ', 0.7338709121442217, 0.47602890856322716, 4625.342)
60((646, 331), (646, 331), 76385.0, 59069.0)
('Error: ', tensor(37379.3594, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7360230872042319, 0.5576372923027475)
('Val: AUC, AUPR, Erros: ', 0.7105138618598619, 0.5308604844509799, 4900.8164)
('Test: AUC, AUPR, Erros: ', 0.7376690403209235, 0.48817645683878685, 4484.195)
70((646, 331), (646, 331), 70649.23, 59069.0)
('Error: ', tensor(36085.8047, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7417361638380489, 0.5689340644425145)
('Val: AUC, AUPR, Erros: ', 0.7134991037261458, 0.5391943040819281, 4787.673)
('Test: AUC, AUPR, Erros: ', 0.7406363410866493, 0.4973569329793722, 4290.9883)
80((646, 331), (646, 331), 68943.31, 59069.0)
('Error: ', tensor(35612.1406, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7461081402232784, 0.5755527238480603)
('Val: AUC, AUPR, Erros: ', 0.7151535587895581, 0.5426374300314616, 4753.899)
('Test: AUC, AUPR, Erros: ', 0.742307241719738, 0.5018299616630004, 4231.8115)
90((646, 331), (646, 331), 67947.16, 59069.0)
('Error: ', tensor(35283.8203, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7498121388091497, 0.581074546455218)
('Val: AUC, AUPR, Erros: ', 0.7162949756988417, 0.545192271367825, 4734.2646)
('Test: AUC, AUPR, Erros: ', 0.7432636629728703, 0.5047897547280542, 4199.3833)
100((646, 331), (646, 331), 67979.63, 59069.0)
('Error: ', tensor(35087.6445, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7531509962286516, 0.5857803007140248)
('Val: AUC, AUPR, Erros: ', 0.7165481500892119, 0.5457651814365616, 4733.7114)
('Test: AUC, AUPR, Erros: ', 0.7442438171042716, 0.5072056818672096, 4191.285)
110((646, 331), (646, 331), 67763.27, 59069.0)
('Error: ', tensor(34904.5703, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7560241316724075, 0.5896446325218424)
('Val: AUC, AUPR, Erros: ', 0.7170540050007358, 0.54635317497233, 4727.803)
('Test: AUC, AUPR, Erros: ', 0.7448703533124778, 0.5083198582438824, 4179.769)
120((646, 331), (646, 331), 67556.4, 59069.0)
('Error: ', tensor(34743.3281, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7585974428967037, 0.5930729320958734)
('Val: AUC, AUPR, Erros: ', 0.7170002107220736, 0.5460530852458816, 4727.157)
('Test: AUC, AUPR, Erros: ', 0.7452947144504843, 0.5088294707745117, 4171.4385)
130((646, 331), (646, 331), 67562.77, 59069.0)
('Error: ', tensor(34607.7422, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.761108712514025, 0.596349063948522)
('Val: AUC, AUPR, Erros: ', 0.7169496861982246, 0.5456098843813445, 4729.6514)
('Test: AUC, AUPR, Erros: ', 0.7456015261909292, 0.5091017634749309, 4169.655)
140((646, 331), (646, 331), 67793.555, 59069.0)
('Error: ', tensor(34502.3281, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7634039195263459, 0.5992868235492287)
('Val: AUC, AUPR, Erros: ', 0.7166682420527009, 0.5448437875155857, 4735.696)
('Test: AUC, AUPR, Erros: ', 0.7457667847591657, 0.5092609533553037, 4173.184)
150((646, 331), (646, 331), 67854.63, 59069.0)
('Error: ', tensor(34391.9023, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.765635522688293, 0.6020891685626637)
('Val: AUC, AUPR, Erros: ', 0.7162066480409626, 0.5438844277217577, 4742.362)
('Test: AUC, AUPR, Erros: ', 0.746127143683517, 0.509628186807211, 4170.5107)
160((646, 331), (646, 331), 67839.08, 59069.0)
('Error: ', tensor(34282.3164, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.767658260110374, 0.6045869232027044)
('Val: AUC, AUPR, Erros: ', 0.7158488891805026, 0.543005517103627, 4746.4663)
('Test: AUC, AUPR, Erros: ', 0.7458072778785154, 0.509153059726868, 4172.944)

Validation:  [0.7170002107220736, 0.5460530852458816, 4727.157, 0.7452947144504843, 0.5088294707745117, 4171.4385]
Train: 0.7586 0.5931
Test: 0.7453 0.5088
7
[0.5535351023913928, 0.5555591093282014, 0.5718663857931119, 0.5813598290998621, 0.5825993313617076, 0.585061524063043, 0.5892746799580738, 0.5942862329449101, 0.6009859085742282, 0.6021012098191535, 0.6071988796889413, 0.6094561925866879, 0.6148223627896628, 0.6176048126874892, 0.6228420849206828, 0.626677471636953, 0.6312762614602424, 0.6373987177915319, 0.6439870483752849, 0.6486198355170357, 0.6493250802837168, 0.6539425849586389, 0.6588110966682401, 0.6613890041914355, 0.6634657260903007, 0.6679293817331631, 0.6710456615033963, 0.6718884108517915, 0.6737421858906013, 0.674421064905413, 0.6802120839748308, 0.6832600839868688, 0.6871924096834624, 0.6896492132566654, 0.6933811104859678, 0.6945347822296013, 0.6956535446220613, 0.699972516110498, 0.699972516110498, 0.7026246775054631, 0.7037027996146578, 0.7065111782593269, 0.7079934273951711, 0.7127853840749306, 0.7155033560806157, 0.7155033560806157, 0.7167527825583778, 0.7167527825583778, 0.7191282883134977, 0.7204193773931903, 0.7204193773931903, 0.7234629119514694, 0.7234629119514694, 0.7234629119514694, 0.7234629119514694, 0.7234629119514694, 0.7234629119514694, 0.7234629119514694, 0.7269319660163088, 0.7269319660163088, 0.7286082828838746, 0.7308062494081271, 0.7308062494081271, 0.7308062494081271, 0.7308062494081271, 0.7308062494081271, 0.7308062494081271, 0.7329517540205428, 0.7329517540205428, 0.7329517540205428, 0.7403554892665901, 0.7403554892665901, 0.7403554892665901, 0.7425167387389313, 0.7425167387389313, 0.7425167387389313, 0.7425167387389313, 0.7425167387389313, 0.7452947144504843, 0.7452947144504843, 0.7452947144504843, 0.7452947144504843, 0.7452947144504843, 0.7452947144504843, 0.7452947144504843, 0.7452947144504843, 0.7452947144504843, 0.7452947144504843, 0.7452947144504843, 0.7452947144504843]
[0.09471291813344385, 0.10584223128247928, 0.11894505430325561, 0.13239765261997608, 0.13590859477998982, 0.14005670843535017, 0.14486153686036135, 0.15202186834308323, 0.16154397345313815, 0.1625946255740828, 0.1729387327548543, 0.1787105113186832, 0.1848606432137862, 0.18847949769558453, 0.19882750976793995, 0.2046575233730311, 0.21432450550382584, 0.22558000768690628, 0.23802213048459736, 0.24854306935580023, 0.2496434549021431, 0.26193056636025347, 0.2737386581394656, 0.2781118925641713, 0.2836448992744147, 0.29486192109486725, 0.3017090152545595, 0.30215499146816194, 0.30574347377065764, 0.30655586301805277, 0.3199262598139355, 0.3268122783008642, 0.33489802715120437, 0.3398523735592024, 0.3497853317624666, 0.352620485965363, 0.35624922897111533, 0.3688773431103437, 0.3688773431103437, 0.3766849880141337, 0.3785789723609482, 0.3859928345280731, 0.390851006742051, 0.4057011390023394, 0.41333739712369516, 0.41333739712369516, 0.4166389108826032, 0.4166389108826032, 0.4221941292147735, 0.4258772864088002, 0.4258772864088002, 0.43443723248358834, 0.43443723248358834, 0.43443723248358834, 0.43443723248358834, 0.43443723248358834, 0.43443723248358834, 0.43443723248358834, 0.44390734626194517, 0.44390734626194517, 0.44876592945864635, 0.4565532429956103, 0.4565532429956103, 0.4565532429956103, 0.4565532429956103, 0.4565532429956103, 0.4565532429956103, 0.46418978774726927, 0.46418978774726927, 0.46418978774726927, 0.49115860966280334, 0.49115860966280334, 0.49115860966280334, 0.49802029064991016, 0.49802029064991016, 0.49802029064991016, 0.49802029064991016, 0.49802029064991016, 0.5088294707745117, 0.5088294707745117, 0.5088294707745117, 0.5088294707745117, 0.5088294707745117, 0.5088294707745117, 0.5088294707745117, 0.5088294707745117, 0.5088294707745117, 0.5088294707745117, 0.5088294707745117, 0.5088294707745117]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
647 81 331
Num Drug-SE:  65156.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_3_8
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((647, 3826), (81, 3826), (647, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19533.0)
('VALIDATE SUM PROTEIN TEST: ', 2699.0)
(647, 3826) (647, 331)
0((647, 331), (647, 331), 47648.0, 57487.0)
('Error: ', tensor(42481.3828, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5285083611095218, 0.2793016324683258)
('Val: AUC, AUPR, Erros: ', 0.5288038240066144, 0.3020206261899915, 5609.598)
('Test: AUC, AUPR, Erros: ', 0.5214181678667326, 0.2931771694695905, 5581.1406)
10((647, 331), (647, 331), 60379.957, 57487.0)
('Error: ', tensor(41500.9531, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6791972037860718, 0.429680975854988)
('Val: AUC, AUPR, Erros: ', 0.677731630982279, 0.45738801785599975, 5408.6304)
('Test: AUC, AUPR, Erros: ', 0.6589600770975488, 0.4276399602761227, 5407.204)
20((647, 331), (647, 331), 53280.156, 57487.0)
('Error: ', tensor(40891.9258, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7033707236408342, 0.4835701910742845)
('Val: AUC, AUPR, Erros: ', 0.7074278711996276, 0.5148952524130704, 5366.6514)
('Test: AUC, AUPR, Erros: ', 0.6866337593546834, 0.48059318338520224, 5364.0337)
30((647, 331), (647, 331), 53801.26, 57487.0)
('Error: ', tensor(39238.3438, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7196363138778922, 0.5210881248976073)
('Val: AUC, AUPR, Erros: ', 0.7222631623581782, 0.5485997473004189, 5142.6177)
('Test: AUC, AUPR, Erros: ', 0.6983365762716154, 0.5089687334015393, 5173.2544)
40((647, 331), (647, 331), 60638.137, 57487.0)
('Error: ', tensor(37242.8047, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7281527408170316, 0.5384060625859385)
('Val: AUC, AUPR, Erros: ', 0.7315364062254097, 0.5646597222581898, 4827.8223)
('Test: AUC, AUPR, Erros: ', 0.7043255409308657, 0.5220649792100431, 4925.1465)
50((647, 331), (647, 331), 63886.125, 57487.0)
('Error: ', tensor(36139.7656, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7351381195211658, 0.5502428547965206)
('Val: AUC, AUPR, Erros: ', 0.7373114037567409, 0.5731424447496726, 4659.0903)
('Test: AUC, AUPR, Erros: ', 0.709082008979319, 0.5320242578059575, 4805.0127)
60((647, 331), (647, 331), 72270.83, 57487.0)
('Error: ', tensor(36126.2930, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7397252406797945, 0.5585143722168406)
('Val: AUC, AUPR, Erros: ', 0.7416240662866239, 0.5787693957306483, 4599.717)
('Test: AUC, AUPR, Erros: ', 0.7112731363933671, 0.5375272758550657, 4815.7637)
70((647, 331), (647, 331), 67106.6, 57487.0)
('Error: ', tensor(35245.7891, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7439183544422284, 0.5641058154480408)
('Val: AUC, AUPR, Erros: ', 0.7443916961639531, 0.5818722001550367, 4527.458)
('Test: AUC, AUPR, Erros: ', 0.7132193251119798, 0.5413778540563489, 4750.5303)
80((647, 331), (647, 331), 65764.46, 57487.0)
('Error: ', tensor(34937.3008, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7470150908284809, 0.5680914365858635)
('Val: AUC, AUPR, Erros: ', 0.7463418481193372, 0.5840617874502722, 4507.405)
('Test: AUC, AUPR, Erros: ', 0.714283357824024, 0.5431623410311686, 4732.477)
90((647, 331), (647, 331), 66312.73, 57487.0)
('Error: ', tensor(34814.5156, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7494544784446725, 0.5718591098567714)
('Val: AUC, AUPR, Erros: ', 0.7475603056399385, 0.5857585693341056, 4501.476)
('Test: AUC, AUPR, Erros: ', 0.7149509361709938, 0.5444986972458945, 4732.468)
100((647, 331), (647, 331), 65519.574, 57487.0)
('Error: ', tensor(34606.2227, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7517764802978499, 0.5751102888428459)
('Val: AUC, AUPR, Erros: ', 0.7484991505960733, 0.5867989076729628, 4493.021)
('Test: AUC, AUPR, Erros: ', 0.7154051698284083, 0.5455231607112134, 4722.821)
110((647, 331), (647, 331), 65639.14, 57487.0)
('Error: ', tensor(34483.1641, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7538387807086129, 0.5783118516573375)
('Val: AUC, AUPR, Erros: ', 0.7493736303847287, 0.5877884035362213, 4488.997)
('Test: AUC, AUPR, Erros: ', 0.7154917774590159, 0.5459604190563305, 4723.0835)
120((647, 331), (647, 331), 65569.766, 57487.0)
('Error: ', tensor(34358.1289, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7557996690072862, 0.5812258740565314)
('Val: AUC, AUPR, Erros: ', 0.7500925613056436, 0.5883780157404191, 4485.976)
('Test: AUC, AUPR, Erros: ', 0.7153563517078521, 0.5459953574028089, 4723.383)
130((647, 331), (647, 331), 65771.22, 57487.0)
('Error: ', tensor(34260.1484, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.757658731769694, 0.5840627966298748)
('Val: AUC, AUPR, Erros: ', 0.7505518446080965, 0.5887744569013371, 4485.9927)
('Test: AUC, AUPR, Erros: ', 0.7152748428511558, 0.546160630362047, 4725.4673)
140((647, 331), (647, 331), 65753.766, 57487.0)
('Error: ', tensor(34154.9414, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7593957525147684, 0.5866756835503206)
('Val: AUC, AUPR, Erros: ', 0.7512091311321625, 0.5893986380926607, 4482.919)
('Test: AUC, AUPR, Erros: ', 0.7150602992515027, 0.546086718877521, 4726.7227)
150((647, 331), (647, 331), 65774.41, 57487.0)
('Error: ', tensor(34062.1172, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7610382206470399, 0.5890105860034571)
('Val: AUC, AUPR, Erros: ', 0.7518521904366413, 0.5901355842769127, 4480.317)
('Test: AUC, AUPR, Erros: ', 0.7145816412068343, 0.5456036401523127, 4730.2856)
160((647, 331), (647, 331), 65498.7, 57487.0)
('Error: ', tensor(33947.7422, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7626906876264866, 0.5913132335142983)
('Val: AUC, AUPR, Erros: ', 0.7520860527263582, 0.5901299344761511, 4479.1675)
('Test: AUC, AUPR, Erros: ', 0.7142536405211668, 0.5453344385688116, 4729.7324)

Validation:  [0.7520860527263582, 0.5901299344761511, 4479.1675, 0.7142536405211668, 0.5453344385688116, 4729.7324]
Train: 0.7627 0.5913
Test: 0.7143 0.5453
8
[0.5511204684280911, 0.559633088251689, 0.5597489445594056, 0.5605627661111686, 0.566145859076959, 0.5695236388652026, 0.5756346943708968, 0.5830462909862446, 0.5866006071112504, 0.5888045447464381, 0.5937826659334651, 0.5975815201861221, 0.6007463811333114, 0.6020598679138183, 0.60780552652159, 0.6127660316553806, 0.6176428504487238, 0.6218633994756353, 0.6249758744035233, 0.6262388842684409, 0.62697820755655, 0.6298612229500185, 0.6319699379459475, 0.6351016176667232, 0.6371457598168326, 0.6414598437102434, 0.6424438650651618, 0.6430616023975029, 0.6451241387349722, 0.6458609616273168, 0.651571894550522, 0.6545513114548025, 0.658808318397401, 0.6619574931016221, 0.6659912662976372, 0.667185025171025, 0.6681566788890205, 0.6712982056050217, 0.6712982056050217, 0.6732153374522358, 0.6740576383520538, 0.6758631251865758, 0.676992512129007, 0.6816822983280407, 0.6856898256295454, 0.6856898256295454, 0.6865082638614857, 0.6865082638614857, 0.6891055657137981, 0.6906699552162749, 0.6906699552162749, 0.6936427191394927, 0.6936427191394927, 0.6936427191394927, 0.6936427191394927, 0.6936427191394927, 0.6936427191394927, 0.6936427191394927, 0.6964218514706952, 0.6964218514706952, 0.6980785962781129, 0.7001726694168882, 0.7001726694168882, 0.7001726694168882, 0.7001726694168882, 0.7001726694168882, 0.7001726694168882, 0.7023717159236333, 0.7023717159236333, 0.7023717159236333, 0.7094042623365528, 0.7094042623365528, 0.7094042623365528, 0.7116856000314533, 0.7116856000314533, 0.7116856000314533, 0.7116856000314533, 0.7116856000314533, 0.7142536405211668, 0.7142536405211668, 0.7142536405211668, 0.7142536405211668, 0.7142536405211668, 0.7142536405211668, 0.7142536405211668, 0.7142536405211668, 0.7142536405211668, 0.7142536405211668, 0.7142536405211668, 0.7142536405211668]
[0.15167696193890295, 0.17164584507579683, 0.16896379376014115, 0.16998451541363635, 0.17888624722433716, 0.18552676806074703, 0.19679025510794812, 0.2121462914722116, 0.21953828744882667, 0.22558246704915985, 0.23490553504751208, 0.24171462607868352, 0.24763785529569943, 0.2519096190558309, 0.26490158953854315, 0.2741916620828185, 0.28191536440191134, 0.2918740372478877, 0.29829901389119995, 0.3014132496127236, 0.3029632251149462, 0.3068579054749798, 0.31218865482353597, 0.32031583261411, 0.3261645605383399, 0.33744333695674816, 0.34057850869837236, 0.3420294354884241, 0.34651267473925396, 0.3482384742908881, 0.3618079544652364, 0.36976309586524697, 0.381984980334641, 0.38994337739529367, 0.4007233071051084, 0.40336387979279553, 0.405635102717951, 0.4134955445940491, 0.4134955445940491, 0.41849042970862155, 0.42059299356223595, 0.42532243827228255, 0.4294574562626263, 0.44316462479326757, 0.4547585423078938, 0.4547585423078938, 0.4567534708313759, 0.4567534708313759, 0.4635883567202751, 0.46785508639674644, 0.46785508639674644, 0.47666620318566777, 0.47666620318566777, 0.47666620318566777, 0.47666620318566777, 0.47666620318566777, 0.47666620318566777, 0.47666620318566777, 0.4837836533714611, 0.4837836533714611, 0.48933183736443686, 0.49691786682534755, 0.49691786682534755, 0.49691786682534755, 0.49691786682534755, 0.49691786682534755, 0.49691786682534755, 0.5051593833650454, 0.5051593833650454, 0.5051593833650454, 0.5296835153008099, 0.5296835153008099, 0.5296835153008099, 0.5366934836782077, 0.5366934836782077, 0.5366934836782077, 0.5366934836782077, 0.5366934836782077, 0.5453344385688116, 0.5453344385688116, 0.5453344385688116, 0.5453344385688116, 0.5453344385688116, 0.5453344385688116, 0.5453344385688116, 0.5453344385688116, 0.5453344385688116, 0.5453344385688116, 0.5453344385688116, 0.5453344385688116]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
647 80 331
Num Drug-SE:  65644.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_3_9
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((647, 3826), (80, 3826), (647, 331), (80, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19758.0)
('VALIDATE SUM PROTEIN TEST: ', 2411.0)
(647, 3826) (647, 331)
0((647, 331), (647, 331), 44924.32, 57892.0)
('Error: ', tensor(43022.2891, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5062126308658172, 0.27283071101807055)
('Val: AUC, AUPR, Erros: ', 0.515819475773855, 0.27930722238094685, 5394.534)
('Test: AUC, AUPR, Erros: ', 0.48894011560423534, 0.2856966560834406, 5666.3184)
10((647, 331), (647, 331), 71018.4, 57892.0)
('Error: ', tensor(42534.5742, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6646815878176214, 0.40943369541175234)
('Val: AUC, AUPR, Erros: ', 0.665345329843195, 0.40835367815364176, 5328.9404)
('Test: AUC, AUPR, Erros: ', 0.6601609528003742, 0.42563799871196767, 5460.358)
20((647, 331), (647, 331), 50024.18, 57892.0)
('Error: ', tensor(40906.9375, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6986249898742534, 0.4801793645872179)
('Val: AUC, AUPR, Erros: ', 0.686103652886559, 0.46252480966001663, 5142.879)
('Test: AUC, AUPR, Erros: ', 0.7029607549982829, 0.5042158927960695, 5357.6885)
30((647, 331), (647, 331), 55735.89, 57892.0)
('Error: ', tensor(38805.8125, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7190388896852319, 0.527153281622429)
('Val: AUC, AUPR, Erros: ', 0.706971163651869, 0.5113274981591913, 4894.4536)
('Test: AUC, AUPR, Erros: ', 0.7254695802138837, 0.5504163210639139, 5038.6704)
40((647, 331), (647, 331), 57324.902, 57892.0)
('Error: ', tensor(36651.1328, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7282792757098111, 0.5447000462008105)
('Val: AUC, AUPR, Erros: ', 0.7133138762012445, 0.5248362288874959, 4663.5103)
('Test: AUC, AUPR, Erros: ', 0.7344612002127904, 0.5674225646791412, 4722.673)
50((647, 331), (647, 331), 45720.605, 57892.0)
('Error: ', tensor(36640.8281, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.736101565908624, 0.5558724406812404)
('Val: AUC, AUPR, Erros: ', 0.7166082522155455, 0.5302046146930404, 4674.162)
('Test: AUC, AUPR, Erros: ', 0.7402898210336317, 0.5774423176192977, 4783.632)
60((647, 331), (647, 331), 53260.81, 57892.0)
('Error: ', tensor(35303.8789, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7416777356332958, 0.5624901601017507)
('Val: AUC, AUPR, Erros: ', 0.7202556756909642, 0.5342979381964957, 4549.709)
('Test: AUC, AUPR, Erros: ', 0.7441246645806414, 0.5819727810485138, 4576.7886)
70((647, 331), (647, 331), 54381.445, 57892.0)
('Error: ', tensor(35067.7773, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7457530673061743, 0.5667513501925573)
('Val: AUC, AUPR, Erros: ', 0.7222063810562547, 0.5365244374010381, 4529.528)
('Test: AUC, AUPR, Erros: ', 0.7462365370758794, 0.5843188371103663, 4555.0137)
80((647, 331), (647, 331), 44499.95, 57892.0)
('Error: ', tensor(35848.2734, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7515434578254232, 0.5736519791218313)
('Val: AUC, AUPR, Erros: ', 0.7242246020210183, 0.5374103026806925, 4613.7793)
('Test: AUC, AUPR, Erros: ', 0.7489454361917433, 0.5866272245474708, 4725.9697)
90((647, 331), (647, 331), 55493.074, 57892.0)
('Error: ', tensor(34564.9414, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7530473952549335, 0.5763822613433773)
('Val: AUC, AUPR, Erros: ', 0.7254887033545487, 0.539164946669588, 4502.858)
('Test: AUC, AUPR, Erros: ', 0.7495745265776448, 0.5877839105714053, 4515.86)
100((647, 331), (647, 331), 46555.9, 57892.0)
('Error: ', tensor(35302.5547, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7570340575985697, 0.5811291919233416)
('Val: AUC, AUPR, Erros: ', 0.7265245517468458, 0.5389217131855712, 4568.7856)
('Test: AUC, AUPR, Erros: ', 0.7517481640102026, 0.5890802899698894, 4667.0903)
110((647, 331), (647, 331), 54417.61, 57892.0)
('Error: ', tensor(34300.4453, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7583821002586086, 0.5841027466509495)
('Val: AUC, AUPR, Erros: ', 0.7277998792698677, 0.5405081314444194, 4492.993)
('Test: AUC, AUPR, Erros: ', 0.751619857288899, 0.5889983068492544, 4516.0156)
120((647, 331), (647, 331), 50495.523, 57892.0)
('Error: ', tensor(34557.1016, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7607169547279323, 0.5869339318187282)
('Val: AUC, AUPR, Erros: ', 0.7276279263027845, 0.5384932054187751, 4518.1357)
('Test: AUC, AUPR, Erros: ', 0.7526312193923635, 0.5898172594423462, 4575.512)
130((647, 331), (647, 331), 52173.383, 57892.0)
('Error: ', tensor(34227.9688, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7625203746072935, 0.5900622150509747)
('Val: AUC, AUPR, Erros: ', 0.728361452848652, 0.5381147901049002, 4505.2007)
('Test: AUC, AUPR, Erros: ', 0.7526622155134677, 0.5889726317533154, 4543.1294)
140((647, 331), (647, 331), 52109.64, 57892.0)
('Error: ', tensor(34183.4922, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7641293260416888, 0.5921548810037135)
('Val: AUC, AUPR, Erros: ', 0.728494561368972, 0.5375631962680945, 4506.115)
('Test: AUC, AUPR, Erros: ', 0.7527603664529505, 0.589402808398511, 4545.0)
150((647, 331), (647, 331), 50213.117, 57892.0)
('Error: ', tensor(34236.5352, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7662073191060026, 0.595043803432664)
('Val: AUC, AUPR, Erros: ', 0.7289121030774353, 0.5363316455514626, 4519.4424)
('Test: AUC, AUPR, Erros: ', 0.7526099285011786, 0.5883145007385735, 4575.14)
160((647, 331), (647, 331), 52158.914, 57892.0)
('Error: ', tensor(33981.8281, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7676077520105364, 0.5971258042894705)
('Val: AUC, AUPR, Erros: ', 0.7286813640352665, 0.535247671854644, 4512.165)
('Test: AUC, AUPR, Erros: ', 0.7532096793364483, 0.5890639384803047, 4542.537)

Validation:  [0.7277998792698677, 0.5405081314444194, 4492.993, 0.751619857288899, 0.5889983068492544, 4516.0156]
Train: 0.7584 0.5841
Test: 0.7516 0.5890
9
[0.5965641818084936, 0.5800453711732415, 0.5831594902218287, 0.5830867801199995, 0.58764118188596, 0.5916586542397122, 0.5989697281634156, 0.6097160265804605, 0.6139382122820511, 0.6161299688697318, 0.620441908224419, 0.6239239098558688, 0.6283716163069875, 0.6295496763121049, 0.6351927165267741, 0.639662733641886, 0.6447822312632236, 0.6507402394858786, 0.6548029449855455, 0.6572171347587227, 0.6575536503158316, 0.6614725125084533, 0.6661856600898534, 0.6707654128545791, 0.6720475987717445, 0.6761153846173563, 0.6775017315287717, 0.6774833946688071, 0.6783608672783698, 0.6799036356027724, 0.6881084850895053, 0.6907693613451276, 0.6952467118672654, 0.6979378353889711, 0.7019830473660833, 0.7048621086869564, 0.7061880254047024, 0.7100205912380736, 0.7100205912380736, 0.7119174505022645, 0.7125969624991497, 0.7150513687775438, 0.7162509547500103, 0.7209063524538832, 0.7240400281322616, 0.7240400281322616, 0.7248299017785889, 0.7248299017785889, 0.7285206534182125, 0.7295846279881526, 0.7295846279881526, 0.7324940937388417, 0.7324940937388417, 0.7324940937388417, 0.7324940937388417, 0.7324940937388417, 0.7324940937388417, 0.7324940937388417, 0.7361069536235476, 0.7361069536235476, 0.7377345503530524, 0.7395877133105803, 0.7395877133105803, 0.7395877133105803, 0.7395877133105803, 0.7395877133105803, 0.7395877133105803, 0.7417952574488497, 0.7417952574488497, 0.7417952574488497, 0.747596278522109, 0.747596278522109, 0.747596278522109, 0.7493097263234803, 0.7493097263234803, 0.7493097263234803, 0.7493097263234803, 0.7493097263234803, 0.751619857288899, 0.751619857288899, 0.751619857288899, 0.751619857288899, 0.751619857288899, 0.751619857288899, 0.751619857288899, 0.751619857288899, 0.751619857288899, 0.751619857288899, 0.751619857288899, 0.751619857288899]
[0.1469608800181304, 0.15111168498696065, 0.1537636821714878, 0.1601574917008832, 0.17345096573255178, 0.1806241245723219, 0.1953833182125737, 0.20967545441668073, 0.21653741745182312, 0.22282650917385635, 0.23171515024975153, 0.24017055244731678, 0.24697393267847156, 0.25040188031496097, 0.26417377575380613, 0.2722070105624602, 0.28310626567057207, 0.29905610871510735, 0.30870298877014346, 0.31312968269647007, 0.314079300089958, 0.32709072462697253, 0.33952200548777234, 0.3497986739826868, 0.3515991574372921, 0.3586110618293257, 0.36132292135234867, 0.3601945899476466, 0.3629074449738146, 0.3680932435640236, 0.3944685008637669, 0.4005882099647028, 0.4132256221407083, 0.4208971552705171, 0.4318388260857456, 0.44010778280183827, 0.4444781805733672, 0.4533078371138256, 0.4533078371138256, 0.4599156839384451, 0.46124555707744075, 0.4683695860792564, 0.4729500655844051, 0.4867552548315987, 0.495415626145017, 0.495415626145017, 0.49738483685993223, 0.49738483685993223, 0.510626260951017, 0.5137111064887883, 0.5137111064887883, 0.5241979918318436, 0.5241979918318436, 0.5241979918318436, 0.5241979918318436, 0.5241979918318436, 0.5241979918318436, 0.5241979918318436, 0.538039881911256, 0.538039881911256, 0.5432005237102562, 0.5504107317339888, 0.5504107317339888, 0.5504107317339888, 0.5504107317339888, 0.5504107317339888, 0.5504107317339888, 0.5585689258577575, 0.5585689258577575, 0.5585689258577575, 0.5766103275883974, 0.5766103275883974, 0.5766103275883974, 0.5803390010095012, 0.5803390010095012, 0.5803390010095012, 0.5803390010095012, 0.5803390010095012, 0.5889983068492544, 0.5889983068492544, 0.5889983068492544, 0.5889983068492544, 0.5889983068492544, 0.5889983068492544, 0.5889983068492544, 0.5889983068492544, 0.5889983068492544, 0.5889983068492544, 0.5889983068492544, 0.5889983068492544]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  66542.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_4_0
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 20030.0)
('VALIDATE SUM PROTEIN TEST: ', 2245.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 35178.86, 59207.0)
('Error: ', tensor(45505.1289, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5132375828089646, 0.28170259624074073)
('Val: AUC, AUPR, Erros: ', 0.5120647166674082, 0.24031129453366018, 4996.276)
('Test: AUC, AUPR, Erros: ', 0.5107005031484051, 0.27836874416907964, 5646.2163)
10((646, 331), (646, 331), 62775.09, 59207.0)
('Error: ', tensor(42548.3242, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6398462672512132, 0.404107903499051)
('Val: AUC, AUPR, Erros: ', 0.6452430053981906, 0.3629262919994324, 4900.2715)
('Test: AUC, AUPR, Erros: ', 0.6298661607602485, 0.38918426343925977, 5302.308)
20((646, 331), (646, 331), 68719.57, 59207.0)
('Error: ', tensor(41546.5586, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7035476817019775, 0.51106084037611)
('Val: AUC, AUPR, Erros: ', 0.7040498338607516, 0.46447227984560013, 4848.313)
('Test: AUC, AUPR, Erros: ', 0.6894707281700806, 0.4868563942479424, 5198.658)
30((646, 331), (646, 331), 70821.78, 59207.0)
('Error: ', tensor(38677.0156, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7284777832991759, 0.5508262966770122)
('Val: AUC, AUPR, Erros: ', 0.7226914358477073, 0.49559636942613544, 4568.989)
('Test: AUC, AUPR, Erros: ', 0.7127344258705557, 0.5215719953709277, 4885.015)
40((646, 331), (646, 331), 87117.9, 59207.0)
('Error: ', tensor(39349.4844, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.737065866425457, 0.564627482803728)
('Val: AUC, AUPR, Erros: ', 0.7268964334017375, 0.5028175659874873, 4906.1123)
('Test: AUC, AUPR, Erros: ', 0.7192354129452738, 0.5314168876546896, 5082.0835)
50((646, 331), (646, 331), 48475.785, 59207.0)
('Error: ', tensor(36320.7422, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.745579857794715, 0.5750267024221106)
('Val: AUC, AUPR, Erros: ', 0.7292989236426365, 0.5050804694556184, 4160.8438)
('Test: AUC, AUPR, Erros: ', 0.7255173724730406, 0.5391025320823195, 4624.1455)
60((646, 331), (646, 331), 56104.605, 59207.0)
('Error: ', tensor(35215.4844, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7488801991516256, 0.5799978626118458)
('Val: AUC, AUPR, Erros: ', 0.7310681662263767, 0.5073676291476359, 4136.439)
('Test: AUC, AUPR, Erros: ', 0.727530302094844, 0.5420326703933236, 4530.887)
70((646, 331), (646, 331), 53530.17, 59207.0)
('Error: ', tensor(35237.5234, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7523016293953673, 0.5847296557818382)
('Val: AUC, AUPR, Erros: ', 0.7319860023063649, 0.5078906212860101, 4124.8438)
('Test: AUC, AUPR, Erros: ', 0.729473217381979, 0.5441361382463561, 4533.385)
80((646, 331), (646, 331), 51912.31, 59207.0)
('Error: ', tensor(35168.4844, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7550501116090799, 0.5890498426097149)
('Val: AUC, AUPR, Erros: ', 0.7324300378470333, 0.507420707562058, 4121.929)
('Test: AUC, AUPR, Erros: ', 0.7308585170037112, 0.5455247094129295, 4534.5054)
90((646, 331), (646, 331), 53696.156, 59207.0)
('Error: ', tensor(34862.9258, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7573384621372556, 0.5924448438838156)
('Val: AUC, AUPR, Erros: ', 0.7329665377336666, 0.5072721974810824, 4119.975)
('Test: AUC, AUPR, Erros: ', 0.7320441441710092, 0.5465937025867449, 4513.715)
100((646, 331), (646, 331), 52536.453, 59207.0)
('Error: ', tensor(34839.5078, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7595200309621497, 0.595618483921314)
('Val: AUC, AUPR, Erros: ', 0.7338806282181868, 0.5074019491978972, 4116.773)
('Test: AUC, AUPR, Erros: ', 0.7332534664515697, 0.5474522445396391, 4515.5356)
110((646, 331), (646, 331), 53271.387, 59207.0)
('Error: ', tensor(34656.0664, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.761304838277986, 0.5982739389669784)
('Val: AUC, AUPR, Erros: ', 0.7342848183063501, 0.5075234906495545, 4114.8564)
('Test: AUC, AUPR, Erros: ', 0.7342891179019835, 0.5478272027783924, 4505.2383)
120((646, 331), (646, 331), 52592.8, 59207.0)
('Error: ', tensor(34615.3711, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.763192771564862, 0.6009487810957601)
('Val: AUC, AUPR, Erros: ', 0.7344850098196067, 0.506525860846778, 4116.8706)
('Test: AUC, AUPR, Erros: ', 0.7354070477456882, 0.5488415778268759, 4504.123)
130((646, 331), (646, 331), 52840.1, 59207.0)
('Error: ', tensor(34484.3320, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7649237643042769, 0.6033866673132271)
('Val: AUC, AUPR, Erros: ', 0.7349664705818628, 0.5063973491152273, 4115.402)
('Test: AUC, AUPR, Erros: ', 0.7362811944241093, 0.5487578116971884, 4499.101)
140((646, 331), (646, 331), 52466.836, 59207.0)
('Error: ', tensor(34425.8477, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7668484472227955, 0.6058156057101767)
('Val: AUC, AUPR, Erros: ', 0.7354814841962379, 0.5062597979501793, 4115.0747)
('Test: AUC, AUPR, Erros: ', 0.7371662191545276, 0.5494334560161069, 4496.9736)
150((646, 331), (646, 331), 52451.9, 59207.0)
('Error: ', tensor(34323.5625, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7688472657018013, 0.6082548340023878)
('Val: AUC, AUPR, Erros: ', 0.7360234929894361, 0.507060261141992, 4111.959)
('Test: AUC, AUPR, Erros: ', 0.7384738919052034, 0.5503612976742233, 4490.937)
160((646, 331), (646, 331), 52210.3, 59207.0)
('Error: ', tensor(34259.3438, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7706957402602523, 0.6104209846438878)
('Val: AUC, AUPR, Erros: ', 0.7360318139738292, 0.5070108281688488, 4112.591)
('Test: AUC, AUPR, Erros: ', 0.7391157074730818, 0.550098316074871, 4491.272)

Validation:  [0.7360234929894361, 0.507060261141992, 4111.959, 0.7384738919052034, 0.5503612976742233, 4490.937]
Train: 0.7688 0.6083
Test: 0.7385 0.5504
0
[0.6214194394096322, 0.6291891476798341, 0.628245212058673, 0.6249926073376104, 0.6264791707190266, 0.6238980498239758, 0.6246766586834461, 0.6317456710900711, 0.6356430908241274, 0.6358107220591946, 0.6388922788664222, 0.6402446056483497, 0.6427586648518004, 0.6438243299148648, 0.6445056035260212, 0.6485816096903078, 0.6509027050268176, 0.6524378822287256, 0.6556377151769793, 0.6579111845398096, 0.6586847860183623, 0.6625778938558531, 0.6650623017992632, 0.6674787551549979, 0.6687627141191906, 0.67277056671588, 0.6743408388394851, 0.6750438766863174, 0.6758420712898525, 0.6770312794638854, 0.6815522804572806, 0.682380217289631, 0.6867610748446895, 0.6896438090606752, 0.6935471137478674, 0.6954643560970933, 0.6959765394207771, 0.6991484924700528, 0.6991484924700528, 0.7007319103331119, 0.7014059888199434, 0.7041195985013431, 0.7051544372402023, 0.7094524869222512, 0.7124247772736155, 0.7124247772736155, 0.7134380730438159, 0.7134380730438159, 0.7158674632667843, 0.7168400391745064, 0.7168400391745064, 0.7192966956949464, 0.7192966956949464, 0.7192966956949464, 0.7192966956949464, 0.7192966956949464, 0.7192966956949464, 0.7192966956949464, 0.7228682592299415, 0.7228682592299415, 0.7242697457793328, 0.7258269401633188, 0.7258269401633188, 0.7258269401633188, 0.7258269401633188, 0.7258269401633188, 0.7258269401633188, 0.7277980339080397, 0.7277980339080397, 0.7277980339080397, 0.7342261722379946, 0.7342261722379946, 0.7342261722379946, 0.7361832808333735, 0.7361832808333735, 0.7361832808333735, 0.7361832808333735, 0.7361832808333735, 0.7384738919052034, 0.7384738919052034, 0.7384738919052034, 0.7384738919052034, 0.7384738919052034, 0.7384738919052034, 0.7384738919052034, 0.7384738919052034, 0.7384738919052034, 0.7384738919052034, 0.7384738919052034, 0.7384738919052034]
[0.18226351139519806, 0.19432046124240177, 0.19439614600156552, 0.19946345348306782, 0.20573379490201632, 0.20603026606154884, 0.21240230519035505, 0.22756248399703793, 0.23968711434274265, 0.24185842718250394, 0.2491445064023225, 0.25380267557543323, 0.2624033670371802, 0.26581291375450206, 0.26796260764187974, 0.27927009121611596, 0.2861086663125751, 0.29428319880459597, 0.3006067063345698, 0.30730904548437177, 0.3092493461515907, 0.31815456847630574, 0.32592180286321104, 0.3318236559375993, 0.337024653471889, 0.3459025361997651, 0.3514843111212086, 0.3528102269704416, 0.3549756324653973, 0.3592887098081695, 0.3734734288284792, 0.3750126882894907, 0.3869682399681342, 0.3940885525196449, 0.40483817472434813, 0.41063997673685904, 0.4111622431183849, 0.4189751549028259, 0.4189751549028259, 0.4251938284910355, 0.42690996249917623, 0.4362501451837529, 0.4391913609428887, 0.4530799247643555, 0.4605891619725335, 0.4605891619725335, 0.4635201291351321, 0.4635201291351321, 0.4716311259705186, 0.47434231431087437, 0.47434231431087437, 0.48261213435729017, 0.48261213435729017, 0.48261213435729017, 0.48261213435729017, 0.48261213435729017, 0.48261213435729017, 0.48261213435729017, 0.49474145867136815, 0.49474145867136815, 0.4992178431600199, 0.5049575035004173, 0.5049575035004173, 0.5049575035004173, 0.5049575035004173, 0.5049575035004173, 0.5049575035004173, 0.5108374958627824, 0.5108374958627824, 0.5108374958627824, 0.5355631176634317, 0.5355631176634317, 0.5355631176634317, 0.5417916446278096, 0.5417916446278096, 0.5417916446278096, 0.5417916446278096, 0.5417916446278096, 0.5503612976742233, 0.5503612976742233, 0.5503612976742233, 0.5503612976742233, 0.5503612976742233, 0.5503612976742233, 0.5503612976742233, 0.5503612976742233, 0.5503612976742233, 0.5503612976742233, 0.5503612976742233, 0.5503612976742233]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  65011.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_4_1
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19622.0)
('VALIDATE SUM PROTEIN TEST: ', 2368.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 39335.113, 58645.0)
('Error: ', tensor(44290.8633, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5195247350423223, 0.2833495248215832)
('Val: AUC, AUPR, Erros: ', 0.5130618613239087, 0.2990948703830789, 5897.742)
('Test: AUC, AUPR, Erros: ', 0.5310629031845399, 0.2526336555561137, 4928.459)
10((646, 331), (646, 331), 58082.164, 58645.0)
('Error: ', tensor(42369.1523, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6280499786445434, 0.3618641091919643)
('Val: AUC, AUPR, Erros: ', 0.6146662099475229, 0.37188935342112683, 5562.824)
('Test: AUC, AUPR, Erros: ', 0.6353864152208093, 0.3256916469643553, 4862.6987)
20((646, 331), (646, 331), 58349.57, 58645.0)
('Error: ', tensor(42128.3828, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6553953653692584, 0.4027469957914404)
('Val: AUC, AUPR, Erros: ', 0.6412868868183627, 0.4093386667181088, 5532.7505)
('Test: AUC, AUPR, Erros: ', 0.6615807012169613, 0.367230288616486, 4837.127)
30((646, 331), (646, 331), 59709.22, 58645.0)
('Error: ', tensor(41539.6680, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.677311906229655, 0.44418007349436556)
('Val: AUC, AUPR, Erros: ', 0.6641972484401146, 0.45119966355030117, 5454.302)
('Test: AUC, AUPR, Erros: ', 0.6806175691707759, 0.40442387933395163, 4782.738)
40((646, 331), (646, 331), 60571.586, 58645.0)
('Error: ', tensor(40489.8867, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7003656657527967, 0.4869067291651173)
('Val: AUC, AUPR, Erros: ', 0.6873492983824775, 0.49337691524744043, 5321.2437)
('Test: AUC, AUPR, Erros: ', 0.6999708611880784, 0.4430810594789959, 4675.216)
50((646, 331), (646, 331), 59345.914, 58645.0)
('Error: ', tensor(38954.7969, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7169861910416224, 0.5192517110347558)
('Val: AUC, AUPR, Erros: ', 0.7042840678365445, 0.5247166278025163, 5137.8364)
('Test: AUC, AUPR, Erros: ', 0.7120556849802849, 0.46951333002015083, 4503.1006)
60((646, 331), (646, 331), 58780.87, 58645.0)
('Error: ', tensor(37437.3906, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7272175141326515, 0.5403506049728887)
('Val: AUC, AUPR, Erros: ', 0.7139888486276246, 0.54421937815917, 4956.107)
('Test: AUC, AUPR, Erros: ', 0.7187242932099768, 0.48549172347710345, 4350.2207)
70((646, 331), (646, 331), 52149.434, 58645.0)
('Error: ', tensor(36635.1875, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7342468865461421, 0.5549602625962777)
('Val: AUC, AUPR, Erros: ', 0.7199275476668526, 0.5569487418549509, 4894.8706)
('Test: AUC, AUPR, Erros: ', 0.7230550044728171, 0.4963808573497409, 4224.997)
80((646, 331), (646, 331), 48903.56, 58645.0)
('Error: ', tensor(36212.9688, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7390408316884303, 0.5641239942374495)
('Val: AUC, AUPR, Erros: ', 0.7232645764948038, 0.5632983985615275, 4868.9863)
('Test: AUC, AUPR, Erros: ', 0.7253558296486277, 0.5017188500698524, 4175.987)
90((646, 331), (646, 331), 52480.023, 58645.0)
('Error: ', tensor(35493.8086, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7436061493946622, 0.5705591308197072)
('Val: AUC, AUPR, Erros: ', 0.7255119776030423, 0.5667176612602411, 4779.326)
('Test: AUC, AUPR, Erros: ', 0.7281485148963676, 0.5059506060854118, 4143.9043)
100((646, 331), (646, 331), 52354.152, 58645.0)
('Error: ', tensor(35243.8320, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7475732121358252, 0.575907034982818)
('Val: AUC, AUPR, Erros: ', 0.7273315041179507, 0.5692151228613944, 4764.3193)
('Test: AUC, AUPR, Erros: ', 0.7300476316811146, 0.5087098337516143, 4128.205)
110((646, 331), (646, 331), 52441.477, 58645.0)
('Error: ', tensor(35044.3633, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7510512543712078, 0.5804618937486131)
('Val: AUC, AUPR, Erros: ', 0.7285776690369099, 0.5703885852207343, 4755.5747)
('Test: AUC, AUPR, Erros: ', 0.7319908081934727, 0.5107080321160733, 4116.1997)
120((646, 331), (646, 331), 52383.93, 58645.0)
('Error: ', tensor(34887.9492, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.75409858083873, 0.5842526136595034)
('Val: AUC, AUPR, Erros: ', 0.7295798324920075, 0.5709592120683838, 4752.0293)
('Test: AUC, AUPR, Erros: ', 0.733439012908436, 0.5119212758628121, 4108.1074)
130((646, 331), (646, 331), 52399.004, 58645.0)
('Error: ', tensor(34748.6133, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7567529355208836, 0.5877240020174037)
('Val: AUC, AUPR, Erros: ', 0.7304531026508434, 0.5714970262141676, 4749.6836)
('Test: AUC, AUPR, Erros: ', 0.7346355366577779, 0.5136699506253419, 4100.2007)
140((646, 331), (646, 331), 52190.14, 58645.0)
('Error: ', tensor(34629.1680, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7595090361366466, 0.5913005370280702)
('Val: AUC, AUPR, Erros: ', 0.7307623106521526, 0.5713277667372384, 4753.8257)
('Test: AUC, AUPR, Erros: ', 0.7353208384878489, 0.5139642218662276, 4097.791)
150((646, 331), (646, 331), 51575.438, 58645.0)
('Error: ', tensor(34567.3984, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7618493199640437, 0.5943501836843539)
('Val: AUC, AUPR, Erros: ', 0.7309171473061441, 0.5706645078258681, 4766.091)
('Test: AUC, AUPR, Erros: ', 0.7361614346268354, 0.5145839105927208, 4094.3354)
160((646, 331), (646, 331), 51776.15, 58645.0)
('Error: ', tensor(34422.2109, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7643504823214069, 0.5975036161633454)
('Val: AUC, AUPR, Erros: ', 0.7312132497273871, 0.5701723301798449, 4764.8047)
('Test: AUC, AUPR, Erros: ', 0.7367850167268688, 0.5156079663142172, 4089.539)

Validation:  [0.7304531026508434, 0.5714970262141676, 4749.6836, 0.7346355366577779, 0.5136699506253419, 4100.2007]
Train: 0.7568 0.5877
Test: 0.7346 0.5137
1
[0.5690179577875384, 0.5883465526409075, 0.5906232612793663, 0.5873081497459607, 0.5938176297021116, 0.5940037211575864, 0.5959345767060296, 0.6076351966904049, 0.608954570592956, 0.6122193937623815, 0.6133621659094408, 0.6147984086782782, 0.6171258391544951, 0.6172175612395993, 0.6249155180261975, 0.6304308088058972, 0.637672818517244, 0.6391492698922396, 0.6425002825776294, 0.6439296974676841, 0.6449129818760723, 0.6475035031502299, 0.6493614275536863, 0.651488145115625, 0.6524445275756172, 0.6582332932729291, 0.6602347352048198, 0.6614185850588562, 0.663231077551474, 0.6644953438323389, 0.6706471415024985, 0.6733134092056641, 0.6764908899593783, 0.6798767196575721, 0.6841816346074671, 0.6856054202312665, 0.6864967766051209, 0.6900992303062443, 0.6900992303062443, 0.6919148442681334, 0.693080157627742, 0.6960664709593936, 0.6973352226582961, 0.7020520586808948, 0.7048116929022343, 0.7048116929022343, 0.7058773773103114, 0.7058773773103114, 0.7084907552502397, 0.7098814775946791, 0.7098814775946791, 0.7129299895285652, 0.7129299895285652, 0.7129299895285652, 0.7129299895285652, 0.7129299895285652, 0.7129299895285652, 0.7129299895285652, 0.7166155952334803, 0.7166155952334803, 0.7180701211471192, 0.7206135354893699, 0.7206135354893699, 0.7206135354893699, 0.7206135354893699, 0.7206135354893699, 0.7206135354893699, 0.7227307344790864, 0.7227307344790864, 0.7227307344790864, 0.7295249820276011, 0.7295249820276011, 0.7295249820276011, 0.7318761673389639, 0.7318761673389639, 0.7318761673389639, 0.7318761673389639, 0.7318761673389639, 0.7346355366577779, 0.7346355366577779, 0.7346355366577779, 0.7346355366577779, 0.7346355366577779, 0.7346355366577779, 0.7346355366577779, 0.7346355366577779, 0.7346355366577779, 0.7346355366577779, 0.7346355366577779, 0.7346355366577779]
[0.1171246288920344, 0.138466637165908, 0.1385550907617732, 0.144054344939285, 0.1537084808077071, 0.1559331964069824, 0.16464532741323573, 0.17898373514550014, 0.18345061868886325, 0.18806146818997377, 0.1905210300264304, 0.19624296839521999, 0.2005496535675266, 0.20172322357154487, 0.22159086079746415, 0.23334614716085594, 0.24667904207123004, 0.24623979157202797, 0.2549076562366826, 0.25855763291732176, 0.2605440888573206, 0.26598842178722576, 0.2704550486416023, 0.2753282043156807, 0.27784378810470745, 0.29219420729129597, 0.2963695258653365, 0.299606026546549, 0.3037971182413073, 0.3070131491989144, 0.3212891938606416, 0.32791162128867124, 0.33659901420727556, 0.34587616771996293, 0.358141642144426, 0.3605349537047491, 0.36214693645932283, 0.37129358309123145, 0.37129358309123145, 0.3771360744766508, 0.3799796461896353, 0.39021777988132117, 0.3941240015162732, 0.4095266960754046, 0.41506381483483434, 0.41506381483483434, 0.41796472406528895, 0.41796472406528895, 0.42641717271001406, 0.4308058077522732, 0.4308058077522732, 0.4409527614800916, 0.4409527614800916, 0.4409527614800916, 0.4409527614800916, 0.4409527614800916, 0.4409527614800916, 0.4409527614800916, 0.4522019851466336, 0.4522019851466336, 0.45537127141918443, 0.4648199843491403, 0.4648199843491403, 0.4648199843491403, 0.4648199843491403, 0.4648199843491403, 0.4648199843491403, 0.4718167221227276, 0.4718167221227276, 0.4718167221227276, 0.4953868601492488, 0.4953868601492488, 0.4953868601492488, 0.5035863369492959, 0.5035863369492959, 0.5035863369492959, 0.5035863369492959, 0.5035863369492959, 0.5136699506253419, 0.5136699506253419, 0.5136699506253419, 0.5136699506253419, 0.5136699506253419, 0.5136699506253419, 0.5136699506253419, 0.5136699506253419, 0.5136699506253419, 0.5136699506253419, 0.5136699506253419, 0.5136699506253419]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  65032.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_4_2
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19180.0)
('VALIDATE SUM PROTEIN TEST: ', 2653.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 46822.58, 57135.0)
('Error: ', tensor(42358.9375, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5095750625265129, 0.27130124179892195)
('Val: AUC, AUPR, Erros: ', 0.5033711295880979, 0.2955810817054755, 5711.555)
('Test: AUC, AUPR, Erros: ', 0.4951670470375772, 0.28954653957396204, 5724.7104)
10((646, 331), (646, 331), 57528.586, 57135.0)
('Error: ', tensor(41391.1641, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.649506856533514, 0.3814068815478752)
('Val: AUC, AUPR, Erros: ', 0.6470435934432879, 0.40981617872094184, 5516.2812)
('Test: AUC, AUPR, Erros: ', 0.6390216500701261, 0.39916229489469274, 5529.6484)
20((646, 331), (646, 331), 59639.516, 57135.0)
('Error: ', tensor(40915.0469, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6693344093117365, 0.4068254161277738)
('Val: AUC, AUPR, Erros: ', 0.6666441139484025, 0.4347874496529051, 5440.1343)
('Test: AUC, AUPR, Erros: ', 0.6577521116252902, 0.419838651283824, 5456.7744)
30((646, 331), (646, 331), 51805.293, 57135.0)
('Error: ', tensor(40603.1992, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6799709214600871, 0.4259131353179872)
('Val: AUC, AUPR, Erros: ', 0.677541458892206, 0.452845340785341, 5447.9854)
('Test: AUC, AUPR, Erros: ', 0.6704335596366291, 0.44077512142974895, 5466.788)
40((646, 331), (646, 331), 51336.355, 57135.0)
('Error: ', tensor(39769.5898, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6948057960623855, 0.4566788313702578)
('Val: AUC, AUPR, Erros: ', 0.6923348809102483, 0.4841301200944058, 5338.743)
('Test: AUC, AUPR, Erros: ', 0.6855775243834422, 0.4701755012960906, 5361.7495)
50((646, 331), (646, 331), 44279.35, 57135.0)
('Error: ', tensor(39727.9883, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7051291659169563, 0.484805425729422)
('Val: AUC, AUPR, Erros: ', 0.7029539925888505, 0.5118615857496444, 5370.8945)
('Test: AUC, AUPR, Erros: ', 0.6967457448775861, 0.4982263155111682, 5398.31)
60((646, 331), (646, 331), 27139.336, 57135.0)
('Error: ', tensor(43110.2383, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7125384303143629, 0.5067474721675534)
('Val: AUC, AUPR, Erros: ', 0.7112082606516666, 0.5335282831418507, 5903.674)
('Test: AUC, AUPR, Erros: ', 0.7058751622497592, 0.5216904120946433, 5933.674)
70((646, 331), (646, 331), 33114.09, 57135.0)
('Error: ', tensor(40566.4688, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7196444819460536, 0.5258760726857524)
('Val: AUC, AUPR, Erros: ', 0.7177668839282445, 0.5515890689425588, 5535.2754)
('Test: AUC, AUPR, Erros: ', 0.7118096835715103, 0.5395492872072197, 5571.904)
80((646, 331), (646, 331), 38903.656, 57135.0)
('Error: ', tensor(38378.8828, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7253137488674255, 0.5368369471753196)
('Val: AUC, AUPR, Erros: ', 0.7230459500123583, 0.5629479076475348, 5211.6177)
('Test: AUC, AUPR, Erros: ', 0.7163650024358637, 0.5487134432551688, 5258.4536)
90((646, 331), (646, 331), 44339.035, 57135.0)
('Error: ', tensor(36829.1719, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7300911268672386, 0.5443437100344853)
('Val: AUC, AUPR, Erros: ', 0.7272241662859079, 0.5700901795387425, 4974.2573)
('Test: AUC, AUPR, Erros: ', 0.7198850206453559, 0.5547282404561217, 5031.091)
100((646, 331), (646, 331), 46672.21, 57135.0)
('Error: ', tensor(36094.8359, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7342064051935177, 0.5501127678394219)
('Val: AUC, AUPR, Erros: ', 0.7305617450734605, 0.5752647625491141, 4863.223)
('Test: AUC, AUPR, Erros: ', 0.7224328357935157, 0.5592685765472607, 4929.8813)
110((646, 331), (646, 331), 48700.39, 57135.0)
('Error: ', tensor(35555.4062, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7379703924448747, 0.5548536289640184)
('Val: AUC, AUPR, Erros: ', 0.7333236662861091, 0.5789696344839342, 4782.973)
('Test: AUC, AUPR, Erros: ', 0.7245652057273454, 0.5628403782295859, 4856.9653)
120((646, 331), (646, 331), 50172.055, 57135.0)
('Error: ', tensor(35185.1406, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7413623433362746, 0.5589083276481792)
('Val: AUC, AUPR, Erros: ', 0.7355329162622711, 0.5815382330051547, 4731.5293)
('Test: AUC, AUPR, Erros: ', 0.726061233635248, 0.5651335782679794, 4811.1333)
130((646, 331), (646, 331), 49984.438, 57135.0)
('Error: ', tensor(35022.0625, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7443230800273355, 0.5625595171149101)
('Val: AUC, AUPR, Erros: ', 0.737233432569764, 0.5836175968080232, 4717.6865)
('Test: AUC, AUPR, Erros: ', 0.7272171859674379, 0.5670004484422817, 4801.975)
140((646, 331), (646, 331), 49872.945, 57135.0)
('Error: ', tensor(34875.1875, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7470740204549663, 0.5658076164671852)
('Val: AUC, AUPR, Erros: ', 0.7387065866320093, 0.585013881095185, 4707.4907)
('Test: AUC, AUPR, Erros: ', 0.7279615695250721, 0.5680320750357737, 4795.7256)
150((646, 331), (646, 331), 50186.516, 57135.0)
('Error: ', tensor(34708.7539, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.749674115149765, 0.5689382139714917)
('Val: AUC, AUPR, Erros: ', 0.7398220141262717, 0.5862300536029671, 4692.4707)
('Test: AUC, AUPR, Erros: ', 0.728396614527726, 0.5684943142786592, 4786.1553)
160((646, 331), (646, 331), 50568.113, 57135.0)
('Error: ', tensor(34554.7305, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7520415666021211, 0.5718363098361626)
('Val: AUC, AUPR, Erros: ', 0.7406646464884882, 0.5869201223273284, 4680.439)
('Test: AUC, AUPR, Erros: ', 0.7289729186025711, 0.569060981360927, 4776.2344)

Validation:  [0.7406646464884882, 0.5869201223273284, 4680.439, 0.7289729186025711, 0.569060981360927, 4776.2344]
Train: 0.7520 0.5718
Test: 0.7290 0.5691
2
[0.5464885965229335, 0.5486133014735166, 0.5523237750384707, 0.5455421722570453, 0.5501773529784605, 0.5558618172164332, 0.5621146652541309, 0.576366411735967, 0.5832572318766619, 0.5856442901486685, 0.5893617497606123, 0.5893564079077807, 0.594693260147314, 0.5967982691298036, 0.6013419579609584, 0.6075845426715197, 0.615660652284397, 0.621917718721116, 0.6268814624815708, 0.6313416568703272, 0.6319274718309065, 0.6349800190600919, 0.6391714978583233, 0.6432337586390218, 0.6452213107972297, 0.6492563916863366, 0.651040523500799, 0.6519103075647793, 0.6542899143003654, 0.6551762631824831, 0.6618033650207159, 0.6645619701823757, 0.669427701815305, 0.6715708612647285, 0.6757611939674406, 0.6772070442955767, 0.6786690325532877, 0.6829793735930697, 0.6829793735930697, 0.6847564683059761, 0.6861172583968083, 0.6875862694979871, 0.6896831831260525, 0.6951740379163495, 0.6993988925361068, 0.6993988925361068, 0.7002110052590511, 0.7002110052590511, 0.7031746369140897, 0.7044162124012175, 0.7044162124012175, 0.707624374446086, 0.707624374446086, 0.707624374446086, 0.707624374446086, 0.707624374446086, 0.707624374446086, 0.707624374446086, 0.7110092291251713, 0.7110092291251713, 0.7124628972523637, 0.714247288555279, 0.714247288555279, 0.714247288555279, 0.714247288555279, 0.714247288555279, 0.714247288555279, 0.7167571431081692, 0.7167571431081692, 0.7167571431081692, 0.724026774668252, 0.724026774668252, 0.724026774668252, 0.7262567106611753, 0.7262567106611753, 0.7262567106611753, 0.7262567106611753, 0.7262567106611753, 0.7289729186025711, 0.7289729186025711, 0.7289729186025711, 0.7289729186025711, 0.7289729186025711, 0.7289729186025711, 0.7289729186025711, 0.7289729186025711, 0.7289729186025711, 0.7289729186025711, 0.7289729186025711, 0.7289729186025711]
[0.15471515798612837, 0.16377619535743776, 0.1704044743108999, 0.16353996550261707, 0.1696908041109026, 0.17538010810381605, 0.18672486996129234, 0.20601450566394724, 0.21543892885725208, 0.2206515171764569, 0.22567411794225373, 0.22378536225733675, 0.23246721061434306, 0.23764089372251193, 0.24766546194585662, 0.2602708999493808, 0.2784250540450278, 0.28785735028736825, 0.2964256194162695, 0.30441692030133544, 0.30503075267061414, 0.3094105497089753, 0.3179916944064294, 0.3273587896663456, 0.33121043045362136, 0.3406081271800246, 0.34479549782931085, 0.3472548372473988, 0.3550233309516161, 0.35773989488300895, 0.37297991203955955, 0.38101962114711985, 0.39334405092854674, 0.3979089465387096, 0.40900794270104496, 0.41215780520205514, 0.4163739049717313, 0.42625873451760954, 0.42625873451760954, 0.4300890342606445, 0.4342021928515594, 0.43718025837208824, 0.4448038857879395, 0.4606446796021516, 0.47266448817858026, 0.47266448817858026, 0.47433433344263776, 0.47433433344263776, 0.4826089464684943, 0.4855247249885697, 0.4855247249885697, 0.49611528144133116, 0.49611528144133116, 0.49611528144133116, 0.49611528144133116, 0.49611528144133116, 0.49611528144133116, 0.49611528144133116, 0.5064828002960382, 0.5064828002960382, 0.5100899600549487, 0.5166410519981531, 0.5166410519981531, 0.5166410519981531, 0.5166410519981531, 0.5166410519981531, 0.5166410519981531, 0.5259025723656956, 0.5259025723656956, 0.5259025723656956, 0.5518536110936675, 0.5518536110936675, 0.5518536110936675, 0.5586260434818986, 0.5586260434818986, 0.5586260434818986, 0.5586260434818986, 0.5586260434818986, 0.569060981360927, 0.569060981360927, 0.569060981360927, 0.569060981360927, 0.569060981360927, 0.569060981360927, 0.569060981360927, 0.569060981360927, 0.569060981360927, 0.569060981360927, 0.569060981360927, 0.569060981360927]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
647 81 331
Num Drug-SE:  65181.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_4_3
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((647, 3826), (81, 3826), (647, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19495.0)
('VALIDATE SUM PROTEIN TEST: ', 2810.0)
(647, 3826) (647, 331)
0((647, 331), (647, 331), 47473.617, 57305.0)
('Error: ', tensor(42413.8438, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5063962187164118, 0.27043347736672296)
('Val: AUC, AUPR, Erros: ', 0.5088553089173651, 0.297059847894499, 5601.5146)
('Test: AUC, AUPR, Erros: ', 0.5117082168649719, 0.29928481551684416, 5699.7944)
10((647, 331), (647, 331), 57324.29, 57305.0)
('Error: ', tensor(41525.1562, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6537384334886795, 0.4007492385674241)
('Val: AUC, AUPR, Erros: ', 0.6415749563931554, 0.4170881358533188, 5434.638)
('Test: AUC, AUPR, Erros: ', 0.6574406167258737, 0.43778876152804375, 5519.839)
20((647, 331), (647, 331), 65195.41, 57305.0)
('Error: ', tensor(41053.8047, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6792861119282195, 0.44976511043431683)
('Val: AUC, AUPR, Erros: ', 0.6741751430637756, 0.47005457619103735, 5325.5186)
('Test: AUC, AUPR, Erros: ', 0.6833041869065578, 0.4898380290700503, 5401.216)
30((647, 331), (647, 331), 66556.11, 57305.0)
('Error: ', tensor(39892.6016, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6976252401057554, 0.4868032180768601)
('Val: AUC, AUPR, Erros: ', 0.6928714105367834, 0.5060715780685849, 5169.829)
('Test: AUC, AUPR, Erros: ', 0.701668189254544, 0.5268705098979228, 5232.206)
40((647, 331), (647, 331), 78916.82, 57305.0)
('Error: ', tensor(39841.6172, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7108033169751231, 0.5124284354007356)
('Val: AUC, AUPR, Erros: ', 0.7041918028027728, 0.5283604028596421, 5091.6357)
('Test: AUC, AUPR, Erros: ', 0.7136625283657987, 0.5502277090644011, 5125.2803)
50((647, 331), (647, 331), 45796.64, 57305.0)
('Error: ', tensor(37870.3906, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7216342205500322, 0.5302279537982656)
('Val: AUC, AUPR, Erros: ', 0.7120164807106555, 0.5435495194202751, 5042.723)
('Test: AUC, AUPR, Erros: ', 0.7229127157500541, 0.5653857511870508, 5091.473)
60((647, 331), (647, 331), 61766.63, 57305.0)
('Error: ', tensor(35947.7070, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7286533523094276, 0.5408098902940537)
('Val: AUC, AUPR, Erros: ', 0.7178528136244502, 0.5518680590860099, 4714.7085)
('Test: AUC, AUPR, Erros: ', 0.7282399103184116, 0.5736210766290186, 4723.731)
70((647, 331), (647, 331), 64900.395, 57305.0)
('Error: ', tensor(35580.7422, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7345662888360693, 0.5484253722457222)
('Val: AUC, AUPR, Erros: ', 0.7223172078154049, 0.5580979898890648, 4657.687)
('Test: AUC, AUPR, Erros: ', 0.7325752256087659, 0.5789624345656633, 4652.177)
80((647, 331), (647, 331), 67751.29, 57305.0)
('Error: ', tensor(35502.9492, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7386630883428061, 0.5542231255530542)
('Val: AUC, AUPR, Erros: ', 0.7253333509173366, 0.5626646724250954, 4642.357)
('Test: AUC, AUPR, Erros: ', 0.735417471602015, 0.5822759781177924, 4624.123)
90((647, 331), (647, 331), 63467.8, 57305.0)
('Error: ', tensor(35007.4648, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7422855165855888, 0.5584220430355713)
('Val: AUC, AUPR, Erros: ', 0.7279157702223751, 0.5656940962484374, 4608.643)
('Test: AUC, AUPR, Erros: ', 0.7377053062902772, 0.5841195364471298, 4599.064)
100((647, 331), (647, 331), 65233.7, 57305.0)
('Error: ', tensor(34964.7578, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7451734510180321, 0.5624369423677881)
('Val: AUC, AUPR, Erros: ', 0.730519186124819, 0.568899735812768, 4601.1094)
('Test: AUC, AUPR, Erros: ', 0.7393976285179726, 0.5856141222805915, 4592.3643)
110((647, 331), (647, 331), 64051.19, 57305.0)
('Error: ', tensor(34749.5273, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7476739943124896, 0.5657897000703156)
('Val: AUC, AUPR, Erros: ', 0.7320949695458243, 0.5708783328027349, 4587.7725)
('Test: AUC, AUPR, Erros: ', 0.7407177940142448, 0.5867853530964666, 4583.68)
120((647, 331), (647, 331), 64750.195, 57305.0)
('Error: ', tensor(34672.2656, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7498393849984395, 0.5689010562126564)
('Val: AUC, AUPR, Erros: ', 0.7338500711548289, 0.5729859603689115, 4581.25)
('Test: AUC, AUPR, Erros: ', 0.7414518883464762, 0.5869947752308159, 4583.1704)
130((647, 331), (647, 331), 64589.445, 57305.0)
('Error: ', tensor(34544.8281, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7518886264195966, 0.5718165816421081)
('Val: AUC, AUPR, Erros: ', 0.7354963493145354, 0.5749509560892548, 4571.373)
('Test: AUC, AUPR, Erros: ', 0.7423781948697014, 0.5876734691024382, 4579.019)
140((647, 331), (647, 331), 64743.883, 57305.0)
('Error: ', tensor(34446.1719, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7538244708443708, 0.5745244609183532)
('Val: AUC, AUPR, Erros: ', 0.7369976422598147, 0.5765538566895765, 4564.633)
('Test: AUC, AUPR, Erros: ', 0.742974106305512, 0.5879444030913936, 4577.5835)
150((647, 331), (647, 331), 64499.543, 57305.0)
('Error: ', tensor(34326.6250, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7556634411173422, 0.577073464799071)
('Val: AUC, AUPR, Erros: ', 0.7385963994434372, 0.5780772198487114, 4555.2964)
('Test: AUC, AUPR, Erros: ', 0.7433757972631774, 0.5878913267135922, 4576.735)
160((647, 331), (647, 331), 65024.258, 57305.0)
('Error: ', tensor(34266.2109, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7574008579316328, 0.5794421311677355)
('Val: AUC, AUPR, Erros: ', 0.7396962760924819, 0.5789702890333264, 4554.2495)
('Test: AUC, AUPR, Erros: ', 0.7436431844366664, 0.5873802425579642, 4580.162)

Validation:  [0.7396962760924819, 0.5789702890333264, 4554.2495, 0.7436431844366664, 0.5873802425579642, 4580.162]
Train: 0.7574 0.5794
Test: 0.7436 0.5874
3
[0.5746497046430515, 0.568454653396076, 0.5717856583406411, 0.5728567251633738, 0.5816376632622393, 0.5857215860889645, 0.5900176790171032, 0.6010085640136033, 0.6055197638330645, 0.606330886090524, 0.6050942971437671, 0.6077761524059752, 0.6110375211768543, 0.6128067321693208, 0.6192864724321561, 0.6231849086809125, 0.6265339546328309, 0.632827559007926, 0.6380897887287026, 0.6428813829344557, 0.6439230122334598, 0.6475908769855471, 0.6512502733034355, 0.6555553325080575, 0.6566092629414157, 0.6627226889267112, 0.6653440959381536, 0.6654984864285289, 0.6673513268214888, 0.6691531244556963, 0.6754736883752244, 0.6785353493334991, 0.682563529104478, 0.6859875311627166, 0.6901916015330279, 0.6923788566087927, 0.6932645353011352, 0.6971515808610819, 0.6971515808610819, 0.7001345989383155, 0.7010317829747176, 0.7030685807949283, 0.7044972529121903, 0.7108007199496693, 0.7145987475958627, 0.7145987475958627, 0.7158225638012614, 0.7158225638012614, 0.7189858038903463, 0.7205067504643592, 0.7205067504643592, 0.7237521738209289, 0.7237521738209289, 0.7237521738209289, 0.7237521738209289, 0.7237521738209289, 0.7237521738209289, 0.7237521738209289, 0.7272604771009135, 0.7272604771009135, 0.7291272964764479, 0.7308466991510937, 0.7308466991510937, 0.7308466991510937, 0.7308466991510937, 0.7308466991510937, 0.7308466991510937, 0.732965832106721, 0.732965832106721, 0.732965832106721, 0.7391378707411724, 0.7391378707411724, 0.7391378707411724, 0.7413412978991426, 0.7413412978991426, 0.7413412978991426, 0.7413412978991426, 0.7413412978991426, 0.7436431844366664, 0.7436431844366664, 0.7436431844366664, 0.7436431844366664, 0.7436431844366664, 0.7436431844366664, 0.7436431844366664, 0.7436431844366664, 0.7436431844366664, 0.7436431844366664, 0.7436431844366664, 0.7436431844366664]
[0.14058725565140567, 0.15108556302746232, 0.15690497707275455, 0.1602602983289425, 0.17258421917657324, 0.17904680469213718, 0.18898031661502518, 0.20854640400200475, 0.2203323465984568, 0.22309646056932156, 0.22233177994148423, 0.22915870597033458, 0.23689276558603867, 0.24141017110949406, 0.2561531785861825, 0.26453425702031585, 0.26963061718623593, 0.2852032243873113, 0.29703950311802163, 0.3072261935255855, 0.3100476763253964, 0.31709138747431687, 0.32529228088128564, 0.3348363808863199, 0.33641406452021083, 0.351263236957859, 0.3576562891663498, 0.3564527198209111, 0.36065890680794965, 0.36551622559938424, 0.38238362868435405, 0.3900462760695712, 0.4005374972009029, 0.4096023537883875, 0.4210263539431994, 0.42618229093341103, 0.42873408446973155, 0.43833206552569726, 0.43833206552569726, 0.4482801602980548, 0.4507543903937209, 0.4558520206708518, 0.4606266104050174, 0.4817025955862079, 0.4924938254122338, 0.4924938254122338, 0.495848231471661, 0.495848231471661, 0.5050860928091174, 0.5098238056102521, 0.5098238056102521, 0.519625729333191, 0.519625729333191, 0.519625729333191, 0.519625729333191, 0.519625729333191, 0.519625729333191, 0.519625729333191, 0.5316383681866502, 0.5316383681866502, 0.5377081146044377, 0.5436819867097764, 0.5436819867097764, 0.5436819867097764, 0.5436819867097764, 0.5436819867097764, 0.5436819867097764, 0.5517517689631355, 0.5517517689631355, 0.5517517689631355, 0.5716965373353529, 0.5716965373353529, 0.5716965373353529, 0.5795130358238553, 0.5795130358238553, 0.5795130358238553, 0.5795130358238553, 0.5795130358238553, 0.5873802425579642, 0.5873802425579642, 0.5873802425579642, 0.5873802425579642, 0.5873802425579642, 0.5873802425579642, 0.5873802425579642, 0.5873802425579642, 0.5873802425579642, 0.5873802425579642, 0.5873802425579642, 0.5873802425579642]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
647 80 331
Num Drug-SE:  66002.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_4_4
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((647, 3826), (80, 3826), (647, 331), (80, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19903.0)
('VALIDATE SUM PROTEIN TEST: ', 2338.0)
(647, 3826) (647, 331)
0((647, 331), (647, 331), 49744.03, 58275.0)
('Error: ', tensor(42747.3633, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5210978417707867, 0.28281195708426454)
('Val: AUC, AUPR, Erros: ', 0.5283374373190117, 0.2731489818027293, 5142.052)
('Test: AUC, AUPR, Erros: ', 0.5173413779182501, 0.3007909095731739, 5565.2837)
10((647, 331), (647, 331), 61527.676, 58275.0)
('Error: ', tensor(42021.6836, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6440139942173532, 0.3959532480424809)
('Val: AUC, AUPR, Erros: ', 0.6339117650717537, 0.36514128731981027, 5101.164)
('Test: AUC, AUPR, Erros: ', 0.6236875461731051, 0.3980668066073363, 5424.1904)
20((647, 331), (647, 331), 67846.03, 58275.0)
('Error: ', tensor(41537.0156, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6875457156317036, 0.46070067809174275)
('Val: AUC, AUPR, Erros: ', 0.6781779336586695, 0.43110499208245956, 5073.5264)
('Test: AUC, AUPR, Erros: ', 0.6690963680744864, 0.4596792866113283, 5340.1807)
30((647, 331), (647, 331), 71665.56, 58275.0)
('Error: ', tensor(40461.2188, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7071971214231385, 0.5024417009577928)
('Val: AUC, AUPR, Erros: ', 0.6983651165800366, 0.472748179431932, 4971.1294)
('Test: AUC, AUPR, Erros: ', 0.6914720192372862, 0.5042078523524296, 5194.974)
40((647, 331), (647, 331), 44058.547, 58275.0)
('Error: ', tensor(40024.1016, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7171261962437339, 0.5291681139510073)
('Val: AUC, AUPR, Erros: ', 0.7063644913978524, 0.4945572014635401, 4814.8667)
('Test: AUC, AUPR, Erros: ', 0.701088809354629, 0.5299410461911721, 5261.945)
50((647, 331), (647, 331), 53381.88, 58275.0)
('Error: ', tensor(37350.0820, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7251393005800827, 0.54363925209383)
('Val: AUC, AUPR, Erros: ', 0.7127563754360872, 0.506919878271147, 4549.0737)
('Test: AUC, AUPR, Erros: ', 0.7082460887617715, 0.5421455308521831, 4897.738)
60((647, 331), (647, 331), 49732.51, 58275.0)
('Error: ', tensor(36703.0859, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.731554852970411, 0.5531511529397287)
('Val: AUC, AUPR, Erros: ', 0.7179050096996354, 0.5158236115167327, 4471.3486)
('Test: AUC, AUPR, Erros: ', 0.7141145704509202, 0.550995085814043, 4836.2993)
70((647, 331), (647, 331), 47882.836, 58275.0)
('Error: ', tensor(36338.2383, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7369961327874365, 0.5596213225160441)
('Val: AUC, AUPR, Erros: ', 0.7219374129635315, 0.521522384432554, 4433.412)
('Test: AUC, AUPR, Erros: ', 0.719480175868466, 0.5574373451107552, 4800.9717)
80((647, 331), (647, 331), 51398.742, 58275.0)
('Error: ', tensor(35621.8828, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7412038603752849, 0.564446070892492)
('Val: AUC, AUPR, Erros: ', 0.7255451011767232, 0.5258417655079024, 4375.958)
('Test: AUC, AUPR, Erros: ', 0.7233868610960558, 0.561605458625076, 4705.391)
90((647, 331), (647, 331), 50830.953, 58275.0)
('Error: ', tensor(35473.8906, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7444714599512461, 0.5683406080887289)
('Val: AUC, AUPR, Erros: ', 0.7280067032857274, 0.5288270156944014, 4361.302)
('Test: AUC, AUPR, Erros: ', 0.7266988888697268, 0.5655260227534378, 4689.0474)
100((647, 331), (647, 331), 51257.28, 58275.0)
('Error: ', tensor(35265.1484, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7473758736567785, 0.5719832728643551)
('Val: AUC, AUPR, Erros: ', 0.7302350587532308, 0.531554881673648, 4344.172)
('Test: AUC, AUPR, Erros: ', 0.729422949806138, 0.5687942041943637, 4662.758)
110((647, 331), (647, 331), 51296.75, 58275.0)
('Error: ', tensor(35132.5938, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7498346532247817, 0.5750760601878169)
('Val: AUC, AUPR, Erros: ', 0.7320628436856126, 0.5336475741415208, 4333.122)
('Test: AUC, AUPR, Erros: ', 0.7316935394473892, 0.5714343663007121, 4647.307)
120((647, 331), (647, 331), 51559.113, 58275.0)
('Error: ', tensor(34989.3711, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7521068967285978, 0.5780376529485893)
('Val: AUC, AUPR, Erros: ', 0.7337259345051461, 0.5356097149131436, 4321.822)
('Test: AUC, AUPR, Erros: ', 0.7338001416947699, 0.5739964614898253, 4628.9155)
130((647, 331), (647, 331), 51511.652, 58275.0)
('Error: ', tensor(34890.4219, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7540712295379287, 0.5806590257808242)
('Val: AUC, AUPR, Erros: ', 0.7350897613650358, 0.5368859167330624, 4315.3516)
('Test: AUC, AUPR, Erros: ', 0.7358122713307504, 0.5760628936832171, 4617.168)
140((647, 331), (647, 331), 51554.383, 58275.0)
('Error: ', tensor(34801.8594, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7557174104309758, 0.5828989610056048)
('Val: AUC, AUPR, Erros: ', 0.7363211680329523, 0.5383479213243987, 4308.393)
('Test: AUC, AUPR, Erros: ', 0.7373053933733745, 0.5776916828802068, 4608.4106)
150((647, 331), (647, 331), 51965.06, 58275.0)
('Error: ', tensor(34666.2109, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7573938742706143, 0.5852119583363625)
('Val: AUC, AUPR, Erros: ', 0.7372747527296797, 0.5395820497072225, 4300.3906)
('Test: AUC, AUPR, Erros: ', 0.7391015910341624, 0.5797211804120311, 4590.4053)
160((647, 331), (647, 331), 51382.32, 58275.0)
('Error: ', tensor(34645.5234, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7589072445766613, 0.5872649329594021)
('Val: AUC, AUPR, Erros: ', 0.7382680569368271, 0.5406336289296332, 4298.6914)
('Test: AUC, AUPR, Erros: ', 0.7401963194624462, 0.5805331532683329, 4592.407)

Validation:  [0.7382680569368271, 0.5406336289296332, 4298.6914, 0.7401963194624462, 0.5805331532683329, 4592.407]
Train: 0.7589 0.5873
Test: 0.7402 0.5805
4
[0.5612423438630335, 0.5782518527766507, 0.5904745178697312, 0.593230823383304, 0.5984560335461772, 0.6011974338775528, 0.5973667422243925, 0.605506819387256, 0.6104250177849015, 0.6115510644104472, 0.6160650269469106, 0.6211783860081321, 0.6230141023625619, 0.6241692322932806, 0.6299195691288443, 0.636452770706736, 0.6409899849782159, 0.648948544956061, 0.6505661216073413, 0.6539062326621433, 0.6545982151392189, 0.6583207302544668, 0.6616755541625476, 0.6636096683773923, 0.6643957420637249, 0.6689363070396603, 0.6695772082768987, 0.6698246448448403, 0.6707657258122202, 0.6721268536520805, 0.6781246815544392, 0.6814847515663952, 0.6856082237360149, 0.6888774089600604, 0.6923263522719258, 0.6943243875920172, 0.6954498650268393, 0.6998331436715484, 0.6998331436715484, 0.7013756764936268, 0.7022731355009648, 0.7046001076904579, 0.7059237557492165, 0.7104932672919129, 0.7135606236216906, 0.7135606236216906, 0.71388497025626, 0.71388497025626, 0.716392091987456, 0.7176332106327058, 0.7176332106327058, 0.7201082258139186, 0.7201082258139186, 0.7201082258139186, 0.7201082258139186, 0.7201082258139186, 0.7201082258139186, 0.7201082258139186, 0.7235044661032587, 0.7235044661032587, 0.725659824479544, 0.7273850928827386, 0.7273850928827386, 0.7273850928827386, 0.7273850928827386, 0.7273850928827386, 0.7273850928827386, 0.7293469344177264, 0.7293469344177264, 0.7293469344177264, 0.7357050057304089, 0.7357050057304089, 0.7357050057304089, 0.7379339777948252, 0.7379339777948252, 0.7379339777948252, 0.7379339777948252, 0.7379339777948252, 0.7401963194624462, 0.7401963194624462, 0.7401963194624462, 0.7401963194624462, 0.7401963194624462, 0.7401963194624462, 0.7401963194624462, 0.7401963194624462, 0.7401963194624462, 0.7401963194624462, 0.7401963194624462, 0.7401963194624462]
[0.14917995532287326, 0.15916293337272247, 0.17541001478920437, 0.1864049864090517, 0.19397561439052563, 0.19924212206275177, 0.1970410023058392, 0.21694128801873616, 0.22823455574789683, 0.23146107962364154, 0.24264918324444099, 0.25468806840623426, 0.2588111216231175, 0.2602575452935084, 0.273936686006113, 0.29008747121469014, 0.2983007144802041, 0.3205712814207019, 0.32181764261873225, 0.3294781483623654, 0.3309662639686791, 0.3409423408583577, 0.348318540556123, 0.3520900227579148, 0.35433023705727135, 0.36806254439462277, 0.3692925746029241, 0.3691185023456138, 0.3721584772473756, 0.37746217327473, 0.39591891370540905, 0.40447903218561454, 0.4175685850517748, 0.42598857391541023, 0.4349667625167058, 0.441367974539459, 0.44464035161533005, 0.4575759246313498, 0.4575759246313498, 0.46043764337135623, 0.4623026835495268, 0.4692117081941358, 0.47359286517772176, 0.4858795721250832, 0.49513255105143983, 0.49513255105143983, 0.49558834767940463, 0.49558834767940463, 0.503488574631567, 0.5069710966123117, 0.5069710966123117, 0.5131198354448226, 0.5131198354448226, 0.5131198354448226, 0.5131198354448226, 0.5131198354448226, 0.5131198354448226, 0.5131198354448226, 0.5243436442235717, 0.5243436442235717, 0.5313568805841442, 0.5368393274676897, 0.5368393274676897, 0.5368393274676897, 0.5368393274676897, 0.5368393274676897, 0.5368393274676897, 0.5435302203614595, 0.5435302203614595, 0.5435302203614595, 0.5651731722808692, 0.5651731722808692, 0.5651731722808692, 0.5728513391751456, 0.5728513391751456, 0.5728513391751456, 0.5728513391751456, 0.5728513391751456, 0.5805331532683329, 0.5805331532683329, 0.5805331532683329, 0.5805331532683329, 0.5805331532683329, 0.5805331532683329, 0.5805331532683329, 0.5805331532683329, 0.5805331532683329, 0.5805331532683329, 0.5805331532683329, 0.5805331532683329]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  66120.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_4_5
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19922.0)
('VALIDATE SUM PROTEIN TEST: ', 2402.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 41629.766, 59214.0)
('Error: ', tensor(44236., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5257093865638799, 0.2882594974911301)
('Val: AUC, AUPR, Erros: ', 0.5296130133905231, 0.26547935369758185, 5157.7188)
('Test: AUC, AUPR, Erros: ', 0.5258312235071412, 0.26697059514764787, 5230.0815)
10((646, 331), (646, 331), 57380.883, 59214.0)
('Error: ', tensor(42393.3438, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6495733101027719, 0.3789317284281176)
('Val: AUC, AUPR, Erros: ', 0.6499235072359774, 0.35315555095430484, 5023.8433)
('Test: AUC, AUPR, Erros: ', 0.6424439123775961, 0.3507123799480113, 5080.9927)
20((646, 331), (646, 331), 53807.12, 59214.0)
('Error: ', tensor(42173.6289, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6626095915164568, 0.3980172107740535)
('Val: AUC, AUPR, Erros: ', 0.6645148003190556, 0.37408934419114526, 4975.7246)
('Test: AUC, AUPR, Erros: ', 0.6565347178710808, 0.37017347167566705, 5039.3145)
30((646, 331), (646, 331), 46724.812, 59214.0)
('Error: ', tensor(42401.6641, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.676332462295193, 0.4231028754338817)
('Val: AUC, AUPR, Erros: ', 0.6790084706947647, 0.4005973894051864, 4962.697)
('Test: AUC, AUPR, Erros: ', 0.6692821164068277, 0.3928937371073772, 5037.3164)
40((646, 331), (646, 331), 45496.754, 59214.0)
('Error: ', tensor(41871.9023, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6916313973795429, 0.4582733708534332)
('Val: AUC, AUPR, Erros: ', 0.6938718065562257, 0.43678492830934973, 4892.5044)
('Test: AUC, AUPR, Erros: ', 0.6840687116976796, 0.4257360822145384, 4972.6016)
50((646, 331), (646, 331), 45155.445, 59214.0)
('Error: ', tensor(41063.1758, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7044770485001428, 0.4918713317133233)
('Val: AUC, AUPR, Erros: ', 0.7051371476720452, 0.46917984721127526, 4795.9194)
('Test: AUC, AUPR, Erros: ', 0.6952698427871224, 0.45683419104378475, 4881.5283)
60((646, 331), (646, 331), 45674.703, 59214.0)
('Error: ', tensor(39983.9648, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.714699620747607, 0.5160480448852451)
('Val: AUC, AUPR, Erros: ', 0.7134673808090642, 0.49153695716978263, 4675.001)
('Test: AUC, AUPR, Erros: ', 0.7043346170882792, 0.4803822930534443, 4764.046)
70((646, 331), (646, 331), 49442.824, 59214.0)
('Error: ', tensor(38493.6445, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7231709990493345, 0.5336971823620905)
('Val: AUC, AUPR, Erros: ', 0.7195337581875128, 0.5057664050654073, 4529.544)
('Test: AUC, AUPR, Erros: ', 0.7115864939988257, 0.49590990993888595, 4616.8633)
80((646, 331), (646, 331), 48950.77, 59214.0)
('Error: ', tensor(37714.8984, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7291235802003075, 0.5462365845686233)
('Val: AUC, AUPR, Erros: ', 0.7238745308834734, 0.5160906051627501, 4444.283)
('Test: AUC, AUPR, Erros: ', 0.7167687989132858, 0.5065170934679089, 4534.345)
90((646, 331), (646, 331), 49977.824, 59214.0)
('Error: ', tensor(36955.1836, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7338315177866347, 0.5552825927216196)
('Val: AUC, AUPR, Erros: ', 0.7275693721224715, 0.5233919298216704, 4370.128)
('Test: AUC, AUPR, Erros: ', 0.7206022663545265, 0.5142285974697873, 4463.211)
100((646, 331), (646, 331), 51272.195, 59214.0)
('Error: ', tensor(36370.5391, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7375901973800543, 0.5619668380612458)
('Val: AUC, AUPR, Erros: ', 0.7291149245839295, 0.5273529790966964, 4323.7446)
('Test: AUC, AUPR, Erros: ', 0.7236255830893238, 0.5201644843005246, 4411.3184)
110((646, 331), (646, 331), 51987.887, 59214.0)
('Error: ', tensor(36011.9297, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7407320225515049, 0.5670911713185516)
('Val: AUC, AUPR, Erros: ', 0.7303838100915827, 0.5301797388844615, 4298.7466)
('Test: AUC, AUPR, Erros: ', 0.7260018900958237, 0.5246000170334834, 4381.475)
120((646, 331), (646, 331), 52630.867, 59214.0)
('Error: ', tensor(35740.6641, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7435769850117298, 0.5712843489378279)
('Val: AUC, AUPR, Erros: ', 0.7319416863300192, 0.5336587134769479, 4278.6177)
('Test: AUC, AUPR, Erros: ', 0.7280739863904662, 0.5284935600584895, 4359.3677)
130((646, 331), (646, 331), 47750.945, 59214.0)
('Error: ', tensor(36136.2656, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7464288282647965, 0.5748266516888323)
('Val: AUC, AUPR, Erros: ', 0.7331454581503516, 0.535624195795209, 4294.5674)
('Test: AUC, AUPR, Erros: ', 0.7305410408388586, 0.5319167701141049, 4379.261)
140((646, 331), (646, 331), 56509.527, 59214.0)
('Error: ', tensor(35204.9141, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7479434539552887, 0.5775739156563551)
('Val: AUC, AUPR, Erros: ', 0.7334354274258145, 0.5371393098484748, 4262.47)
('Test: AUC, AUPR, Erros: ', 0.7310456750363532, 0.5330029978460569, 4331.441)
150((646, 331), (646, 331), 51418.254, 59214.0)
('Error: ', tensor(35424.9688, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7502745746550222, 0.5805913337566436)
('Val: AUC, AUPR, Erros: ', 0.7344248207078065, 0.538558919850822, 4252.6772)
('Test: AUC, AUPR, Erros: ', 0.7329929094854192, 0.5355516622170613, 4328.679)
160((646, 331), (646, 331), 54087.574, 59214.0)
('Error: ', tensor(35119.3516, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7517234579989995, 0.5827943560618781)
('Val: AUC, AUPR, Erros: ', 0.7346830755709308, 0.5393350931778059, 4244.294)
('Test: AUC, AUPR, Erros: ', 0.734103298952678, 0.537074243507206, 4311.3267)

Validation:  [0.7346830755709308, 0.5393350931778059, 4244.294, 0.734103298952678, 0.537074243507206, 4311.3267]
Train: 0.7517 0.5828
Test: 0.7341 0.5371
5
[0.574426528723672, 0.5911391158889931, 0.5979609300264983, 0.5972358947732779, 0.598480875554978, 0.5976880060056733, 0.6027157844296724, 0.601497565819317, 0.605795668238697, 0.6057700757726816, 0.6071969066713192, 0.6111397928609172, 0.6133576912747877, 0.616266617410635, 0.6196771367441204, 0.6219069457829814, 0.6247095466629795, 0.6300821734520954, 0.6353781373096152, 0.6377262080074177, 0.6378257828226592, 0.6424616169936544, 0.6452798655909967, 0.6489412734037715, 0.6505798057591673, 0.6561644866778922, 0.6583221911727168, 0.6593714204893066, 0.6622415717244867, 0.6628666903617902, 0.6692417645808884, 0.6720671275200863, 0.6755753564518954, 0.6780542449507959, 0.6829510888220658, 0.6843789570667498, 0.6856189034323692, 0.6898462221721184, 0.6898462221721184, 0.692062944418756, 0.6933870094550921, 0.6957170847266607, 0.6967412789921588, 0.7012281649814293, 0.7049971209089401, 0.7049971209089401, 0.7059676357469623, 0.7059676357469623, 0.7090650497110372, 0.710448174070967, 0.710448174070967, 0.71317003358943, 0.71317003358943, 0.71317003358943, 0.71317003358943, 0.71317003358943, 0.71317003358943, 0.71317003358943, 0.7166260528971168, 0.7166260528971168, 0.7182671382171664, 0.7200824834029875, 0.7200824834029875, 0.7200824834029875, 0.7200824834029875, 0.7200824834029875, 0.7200824834029875, 0.72234066827114, 0.72234066827114, 0.72234066827114, 0.7291703782984332, 0.7291703782984332, 0.7291703782984332, 0.7315982850977132, 0.7315982850977132, 0.7315982850977132, 0.7315982850977132, 0.7315982850977132, 0.734103298952678, 0.734103298952678, 0.734103298952678, 0.734103298952678, 0.734103298952678, 0.734103298952678, 0.734103298952678, 0.734103298952678, 0.734103298952678, 0.734103298952678, 0.734103298952678, 0.734103298952678]
[0.13253104467857527, 0.14696683477609596, 0.15681877333648853, 0.16445354021309982, 0.17002408641729133, 0.17146882190582755, 0.1822742097160634, 0.1875467459039612, 0.19709211235752389, 0.1985798960188065, 0.20189986060039922, 0.21094696329973076, 0.21837087445480696, 0.22352420377754284, 0.2291901192768529, 0.2346940399655815, 0.23909702985260003, 0.25280556225185646, 0.2634686163212808, 0.2665735954340118, 0.26652314256197124, 0.27878876057613866, 0.2844139214600654, 0.292026561491529, 0.297055195487807, 0.3102200911618927, 0.31591770330775426, 0.3179598946403843, 0.3258894856760795, 0.32694426961267986, 0.3430166727779753, 0.3495738461401354, 0.35781583449516335, 0.36282366380429465, 0.3772125596476798, 0.38072500544598953, 0.38389697995598804, 0.39511914981522, 0.39511914981522, 0.4003550973923177, 0.405067418298081, 0.4111364039208121, 0.41464216068852866, 0.42754650143673784, 0.4387517974926184, 0.4387517974926184, 0.4407079503116592, 0.4407079503116592, 0.4506109387638716, 0.4542262215787972, 0.4542262215787972, 0.4614440308126635, 0.4614440308126635, 0.4614440308126635, 0.4614440308126635, 0.4614440308126635, 0.4614440308126635, 0.4614440308126635, 0.4747768533816282, 0.4747768533816282, 0.4803580412728716, 0.48590266586617537, 0.48590266586617537, 0.48590266586617537, 0.48590266586617537, 0.48590266586617537, 0.48590266586617537, 0.4949102079239778, 0.4949102079239778, 0.4949102079239778, 0.5193939199748495, 0.5193939199748495, 0.5193939199748495, 0.5279483649707993, 0.5279483649707993, 0.5279483649707993, 0.5279483649707993, 0.5279483649707993, 0.537074243507206, 0.537074243507206, 0.537074243507206, 0.537074243507206, 0.537074243507206, 0.537074243507206, 0.537074243507206, 0.537074243507206, 0.537074243507206, 0.537074243507206, 0.537074243507206, 0.537074243507206]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  65248.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_4_6
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 20100.0)
('VALIDATE SUM PROTEIN TEST: ', 2319.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 51876.242, 58460.0)
('Error: ', tensor(42670.1484, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5088717431262889, 0.2839256713116093)
('Val: AUC, AUPR, Erros: ', 0.5007742268978721, 0.29281221031337423, 5521.549)
('Test: AUC, AUPR, Erros: ', 0.5071599047365417, 0.26477463634471593, 5071.4155)
10((646, 331), (646, 331), 57657.24, 58460.0)
('Error: ', tensor(41960.6953, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6674736185389776, 0.4103133345232392)
('Val: AUC, AUPR, Erros: ', 0.6487429570652801, 0.41219482332983925, 5420.5757)
('Test: AUC, AUPR, Erros: ', 0.6626215076586499, 0.38876593505662843, 5015.9053)
20((646, 331), (646, 331), 60118.383, 58460.0)
('Error: ', tensor(41193.3594, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6968810189312549, 0.45746945649119947)
('Val: AUC, AUPR, Erros: ', 0.6744651241548376, 0.4545889799982451, 5327.5576)
('Test: AUC, AUPR, Erros: ', 0.695515680685538, 0.4409574277221863, 4934.2476)
30((646, 331), (646, 331), 60372.27, 58460.0)
('Error: ', tensor(40055.4141, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7163318599037698, 0.502843784959894)
('Val: AUC, AUPR, Erros: ', 0.6910042839421157, 0.49229665464601424, 5202.743)
('Test: AUC, AUPR, Erros: ', 0.7128968193648606, 0.48354670981820613, 4804.233)
40((646, 331), (646, 331), 66637.1, 58460.0)
('Error: ', tensor(38609.8086, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7277870709309939, 0.5334447025604525)
('Val: AUC, AUPR, Erros: ', 0.7017562533461907, 0.5152413207016029, 5026.698)
('Test: AUC, AUPR, Erros: ', 0.7221138567783172, 0.5090418285013626, 4676.665)
50((646, 331), (646, 331), 75894.625, 58460.0)
('Error: ', tensor(37801.9102, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7357024753605217, 0.552233667814409)
('Val: AUC, AUPR, Erros: ', 0.7078735432694923, 0.5271284977460264, 4932.665)
('Test: AUC, AUPR, Erros: ', 0.7277294303948808, 0.5239646244421813, 4658.836)
60((646, 331), (646, 331), 71980.89, 58460.0)
('Error: ', tensor(36324.5391, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7415146156003392, 0.5640281386009192)
('Val: AUC, AUPR, Erros: ', 0.7118016831467056, 0.5335744367822546, 4802.338)
('Test: AUC, AUPR, Erros: ', 0.7304356177785059, 0.5308866803668452, 4491.6133)
70((646, 331), (646, 331), 67008.96, 58460.0)
('Error: ', tensor(35441.0820, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7456641349177502, 0.5704427221716581)
('Val: AUC, AUPR, Erros: ', 0.714208350074228, 0.5371697689337455, 4737.991)
('Test: AUC, AUPR, Erros: ', 0.7325592363125364, 0.5349724138252424, 4373.1724)
80((646, 331), (646, 331), 67004.375, 58460.0)
('Error: ', tensor(35186.6328, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7489706273193085, 0.5749623323153845)
('Val: AUC, AUPR, Erros: ', 0.7154165234573167, 0.538777833509342, 4730.4307)
('Test: AUC, AUPR, Erros: ', 0.7341972465312503, 0.5376972369405788, 4358.567)
90((646, 331), (646, 331), 65892.77, 58460.0)
('Error: ', tensor(34922.5938, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7516597687407442, 0.5787742287275296)
('Val: AUC, AUPR, Erros: ', 0.715986069485154, 0.5398994264412695, 4721.8535)
('Test: AUC, AUPR, Erros: ', 0.7347786418629771, 0.539036256159875, 4336.759)
100((646, 331), (646, 331), 65771.836, 58460.0)
('Error: ', tensor(34773.5859, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7538286964158735, 0.5818507644939471)
('Val: AUC, AUPR, Erros: ', 0.7163655327939982, 0.5405584030470041, 4718.738)
('Test: AUC, AUPR, Erros: ', 0.7347248513355193, 0.5392760595381598, 4336.0938)
110((646, 331), (646, 331), 65418.72, 58460.0)
('Error: ', tensor(34627.7930, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7557800153081414, 0.5846846689295251)
('Val: AUC, AUPR, Erros: ', 0.7162605167697751, 0.5406556362918924, 4717.428)
('Test: AUC, AUPR, Erros: ', 0.7350262614905058, 0.53988892006789, 4328.59)
120((646, 331), (646, 331), 65739.28, 58460.0)
('Error: ', tensor(34541.7930, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7575661579751412, 0.5872483288908347)
('Val: AUC, AUPR, Erros: ', 0.7162646238844157, 0.5409877423294456, 4717.8027)
('Test: AUC, AUPR, Erros: ', 0.7350771973161919, 0.540415175978579, 4331.5464)
130((646, 331), (646, 331), 64781.97, 58460.0)
('Error: ', tensor(34379.6953, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.75928430866316, 0.5897559217645536)
('Val: AUC, AUPR, Erros: ', 0.7162595112935768, 0.5412873812090297, 4713.847)
('Test: AUC, AUPR, Erros: ', 0.7355124657616046, 0.5410800857677845, 4314.0063)
140((646, 331), (646, 331), 65509.27, 58460.0)
('Error: ', tensor(34335.1680, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.760717410077551, 0.5920152507747848)
('Val: AUC, AUPR, Erros: ', 0.7162220291859406, 0.5414018827231108, 4716.126)
('Test: AUC, AUPR, Erros: ', 0.7348776404188806, 0.5400285165094952, 4331.977)
150((646, 331), (646, 331), 65701.13, 58460.0)
('Error: ', tensor(34267.3750, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7621060795320918, 0.5940337915284939)
('Val: AUC, AUPR, Erros: ', 0.7155822736523109, 0.5408597291933569, 4720.452)
('Test: AUC, AUPR, Erros: ', 0.7342746803168106, 0.5390491452174027, 4341.33)
160((646, 331), (646, 331), 65285.047, 58460.0)
('Error: ', tensor(34157.2891, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7635751726263807, 0.59612025513888)
('Val: AUC, AUPR, Erros: ', 0.7156864443948485, 0.540901254734846, 4718.786)
('Test: AUC, AUPR, Erros: ', 0.7344749214596498, 0.5389463260295755, 4334.08)

Validation:  [0.7162595112935768, 0.5412873812090297, 4713.847, 0.7355124657616046, 0.5410800857677845, 4314.0063]
Train: 0.7593 0.5898
Test: 0.7355 0.5411
6
[0.5664424057084607, 0.5798851569713758, 0.5699659767269779, 0.5676699436968649, 0.5688911280597286, 0.5708397413663344, 0.576537388682295, 0.5833555848542172, 0.5920050427394442, 0.5906573148793229, 0.5966471742861572, 0.5973350802310604, 0.6009089431638772, 0.6038692051610411, 0.6112316932234475, 0.6145527303692866, 0.6202345986679128, 0.6239560838109022, 0.6294460044460045, 0.6332191157545211, 0.6338909016337779, 0.637847894659699, 0.6414325403018686, 0.6456822639190317, 0.6481093253943315, 0.6549098255076542, 0.6578079380277081, 0.6594585803206519, 0.6615128389002951, 0.6622138433038353, 0.670301564065447, 0.6740900524053846, 0.677914472944676, 0.6801234084293066, 0.6843129476446727, 0.6860833771380571, 0.6873901892875156, 0.6905479055994335, 0.6905479055994335, 0.6932120957810325, 0.6945026777508819, 0.696555917943221, 0.6977681566918877, 0.7024758561281601, 0.7060564437520669, 0.7060564437520669, 0.7071522507896957, 0.7071522507896957, 0.7096436246103467, 0.7111302844430245, 0.7111302844430245, 0.7137574930518582, 0.7137574930518582, 0.7137574930518582, 0.7137574930518582, 0.7137574930518582, 0.7137574930518582, 0.7137574930518582, 0.7171059260483594, 0.7171059260483594, 0.7189750099049519, 0.721045983761737, 0.721045983761737, 0.721045983761737, 0.721045983761737, 0.721045983761737, 0.721045983761737, 0.7234071868410172, 0.7234071868410172, 0.7234071868410172, 0.7303101217403977, 0.7303101217403977, 0.7303101217403977, 0.732852909229449, 0.732852909229449, 0.732852909229449, 0.732852909229449, 0.732852909229449, 0.7355124657616046, 0.7355124657616046, 0.7355124657616046, 0.7355124657616046, 0.7355124657616046, 0.7355124657616046, 0.7355124657616046, 0.7355124657616046, 0.7355124657616046, 0.7355124657616046, 0.7355124657616046, 0.7355124657616046]
[0.11697077673095663, 0.1386242800413826, 0.13831427532631754, 0.14536350228243128, 0.14844611467631752, 0.15172895757274324, 0.16372884682035874, 0.17749682095644745, 0.18764817467043932, 0.186765154702134, 0.1966068342626967, 0.20033727251273023, 0.20391394189312098, 0.20894611028597948, 0.22488305255410232, 0.22928924377113363, 0.23934072715146715, 0.24723206396025538, 0.25704618401077967, 0.26520130616753745, 0.2666812254970357, 0.2767882916666581, 0.28472361141857516, 0.2945479976167776, 0.3011340565430033, 0.31901945960270084, 0.32511860952820293, 0.3288966834594155, 0.3332975965452533, 0.33357816272057544, 0.35269197860930884, 0.3612264838004767, 0.3688080062038157, 0.37229164640944434, 0.3833609590749123, 0.38749673634047344, 0.39070812229101004, 0.3975294039638122, 0.3975294039638122, 0.40653210747433344, 0.40778414642508276, 0.41367431534527843, 0.41694842209395494, 0.4315830205300007, 0.4427397892075883, 0.4427397892075883, 0.44543731458521374, 0.44543731458521374, 0.45227628807068504, 0.456629934612473, 0.456629934612473, 0.4645956351125786, 0.4645956351125786, 0.4645956351125786, 0.4645956351125786, 0.4645956351125786, 0.4645956351125786, 0.4645956351125786, 0.47554456100921505, 0.47554456100921505, 0.4819948191753397, 0.48941795768770147, 0.48941795768770147, 0.48941795768770147, 0.48941795768770147, 0.48941795768770147, 0.48941795768770147, 0.4990847476007966, 0.4990847476007966, 0.4990847476007966, 0.523320575829702, 0.523320575829702, 0.523320575829702, 0.5317314621317817, 0.5317314621317817, 0.5317314621317817, 0.5317314621317817, 0.5317314621317817, 0.5410800857677845, 0.5410800857677845, 0.5410800857677845, 0.5410800857677845, 0.5410800857677845, 0.5410800857677845, 0.5410800857677845, 0.5410800857677845, 0.5410800857677845, 0.5410800857677845, 0.5410800857677845, 0.5410800857677845]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
646 81 331
Num Drug-SE:  66302.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_4_7
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((646, 3826), (81, 3826), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19653.0)
('VALIDATE SUM PROTEIN TEST: ', 2224.0)
(646, 3826) (646, 331)
0((646, 331), (646, 331), 40618.438, 58642.0)
('Error: ', tensor(44093.6680, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.4945964322265921, 0.2742871458735582)
('Val: AUC, AUPR, Erros: ', 0.4829590813147976, 0.23898774450430357, 5067.3076)
('Test: AUC, AUPR, Erros: ', 0.4886882939257104, 0.28362221097589374, 5720.899)
10((646, 331), (646, 331), 55122.8, 58642.0)
('Error: ', tensor(42200.5391, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6359358548179962, 0.37463878095633835)
('Val: AUC, AUPR, Erros: ', 0.6143894855209129, 0.32283223562748614, 4941.8857)
('Test: AUC, AUPR, Erros: ', 0.6082305282206153, 0.3776095037815269, 5452.4116)
20((646, 331), (646, 331), 58118.36, 58642.0)
('Error: ', tensor(41580.9102, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.670016310916993, 0.4195602359897195)
('Val: AUC, AUPR, Erros: ', 0.6477193462738088, 0.36663268155400175, 4899.2974)
('Test: AUC, AUPR, Erros: ', 0.6366671776985242, 0.4223319488869809, 5383.331)
30((646, 331), (646, 331), 58438.53, 58642.0)
('Error: ', tensor(40843.0977, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6965989847406492, 0.45836656910059215)
('Val: AUC, AUPR, Erros: ', 0.6778287201956512, 0.40576731033669133, 4823.5166)
('Test: AUC, AUPR, Erros: ', 0.6604090202190016, 0.4524275540812473, 5307.142)
40((646, 331), (646, 331), 60265.6, 58642.0)
('Error: ', tensor(39797.2109, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7169316420593552, 0.4951606954204729)
('Val: AUC, AUPR, Erros: ', 0.7013145833469128, 0.4415946346203896, 4724.9863)
('Test: AUC, AUPR, Erros: ', 0.6791117398310227, 0.4782179284093754, 5194.247)
50((646, 331), (646, 331), 68958.984, 58642.0)
('Error: ', tensor(39071.9727, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7290007369194318, 0.5222789250358288)
('Val: AUC, AUPR, Erros: ', 0.7173728704035228, 0.46822716471042103, 4725.0776)
('Test: AUC, AUPR, Erros: ', 0.6951888918261669, 0.49898072149268735, 5090.741)
60((646, 331), (646, 331), 77884.94, 58642.0)
('Error: ', tensor(38862.3906, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7350727188565972, 0.5431724300371001)
('Val: AUC, AUPR, Erros: ', 0.7271744365934907, 0.4913977014219584, 4801.5796)
('Test: AUC, AUPR, Erros: ', 0.7029262629428645, 0.5117017427252859, 5066.7583)
70((646, 331), (646, 331), 72627.36, 58642.0)
('Error: ', tensor(37056.7578, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7393166871276181, 0.5572238543125854)
('Val: AUC, AUPR, Erros: ', 0.7325497101575338, 0.5054300866364837, 4557.508)
('Test: AUC, AUPR, Erros: ', 0.7081274072633965, 0.5213351072515853, 4890.7065)
80((646, 331), (646, 331), 69684.664, 58642.0)
('Error: ', tensor(36156.1094, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7431163696670554, 0.5655263656332553)
('Val: AUC, AUPR, Erros: ', 0.7361510195638514, 0.5141172306007851, 4438.7285)
('Test: AUC, AUPR, Erros: ', 0.7110039894568834, 0.5260934380027683, 4817.32)
90((646, 331), (646, 331), 67907.51, 58642.0)
('Error: ', tensor(35628.0312, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7467005277213206, 0.5711283420505995)
('Val: AUC, AUPR, Erros: ', 0.7384294631255786, 0.5186890436679039, 4373.7534)
('Test: AUC, AUPR, Erros: ', 0.7125712882624595, 0.5293907311495043, 4781.954)
100((646, 331), (646, 331), 67892.43, 58642.0)
('Error: ', tensor(35360.7422, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7499079255092453, 0.5753399027894865)
('Val: AUC, AUPR, Erros: ', 0.7397194949167342, 0.5218248022538139, 4359.8994)
('Test: AUC, AUPR, Erros: ', 0.7138059959920013, 0.5319055549201932, 4767.5127)
110((646, 331), (646, 331), 67103.05, 58642.0)
('Error: ', tensor(35092.0859, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.752515885374984, 0.5785853715248894)
('Val: AUC, AUPR, Erros: ', 0.7404257623362951, 0.5229593825446385, 4336.1226)
('Test: AUC, AUPR, Erros: ', 0.7135205157363502, 0.5324615304237799, 4759.6836)
120((646, 331), (646, 331), 67305.47, 58642.0)
('Error: ', tensor(34937.9922, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7548878362113729, 0.5817998300471648)
('Val: AUC, AUPR, Erros: ', 0.7410718570918148, 0.5248480146562525, 4333.449)
('Test: AUC, AUPR, Erros: ', 0.7132960866321019, 0.5323562196484056, 4761.5513)
130((646, 331), (646, 331), 66678.99, 58642.0)
('Error: ', tensor(34753.2266, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7569683123202594, 0.5846253382428735)
('Val: AUC, AUPR, Erros: ', 0.7421562724130344, 0.5267937153113266, 4310.501)
('Test: AUC, AUPR, Erros: ', 0.7132046803246919, 0.5331592617516332, 4755.3335)
140((646, 331), (646, 331), 66838.195, 58642.0)
('Error: ', tensor(34650.3398, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7588424558935603, 0.587123809544413)
('Val: AUC, AUPR, Erros: ', 0.7422907253332721, 0.5266969022359901, 4312.0513)
('Test: AUC, AUPR, Erros: ', 0.7128208644968468, 0.5327393510746459, 4758.556)
150((646, 331), (646, 331), 66819.195, 58642.0)
('Error: ', tensor(34549.3086, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.760573143868514, 0.5894008844885144)
('Val: AUC, AUPR, Erros: ', 0.7428694849934702, 0.5275164632009244, 4308.8813)
('Test: AUC, AUPR, Erros: ', 0.7119957366445834, 0.5320752381548245, 4763.801)
160((646, 331), (646, 331), 66801.34, 58642.0)
('Error: ', tensor(34451.8164, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7622180812100794, 0.5917246940254584)
('Val: AUC, AUPR, Erros: ', 0.7430683136362727, 0.5274469136256752, 4306.3003)
('Test: AUC, AUPR, Erros: ', 0.7121978918947438, 0.5321159140577966, 4762.488)

Validation:  [0.7430683136362727, 0.5274469136256752, 4306.3003, 0.7121978918947438, 0.5321159140577966, 4762.488]
Train: 0.7622 0.5917
Test: 0.7122 0.5321
7
[0.5461135309044054, 0.55749767321814, 0.5609871985301352, 0.5606296578419703, 0.5690882848721455, 0.5681878383973749, 0.5734144219113952, 0.5768615029976959, 0.583656245091227, 0.5859426762734387, 0.5890760610742674, 0.5933040592613124, 0.5963281826216247, 0.5980890821318938, 0.6033195370226436, 0.6064861424137972, 0.6089438087089547, 0.6138622572863053, 0.6168422350031889, 0.6198569427645358, 0.6202163575771403, 0.6224816681692834, 0.6258493186844546, 0.630741229619731, 0.6326402199699982, 0.6359192911071578, 0.6369273757961857, 0.6381868284402893, 0.640854713097051, 0.6411635881290311, 0.646164032923966, 0.650249860495739, 0.6535861654036639, 0.6561375116258206, 0.6599886557062843, 0.6618179812972217, 0.6631295324349477, 0.6667283331020786, 0.6667283331020786, 0.6695396731138755, 0.6708089872428145, 0.673076373119948, 0.6742556923563596, 0.6793443702993307, 0.6834327644018938, 0.6834327644018938, 0.6841533368156123, 0.6841533368156123, 0.6868506661914996, 0.688007454245503, 0.688007454245503, 0.6908883579863984, 0.6908883579863984, 0.6908883579863984, 0.6908883579863984, 0.6908883579863984, 0.6908883579863984, 0.6908883579863984, 0.6947154532814928, 0.6947154532814928, 0.6959418302868008, 0.6978799964205692, 0.6978799964205692, 0.6978799964205692, 0.6978799964205692, 0.6978799964205692, 0.6978799964205692, 0.7000053437676195, 0.7000053437676195, 0.7000053437676195, 0.707151243175844, 0.707151243175844, 0.707151243175844, 0.7095306018902554, 0.7095306018902554, 0.7095306018902554, 0.7095306018902554, 0.7095306018902554, 0.7121978918947438, 0.7121978918947438, 0.7121978918947438, 0.7121978918947438, 0.7121978918947438, 0.7121978918947438, 0.7121978918947438, 0.7121978918947438, 0.7121978918947438, 0.7121978918947438, 0.7121978918947438, 0.7121978918947438]
[0.13720707325388626, 0.1547013200626891, 0.16160174982277786, 0.166729460034873, 0.18076941439714156, 0.1795254817343492, 0.18918043884970975, 0.19954451879840043, 0.21010586420412158, 0.21639549847812056, 0.2228372626236692, 0.22957436630210518, 0.23494546668571364, 0.24002038747346868, 0.25150059181793966, 0.25613157762127015, 0.2611151765623451, 0.2725486064945253, 0.279350908415244, 0.2870850984291115, 0.28826541214090046, 0.29376746277693755, 0.3006702260471982, 0.3106986152864134, 0.3148390467275164, 0.3205050595514084, 0.3221976409863352, 0.3251913803648751, 0.3314426020194517, 0.33143514189825596, 0.34217286057911644, 0.35204431072404163, 0.35856465796927794, 0.3644266001297907, 0.3752117287499372, 0.38029436169718683, 0.3834504833771367, 0.39141913833805264, 0.39141913833805264, 0.401183648971713, 0.40506268330816164, 0.4111816800845141, 0.41510502237575836, 0.42936807166042246, 0.44127830002905816, 0.44127830002905816, 0.44294296746348616, 0.44294296746348616, 0.44997351039921263, 0.4530183870112777, 0.4530183870112777, 0.4613241523174948, 0.4613241523174948, 0.4613241523174948, 0.4613241523174948, 0.4613241523174948, 0.4613241523174948, 0.4613241523174948, 0.474029840153813, 0.474029840153813, 0.4771078915365121, 0.48438464042500695, 0.48438464042500695, 0.48438464042500695, 0.48438464042500695, 0.48438464042500695, 0.48438464042500695, 0.4910788003030441, 0.4910788003030441, 0.4910788003030441, 0.5144873129686242, 0.5144873129686242, 0.5144873129686242, 0.5220096991566553, 0.5220096991566553, 0.5220096991566553, 0.5220096991566553, 0.5220096991566553, 0.5321159140577966, 0.5321159140577966, 0.5321159140577966, 0.5321159140577966, 0.5321159140577966, 0.5321159140577966, 0.5321159140577966, 0.5321159140577966, 0.5321159140577966, 0.5321159140577966, 0.5321159140577966, 0.5321159140577966]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
647 81 331
Num Drug-SE:  65161.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_4_8
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((647, 3826), (81, 3826), (647, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19359.0)
('VALIDATE SUM PROTEIN TEST: ', 2766.0)
(647, 3826) (647, 331)
0((647, 331), (647, 331), 41555.92, 58555.0)
('Error: ', tensor(43903.6406, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.49720815536871654, 0.2681654855173572)
('Val: AUC, AUPR, Erros: ', 0.48826607222371354, 0.2817443026212711, 5740.523)
('Test: AUC, AUPR, Erros: ', 0.49919106482202596, 0.24328145460992714, 5052.636)
10((647, 331), (647, 331), 59112.57, 58555.0)
('Error: ', tensor(42205.2070, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6358668239137387, 0.399036754920252)
('Val: AUC, AUPR, Erros: ', 0.62016705223088, 0.40829053714205454, 5448.739)
('Test: AUC, AUPR, Erros: ', 0.6336490159935743, 0.364246017854828, 4963.9404)
20((647, 331), (647, 331), 51591.06, 58555.0)
('Error: ', tensor(41720.3438, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6794910715301626, 0.4515087119205332)
('Val: AUC, AUPR, Erros: ', 0.6564718880680637, 0.4532119536248612, 5432.935)
('Test: AUC, AUPR, Erros: ', 0.6813598699913834, 0.41879782669366694, 4856.0146)
30((647, 331), (647, 331), 59217.617, 58555.0)
('Error: ', tensor(39947.6016, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7081123587651169, 0.5017905098652795)
('Val: AUC, AUPR, Erros: ', 0.6825219324881839, 0.49719649923264986, 5196.719)
('Test: AUC, AUPR, Erros: ', 0.7109441875034604, 0.46943590578668104, 4698.218)
40((647, 331), (647, 331), 59087.35, 58555.0)
('Error: ', tensor(38419.4766, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7203001578008548, 0.5263199254182231)
('Val: AUC, AUPR, Erros: ', 0.694219250332082, 0.5172313965987083, 5030.4976)
('Test: AUC, AUPR, Erros: ', 0.7232297687725937, 0.49335890820510464, 4518.075)
50((647, 331), (647, 331), 58143.734, 58555.0)
('Error: ', tensor(36960.0391, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7269013547545049, 0.5409731595824149)
('Val: AUC, AUPR, Erros: ', 0.7003697361999074, 0.5290622433043383, 4884.2686)
('Test: AUC, AUPR, Erros: ', 0.7296841757393917, 0.5074199825449158, 4344.5347)
60((647, 331), (647, 331), 55294.15, 58555.0)
('Error: ', tensor(36318.6641, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7324680724079246, 0.5511762135435964)
('Val: AUC, AUPR, Erros: ', 0.704681253415213, 0.5372813776831409, 4835.65)
('Test: AUC, AUPR, Erros: ', 0.7339017351888826, 0.5168252443467464, 4254.6177)
70((647, 331), (647, 331), 53097.1, 58555.0)
('Error: ', tensor(35756.5078, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7375331778890826, 0.5600949493411616)
('Val: AUC, AUPR, Erros: ', 0.7072860297772774, 0.5431037026197423, 4806.8237)
('Test: AUC, AUPR, Erros: ', 0.7372007877475675, 0.5233188495891085, 4191.9907)
80((647, 331), (647, 331), 56835.754, 58555.0)
('Error: ', tensor(35407.0234, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7414005568864882, 0.564256261705546)
('Val: AUC, AUPR, Erros: ', 0.7093393832446724, 0.5452140960119471, 4760.1665)
('Test: AUC, AUPR, Erros: ', 0.7391951053023494, 0.5260912448754226, 4188.0825)
90((647, 331), (647, 331), 45444.242, 58555.0)
('Error: ', tensor(36236.3320, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7466586528633532, 0.570309310842459)
('Val: AUC, AUPR, Erros: ', 0.7106825915347708, 0.5467959941420384, 4907.694)
('Test: AUC, AUPR, Erros: ', 0.741112205704427, 0.5279866203545821, 4206.949)
100((647, 331), (647, 331), 55003.65, 58555.0)
('Error: ', tensor(34994.7891, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.749376272592871, 0.5743849216588803)
('Val: AUC, AUPR, Erros: ', 0.7117941436387286, 0.5487905070270702, 4749.7983)
('Test: AUC, AUPR, Erros: ', 0.7421246820453655, 0.529089675360133, 4159.7725)
110((647, 331), (647, 331), 51277.977, 58555.0)
('Error: ', tensor(35162.5820, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7523886132003756, 0.5774869320078594)
('Val: AUC, AUPR, Erros: ', 0.7129605555162062, 0.5498598839487403, 4783.137)
('Test: AUC, AUPR, Erros: ', 0.7429563819173184, 0.5296445485492554, 4154.3203)
120((647, 331), (647, 331), 51935.24, 58555.0)
('Error: ', tensor(34914.6406, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7549190461772809, 0.5812650081620186)
('Val: AUC, AUPR, Erros: ', 0.7127648822148638, 0.5511039973075736, 4767.743)
('Test: AUC, AUPR, Erros: ', 0.7435600939597103, 0.5299100526792924, 4149.473)
130((647, 331), (647, 331), 52127.164, 58555.0)
('Error: ', tensor(34806.6094, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7570672200896807, 0.5839447504802522)
('Val: AUC, AUPR, Erros: ', 0.7146892223632099, 0.5535864028958, 4753.0327)
('Test: AUC, AUPR, Erros: ', 0.7439087417848375, 0.5308347853471831, 4146.6167)
140((647, 331), (647, 331), 51246.668, 58555.0)
('Error: ', tensor(34761.1953, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7592263442257096, 0.5868196457121537)
('Val: AUC, AUPR, Erros: ', 0.7144308925372662, 0.5544116720929981, 4759.833)
('Test: AUC, AUPR, Erros: ', 0.7444321873967732, 0.5314770611698441, 4144.3237)
150((647, 331), (647, 331), 51976.492, 58555.0)
('Error: ', tensor(34606.1016, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7610953578154003, 0.5892650425314294)
('Val: AUC, AUPR, Erros: ', 0.7154822790804017, 0.5556839564472087, 4743.137)
('Test: AUC, AUPR, Erros: ', 0.7447645811479864, 0.5318647079351911, 4142.4365)
160((647, 331), (647, 331), 51144.793, 58555.0)
('Error: ', tensor(34587.3477, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7629739641348618, 0.5916193171249917)
('Val: AUC, AUPR, Erros: ', 0.7154636502544631, 0.5571796982639988, 4747.2104)
('Test: AUC, AUPR, Erros: ', 0.7450767462752922, 0.5318845701763084, 4142.8413)

Validation:  [0.7154822790804017, 0.5556839564472087, 4743.137, 0.7447645811479864, 0.5318647079351911, 4142.4365]
Train: 0.7611 0.5893
Test: 0.7448 0.5319
8
[0.5782953341237449, 0.567975057677168, 0.5732590725899278, 0.5747009849921916, 0.5783812533355367, 0.5775961915892415, 0.5838921046215488, 0.5900107347810308, 0.5963336236344945, 0.5964828816391372, 0.6028455381714982, 0.6049176019729801, 0.607600062780462, 0.6095903276525196, 0.6208763942175034, 0.6248119999700646, 0.630421074583635, 0.6349341267330917, 0.6389555217924865, 0.64094280026216, 0.6412976831807293, 0.6470326733206583, 0.6510835003067811, 0.6555854870977945, 0.6573691203291079, 0.662752365269113, 0.6652790029488116, 0.6665211854855307, 0.6695866422269903, 0.6710614382252703, 0.6768395318605998, 0.6788456618777348, 0.6828572772948862, 0.6853916419200109, 0.6896840744102122, 0.6917162362541973, 0.691923383116042, 0.6954888972062021, 0.6954888972062021, 0.6990756131861404, 0.7001559042884703, 0.7027204962496144, 0.7038977596508554, 0.7094851252937365, 0.713842584356688, 0.713842584356688, 0.7150661229253896, 0.7150661229253896, 0.718142330980922, 0.719921005234197, 0.719921005234197, 0.7229986619738672, 0.7229986619738672, 0.7229986619738672, 0.7229986619738672, 0.7229986619738672, 0.7229986619738672, 0.7229986619738672, 0.7262311483978754, 0.7262311483978754, 0.7282641268651968, 0.7304410329000709, 0.7304410329000709, 0.7304410329000709, 0.7304410329000709, 0.7304410329000709, 0.7304410329000709, 0.7324620337032489, 0.7324620337032489, 0.7324620337032489, 0.739918609937024, 0.739918609937024, 0.739918609937024, 0.7421226549620892, 0.7421226549620892, 0.7421226549620892, 0.7421226549620892, 0.7421226549620892, 0.7447645811479864, 0.7447645811479864, 0.7447645811479864, 0.7447645811479864, 0.7447645811479864, 0.7447645811479864, 0.7447645811479864, 0.7447645811479864, 0.7447645811479864, 0.7447645811479864, 0.7447645811479864, 0.7447645811479864]
[0.10799855061329032, 0.11391735591613823, 0.12309659336772359, 0.13457836312870544, 0.1403205986216048, 0.14151352516633256, 0.1544827118470237, 0.16064018491434262, 0.16988673599193715, 0.1712173726222075, 0.18277161185079424, 0.18522607173812075, 0.18803223217162296, 0.19182264257241452, 0.2118956269875687, 0.22307161971398826, 0.22996022115329015, 0.23450180934072054, 0.24167313314644642, 0.24320236968073136, 0.2437220869223337, 0.2571009934993469, 0.26648056557046, 0.27512031582512897, 0.27836951740180427, 0.293618821654589, 0.2997081714677161, 0.3033342232779197, 0.3148767338870906, 0.31867274911664345, 0.33030687794406877, 0.3326403911546735, 0.3406652808852138, 0.3476984867781663, 0.3605762784931596, 0.36475147503189453, 0.363520194033066, 0.3753626007468017, 0.3753626007468017, 0.3853383306515865, 0.3890290242385646, 0.3958834003860684, 0.39977669382546377, 0.41613168188777566, 0.430902115430447, 0.430902115430447, 0.4340192207606778, 0.4340192207606778, 0.4413178347720757, 0.4470419548267439, 0.4470419548267439, 0.4552283654289835, 0.4552283654289835, 0.4552283654289835, 0.4552283654289835, 0.4552283654289835, 0.4552283654289835, 0.4552283654289835, 0.46712010100843027, 0.46712010100843027, 0.47411692507304853, 0.4815139535583617, 0.4815139535583617, 0.4815139535583617, 0.4815139535583617, 0.4815139535583617, 0.4815139535583617, 0.48863099835483015, 0.48863099835483015, 0.48863099835483015, 0.5150364814913728, 0.5150364814913728, 0.5150364814913728, 0.5222242920459813, 0.5222242920459813, 0.5222242920459813, 0.5222242920459813, 0.5222242920459813, 0.5318647079351911, 0.5318647079351911, 0.5318647079351911, 0.5318647079351911, 0.5318647079351911, 0.5318647079351911, 0.5318647079351911, 0.5318647079351911, 0.5318647079351911, 0.5318647079351911, 0.5318647079351911, 0.5318647079351911]
[1154, 392, 1050, 1169, 561, 44, 106, 238, 267, 1312, 299, 47, 70, 361, 88, 161, 746, 979, 550, 363, 1427, 563, 1247]
808
Num selected se:  331 Thres:  0.1
712 331 587
X len 331 331
Id, name, prop:  0 abdominal discomfort 0.22
Batch molecular graph completed.
Total:  21023 808 26.018564356435643
Total nodes:  3317
N Protein-Protein:  1069
97 89
DART Info: Drug, Se, Protein, Pair:  90 53 41 239
Drug-Protein:  8132.0 Protein-Protein:  1069 Protein-Pathways:  4913.0
647 80 331
Num Drug-SE:  65573.0
Num edges:  28222 1380
Undirected graph:  True Config:  True
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/NTimeKFold/ATCInchikeySideEffectByDrug.txt_P3_4_9
('Number of substructures, proteins, pathways, drugs, se: ', 2048, 1448, 330, 808, 331)
((647, 3826), (80, 3826), (647, 331), (80, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19880.0)
('VALIDATE SUM PROTEIN TEST: ', 2518.0)
(647, 3826) (647, 331)
0((647, 331), (647, 331), 35522.266, 57826.0)
('Error: ', tensor(44515.6172, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5209109450391523, 0.28910293548920263)
('Val: AUC, AUPR, Erros: ', 0.5194742785870516, 0.2907977683911493, 5637.234)
('Test: AUC, AUPR, Erros: ', 0.5122694333090477, 0.3067093008381472, 5904.3037)
10((647, 331), (647, 331), 58039.355, 57826.0)
('Error: ', tensor(41766.1094, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6693928995904956, 0.43662962213097584)
('Val: AUC, AUPR, Erros: ', 0.6599724506683142, 0.42834352166141576, 5275.5137)
('Test: AUC, AUPR, Erros: ', 0.6503339121441967, 0.44149801946366996, 5441.3403)
20((647, 331), (647, 331), 44304.527, 57826.0)
('Error: ', tensor(41140.6289, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.719506068131063, 0.5210662428759236)
('Val: AUC, AUPR, Erros: ', 0.7055441700011327, 0.5040933786401567, 5220.3184)
('Test: AUC, AUPR, Erros: ', 0.693125520850018, 0.515521113376775, 5454.0103)
30((647, 331), (647, 331), 60655.953, 57826.0)
('Error: ', tensor(37147.9688, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7329763502563056, 0.5463889158446098)
('Val: AUC, AUPR, Erros: ', 0.7162178070211176, 0.5263816442731485, 4751.1274)
('Test: AUC, AUPR, Erros: ', 0.7063945059165075, 0.5370747915521096, 4911.5786)
40((647, 331), (647, 331), 60859.773, 57826.0)
('Error: ', tensor(35933.2188, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7400762603245664, 0.5580550604460363)
('Val: AUC, AUPR, Erros: ', 0.7212077983732761, 0.5346437093029731, 4628.5415)
('Test: AUC, AUPR, Erros: ', 0.7116204101124144, 0.5468322298374627, 4785.8413)
50((647, 331), (647, 331), 36783.984, 57826.0)
('Error: ', tensor(38181.9883, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7469372059172918, 0.5672355160825092)
('Val: AUC, AUPR, Erros: ', 0.7259319319546348, 0.5412831955781713, 4915.7114)
('Test: AUC, AUPR, Erros: ', 0.7165534348492144, 0.5561132323557145, 5167.219)
60((647, 331), (647, 331), 58477.43, 57826.0)
('Error: ', tensor(34638.0078, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7492549999250521, 0.572032865871557)
('Val: AUC, AUPR, Erros: ', 0.72712349165029, 0.5427913673333896, 4531.7637)
('Test: AUC, AUPR, Erros: ', 0.7174511258263945, 0.5575435301728258, 4693.268)
70((647, 331), (647, 331), 41819.945, 57826.0)
('Error: ', tensor(36106.2188, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.754207378387314, 0.5774156297237473)
('Val: AUC, AUPR, Erros: ', 0.7296260911127156, 0.5445076213601941, 4698.3584)
('Test: AUC, AUPR, Erros: ', 0.721970843513583, 0.5636230880181059, 4905.6504)
80((647, 331), (647, 331), 56818.45, 57826.0)
('Error: ', tensor(34277.5273, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7557822265244826, 0.5806033027206309)
('Val: AUC, AUPR, Erros: ', 0.7302292104956262, 0.5454466040951339, 4511.0894)
('Test: AUC, AUPR, Erros: ', 0.7216429389676458, 0.5637615824626048, 4665.4043)
90((647, 331), (647, 331), 45127.984, 57826.0)
('Error: ', tensor(35269.4062, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7592574479282377, 0.5842683639701907)
('Val: AUC, AUPR, Erros: ', 0.7318539182617293, 0.545901853352477, 4615.8174)
('Test: AUC, AUPR, Erros: ', 0.7248856087761469, 0.5678297365665761, 4795.6323)
100((647, 331), (647, 331), 55474.195, 57826.0)
('Error: ', tensor(34049.6914, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7605690089585196, 0.587213397917704)
('Val: AUC, AUPR, Erros: ', 0.7321948478913729, 0.5467937334955184, 4501.9395)
('Test: AUC, AUPR, Erros: ', 0.7246007603496392, 0.5685404661509667, 4646.046)
110((647, 331), (647, 331), 49206.85, 57826.0)
('Error: ', tensor(34488.7344, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7630240161845481, 0.5897569676983766)
('Val: AUC, AUPR, Erros: ', 0.7335326557860946, 0.5470190971647464, 4542.7407)
('Test: AUC, AUPR, Erros: ', 0.7265951575622791, 0.5705711872193642, 4698.5566)
120((647, 331), (647, 331), 53296.71, 57826.0)
('Error: ', tensor(33930.6641, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7647361550289536, 0.592904921267743)
('Val: AUC, AUPR, Erros: ', 0.7339364702163277, 0.5471044534595457, 4502.9062)
('Test: AUC, AUPR, Erros: ', 0.7264658031569035, 0.5713498686711074, 4643.8423)
130((647, 331), (647, 331), 52154.254, 57826.0)
('Error: ', tensor(33975.1680, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7666917517688225, 0.5949852171784127)
('Val: AUC, AUPR, Erros: ', 0.7345534496654894, 0.5467029189666391, 4509.441)
('Test: AUC, AUPR, Erros: ', 0.7272654094206293, 0.5720517069056553, 4649.0283)
140((647, 331), (647, 331), 50318.277, 57826.0)
('Error: ', tensor(34020.1875, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.768947610851517, 0.5976939665133332)
('Val: AUC, AUPR, Erros: ', 0.7354230463221615, 0.5465263136740448, 4521.222)
('Test: AUC, AUPR, Erros: ', 0.7282019842390417, 0.5733434675875868, 4659.6147)
150((647, 331), (647, 331), 51818.32, 57826.0)
('Error: ', tensor(33793.7969, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7705284871990468, 0.5998262753012572)
('Val: AUC, AUPR, Erros: ', 0.7355948516433909, 0.5457804246563227, 4509.823)
('Test: AUC, AUPR, Erros: ', 0.7277546167912002, 0.5731032613670992, 4643.293)
160((647, 331), (647, 331), 50714.348, 57826.0)
('Error: ', tensor(33825.2070, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7725033969443815, 0.6019021482890182)
('Val: AUC, AUPR, Erros: ', 0.7364496712294286, 0.5455898115860485, 4516.2676)
('Test: AUC, AUPR, Erros: ', 0.7283877315837484, 0.5736463331499839, 4650.0146)

Validation:  [0.7321948478913729, 0.5467937334955184, 4501.9395, 0.7246007603496392, 0.5685404661509667, 4646.046]
Train: 0.7606 0.5872
Test: 0.7246 0.5685
9
[0.6081432625604372, 0.6192022547083754, 0.615558278079551, 0.6131539116943008, 0.611076013238129, 0.6108315495236945, 0.6074912639657637, 0.6048818769942499, 0.6049710137139874, 0.6054610242486876, 0.6114184410953164, 0.6163643672688004, 0.6210937372659464, 0.6229335141242938, 0.6249923781649669, 0.6281770240445006, 0.632120767854773, 0.6356900910616647, 0.6387897115463617, 0.6396429391729936, 0.640239570791767, 0.643267944258013, 0.6443288854100204, 0.6472052332542433, 0.6496583901629849, 0.651970238250175, 0.6540174578610031, 0.6542011628761616, 0.6562712517866546, 0.6565674182240132, 0.6618241386746821, 0.6653189104135544, 0.6681621471855199, 0.6707006720177926, 0.6752982073923144, 0.6768344751851474, 0.6779561521200491, 0.6804486183049894, 0.6804486183049894, 0.6831193772532025, 0.6839429696092463, 0.6865770954925102, 0.6882381000457486, 0.6937568173047732, 0.6977709216231125, 0.6977709216231125, 0.6986146006075564, 0.6986146006075564, 0.7008119603399511, 0.7018070863939148, 0.7018070863939148, 0.7040955810714877, 0.7040955810714877, 0.7040955810714877, 0.7040955810714877, 0.7040955810714877, 0.7040955810714877, 0.7040955810714877, 0.7070194453869875, 0.7070194453869875, 0.7086599782058622, 0.710497596082295, 0.710497596082295, 0.710497596082295, 0.710497596082295, 0.710497596082295, 0.710497596082295, 0.7130144824871191, 0.7130144824871191, 0.7130144824871191, 0.7196718716233675, 0.7196718716233675, 0.7196718716233675, 0.721975807828466, 0.721975807828466, 0.721975807828466, 0.721975807828466, 0.721975807828466, 0.7246007603496392, 0.7246007603496392, 0.7246007603496392, 0.7246007603496392, 0.7246007603496392, 0.7246007603496392, 0.7246007603496392, 0.7246007603496392, 0.7246007603496392, 0.7246007603496392, 0.7246007603496392, 0.7246007603496392]
[0.1934278713202483, 0.2172382133819355, 0.22059362843154873, 0.22228442270684856, 0.22627808969658236, 0.23285998994838017, 0.23133120174008404, 0.23725800447284698, 0.24420250164957613, 0.2471890722974926, 0.263809697449799, 0.2764509982806534, 0.2852532366573519, 0.2888907740508869, 0.29020051837406985, 0.29487299631613345, 0.30496185248949176, 0.31562923638446133, 0.3222152085164207, 0.32594519962972585, 0.32792208554283075, 0.3366333774306574, 0.338263737139742, 0.34736280046169743, 0.3540250531376363, 0.35786444720449667, 0.36490557223978126, 0.36543510063549983, 0.3714984990775758, 0.37136957143046945, 0.3855426056102246, 0.39498010913010206, 0.4049837166529654, 0.41317382618695864, 0.4280625948662474, 0.4322888870200717, 0.43478484322348504, 0.43815532787002337, 0.43815532787002337, 0.44420575478476376, 0.4450808679954187, 0.45419122984842436, 0.46045765737247774, 0.4775340687534062, 0.4900992427400935, 0.4900992427400935, 0.4923055374459149, 0.4923055374459149, 0.4978632195364988, 0.49965269525889233, 0.49965269525889233, 0.5048289117547611, 0.5048289117547611, 0.5048289117547611, 0.5048289117547611, 0.5048289117547611, 0.5048289117547611, 0.5048289117547611, 0.5128123332521496, 0.5128123332521496, 0.517516677461322, 0.5228935403969416, 0.5228935403969416, 0.5228935403969416, 0.5228935403969416, 0.5228935403969416, 0.5228935403969416, 0.5320920291322758, 0.5320920291322758, 0.5320920291322758, 0.5527485536430431, 0.5527485536430431, 0.5527485536430431, 0.5598918088882447, 0.5598918088882447, 0.5598918088882447, 0.5598918088882447, 0.5598918088882447, 0.5685404661509667, 0.5685404661509667, 0.5685404661509667, 0.5685404661509667, 0.5685404661509667, 0.5685404661509667, 0.5685404661509667, 0.5685404661509667, 0.5685404661509667, 0.5685404661509667, 0.5685404661509667, 0.5685404661509667]
AUC: 0.7331 0.0015
AUPR: 0.5496 0.0033
('RARE AUC', [(0.5679247482894251, 0.004268891651262452), (0.5764197974785066, 0.0037932515780838036), (0.5782358298471028, 0.003624580289743636), (0.5779616187886496, 0.0033550684904088174), (0.5823435158190555, 0.0029895718356725736), (0.5838235416814584, 0.002801251960052264), (0.587080886805158, 0.0025322105949068356), (0.5943155453612531, 0.0023267948214620773), (0.5992130522428439, 0.0021733611976322374), (0.60039920721804, 0.0021142982765611643), (0.603998410592486, 0.0020324813075685943), (0.6068111963570566, 0.0019787962080248752), (0.6103244955982395, 0.0019598168801538743), (0.6122688104409363, 0.0019270979702161598), (0.6178666994936498, 0.0018224246698753288), (0.6222804488644188, 0.0018181795471267173), (0.6269170181242948, 0.0017573207319618357), (0.6316557434101419, 0.001708712614560262), (0.6356734267838422, 0.0016504854371728493), (0.6386446414776049, 0.0016765717573329825), (0.6392859533994186, 0.0016709703247216215), (0.64301331667942, 0.0016780181934417438), (0.6461355452520777, 0.0016731986677146935), (0.6496823808745148, 0.001641634428127622), (0.6513535534691195, 0.001624388429311472), (0.656201631494706, 0.0015910639137439006), (0.6581641509639455, 0.0016084782215770785), (0.6590237198670158, 0.001592422948676256), (0.6610516653459817, 0.0015643601433192114), (0.6620607795792659, 0.0015585842509581779), (0.6681111213374902, 0.0015497940824563303), (0.6710368942613172, 0.0015376949703666083), (0.674893971299165, 0.0015596245223530743), (0.6776639559082019, 0.0015569511425023383), (0.6818541611019756, 0.0015492327882765953), (0.6836327453293258, 0.001555245164815343), (0.6846468425224466, 0.001553672615355873), (0.6883316790348938, 0.001542168404809766), (0.6883316790348938, 0.001542168404809766), (0.6907224870148645, 0.0015374901545968137), (0.6918081000932038, 0.001528931857369154), (0.6941507991972763, 0.0015413653249745248), (0.6955030997590298, 0.00154578803617662), (0.7006216415615864, 0.001551172909679757), (0.7043008451084529, 0.001536757833166231), (0.7043008451084529, 0.001536757833166231), (0.7052510269892618, 0.0015283487373507678), (0.7052510269892618, 0.0015283487373507678), (0.7079896184701795, 0.0015242416277027016), (0.7093104084216643, 0.0015250844238780537), (0.7093104084216643, 0.0015250844238780537), (0.7121280547179871, 0.001520638169078454), (0.7121280547179871, 0.001520638169078454), (0.7121280547179871, 0.001520638169078454), (0.7121280547179871, 0.001520638169078454), (0.7121280547179871, 0.001520638169078454), (0.7121280547179871, 0.001520638169078454), (0.7121280547179871, 0.001520638169078454), (0.7155882455646815, 0.0015263289736805591), (0.7155882455646815, 0.0015263289736805591), (0.7172760146760949, 0.0015328287147812042), (0.7192012923142079, 0.0015328313949830627), (0.7192012923142079, 0.0015328313949830627), (0.7192012923142079, 0.0015328313949830627), (0.7192012923142079, 0.0015328313949830627), (0.7192012923142079, 0.0015328313949830627), (0.7192012923142079, 0.0015328313949830627), (0.7214207550654269, 0.0015310701348014214), (0.7214207550654269, 0.0015310701348014214), (0.7214207550654269, 0.0015310701348014214), (0.728253495849346, 0.0015276639739420892), (0.728253495849346, 0.0015276639739420892), (0.728253495849346, 0.0015276639739420892), (0.7305473756585195, 0.0015283744449067702), (0.7305473756585195, 0.0015283744449067702), (0.7305473756585195, 0.0015283744449067702), (0.7305473756585195, 0.0015283744449067702), (0.7305473756585195, 0.0015283744449067702), (0.7330943419492931, 0.00152796313715656), (0.7330943419492931, 0.00152796313715656), (0.7330943419492931, 0.00152796313715656), (0.7330943419492931, 0.00152796313715656), (0.7330943419492931, 0.00152796313715656), (0.7330943419492931, 0.00152796313715656), (0.7330943419492931, 0.00152796313715656), (0.7330943419492931, 0.00152796313715656), (0.7330943419492931, 0.00152796313715656), (0.7330943419492931, 0.00152796313715656), (0.7330943419492931, 0.00152796313715656), (0.7330943419492931, 0.00152796313715656)])
('RARE AUPR', [(0.13976261736349707, 0.0034783313146808654), (0.15435214148696225, 0.0034657463197951487), (0.16034263084172248, 0.0036793243362625923), (0.16526720392461378, 0.0036974235143116744), (0.173552680934813, 0.0037464116823117634), (0.17730769259438833, 0.0038231238945002272), (0.1847420664113643, 0.0036617459909877395), (0.1977987079546995, 0.003800326653461716), (0.20727999756105778, 0.0038720781626169834), (0.210086221841229, 0.003916377938210695), (0.21780558269593464, 0.0037928775191677986), (0.22389417394570843, 0.0037860148718164705), (0.2303294871402527, 0.003865740757750194), (0.23416938398496703, 0.0038236929419699613), (0.24578496392493274, 0.0036757196662233317), (0.2548382215935138, 0.0036581381536594767), (0.2635368164109537, 0.0037530961217925474), (0.27461872296499945, 0.003895438242649566), (0.2824168224670545, 0.0038134475139125885), (0.2888671695331189, 0.003847151352373375), (0.29021884795819697, 0.0038779969784198784), (0.2986034958267473, 0.003925946726060916), (0.30555218146057833, 0.0038146890542132073), (0.3134237129598778, 0.003938630919370604), (0.31728161028067314, 0.003926111250970742), (0.32835460069443373, 0.00392587578238899), (0.3329659342340052, 0.003904725576093857), (0.3346772866997235, 0.0038555429793635135), (0.3398758558107549, 0.003888606761436824), (0.34269346291127883, 0.0038962052355705407), (0.3579733947924973, 0.0038873580141403), (0.36498721387532645, 0.003826295666834588), (0.37487340349337295, 0.003984578686077361), (0.3819272959311465, 0.004044365080896715), (0.39308793048027973, 0.004085062454536637), (0.39765264107183546, 0.00408509815327839), (0.4000194404779956, 0.0040874779128585925), (0.40880665136159705, 0.004012533013869577), (0.40880665136159705, 0.004012533013869577), (0.4162192482136756, 0.0038982484763082498), (0.4187682343447518, 0.003850701258350802), (0.4256293600750231, 0.003915992786432421), (0.4299480347973085, 0.003937832601217676), (0.44550173141278804, 0.00392849079925111), (0.45591977727394023, 0.003891380314404948), (0.45591977727394023, 0.003891380314404948), (0.4581823713331749, 0.003859363298057267), (0.4581823713331749, 0.003859363298057267), (0.46621855758820624, 0.0038631090495099335), (0.4700249345289509, 0.003827779659282586), (0.4700249345289509, 0.003827779659282586), (0.4782006450181517, 0.0038567592842998805), (0.4782006450181517, 0.0038567592842998805), (0.4782006450181517, 0.0038567592842998805), (0.4782006450181517, 0.0038567592842998805), (0.4782006450181517, 0.0038567592842998805), (0.4782006450181517, 0.0038567592842998805), (0.4782006450181517, 0.0038567592842998805), (0.48962375211356934, 0.003829330433069161), (0.48962375211356934, 0.003829330433069161), (0.4948196527991318, 0.003834671777201944), (0.5014760611165916, 0.0037618641716511397), (0.5014760611165916, 0.0037618641716511397), (0.5014760611165916, 0.0037618641716511397), (0.5014760611165916, 0.0037618641716511397), (0.5014760611165916, 0.0037618641716511397), (0.5014760611165916, 0.0037618641716511397), (0.5093469135512821, 0.003677188146577639), (0.5093469135512821, 0.003677188146577639), (0.5093469135512821, 0.003677188146577639), (0.5330054225244235, 0.003458131383018227), (0.5330054225244235, 0.003458131383018227), (0.5330054225244235, 0.003458131383018227), (0.5404778151207389, 0.0033880076856106435), (0.5404778151207389, 0.0033880076856106435), (0.5404778151207389, 0.0033880076856106435), (0.5404778151207389, 0.0033880076856106435), (0.5404778151207389, 0.0033880076856106435), (0.5495622936232336, 0.0032626949780659204), (0.5495622936232336, 0.0032626949780659204), (0.5495622936232336, 0.0032626949780659204), (0.5495622936232336, 0.0032626949780659204), (0.5495622936232336, 0.0032626949780659204), (0.5495622936232336, 0.0032626949780659204), (0.5495622936232336, 0.0032626949780659204), (0.5495622936232336, 0.0032626949780659204), (0.5495622936232336, 0.0032626949780659204), (0.5495622936232336, 0.0032626949780659204), (0.5495622936232336, 0.0032626949780659204), (0.5495622936232336, 0.0032626949780659204)])
