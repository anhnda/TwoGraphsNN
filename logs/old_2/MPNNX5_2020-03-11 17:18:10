class Net5(torch.nn.Module):
    def __init__(self, numNode=10000, numAtomFeature=0):
        super(Net5, self).__init__()

        self.convD1 = SAGEConv(config.EMBED_DIM, config.EMBED_DIM)  # SAGEConv(config.EMBED_DIM, config.EMBED_DIM)
        self.convD2 = SAGEConv(config.EMBED_DIM, config.EMBED_DIM)  # SAGEConv(config.EMBED_DIM, config.EMBED_DIM)

        # self.my_reset_params(self.convD1.weight, config.EMBED_DIM)
        # self.my_reset_params(self.convD1.bias, config.EMBED_DIM)
        #
        # self.my_reset_params(self.convD2.weight, config.EMBED_DIM)
        # self.my_reset_params(self.convD2.bias, config.EMBED_DIM)

        self.convS1 = SAGEConv(config.EMBED_DIM, config.EMBED_DIM)  # SAGEConv(config.EMBED_DIM, config.EMBED_DIM)
        self.convS2 = SAGEConv(config.EMBED_DIM, config.EMBED_DIM)  # SAGEConv(config.EMBED_DIM, config.EMBED_DIM)

        # self.my_reset_params(self.convS1.weight, config.EMBED_DIM)
        # self.my_reset_params(self.convS1.bias, config.EMBED_DIM)
        #
        # self.my_reset_params(self.convS2.weight, config.EMBED_DIM)
        # self.my_reset_params(self.convS2.bias, config.EMBED_DIM)

        self.L1 = Linear(config.CHEM_FINGERPRINT_SIZE, config.EMBED_DIM * 2)
        self.actL1 = F.relu
        self.L2 = Linear(config.EMBED_DIM * 2, config.EMBED_DIM)
        self.actL2 = F.relu

        self.linear1 = Linear(config.EMBED_DIM * 2, config.EMBED_DIM)
        self.act1 = F.relu
        self.linear2 = Linear(config.EMBED_DIM, 1)
        self.act2 = F.relu

        self.nodesEmbedding = torch.nn.Embedding(num_embeddings=numNode + 1, embedding_dim=config.EMBED_DIM)
        # self.nodesEmbedding.weight.data.uniform_(0.001, 0.3)

        # Molecule graph neural net

        self.mlinear1 = Linear(numAtomFeature, config.EMBED_DIM * 2)
        self.mact1 = F.relu
        self.mlinear2 = Linear(config.EMBED_DIM * 2, config.EMBED_DIM)
        self.mact2 = F.relu

        self.conv1 = SAGEConv(config.EMBED_DIM, config.EMBED_DIM)
        self.pool1 = TopKPooling(config.EMBED_DIM, ratio=0.8)
        self.conv2 = SAGEConv(config.EMBED_DIM, config.EMBED_DIM)
        self.pool2 = TopKPooling(config.EMBED_DIM, ratio=0.8)
        self.conv3 = SAGEConv(config.EMBED_DIM, config.EMBED_DIM)
        self.pool3 = TopKPooling(config.EMBED_DIM, ratio=0.8)
        self.lin1 = torch.nn.Linear(config.EMBED_DIM * 2, config.EMBED_DIM)
        self.lin2 = torch.nn.Linear(config.EMBED_DIM, config.EMBED_DIM)

        self.bn1 = torch.nn.BatchNorm1d(128)
        self.bn2 = torch.nn.BatchNorm1d(64)
        self.act1 = torch.nn.ReLU()
        self.act2 = torch.nn.ReLU()

    def my_reset_params(self, tensor, size=10):
        bound = 1.0 / math.sqrt(size)
        if tensor is not None:
            tensor.data.uniform_(0.0, bound)

    def forward(self, x, drugEdges, seEdges, drugNodes, seNodes, drugGraphBatch, nDrug):

        # xDrug, edge_index, batch = drugGraphBatch.x, drugGraphBatch.edge_index, drugGraphBatch.batch
        #
        # # xDrug = self.mact1(self.mlinear1(xDrug))
        # # xDrug = self.mact2(self.mlinear2(xDrug))
        #
        # xDrug = self.nodesEmbedding(xDrug)
        # xDrug = xDrug.squeeze(1)
        #
        # xDrug = F.relu(self.conv1(xDrug, edge_index))
        #
        # v = self.pool1(xDrug, edge_index, None, batch)
        # xDrug, edge_index, _, batch, _, _ = v
        # x1 = torch.cat([gmp(xDrug, batch), gap(xDrug, batch)], dim=1)
        #
        # xDrug = F.relu(self.conv2(xDrug, edge_index))
        #
        # xDrug, edge_index, _, batch, _, _ = self.pool2(xDrug, edge_index, None, batch)
        # x2 = torch.cat([gmp(xDrug, batch), gap(xDrug, batch)], dim=1)
        #
        # xDrug = F.relu(self.conv3(xDrug, edge_index))
        #
        # xDrug, edge_index, _, batch, _, _ = self.pool3(xDrug, edge_index, None, batch)
        # x3 = torch.cat([gmp(xDrug, batch), gap(xDrug, batch)], dim=1)
        #
        # xDrug = x1 + x2 + x3
        #
        # xDrug = self.lin1(xDrug)
        # xDrug = self.act1(xDrug)
        # xDrug = self.lin2(xDrug)
        # xDrug = self.act2(xDrug)
        #
        # x = self.nodesEmbedding(x[nDrug:])
        # x = x.squeeze(1)
        #
        # x = torch.cat((xDrug, x), dim=0)

        x = self.nodesEmbedding(x)

        # Conv Drug:
        # x = self.convD1(x, drugEdges)
        # x = F.relu(x)
        # x = self.convD2(x, drugEdges)
        # x = F.relu(x)
        # # Conv SE:
        # x = self.convS1(x, seEdges)
        # x = F.relu(x)
        # x = self.convS2(x, seEdges)
        # x = F.relu(x)

        drugEmbedding = x[drugNodes]
        seEmbedding = x[seNodes]
        # re = torch.sigmoid(re)
        return drugEmbedding, seEmbedding, x

    def cal(self, drugE, seE):
        return torch.matmul(drugE, seE.t())

    def cal2(self, drugE, seE):
        nDrug, nDim = drugE.shape
        nSe, _ = seE.shape
        preRe = list()
        for i in range(nDrug):
            dE = drugE[i]
            dE = dE.squeeze()
            de = dE.expand((nSe, nDim))
            v = torch.cat((de, seE), dim=1)
            v = self.linear1(v)
            v = self.act1(v)
            v = self.linear2(v)
            # v = self.act2(v)
            v = v.squeeze()
            preRe.append(v)
        return torch.stack(preRe)

('Undirected graph: ', False)
MPNNX
<models.MPNNX5.MPNNX5 object at 0x7f3e7f39bb90>
('Manual torch seed: ', 443181909)
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/KFold/ATCInchikeySideEffectByDrug.txt_train_0
('Number of substructures, proteins, pathways, drugs, se: ', 2936, 1448, 330, 969, 598)
((872, 330), (97, 330), (872, 598), (97, 598))
((872, 598), (872, 598), -4310.666, 88676.0)
('Error: ', tensor(51953784., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5005089897482482, 0.1703299870229478)
('Test: AUC, AUPR: ', 0.5010783838742964, 0.18209182088984638)
((872, 598), (872, 598), -1295.0896, 88676.0)
('Error: ', tensor(36869864., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5011361807484144, 0.17061020639109784)
('Test: AUC, AUPR: ', 0.5010480139864875, 0.1820093348901281)
((872, 598), (872, 598), 1212.3125, 88676.0)
('Error: ', tensor(26298182., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5019284191626399, 0.1709519902788155)
('Test: AUC, AUPR: ', 0.5010214474697307, 0.18192214674713372)
((872, 598), (872, 598), 3379.8572, 88676.0)
('Error: ', tensor(19035312., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5029348487542888, 0.17139147543752029)
('Test: AUC, AUPR: ', 0.5010111068669175, 0.1818530854444794)
((872, 598), (872, 598), 5243.259, 88676.0)
('Error: ', tensor(14029120., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5041411576660525, 0.17192339984064808)
('Test: AUC, AUPR: ', 0.5010552221657485, 0.18185551726888374)
((872, 598), (872, 598), 6817.8315, 88676.0)
('Error: ', tensor(10513676., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5055312679919982, 0.17254389766587996)
('Test: AUC, AUPR: ', 0.50110401507021, 0.18189850524683057)
((872, 598), (872, 598), 8152.51, 88676.0)
('Error: ', tensor(7981383., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5071204215817388, 0.17326052937874747)
('Test: AUC, AUPR: ', 0.5012171368187069, 0.18200932048192284)
((872, 598), (872, 598), 9323.575, 88676.0)
('Error: ', tensor(6110547., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5089314673277534, 0.1740806766042422)
('Test: AUC, AUPR: ', 0.5013451085380655, 0.18214363321911378)
((872, 598), (872, 598), 10383.092, 88676.0)
('Error: ', tensor(4699666., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5109952800990327, 0.17502093460081225)
('Test: AUC, AUPR: ', 0.5014936653272892, 0.1823150569218026)
((872, 598), (872, 598), 11369.647, 88676.0)
('Error: ', tensor(3620762.2500, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.513359832299362, 0.1761140553131099)
('Test: AUC, AUPR: ', 0.5016559154539977, 0.1824831139973294)
((872, 598), (872, 598), 12306.5625, 88676.0)
('Error: ', tensor(2789678.2500, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5160879764960274, 0.1773955514718301)
('Test: AUC, AUPR: ', 0.5018348391267877, 0.1826596035894256)
((872, 598), (872, 598), 13219.74, 88676.0)
('Error: ', tensor(2148294., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5192596939815041, 0.17892169046709172)
('Test: AUC, AUPR: ', 0.5020128394957047, 0.18282127524689762)
((872, 598), (872, 598), 14136.83, 88676.0)
('Error: ', tensor(1654271.1250, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5229603214025889, 0.1807524017674523)
('Test: AUC, AUPR: ', 0.5021810700678906, 0.18295115913815538)
((872, 598), (872, 598), 15083.639, 88676.0)
('Error: ', tensor(1275317.3750, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5272875819535312, 0.18295330476449806)
('Test: AUC, AUPR: ', 0.5023434834251103, 0.18308651369111129)
((872, 598), (872, 598), 16086.862, 88676.0)
('Error: ', tensor(986050.5000, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5323484718997451, 0.18561547348753157)
('Test: AUC, AUPR: ', 0.5024984082070988, 0.18318656461209268)
((872, 598), (872, 598), 17175.627, 88676.0)
('Error: ', tensor(766255.1250, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5382609171864507, 0.18884405645311667)
('Test: AUC, AUPR: ', 0.5026447568780575, 0.1832683975367345)
Train: 0.5444 0.1923
Test: 0.5026 0.1833
[0.5086878624455626, 0.5075670249569102, 0.5188235227687663, 0.5151202065057274, 0.517854144229382, 0.5151470696201097, 0.5086527812269841, 0.503937624833498, 0.5014843281213008, 0.5021329297737357, 0.5010505234124492, 0.5014658888545971, 0.5006675425569179, 0.5000920918809606, 0.4993305441724336, 0.500041850053758, 0.5013554951806299, 0.5006719155576499, 0.5011967301486027, 0.5015510690406936, 0.5005793595714824, 0.5010869892887001, 0.5013349055785328, 0.501160087956523, 0.5016136885761409, 0.5015170594739172, 0.50234824582608, 0.5033165997060092, 0.5034865108910405, 0.5032001849359066, 0.5027598587779277, 0.5021176168904247, 0.5018985772781759, 0.501101152374938, 0.5014070897478409, 0.5014537530692087, 0.5022548497776251, 0.502071184033771, 0.5012347686607264, 0.5012032028895136, 0.501749722596966, 0.5017902909113283, 0.5019924957595127, 0.5019924957595127, 0.5021497158688315, 0.5021026932538966, 0.5019115875922266, 0.5019387048687616, 0.501608051210778, 0.5013329807529814, 0.5013329807529814, 0.5010975739932702, 0.5010975739932702, 0.5014715049246871, 0.5014375266821339, 0.5014375266821339, 0.5007463123082164, 0.5007463123082164, 0.5007463123082164, 0.5007463123082164, 0.5007463123082164, 0.5007463123082164, 0.5007463123082164, 0.5018340805898984, 0.5018340805898984, 0.5017504649454788, 0.5022370986960677, 0.5022370986960677, 0.5022370986960677, 0.5022370986960677, 0.5022370986960677, 0.5022370986960677, 0.5021063392478994, 0.5021063392478994, 0.5021063392478994, 0.5025116150832736, 0.5025116150832736, 0.5025116150832736, 0.5032417107665462, 0.5032417107665462, 0.5032417107665462, 0.5032417107665462, 0.5032417107665462, 0.5026447568780575, 0.5026447568780575, 0.5026447568780575, 0.5026447568780575, 0.5026447568780575, 0.5026447568780575, 0.5026447568780575, 0.5026447568780575, 0.5026447568780575, 0.5026447568780575, 0.5026447568780575, 0.5026447568780575]
[0.058560861205249205, 0.06472112908875431, 0.07210127999725065, 0.07574493954094631, 0.07907850857386828, 0.08374386969618723, 0.08792925338773404, 0.09141650534663696, 0.09323405230905148, 0.09583373231573948, 0.09704080101155016, 0.09930678548321338, 0.10356078872811117, 0.10663173899140918, 0.10762267228604651, 0.10951073065484655, 0.11069042662829486, 0.11231684151675214, 0.11350586593472804, 0.11650716899125681, 0.11867774750172053, 0.12099235358919577, 0.12333834391837589, 0.12556416897131614, 0.12782149899317063, 0.12807864273053954, 0.12996250909723264, 0.13205426552576363, 0.13422132920533245, 0.1349279628701556, 0.1379850801629038, 0.13920777596658676, 0.13967605560443974, 0.14047260999134747, 0.14114510674511022, 0.1448791587487633, 0.14671362345329753, 0.14922302622926328, 0.15058763058176713, 0.1529218105810209, 0.1543572106571088, 0.15508641059207454, 0.15765739175766094, 0.15765739175766094, 0.15913246610209708, 0.15974525593032013, 0.16107689484670867, 0.16195316831832213, 0.16458006228132452, 0.16709162649351006, 0.16709162649351006, 0.1677565001846065, 0.1677565001846065, 0.16952139070136335, 0.1704533544703294, 0.1704533544703294, 0.17162641106167653, 0.17162641106167653, 0.17162641106167653, 0.17162641106167653, 0.17162641106167653, 0.17162641106167653, 0.17162641106167653, 0.1739612231531196, 0.1739612231531196, 0.1749973560291782, 0.17621584089466674, 0.17621584089466674, 0.17621584089466674, 0.17621584089466674, 0.17621584089466674, 0.17621584089466674, 0.17730976577137908, 0.17730976577137908, 0.17730976577137908, 0.180738787778742, 0.180738787778742, 0.180738787778742, 0.1822314297513751, 0.1822314297513751, 0.1822314297513751, 0.1822314297513751, 0.1822314297513751, 0.1832683975367345, 0.1832683975367345, 0.1832683975367345, 0.1832683975367345, 0.1832683975367345, 0.1832683975367345, 0.1832683975367345, 0.1832683975367345, 0.1832683975367345, 0.1832683975367345, 0.1832683975367345, 0.1832683975367345]
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/KFold/ATCInchikeySideEffectByDrug.txt_train_1
('Number of substructures, proteins, pathways, drugs, se: ', 2936, 1448, 330, 969, 598)
((872, 330), (97, 330), (872, 598), (97, 598))
((872, 598), (872, 598), -7244.8896, 89035.0)
('Error: ', tensor(52553444., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.4968712475438276, 0.16974344756838874)
('Test: AUC, AUPR: ', 0.502507554150081, 0.17578964790456367)
((872, 598), (872, 598), -3505.9954, 89035.0)
('Error: ', tensor(37342096., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.4974584012584965, 0.17009109363254568)
('Test: AUC, AUPR: ', 0.502657804451586, 0.17584859544480633)
((872, 598), (872, 598), -252.60767, 89035.0)
('Error: ', tensor(26670332., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.4983265929556987, 0.17055629279493617)
('Test: AUC, AUPR: ', 0.5029066677685914, 0.17595221734870853)
((872, 598), (872, 598), 2413.599, 89035.0)
('Error: ', tensor(19330556., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.4994729905629621, 0.17113212927587754)
('Test: AUC, AUPR: ', 0.5032157588073041, 0.17608658740080743)
((872, 598), (872, 598), 4665.995, 89035.0)
('Error: ', tensor(14266111., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5008675192142412, 0.17180299511633673)
('Test: AUC, AUPR: ', 0.503500549038743, 0.17624276303784117)
((872, 598), (872, 598), 6699.3813, 89035.0)
('Error: ', tensor(10706506., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5024745352866609, 0.17257231437905943)
('Test: AUC, AUPR: ', 0.5037099959627009, 0.1763857310110659)
((872, 598), (872, 598), 8643.023, 89035.0)
('Error: ', tensor(8140175., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5042967603739059, 0.17344476312700172)
('Test: AUC, AUPR: ', 0.5038892518477175, 0.17653485056382195)
((872, 598), (872, 598), 10507.571, 89035.0)
('Error: ', tensor(6242499.5000, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.506356908483425, 0.17443977879233266)
('Test: AUC, AUPR: ', 0.5040502690070038, 0.17668089949733246)
((872, 598), (872, 598), 12299.683, 89035.0)
('Error: ', tensor(4809907., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5086984931536426, 0.1755825764827214)
('Test: AUC, AUPR: ', 0.5042010554389592, 0.17682414327379015)
((872, 598), (872, 598), 14032.01, 89035.0)
('Error: ', tensor(3712974.7500, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5113741170531804, 0.17689594848621934)
('Test: AUC, AUPR: ', 0.5043733385409952, 0.17696788127440338)
((872, 598), (872, 598), 15715.16, 89035.0)
('Error: ', tensor(2866594., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5144481229522725, 0.17842856422930836)
('Test: AUC, AUPR: ', 0.5045455804813841, 0.17709588781995367)
((872, 598), (872, 598), 17361.393, 89035.0)
('Error: ', tensor(2212030.5000, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5180005060380386, 0.18022714292027917)
('Test: AUC, AUPR: ', 0.5047158374013526, 0.17722104777747266)
((872, 598), (872, 598), 18983.129, 89035.0)
('Error: ', tensor(1706560.2500, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5221251902402149, 0.18236163072490805)
('Test: AUC, AUPR: ', 0.5048911006066222, 0.17733738084022718)
((872, 598), (872, 598), 20600.72, 89035.0)
('Error: ', tensor(1317656.7500, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5269287182906561, 0.18491964739661018)
('Test: AUC, AUPR: ', 0.5050552429639474, 0.1774534624373903)
((872, 598), (872, 598), 22239.463, 89035.0)
('Error: ', tensor(1019786., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5325299715718861, 0.18800889427124057)
('Test: AUC, AUPR: ', 0.5052120955936111, 0.1775634993439376)
((872, 598), (872, 598), 23928.008, 89035.0)
('Error: ', tensor(792618., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5390622288900063, 0.19176236059484184)
('Test: AUC, AUPR: ', 0.5053533901497973, 0.17765572018786635)
Train: 0.5459 0.1958
Test: 0.5054 0.1777
[0.5056797842213645, 0.5013248169583528, 0.5004404552619541, 0.4971874149882707, 0.4969601993859724, 0.4968137360257763, 0.5002204754286419, 0.5012769071864104, 0.5011354086152559, 0.5011667750960751, 0.5021117462009219, 0.4999314652743856, 0.5001197192447815, 0.5022447192806483, 0.5027494186988706, 0.5016465947277833, 0.5023908068429691, 0.5024242913788244, 0.5022403186329969, 0.5018886241423529, 0.502470101016645, 0.5032641555747149, 0.503988480020053, 0.504750556432028, 0.5046662475867949, 0.5047696727846643, 0.5050638909842532, 0.5046690915987859, 0.5055360369879844, 0.505360187794339, 0.5047311230311872, 0.5054194587907302, 0.5054402100323188, 0.5048152658777675, 0.5048528096177631, 0.5048335648549527, 0.5044459206424989, 0.5048464556427181, 0.5043374740885612, 0.5043660949043356, 0.5042333397975378, 0.5042981967489258, 0.5043839138992752, 0.5043839138992752, 0.5048195423687052, 0.5044270547604519, 0.5044577786538093, 0.5044890659459014, 0.5049303923303384, 0.5051319472438662, 0.5051319472438662, 0.5046381486559492, 0.5046381486559492, 0.5049145388203999, 0.5050048693359883, 0.5050048693359883, 0.5046164481714249, 0.5046164481714249, 0.5046164481714249, 0.5046164481714249, 0.5046164481714249, 0.5046164481714249, 0.5046164481714249, 0.5047051862126656, 0.5047051862126656, 0.5046479527856064, 0.5046338857561062, 0.5046338857561062, 0.5046338857561062, 0.5046338857561062, 0.5046338857561062, 0.5046338857561062, 0.5047018207181116, 0.5047018207181116, 0.5047018207181116, 0.5048696550205316, 0.5048696550205316, 0.5048696550205316, 0.5051420942544161, 0.5051420942544161, 0.5051420942544161, 0.5051420942544161, 0.5051420942544161, 0.5053533901497973, 0.5053533901497973, 0.5053533901497973, 0.5053533901497973, 0.5053533901497973, 0.5053533901497973, 0.5053533901497973, 0.5053533901497973, 0.5053533901497973, 0.5053533901497973, 0.5053533901497973, 0.5053533901497973]
[0.05772186368915121, 0.0589184662244164, 0.061702450892043105, 0.0657935855869536, 0.0691408497522253, 0.07178436475697231, 0.0771385009754851, 0.08113835357690644, 0.08471024801721873, 0.08610797874372583, 0.08741206778434549, 0.08907736481626992, 0.09308718044070026, 0.09733570566308442, 0.09874230377803883, 0.10064690221499527, 0.10192506028148778, 0.10453626740076208, 0.10567616814165173, 0.10855733186282664, 0.11066633601654642, 0.1135252169806123, 0.11618839121059282, 0.1186613023823746, 0.12012622845144158, 0.12061442191102756, 0.1225113157943523, 0.12399490016937958, 0.12671747478580853, 0.12769821060320136, 0.1307333919215826, 0.13285871131697008, 0.1335412858860959, 0.1346145997405486, 0.13531906734581328, 0.13888648936867942, 0.14042731118498708, 0.1431789108388269, 0.14485622442605012, 0.1473894588743975, 0.14867809932654613, 0.14942977434451882, 0.15207026356781106, 0.15207026356781106, 0.15338067309638556, 0.15391184247166256, 0.15571570830574044, 0.1564310429882398, 0.1592288591961398, 0.16164494319951916, 0.16164494319951916, 0.16224494444889598, 0.16224494444889598, 0.16419916538897797, 0.165011840622714, 0.165011840622714, 0.16653438270456414, 0.16653438270456414, 0.16653438270456414, 0.16653438270456414, 0.16653438270456414, 0.16653438270456414, 0.16653438270456414, 0.168580936867924, 0.168580936867924, 0.16943368577902532, 0.17042357319703155, 0.17042357319703155, 0.17042357319703155, 0.17042357319703155, 0.17042357319703155, 0.17042357319703155, 0.1716207744326619, 0.1716207744326619, 0.1716207744326619, 0.17477360519778706, 0.17477360519778706, 0.17477360519778706, 0.17604911356851066, 0.17604911356851066, 0.17604911356851066, 0.17604911356851066, 0.17604911356851066, 0.17765572018786635, 0.17765572018786635, 0.17765572018786635, 0.17765572018786635, 0.17765572018786635, 0.17765572018786635, 0.17765572018786635, 0.17765572018786635, 0.17765572018786635, 0.17765572018786635, 0.17765572018786635, 0.17765572018786635]
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/KFold/ATCInchikeySideEffectByDrug.txt_train_2
('Number of substructures, proteins, pathways, drugs, se: ', 2936, 1448, 330, 969, 598)
((872, 330), (97, 330), (872, 598), (97, 598))
((872, 598), (872, 598), -602.0642, 87628.0)
('Error: ', tensor(52222848., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.49965518234925566, 0.16726811063540492)
('Test: AUC, AUPR: ', 0.5020814762220837, 0.20216735043332937)
((872, 598), (872, 598), 1561.4305, 87628.0)
('Error: ', tensor(37049744., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5003496229563745, 0.16747860358522354)
('Test: AUC, AUPR: ', 0.5021989125276123, 0.20220260778368598)
((872, 598), (872, 598), 2907.311, 87628.0)
('Error: ', tensor(26423690., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5011698384715573, 0.1677700277362959)
('Test: AUC, AUPR: ', 0.5023899244966918, 0.20227096446171)
((872, 598), (872, 598), 3996.942, 87628.0)
('Error: ', tensor(19124400., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5022296485151752, 0.1681888677165226)
('Test: AUC, AUPR: ', 0.5026879453697276, 0.2023747115410929)
((872, 598), (872, 598), 5085.455, 87628.0)
('Error: ', tensor(14092506., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5035302579122106, 0.16872213958815793)
('Test: AUC, AUPR: ', 0.5029825813879039, 0.20240016427889398)
((872, 598), (872, 598), 6156.8477, 87628.0)
('Error: ', tensor(10558487., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5050471426792652, 0.16936063579765784)
('Test: AUC, AUPR: ', 0.5032556381415652, 0.20248997619461154)
((872, 598), (872, 598), 7190.2197, 87628.0)
('Error: ', tensor(8012371.5000, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.506779311378114, 0.17008685089271125)
('Test: AUC, AUPR: ', 0.5035017399038603, 0.2026049867831206)
((872, 598), (872, 598), 8194.815, 87628.0)
('Error: ', tensor(6131238.5000, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5087507218149031, 0.1709193255688147)
('Test: AUC, AUPR: ', 0.503761148289523, 0.20275316518486275)
((872, 598), (872, 598), 9182.62, 87628.0)
('Error: ', tensor(4712964., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5110029523282633, 0.17188666283021306)
('Test: AUC, AUPR: ', 0.5040350486961422, 0.20291783870013855)
((872, 598), (872, 598), 10170.561, 87628.0)
('Error: ', tensor(3629089., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5135902848975588, 0.17301575648510098)
('Test: AUC, AUPR: ', 0.5043011495032286, 0.20310857429805496)
((872, 598), (872, 598), 11178.2, 87628.0)
('Error: ', tensor(2794930., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5165793269022322, 0.1743508678796472)
('Test: AUC, AUPR: ', 0.5045768405772192, 0.20330935069373174)
((872, 598), (872, 598), 12216.995, 87628.0)
('Error: ', tensor(2151782.5000, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5200431013450492, 0.17593253119766417)
('Test: AUC, AUPR: ', 0.5048437738630522, 0.2035108825103376)
((872, 598), (872, 598), 13294.184, 87628.0)
('Error: ', tensor(1656750.1250, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5240715637520594, 0.17782738108492377)
('Test: AUC, AUPR: ', 0.5051055716675785, 0.20368736602403972)
((872, 598), (872, 598), 14420.4, 87628.0)
('Error: ', tensor(1277109.2500, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5287731225400908, 0.1801062394717364)
('Test: AUC, AUPR: ', 0.5053449754213444, 0.20385586327047414)
((872, 598), (872, 598), 15610.345, 87628.0)
('Error: ', tensor(987213.3750, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5342657397341359, 0.18286257373670495)
('Test: AUC, AUPR: ', 0.5055635755871007, 0.20402358013955818)
((872, 598), (872, 598), 16882.05, 87628.0)
('Error: ', tensor(766738.5000, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5406858948946843, 0.18620702329746985)
('Test: AUC, AUPR: ', 0.5057695479628299, 0.2041886648011619)
Train: 0.5474 0.1898
Test: 0.5058 0.2042
[0.5197533269643336, 0.4963558210117261, 0.49750489975243883, 0.5046770194937291, 0.5044335802558185, 0.5038302081840238, 0.5001585809428741, 0.4987425903910292, 0.49971463702233726, 0.49992980082655064, 0.5004758860301173, 0.5011632884334658, 0.5022133271467543, 0.5030087009012366, 0.5031672879771834, 0.5031039628610702, 0.50334381245164, 0.5037356696013874, 0.5033898751867247, 0.5034007562242305, 0.5033251752961463, 0.5043322135290333, 0.5050952530828426, 0.5053512322284324, 0.5049960497730019, 0.504934597531209, 0.5049183318708874, 0.5046758947546028, 0.5050551043387903, 0.5048312617853072, 0.5042042440102424, 0.5045124083411627, 0.5042547137691664, 0.5045682794431083, 0.5045544520208991, 0.5049094617612465, 0.5041986550083862, 0.5044041288681484, 0.504884155433108, 0.5045009537026512, 0.5046971877221946, 0.5048683154125059, 0.5051768686392965, 0.5051768686392965, 0.5057686458721012, 0.50514219735983, 0.5049241213995839, 0.5049803579869845, 0.505502057275742, 0.5051890653010538, 0.5051890653010538, 0.5053716531039044, 0.5053716531039044, 0.5052076997256278, 0.5056557546679017, 0.5056557546679017, 0.5056266223438289, 0.5056266223438289, 0.5056266223438289, 0.5056266223438289, 0.5056266223438289, 0.5056266223438289, 0.5056266223438289, 0.5056608487780875, 0.5056608487780875, 0.5060815528870358, 0.5064006429891514, 0.5064006429891514, 0.5064006429891514, 0.5064006429891514, 0.5064006429891514, 0.5064006429891514, 0.5062120012538734, 0.5062120012538734, 0.5062120012538734, 0.5058725029794486, 0.5058725029794486, 0.5058725029794486, 0.5059198750531606, 0.5059198750531606, 0.5059198750531606, 0.5059198750531606, 0.5059198750531606, 0.5057695479628299, 0.5057695479628299, 0.5057695479628299, 0.5057695479628299, 0.5057695479628299, 0.5057695479628299, 0.5057695479628299, 0.5057695479628299, 0.5057695479628299, 0.5057695479628299, 0.5057695479628299, 0.5057695479628299]
[0.07405200262609256, 0.07459094517740869, 0.08225773957539573, 0.08802123785090421, 0.09155538296115895, 0.09475866543549083, 0.09956017367760314, 0.10309606478643564, 0.1066208130473358, 0.1088587669181867, 0.11058216660134645, 0.11389759454668866, 0.1191686189372171, 0.1226508139147866, 0.12378373671515151, 0.12556599795956647, 0.12756720443614641, 0.13021328168693497, 0.13127362902305492, 0.13496588236508789, 0.13702487780750738, 0.1398983608336207, 0.14300715992145663, 0.14600008917452803, 0.1478372344101281, 0.1482362559050004, 0.15044496075771643, 0.15283519717949107, 0.15557329228169461, 0.1564092538617697, 0.15880014007823545, 0.16052897162354757, 0.16092247390484812, 0.16206849463036016, 0.1626571963454932, 0.1664122163874812, 0.16802092507916067, 0.17029509514367985, 0.1723160244261716, 0.17473683028905646, 0.17597805699951716, 0.17684692671365354, 0.1795663513699978, 0.1795663513699978, 0.18105748744319888, 0.181516550368093, 0.18282723561594316, 0.18366187211793028, 0.18671901887338793, 0.1885731546208495, 0.1885731546208495, 0.1893865817214132, 0.1893865817214132, 0.19060072588974913, 0.1917603403634481, 0.1917603403634481, 0.19322490451154387, 0.19322490451154387, 0.19322490451154387, 0.19322490451154387, 0.19322490451154387, 0.19322490451154387, 0.19322490451154387, 0.19506222558706995, 0.19506222558706995, 0.19644892790595148, 0.1975807817837598, 0.1975807817837598, 0.1975807817837598, 0.1975807817837598, 0.1975807817837598, 0.1975807817837598, 0.19846419573669752, 0.19846419573669752, 0.19846419573669752, 0.20182417154046747, 0.20182417154046747, 0.20182417154046747, 0.20301527344644188, 0.20301527344644188, 0.20301527344644188, 0.20301527344644188, 0.20301527344644188, 0.2041886648011619, 0.2041886648011619, 0.2041886648011619, 0.2041886648011619, 0.2041886648011619, 0.2041886648011619, 0.2041886648011619, 0.2041886648011619, 0.2041886648011619, 0.2041886648011619, 0.2041886648011619, 0.2041886648011619]
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/KFold/ATCInchikeySideEffectByDrug.txt_train_3
('Number of substructures, proteins, pathways, drugs, se: ', 2936, 1448, 330, 969, 598)
((872, 330), (97, 330), (872, 598), (97, 598))
((872, 598), (872, 598), -47.041565, 89031.0)
('Error: ', tensor(52386832., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.4982306834788548, 0.17031108380296833)
('Test: AUC, AUPR: ', 0.49665368271430116, 0.1737928793445244)
((872, 598), (872, 598), 1403.0342, 89031.0)
('Error: ', tensor(37220248., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.4990433698847331, 0.17068312166734984)
('Test: AUC, AUPR: ', 0.4963698428975341, 0.17385198507557675)
((872, 598), (872, 598), 2900.531, 89031.0)
('Error: ', tensor(26578466., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5000375265295809, 0.17116653313812283)
('Test: AUC, AUPR: ', 0.4962878805049093, 0.1739614936867334)
((872, 598), (872, 598), 4487.465, 89031.0)
('Error: ', tensor(19258860., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5012407794982617, 0.17174096347210063)
('Test: AUC, AUPR: ', 0.4964290160128061, 0.17412451677590496)
((872, 598), (872, 598), 5977.9233, 89031.0)
('Error: ', tensor(14207122., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.502659218548907, 0.17239493535561723)
('Test: AUC, AUPR: ', 0.49659617818603174, 0.17430282451526996)
((872, 598), (872, 598), 7337.381, 89031.0)
('Error: ', tensor(10654616., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5042561171419578, 0.17312229455783612)
('Test: AUC, AUPR: ', 0.496692506680685, 0.17444647451398035)
((872, 598), (872, 598), 8568.329, 89031.0)
('Error: ', tensor(8091507.5000, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5060377149086722, 0.17393230070487883)
('Test: AUC, AUPR: ', 0.4967639894828076, 0.17456954438952163)
((872, 598), (872, 598), 9696.99, 89031.0)
('Error: ', tensor(6194692.5000, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5080265461178147, 0.17485269677881188)
('Test: AUC, AUPR: ', 0.49682268527109497, 0.17468883553932618)
((872, 598), (872, 598), 10751.441, 89031.0)
('Error: ', tensor(4761963.5000, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5102701773308901, 0.17590535176709915)
('Test: AUC, AUPR: ', 0.49685760935256723, 0.17480145947199177)
((872, 598), (872, 598), 11755.999, 89031.0)
('Error: ', tensor(3665030.7500, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5128250274552405, 0.17711981141381353)
('Test: AUC, AUPR: ', 0.4968732202081547, 0.17488793208820316)
((872, 598), (872, 598), 12738.448, 89031.0)
('Error: ', tensor(2819573.5000, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5157647630677593, 0.17854122791910615)
('Test: AUC, AUPR: ', 0.49688492706394294, 0.17496403749191017)
((872, 598), (872, 598), 13722.469, 89031.0)
('Error: ', tensor(2167212.5000, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5191719319488964, 0.18022183314107582)
('Test: AUC, AUPR: ', 0.4968863724182823, 0.17505375765806008)
((872, 598), (872, 598), 14733.582, 89031.0)
('Error: ', tensor(1665179.8750, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5231442897026706, 0.18223104745738286)
('Test: AUC, AUPR: ', 0.49683389525418137, 0.17509171102923873)
((872, 598), (872, 598), 15795.88, 89031.0)
('Error: ', tensor(1280636., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.527784876259542, 0.1846486668222527)
('Test: AUC, AUPR: ', 0.49675789224781147, 0.1751229702578029)
((872, 598), (872, 598), 16936.041, 89031.0)
('Error: ', tensor(987633.3125, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5332131320727117, 0.1875748415037755)
('Test: AUC, AUPR: ', 0.4966543935611684, 0.17515545241009112)
((872, 598), (872, 598), 18181.346, 89031.0)
('Error: ', tensor(765448.1875, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5395559949141243, 0.19113665849955538)
('Test: AUC, AUPR: ', 0.49651838211730337, 0.1751547832074837)
Train: 0.5462 0.1950
Test: 0.4965 0.1752
[0.5156383197578123, 0.5062986490302523, 0.5001773320727936, 0.4961636015292695, 0.4967529739098112, 0.49711011592087395, 0.4957185177930127, 0.49693370782420926, 0.4979946038631008, 0.4981507107933829, 0.49748734932015426, 0.4980722183047102, 0.49751638955965494, 0.49775128314538675, 0.49744287338495863, 0.49741549311201894, 0.496954699239172, 0.4970713621310643, 0.497580113156231, 0.49774020872346486, 0.49835140800261873, 0.4971375529362677, 0.4978441766007859, 0.49700814819097033, 0.4975337058698114, 0.49747212032157107, 0.4981535280522954, 0.4970673472671687, 0.497165226606525, 0.4974312353811326, 0.4972067788964923, 0.49644003679610066, 0.49617881318716, 0.4965205416370002, 0.4964922606840815, 0.49660544899037934, 0.4965866567648004, 0.49626213892024007, 0.4960868867635877, 0.4960083891946262, 0.4959758182319334, 0.495541080349681, 0.49568395552747785, 0.49568395552747785, 0.496142692735389, 0.49609661469451555, 0.49616120700076305, 0.49632487883611365, 0.4959395905315947, 0.4958597755887514, 0.4958597755887514, 0.4958282466793231, 0.4958282466793231, 0.49580869568780767, 0.49598914067455496, 0.49598914067455496, 0.49620692581145504, 0.49620692581145504, 0.49620692581145504, 0.49620692581145504, 0.49620692581145504, 0.49620692581145504, 0.49620692581145504, 0.4962217068837546, 0.4962217068837546, 0.4961268327481455, 0.4956993706207621, 0.4956993706207621, 0.4956993706207621, 0.4956993706207621, 0.4956993706207621, 0.4956993706207621, 0.49568039968390704, 0.49568039968390704, 0.49568039968390704, 0.4962721323397364, 0.4962721323397364, 0.4962721323397364, 0.4963636827904289, 0.4963636827904289, 0.4963636827904289, 0.4963636827904289, 0.4963636827904289, 0.49651838211730337, 0.49651838211730337, 0.49651838211730337, 0.49651838211730337, 0.49651838211730337, 0.49651838211730337, 0.49651838211730337, 0.49651838211730337, 0.49651838211730337, 0.49651838211730337, 0.49651838211730337, 0.49651838211730337]
[0.06638129706293286, 0.06597635082822983, 0.06790831991812199, 0.07131984163294816, 0.07530869679534388, 0.07977833760978871, 0.08303089306394501, 0.08743551325216598, 0.09075882195327206, 0.09286679647338804, 0.09403691125402708, 0.09629135710855603, 0.10046862147398894, 0.1037367845018625, 0.1047917373077919, 0.10660117380413886, 0.10782504853973783, 0.10970530184182134, 0.11140063838157127, 0.1135983612297572, 0.11604196098174892, 0.11812158507315343, 0.12091154196789004, 0.12287084951330411, 0.12457199363140858, 0.12496263718016476, 0.1272720346283079, 0.12832599253816554, 0.13068113852236077, 0.1313593509674811, 0.13438798339843658, 0.1353095193735838, 0.1355269959550548, 0.1364948125820243, 0.1368404812843854, 0.13953245935339267, 0.14109805204384016, 0.1428583081116948, 0.14437348007959144, 0.14663157277093197, 0.1477959950313995, 0.14822914957929395, 0.15088307938847223, 0.15088307938847223, 0.15234635815076297, 0.152958894399733, 0.15423373871009077, 0.15498847169843172, 0.15768593788440932, 0.15989540866785418, 0.15989540866785418, 0.16060319784564742, 0.16060319784564742, 0.16189172860637985, 0.16271867280117702, 0.16271867280117702, 0.16436002079322276, 0.16436002079322276, 0.16436002079322276, 0.16436002079322276, 0.16436002079322276, 0.16436002079322276, 0.16436002079322276, 0.16647021684084745, 0.16647021684084745, 0.16734859142430164, 0.16805279232698953, 0.16805279232698953, 0.16805279232698953, 0.16805279232698953, 0.16805279232698953, 0.16805279232698953, 0.1691953004667606, 0.1691953004667606, 0.1691953004667606, 0.17285432969423448, 0.17285432969423448, 0.17285432969423448, 0.17397727467224164, 0.17397727467224164, 0.17397727467224164, 0.17397727467224164, 0.17397727467224164, 0.1751547832074837, 0.1751547832074837, 0.1751547832074837, 0.1751547832074837, 0.1751547832074837, 0.1751547832074837, 0.1751547832074837, 0.1751547832074837, 0.1751547832074837, 0.1751547832074837, 0.1751547832074837, 0.1751547832074837]
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/KFold/ATCInchikeySideEffectByDrug.txt_train_4
('Number of substructures, proteins, pathways, drugs, se: ', 2936, 1448, 330, 969, 598)
((872, 330), (97, 330), (872, 598), (97, 598))
((872, 598), (872, 598), 2322.4434, 89931.0)
('Error: ', tensor(52055376., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.49923534155025423, 0.173337041237786)
('Test: AUC, AUPR: ', 0.4996113671426492, 0.1596274258705611)
((872, 598), (872, 598), 4806.9, 89931.0)
('Error: ', tensor(36946724., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5000205663343112, 0.17375005561754828)
('Test: AUC, AUPR: ', 0.49944653550260365, 0.15960490573662658)
((872, 598), (872, 598), 6674.298, 89931.0)
('Error: ', tensor(26359812., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5009966468115806, 0.17424976311664617)
('Test: AUC, AUPR: ', 0.49925139314310657, 0.15952410057931754)
((872, 598), (872, 598), 8211.895, 89931.0)
('Error: ', tensor(19086804., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5021808092897226, 0.1748375926802391)
('Test: AUC, AUPR: ', 0.4990414283443557, 0.15944057143005916)
((872, 598), (872, 598), 9689.307, 89931.0)
('Error: ', tensor(14072999., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5035715581805721, 0.17551197191016918)
('Test: AUC, AUPR: ', 0.49876418480514895, 0.1593306000415385)
((872, 598), (872, 598), 11065.679, 89931.0)
('Error: ', tensor(10550964., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5051466371403446, 0.1762751026991808)
('Test: AUC, AUPR: ', 0.4984419920167155, 0.1592196601278501)
((872, 598), (872, 598), 12270.724, 89931.0)
('Error: ', tensor(8012469., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5069110029203131, 0.17713214557530074)
('Test: AUC, AUPR: ', 0.4980925196915646, 0.15905852990628577)
