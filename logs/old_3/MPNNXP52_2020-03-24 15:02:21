class Net52(torch.nn.Module):
    def __init__(self, numNode=10000, numAtomFeature=0):
        super(Net52, self).__init__()

        self.convD1 = GATConv(config.EMBED_DIM, config.EMBED_DIM)  # SAGEConv(config.EMBED_DIM, config.EMBED_DIM)
        self.convD2 = GATConv(config.EMBED_DIM, config.EMBED_DIM)  # SAGEConv(config.EMBED_DIM, config.EMBED_DIM)

        # self.my_reset_params(self.convD1.weight, config.EMBED_DIM)
        # self.my_reset_params(self.convD1.bias, config.EMBED_DIM)
        #
        # self.my_reset_params(self.convD2.weight, config.EMBED_DIM)
        # self.my_reset_params(self.convD2.bias, config.EMBED_DIM)

        self.convS1 = GATConv(config.EMBED_DIM, config.EMBED_DIM)  # SAGEConv(config.EMBED_DIM, config.EMBED_DIM)
        self.convS2 = GATConv(config.EMBED_DIM, config.EMBED_DIM)  # SAGEConv(config.EMBED_DIM, config.EMBED_DIM)

        # self.my_reset_params(self.convS1.weight, config.EMBED_DIM)
        # self.my_reset_params(self.convS1.bias, config.EMBED_DIM)
        #
        # self.my_reset_params(self.convS2.weight, config.EMBED_DIM)
        # self.my_reset_params(self.convS2.bias, config.EMBED_DIM)

        self.L1 = Linear(config.CHEM_FINGERPRINT_SIZE, config.EMBED_DIM * 2)
        self.actL1 = F.relu
        self.L2 = Linear(config.EMBED_DIM * 2, config.EMBED_DIM)
        self.actL2 = F.relu

        self.linear1 = Linear(config.EMBED_DIM * 2, config.EMBED_DIM)
        self.act1 = F.relu
        self.linear2 = Linear(config.EMBED_DIM, 1)
        self.act2 = F.relu

        self.nodesEmbedding = torch.nn.Embedding(num_embeddings=numNode + 1, embedding_dim=config.EMBED_DIM)
        self.nodesEmbedding.weight.data.uniform_(0.001, 0.3)

        # Molecule graph neural net

        self.mlinear1 = Linear(numAtomFeature, config.EMBED_DIM * 2)
        self.mact1 = F.relu
        self.mlinear2 = Linear(config.EMBED_DIM * 2, config.EMBED_DIM)
        self.mact2 = F.relu

        self.conv1 = EATConv(config.EMBED_DIM, config.EMBED_DIM)
        self.conv1g = GATConv(config.EMBED_DIM, config.EMBED_DIM)

        self.pool1 = TopKPooling(config.EMBED_DIM, ratio=0.8)
        self.conv2 = EATConv(config.EMBED_DIM, config.EMBED_DIM)
        self.conv2g = GATConv(config.EMBED_DIM, config.EMBED_DIM)

        self.pool2 = TopKPooling(config.EMBED_DIM, ratio=0.8)
        self.conv3 = EATConv(config.EMBED_DIM, config.EMBED_DIM)
        self.conv3g = GATConv(config.EMBED_DIM, config.EMBED_DIM)

        self.pool3 = TopKPooling(config.EMBED_DIM, ratio=0.8)

        self.lin1 = torch.nn.Linear(config.EMBED_DIM * 2, config.EMBED_DIM)
        self.lin2 = torch.nn.Linear(config.EMBED_DIM, config.EMBED_DIM)

        self.bn1 = torch.nn.BatchNorm1d(128)
        self.bn2 = torch.nn.BatchNorm1d(64)
        self.act1 = torch.nn.ReLU()
        self.act2 = torch.nn.ReLU()

    def my_reset_params(self, tensor, size=10):
        bound = 1.0 / math.sqrt(size)
        if tensor is not None:
            tensor.data.uniform_(0.0, bound)

    def forward(self, x, drugEdges, seEdges, drugNodes, seNodes, proteinNodes, proteinWeight, drugGraphBatch, nDrug, drugFeatures = None):


        if config.INNER_FEATURE and drugFeatures is not None:
            nDrug = drugFeatures.shape[0]
            x = self.nodesEmbedding(x[nDrug:])
            x = x.squeeze(1)

            xDrug = self.L1(drugFeatures)
            xDrug = self.actL1(xDrug)
            xDrug = self.L2(xDrug)
            xDrug = self.actL2(xDrug)

            x = torch.cat((xDrug, x), dim=0)

        elif config.INNER_GRAPH:
            xAtom, edge_index, batch = drugGraphBatch.x, drugGraphBatch.edge_index, drugGraphBatch.batch
            # xDrug = self.mact1(self.mlinear1(xDrug))
            # xDrug = self.mact2(self.mlinear2(xDrug))

            xProtein = self.nodesEmbedding(proteinNodes)

            xAtom = self.nodesEmbedding(xAtom)
            xAtom = xAtom.squeeze(1)




            iLevel = 0
            if config.BOTH_GRAPH and config.EXT_MODE and iLevel >= config.INTER_LEVELS:
                xAtom = F.relu(self.conv1(xAtom, edge_index, xProtein, proteinWeight))
            else:
                xAtom = F.relu(self.conv1g(xAtom, edge_index))
            xAtom, edge_index, _, batch, _, _ = self.pool1(xAtom, edge_index, None, batch)
            x1 = torch.cat([gmp(xAtom, batch), gap(xAtom, batch)], dim=1)
            iLevel += 1

            if config.BOTH_GRAPH and config.EXT_MODE and iLevel >= config.INTER_LEVELS:
                xAtom = F.relu(self.conv2(xAtom, edge_index, xProtein, proteinWeight))
            else:
                xAtom = F.relu(self.conv2g(xAtom, edge_index))

            iLevel += 1
            xAtom, edge_index, _, batch, _, _ = self.pool2(xAtom, edge_index, None, batch)
            x2 = torch.cat([gmp(xAtom, batch), gap(xAtom, batch)], dim=1)

            if config.BOTH_GRAPH and config.EXT_MODE and iLevel >= config.INTER_LEVELS:
                xAtom = F.relu(self.conv3(xAtom, edge_index, xProtein, proteinWeight))
            else:
                xAtom = F.relu(self.conv3g(xAtom, edge_index))

            xAtom, edge_index, _, batch, _, _ = self.pool3(xAtom, edge_index, None, batch)
            x3 = torch.cat([gmp(xAtom, batch), gap(xAtom, batch)], dim=1)

            xDrug = x1 + x2 + x3

            xDrug = self.lin1(xDrug)
            xDrug = self.act1(xDrug)
            xDrug = self.lin2(xDrug)
            xDrug = self.act2(xDrug)

            x = self.nodesEmbedding(x[nDrug:])
            x = x.squeeze(1)

            x = torch.cat((xDrug, x), dim=0)
        else:
            x = self.nodesEmbedding(x)

        if config.OUTER_GRAPH:
            # Conv Drug:
            x = self.convD1(x, drugEdges)
            x = F.relu(x)
            x = self.convD2(x, drugEdges)
            x = F.relu(x)

        if config.SE_GRAPH:
            # Conv SE:
            x = self.convS1(x, seEdges)
            x = F.relu(x)
            # x = self.convS2(x, seEdges)
            # x = F.relu(x)

        drugEmbedding = x[drugNodes]
        seEmbedding = x[seNodes]
        # re = torch.sigmoid(re)
        return drugEmbedding, seEmbedding, x

    def cal(self, drugE, seE):
        return torch.matmul(drugE, seE.t())

    def cal2(self, drugE, seE):
        nDrug, nDim = drugE.shape
        nSe, _ = seE.shape
        preRe = list()
        for i in range(nDrug):
            dE = drugE[i]
            dE = dE.squeeze()
            de = dE.expand((nSe, nDim))
            v = torch.cat((de, seE), dim=1)
            v = self.linear1(v)
            v = self.act1(v)
            v = self.linear2(v)
            # v = self.act2(v)
            v = v.squeeze()
            preRe.append(v)
        return torch.stack(preRe)

('Undirected graph: ', False)
('Protein Test: ', True)
('Inner Graph, Outer Graph, Se Graph: ', True, True, False)
('Drug Features: ', False)
('Cross Prob: ', 0.5)
('Inner Level: ', 0)
MPNNX
<models.MPNNXP5.MPNNXP5 object at 0x7f2ee2352550>
('Manual torch seed: ', 1772727637)
('Config: ', 'Protein Test: ', True, 'KNN: ', 2)
('EXT MODE: ', False)
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/KFold/ATCInchikeySideEffectByDrug.txt_P3_0
('Number of substructures, proteins, pathways, drugs, se: ', 888, 1448, 330, 808, 331)
((646, 2666), (81, 2666), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19906.0)
('VALIDATE SUM PROTEIN TEST: ', 2291.0)
((646, 331), (646, 331), 181977.98, 58595.0)
('Error: ', tensor(115677.0156, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.4986766899730064, 0.2751845543723532)
('Val: AUC, AUPR, Erros: ', 0.512319094900155, 0.2894938469538055, 14356.52)
('Test: AUC, AUPR, Erros: ', 0.49239567744281043, 0.25267191137344175, 14773.208)
((646, 331), (646, 331), 63801.848, 58595.0)
('Error: ', tensor(40509.1484, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6626497677072453, 0.4742419038831217)
('Val: AUC, AUPR, Erros: ', 0.6354922643949421, 0.44653017847677307, 5187.431)
('Test: AUC, AUPR, Erros: ', 0.6405882826076249, 0.4318092323025756, 4913.4834)
((646, 331), (646, 331), 85738.91, 58595.0)
('Error: ', tensor(39450.7188, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7493928003839376, 0.5815678665293207)
('Val: AUC, AUPR, Erros: ', 0.6947889087651586, 0.5200100236193351, 5195.17)
('Test: AUC, AUPR, Erros: ', 0.7061913624887515, 0.5090222263448932, 5044.6514)
((646, 331), (646, 331), 78573.086, 58595.0)
('Error: ', tensor(35707.4844, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7716712210531398, 0.6086057069907073)
('Val: AUC, AUPR, Erros: ', 0.706105443941298, 0.5292572792108925, 4898.7695)
('Test: AUC, AUPR, Erros: ', 0.72027864856836, 0.5214596808770295, 4683.7275)
((646, 331), (646, 331), 70472.79, 58595.0)
('Error: ', tensor(33731.3906, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7820774712036734, 0.6223703684552859)
('Val: AUC, AUPR, Erros: ', 0.7086821116749193, 0.5295567842941602, 4756.13)
('Test: AUC, AUPR, Erros: ', 0.7235610529100263, 0.5226912438503493, 4484.2783)
((646, 331), (646, 331), 69678.086, 58595.0)
('Error: ', tensor(33120.1602, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7888464331142574, 0.6322675856689701)
('Val: AUC, AUPR, Erros: ', 0.7078240812436426, 0.5271645270781643, 4781.474)
('Test: AUC, AUPR, Erros: ', 0.723165831713731, 0.5206123879567376, 4492.847)
((646, 331), (646, 331), 68636.93, 58595.0)
('Error: ', tensor(32634.2617, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7946469994131427, 0.6410225778145396)
('Val: AUC, AUPR, Erros: ', 0.705703805988696, 0.5237946318819917, 4804.2573)
('Test: AUC, AUPR, Erros: ', 0.7210433339260409, 0.5170171768286296, 4504.2383)
((646, 331), (646, 331), 68824.54, 58595.0)
('Error: ', tensor(32245.5469, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.801108355817082, 0.6509954491504074)
('Val: AUC, AUPR, Erros: ', 0.70394742004437, 0.5207177926098847, 4835.68)
('Test: AUC, AUPR, Erros: ', 0.7178977074360889, 0.5127740837704812, 4541.169)
((646, 331), (646, 331), 69208.85, 58595.0)
('Error: ', tensor(31879.9453, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8081665939806972, 0.6618459822862889)
('Val: AUC, AUPR, Erros: ', 0.703107269276363, 0.5194421919250362, 4860.9546)
('Test: AUC, AUPR, Erros: ', 0.7129180238017305, 0.5063436919842007, 4590.4116)
((646, 331), (646, 331), 67711.08, 58595.0)
('Error: ', tensor(31494.8984, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.812559012761027, 0.6681304299502671)
('Val: AUC, AUPR, Erros: ', 0.6999750748445398, 0.5154954892900727, 4877.0967)
('Test: AUC, AUPR, Erros: ', 0.7056959045375474, 0.4993036254874658, 4607.471)
((646, 331), (646, 331), 66716.945, 58595.0)
('Error: ', tensor(31248.4727, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8152231879717233, 0.6719376195907817)
('Val: AUC, AUPR, Erros: ', 0.6956799217701702, 0.509030024826414, 4910.9927)
('Test: AUC, AUPR, Erros: ', 0.700482613913403, 0.49345184197786446, 4630.263)
Train: 0.7821 0.6224
Test: 0.7236 0.5227
[0.5560145644160748, 0.5586165721352723, 0.5613266880126225, 0.5615723145597413, 0.5730508197314501, 0.5762961887521472, 0.5790198626361868, 0.585368968742386, 0.5902108983474756, 0.592556664578724, 0.5951177597510403, 0.5995027722141798, 0.6045212745727327, 0.6053349521922544, 0.6102510687502982, 0.6178629590092084, 0.6205364168168084, 0.6244905600749135, 0.6284982272462425, 0.6308518392076214, 0.6312694287897681, 0.6339232916684713, 0.6374388382833285, 0.639262498118743, 0.6408053820429692, 0.6459975284851059, 0.6486665249237514, 0.6484557106513591, 0.6510344148330074, 0.652343033519717, 0.6580089428735447, 0.659987990227455, 0.6626552356088475, 0.6653479872781917, 0.6702723382641177, 0.6718329367220512, 0.6727387867876291, 0.6762594332960254, 0.6762594332960254, 0.6785849623751548, 0.6794064265959844, 0.6819716314151981, 0.6830523245066722, 0.688388876694529, 0.692013429534408, 0.692013429534408, 0.6932638214102999, 0.6932638214102999, 0.6963896649118397, 0.6976173182342879, 0.6976173182342879, 0.700858492330315, 0.700858492330315, 0.700858492330315, 0.700858492330315, 0.700858492330315, 0.700858492330315, 0.700858492330315, 0.7045625079152562, 0.7045625079152562, 0.7065027854012629, 0.7081578262333796, 0.7081578262333796, 0.7081578262333796, 0.7081578262333796, 0.7081578262333796, 0.7081578262333796, 0.7109749717758286, 0.7109749717758286, 0.7109749717758286, 0.7185765877663434, 0.7185765877663434, 0.7185765877663434, 0.720772544363165, 0.720772544363165, 0.720772544363165, 0.720772544363165, 0.720772544363165, 0.7235610529100263, 0.7235610529100263, 0.7235610529100263, 0.7235610529100263, 0.7235610529100263, 0.7235610529100263, 0.7235610529100263, 0.7235610529100263, 0.7235610529100263, 0.7235610529100263, 0.7235610529100263, 0.7235610529100263]
[0.13471662626200992, 0.14201435569706228, 0.15034246768155968, 0.158386612966334, 0.16801919943743712, 0.17889941308849044, 0.1848826544709249, 0.19354361240785328, 0.20463177822419698, 0.20848764634168226, 0.21351134339212954, 0.2226612504537095, 0.23032479679966253, 0.23279304431369746, 0.24234336385967403, 0.2531563842902794, 0.25509941474769204, 0.2659203537082075, 0.2764820640583805, 0.28117810359219086, 0.28250747481867067, 0.28680921132170345, 0.292871212500313, 0.29314885729161827, 0.2960456537350995, 0.3065810971855265, 0.3137048482035222, 0.3121601642796531, 0.31700914419712395, 0.3209577474081534, 0.3355625402773721, 0.33936688673340365, 0.3452769885450231, 0.3538424782037184, 0.36654562961688386, 0.3712835459019613, 0.37384648026753015, 0.38140925367103146, 0.38140925367103146, 0.3884223526814523, 0.38971298685199335, 0.39751258905004927, 0.4012986469585478, 0.41639666219215576, 0.4258868537049906, 0.4258868537049906, 0.4285253321296872, 0.4285253321296872, 0.4373298391245586, 0.44013506729097207, 0.44013506729097207, 0.4492458861780566, 0.4492458861780566, 0.4492458861780566, 0.4492458861780566, 0.4492458861780566, 0.4492458861780566, 0.4492458861780566, 0.4607274895178275, 0.4607274895178275, 0.46629636786966516, 0.47124705801662015, 0.47124705801662015, 0.47124705801662015, 0.47124705801662015, 0.47124705801662015, 0.47124705801662015, 0.4816824080576088, 0.4816824080576088, 0.4816824080576088, 0.5072951375411054, 0.5072951375411054, 0.5072951375411054, 0.5137050967390588, 0.5137050967390588, 0.5137050967390588, 0.5137050967390588, 0.5137050967390588, 0.5226912438503493, 0.5226912438503493, 0.5226912438503493, 0.5226912438503493, 0.5226912438503493, 0.5226912438503493, 0.5226912438503493, 0.5226912438503493, 0.5226912438503493, 0.5226912438503493, 0.5226912438503493, 0.5226912438503493]
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/KFold/ATCInchikeySideEffectByDrug.txt_P3_1
('Number of substructures, proteins, pathways, drugs, se: ', 888, 1448, 330, 808, 331)
((646, 2666), (81, 2666), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19911.0)
('VALIDATE SUM PROTEIN TEST: ', 2446.0)
((646, 331), (646, 331), 175728.94, 58221.0)
('Error: ', tensor(108012.7188, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5266256386658177, 0.2866896999173997)
('Val: AUC, AUPR, Erros: ', 0.5170616980395331, 0.27596740630127825, 13718.51)
('Test: AUC, AUPR, Erros: ', 0.5113499218295734, 0.28496978651222304, 13280.37)
((646, 331), (646, 331), 64008.54, 58221.0)
('Error: ', tensor(39742.7109, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7054587178920909, 0.518552677831602)
('Val: AUC, AUPR, Erros: ', 0.6804351801994855, 0.482468478636274, 4997.4897)
('Test: AUC, AUPR, Erros: ', 0.6640838456396209, 0.4739638027565579, 5134.707)
((646, 331), (646, 331), 66817.8, 58221.0)
('Error: ', tensor(36592.8867, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7594696771794002, 0.5887500430475854)
('Val: AUC, AUPR, Erros: ', 0.7251032226484044, 0.5370659690610939, 4692.4087)
('Test: AUC, AUPR, Erros: ', 0.6992825098695603, 0.5184270369411099, 4869.731)
((646, 331), (646, 331), 72224.914, 58221.0)
('Error: ', tensor(34651.3789, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.776879927772842, 0.6130143774281306)
('Val: AUC, AUPR, Erros: ', 0.7348580205415954, 0.5441781905076275, 4578.0415)
('Test: AUC, AUPR, Erros: ', 0.707001195385175, 0.5234992692508273, 4788.9775)
((646, 331), (646, 331), 71437.22, 58221.0)
('Error: ', tensor(33240.5234, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7910641311011284, 0.6345969422914317)
('Val: AUC, AUPR, Erros: ', 0.7401232778082085, 0.5472482277804751, 4504.4663)
('Test: AUC, AUPR, Erros: ', 0.7106095165811515, 0.5202219117602127, 4770.956)
((646, 331), (646, 331), 69030.97, 58221.0)
('Error: ', tensor(32380.9492, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8004844346615195, 0.6496108695913858)
('Val: AUC, AUPR, Erros: ', 0.742360845774972, 0.5499056235198997, 4459.865)
('Test: AUC, AUPR, Erros: ', 0.7120588088614609, 0.5202290545012643, 4758.828)
((646, 331), (646, 331), 67654.984, 58221.0)
('Error: ', tensor(31903.4453, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8059899785370708, 0.6582313883898496)
('Val: AUC, AUPR, Erros: ', 0.7404956559556322, 0.5444759143831889, 4479.0464)
('Test: AUC, AUPR, Erros: ', 0.7107769057331104, 0.5200587386393469, 4758.244)
((646, 331), (646, 331), 67011.3, 58221.0)
('Error: ', tensor(31588.4414, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8098720761880747, 0.6642960632390056)
('Val: AUC, AUPR, Erros: ', 0.7375966556675525, 0.5368538504658404, 4513.295)
('Test: AUC, AUPR, Erros: ', 0.708705883303717, 0.5175560326199888, 4767.0625)
((646, 331), (646, 331), 66339.87, 58221.0)
('Error: ', tensor(31347.5000, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8126484458688288, 0.6682979847498492)
('Val: AUC, AUPR, Erros: ', 0.734786036055829, 0.5313176948580081, 4534.049)
('Test: AUC, AUPR, Erros: ', 0.7067223251339921, 0.5145216871540406, 4777.993)
((646, 331), (646, 331), 66178.93, 58221.0)
('Error: ', tensor(31149.3125, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8152241659803096, 0.6719251008779213)
('Val: AUC, AUPR, Erros: ', 0.7318316388264288, 0.5270029340600895, 4557.376)
('Test: AUC, AUPR, Erros: ', 0.705166601023862, 0.5127296839168658, 4789.6104)
((646, 331), (646, 331), 66183.47, 58221.0)
('Error: ', tensor(30950.1777, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.817865576129747, 0.67575802532489)
('Val: AUC, AUPR, Erros: ', 0.7282148277013026, 0.522976210368075, 4584.2324)
('Test: AUC, AUPR, Erros: ', 0.7039611656614868, 0.5117172336546051, 4798.782)
Train: 0.8005 0.6496
Test: 0.7121 0.5202
[0.5805286172528782, 0.5617329914791367, 0.5706957614003594, 0.5758295303093447, 0.5803631701669547, 0.5782871311590453, 0.5809408688173039, 0.5870525046896791, 0.5916837846066145, 0.5919890999113394, 0.5935701734316862, 0.5959255481153497, 0.5982605680857522, 0.5995089492396872, 0.6047673466978128, 0.6072273534365474, 0.6115695296742012, 0.6162628532590744, 0.61966199790002, 0.6211976777985275, 0.6216832513329474, 0.6241750385737819, 0.6253238882951673, 0.6270650614067221, 0.6284924666710924, 0.6341244941064924, 0.6360794271121678, 0.636403437607697, 0.638332455920468, 0.6395203734623761, 0.646241456742106, 0.6488916276788788, 0.6530916679111001, 0.6561529393816288, 0.6602866662812531, 0.6616109921259542, 0.6623215368178581, 0.6659910217757204, 0.6659910217757204, 0.6682910338661705, 0.6691810626194546, 0.6718914467934023, 0.6736846578444369, 0.6795015684718317, 0.682816044587454, 0.682816044587454, 0.6834243343420824, 0.6834243343420824, 0.6860810845624966, 0.687976710133319, 0.687976710133319, 0.6910871574709652, 0.6910871574709652, 0.6910871574709652, 0.6910871574709652, 0.6910871574709652, 0.6910871574709652, 0.6910871574709652, 0.6942759191901062, 0.6942759191901062, 0.6959329377591825, 0.6980125989233772, 0.6980125989233772, 0.6980125989233772, 0.6980125989233772, 0.6980125989233772, 0.6980125989233772, 0.6998442956157249, 0.6998442956157249, 0.6998442956157249, 0.7068588399938793, 0.7068588399938793, 0.7068588399938793, 0.7093025557752332, 0.7093025557752332, 0.7093025557752332, 0.7093025557752332, 0.7093025557752332, 0.7120588088614609, 0.7120588088614609, 0.7120588088614609, 0.7120588088614609, 0.7120588088614609, 0.7120588088614609, 0.7120588088614609, 0.7120588088614609, 0.7120588088614609, 0.7120588088614609, 0.7120588088614609, 0.7120588088614609]
[0.18227647891615034, 0.16997999854286788, 0.18946582026426811, 0.19172738572216977, 0.19882024895092834, 0.19931995486807932, 0.2040029639784701, 0.21608872945961835, 0.22597026728201186, 0.22782208802291903, 0.23132857679097119, 0.23621122784918894, 0.24015627242153773, 0.24224693831021418, 0.25125139169534005, 0.2559376339849563, 0.264939898305188, 0.27545969194141273, 0.28238034075697177, 0.2862942826808426, 0.2871749251704467, 0.29211389832270535, 0.29550090776323956, 0.30038815902427063, 0.30328944103829586, 0.31567120111280467, 0.32025020874378807, 0.32079938890345777, 0.32581241653851856, 0.3289562498291063, 0.3449489448030123, 0.35065029638951345, 0.36175858167054187, 0.3689088171938335, 0.37800498318984477, 0.38106358308224053, 0.3826348532648353, 0.39151000649641493, 0.39151000649641493, 0.3964396116595595, 0.39892817376279055, 0.40577735415335714, 0.41133170448902245, 0.4270534485788084, 0.43573588208668296, 0.43573588208668296, 0.4368191163112215, 0.4368191163112215, 0.4440703293139671, 0.44875074191851283, 0.44875074191851283, 0.45692383694370997, 0.45692383694370997, 0.45692383694370997, 0.45692383694370997, 0.45692383694370997, 0.45692383694370997, 0.45692383694370997, 0.4658062659007426, 0.4658062659007426, 0.47065982331875517, 0.4766585987737735, 0.4766585987737735, 0.4766585987737735, 0.4766585987737735, 0.4766585987737735, 0.4766585987737735, 0.48167978729612637, 0.48167978729612637, 0.48167978729612637, 0.5036012751275137, 0.5036012751275137, 0.5036012751275137, 0.5113716834286934, 0.5113716834286934, 0.5113716834286934, 0.5113716834286934, 0.5113716834286934, 0.5202290545012643, 0.5202290545012643, 0.5202290545012643, 0.5202290545012643, 0.5202290545012643, 0.5202290545012643, 0.5202290545012643, 0.5202290545012643, 0.5202290545012643, 0.5202290545012643, 0.5202290545012643, 0.5202290545012643]
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/KFold/ATCInchikeySideEffectByDrug.txt_P3_2
('Number of substructures, proteins, pathways, drugs, se: ', 888, 1448, 330, 808, 331)
((646, 2666), (81, 2666), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19946.0)
('VALIDATE SUM PROTEIN TEST: ', 2286.0)
((646, 331), (646, 331), 112697.04, 58507.0)
('Error: ', tensor(56974.6719, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5015738791156956, 0.2772099240667073)
('Val: AUC, AUPR, Erros: ', 0.5067829343398182, 0.2757182079425784, 7139.9004)
('Test: AUC, AUPR, Erros: ', 0.5091880077716313, 0.27462440931432364, 7133.931)
((646, 331), (646, 331), 70904.32, 58507.0)
('Error: ', tensor(40188.0312, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6981391200354634, 0.5122328326399093)
('Val: AUC, AUPR, Erros: ', 0.6953287928741592, 0.49719186101682794, 5017.686)
('Test: AUC, AUPR, Erros: ', 0.672277464111797, 0.4723775509958671, 5054.907)
((646, 331), (646, 331), 74793.72, 58507.0)
('Error: ', tensor(36971.7461, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7583406968904413, 0.5888327564261262)
('Val: AUC, AUPR, Erros: ', 0.7420259112787814, 0.5579464388194293, 4706.034)
('Test: AUC, AUPR, Erros: ', 0.7224691269688681, 0.5331434337421836, 4765.7007)
((646, 331), (646, 331), 72938.25, 58507.0)
('Error: ', tensor(34785.2695, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7738934091196951, 0.6088749494630249)
('Val: AUC, AUPR, Erros: ', 0.7513599878814656, 0.5711298819693245, 4499.883)
('Test: AUC, AUPR, Erros: ', 0.7333554817153312, 0.5432498065168507, 4581.717)
((646, 331), (646, 331), 70941.77, 58507.0)
('Error: ', tensor(33583.8359, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7845201178560058, 0.6246473019728679)
('Val: AUC, AUPR, Erros: ', 0.7580924094572858, 0.581221259423577, 4397.68)
('Test: AUC, AUPR, Erros: ', 0.737663817327429, 0.5466644171204267, 4504.8784)
((646, 331), (646, 331), 69504.07, 58507.0)
('Error: ', tensor(32832.5977, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7942300995119025, 0.6403912520071152)
('Val: AUC, AUPR, Erros: ', 0.7626045197756905, 0.5869752201605745, 4350.8145)
('Test: AUC, AUPR, Erros: ', 0.7408481581071583, 0.5525374127848903, 4457.3564)
((646, 331), (646, 331), 68136.914, 58507.0)
('Error: ', tensor(32351.7051, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8004646235867483, 0.6509302443651258)
('Val: AUC, AUPR, Erros: ', 0.7637692713660464, 0.5878695910386447, 4320.743)
('Test: AUC, AUPR, Erros: ', 0.7408842956372286, 0.5551811299037122, 4442.554)
((646, 331), (646, 331), 67459.08, 58507.0)
('Error: ', tensor(32046.1484, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8043988489007501, 0.6571244006355816)
('Val: AUC, AUPR, Erros: ', 0.7643216317663661, 0.5890966511742635, 4298.476)
('Test: AUC, AUPR, Erros: ', 0.7384473511268418, 0.5518019624411676, 4459.5806)
((646, 331), (646, 331), 67434.94, 58507.0)
('Error: ', tensor(31815.7188, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8079679160577017, 0.6624630326972596)
('Val: AUC, AUPR, Erros: ', 0.7653779946274177, 0.5908928546239552, 4283.6494)
('Test: AUC, AUPR, Erros: ', 0.7353237014117833, 0.5465295811966391, 4498.149)
((646, 331), (646, 331), 67814.07, 58507.0)
('Error: ', tensor(31607.3184, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8117373649862436, 0.667914464152893)
('Val: AUC, AUPR, Erros: ', 0.7659719583535352, 0.5925203301039556, 4276.2646)
('Test: AUC, AUPR, Erros: ', 0.7316083607687516, 0.5380441636286099, 4579.5996)
((646, 331), (646, 331), 68279.56, 58507.0)
('Error: ', tensor(31440.4785, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8146628394924557, 0.6725215474406994)
('Val: AUC, AUPR, Erros: ', 0.7662624173614224, 0.5957505477137799, 4265.479)
('Test: AUC, AUPR, Erros: ', 0.7280930416027096, 0.5312301958018099, 4664.7197)
Train: 0.8147 0.6725
Test: 0.7281 0.5312
[0.5738060411184982, 0.59290537446096, 0.5886805041328217, 0.582526904955419, 0.5877876403087399, 0.5897510554498371, 0.5913034597249704, 0.5969479189293431, 0.6034241584533446, 0.6055961248575515, 0.6120035180893224, 0.6125395033343953, 0.6179804634430563, 0.6176332288485945, 0.6229912984141497, 0.6281153292846636, 0.6310926671477051, 0.6364905098587285, 0.6399167617782742, 0.6431593795154471, 0.6439978208504274, 0.6482801841570163, 0.6504737896497408, 0.6534695075077473, 0.6552498212638552, 0.6590960855068537, 0.6600890660783079, 0.6609500383504485, 0.6629149957962173, 0.6638309973960957, 0.6690747031974253, 0.6717596662563775, 0.675220424055755, 0.6781681125087234, 0.6817870655758371, 0.6839365146444506, 0.6847528550714915, 0.687448458174594, 0.687448458174594, 0.6897722416761807, 0.6905285769331957, 0.6924843679342875, 0.6937297697797147, 0.698574630408668, 0.7027049309400816, 0.7027049309400816, 0.7034601012856782, 0.7034601012856782, 0.705604141835663, 0.7069693721075798, 0.7069693721075798, 0.7085349961021241, 0.7085349961021241, 0.7085349961021241, 0.7085349961021241, 0.7085349961021241, 0.7085349961021241, 0.7085349961021241, 0.7120884071506886, 0.7120884071506886, 0.7133065821113311, 0.7152982420343805, 0.7152982420343805, 0.7152982420343805, 0.7152982420343805, 0.7152982420343805, 0.7152982420343805, 0.7171985314644398, 0.7171985314644398, 0.7171985314644398, 0.7236340699277486, 0.7236340699277486, 0.7236340699277486, 0.7257743064681379, 0.7257743064681379, 0.7257743064681379, 0.7257743064681379, 0.7257743064681379, 0.7280930416027096, 0.7280930416027096, 0.7280930416027096, 0.7280930416027096, 0.7280930416027096, 0.7280930416027096, 0.7280930416027096, 0.7280930416027096, 0.7280930416027096, 0.7280930416027096, 0.7280930416027096, 0.7280930416027096]
[0.1739694268308014, 0.1836465692632003, 0.1839286822385997, 0.18126991736266723, 0.1923633231361593, 0.19938869008540952, 0.20281746367953316, 0.21808035773292392, 0.2311199066960885, 0.2336967048818856, 0.2456160316769036, 0.24620775870597233, 0.2557742938658, 0.25643508832241535, 0.266243045852111, 0.2742923149055454, 0.2809942308727373, 0.29323663464316196, 0.30016265726036195, 0.30797717246649003, 0.30952609568751144, 0.31841671110966197, 0.3227865531963122, 0.33036156202017997, 0.3342144253625512, 0.34236209842365245, 0.34614263515519433, 0.3483550245208146, 0.3533096766151871, 0.35586926852804246, 0.3675878044069606, 0.3729965497922148, 0.3832844099346498, 0.3905093975340741, 0.3992514858179489, 0.405035776178476, 0.406440224923549, 0.4129068214690174, 0.4129068214690174, 0.41803034421539736, 0.4196744676823633, 0.42588466307272427, 0.42958726442318257, 0.4430720974619859, 0.45512957276527377, 0.45512957276527377, 0.4574216547989079, 0.4574216547989079, 0.46321224384527965, 0.4674012944917326, 0.4674012944917326, 0.47144290411072676, 0.47144290411072676, 0.47144290411072676, 0.47144290411072676, 0.47144290411072676, 0.47144290411072676, 0.47144290411072676, 0.4817499582179124, 0.4817499582179124, 0.48536457166856095, 0.49118412929928024, 0.49118412929928024, 0.49118412929928024, 0.49118412929928024, 0.49118412929928024, 0.49118412929928024, 0.49689426438226253, 0.49689426438226253, 0.49689426438226253, 0.517546205065313, 0.517546205065313, 0.517546205065313, 0.524016264672059, 0.524016264672059, 0.524016264672059, 0.524016264672059, 0.524016264672059, 0.5312301958018099, 0.5312301958018099, 0.5312301958018099, 0.5312301958018099, 0.5312301958018099, 0.5312301958018099, 0.5312301958018099, 0.5312301958018099, 0.5312301958018099, 0.5312301958018099, 0.5312301958018099, 0.5312301958018099]
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/KFold/ATCInchikeySideEffectByDrug.txt_P3_3
('Number of substructures, proteins, pathways, drugs, se: ', 888, 1448, 330, 808, 331)
((647, 2666), (81, 2666), (647, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19714.0)
('VALIDATE SUM PROTEIN TEST: ', 2411.0)
((647, 331), (647, 331), 83772.195, 58338.0)
('Error: ', tensor(45947.4531, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5159663662294962, 0.28013665572676083)
('Val: AUC, AUPR, Erros: ', 0.5178101981043672, 0.28871514479605664, 5694.124)
('Test: AUC, AUPR, Erros: ', 0.5349692229507864, 0.2881367019623878, 5699.93)
((647, 331), (647, 331), 52540.51, 58338.0)
('Error: ', tensor(39017.3164, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7330457069590385, 0.5519737231286711)
('Val: AUC, AUPR, Erros: ', 0.70424462908324, 0.5142485853922132, 4964.0605)
('Test: AUC, AUPR, Erros: ', 0.7158559155747014, 0.5203826250998822, 4880.463)
((647, 331), (647, 331), 52718.355, 58338.0)
('Error: ', tensor(35886.9531, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7653184998240069, 0.5953390523571453)
('Val: AUC, AUPR, Erros: ', 0.7329148651686466, 0.5507694154201079, 4640.7754)
('Test: AUC, AUPR, Erros: ', 0.7391957634835855, 0.5504372992122963, 4568.929)
((647, 331), (647, 331), 50600.383, 58338.0)
('Error: ', tensor(34465.1562, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7765598554578749, 0.6123753662816604)
('Val: AUC, AUPR, Erros: ', 0.7390870025407121, 0.5585212928350769, 4527.475)
('Test: AUC, AUPR, Erros: ', 0.7451589728961869, 0.5603832157484127, 4452.549)
((647, 331), (647, 331), 49879.35, 58338.0)
('Error: ', tensor(33509.7070, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7880238347898969, 0.6298892191597003)
('Val: AUC, AUPR, Erros: ', 0.7424746327598675, 0.560206567388104, 4490.937)
('Test: AUC, AUPR, Erros: ', 0.7506017373701708, 0.5697609515870647, 4392.2793)
((647, 331), (647, 331), 50464.21, 58338.0)
('Error: ', tensor(32696.5371, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7990693100133053, 0.6478073608076703)
('Val: AUC, AUPR, Erros: ', 0.7438905460582825, 0.5597918333452429, 4490.8438)
('Test: AUC, AUPR, Erros: ', 0.75408506587231, 0.576104511725994, 4365.5615)
((647, 331), (647, 331), 52685.11, 58338.0)
('Error: ', tensor(32022.2148, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8054799474988232, 0.6581071046066462)
('Val: AUC, AUPR, Erros: ', 0.743397722523229, 0.5585822528049482, 4480.4736)
('Test: AUC, AUPR, Erros: ', 0.7560851321375834, 0.5808266786405764, 4329.6245)
((647, 331), (647, 331), 53926.047, 58338.0)
('Error: ', tensor(31596.7500, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8101338641453011, 0.6650202335954226)
('Val: AUC, AUPR, Erros: ', 0.7421524171545749, 0.5556361140917978, 4489.3306)
('Test: AUC, AUPR, Erros: ', 0.7577705728092239, 0.5850341619777402, 4305.4478)
((647, 331), (647, 331), 54030.34, 58338.0)
('Error: ', tensor(31358.7109, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8131614611612545, 0.6695420830061157)
('Val: AUC, AUPR, Erros: ', 0.7406115917509877, 0.5515178996483252, 4509.823)
('Test: AUC, AUPR, Erros: ', 0.7580595457313113, 0.5876090447780138, 4300.301)
((647, 331), (647, 331), 54407.793, 58338.0)
('Error: ', tensor(31163.6426, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8152179105370636, 0.6730257639999321)
('Val: AUC, AUPR, Erros: ', 0.739618544245286, 0.5484441595130121, 4526.736)
('Test: AUC, AUPR, Erros: ', 0.7571935716910224, 0.5890315901561869, 4297.714)
((647, 331), (647, 331), 54806.824, 58338.0)
('Error: ', tensor(30997.0410, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.817049278504588, 0.6759480419651682)
('Val: AUC, AUPR, Erros: ', 0.7384477228575453, 0.5460207098383651, 4540.5146)
('Test: AUC, AUPR, Erros: ', 0.756351060114874, 0.5905031835559321, 4293.427)
Train: 0.8055 0.6581
Test: 0.7561 0.5808
[0.6081433379153434, 0.6194198384601133, 0.6322056737767958, 0.635060771365681, 0.6368325439677227, 0.6375890769277561, 0.6384546524605073, 0.6455651966061261, 0.6502512599649725, 0.6507374218307137, 0.6542594975455225, 0.6566678228294776, 0.6589139379040243, 0.6598125489843039, 0.6627243151073514, 0.6651646042369093, 0.667373085912766, 0.6697256661970846, 0.6726620881889659, 0.6762600952722839, 0.6768647730912799, 0.6792484937906278, 0.6815237027871985, 0.6853717246587133, 0.6866571592936933, 0.6905380224560114, 0.6921553817286639, 0.6924928989196982, 0.6938562729565365, 0.6942639578706395, 0.6989069874785157, 0.7012471287842302, 0.7055920960930882, 0.7076624829170935, 0.7116707282341725, 0.7125980322400067, 0.7135556562203348, 0.7170410778751641, 0.7170410778751641, 0.7187420989680672, 0.7199020385568651, 0.7220875085972669, 0.7229576564630245, 0.7268809713689804, 0.7296006936629508, 0.7296006936629508, 0.7305415426655134, 0.7305415426655134, 0.7332046315827778, 0.7340316775237756, 0.7340316775237756, 0.7367197870519449, 0.7367197870519449, 0.7367197870519449, 0.7367197870519449, 0.7367197870519449, 0.7367197870519449, 0.7367197870519449, 0.7398559300191508, 0.7398559300191508, 0.7415665109020775, 0.7432821107890824, 0.7432821107890824, 0.7432821107890824, 0.7432821107890824, 0.7432821107890824, 0.7432821107890824, 0.7452288799394448, 0.7452288799394448, 0.7452288799394448, 0.7514792771456535, 0.7514792771456535, 0.7514792771456535, 0.7537551399949126, 0.7537551399949126, 0.7537551399949126, 0.7537551399949126, 0.7537551399949126, 0.7560851321375834, 0.7560851321375834, 0.7560851321375834, 0.7560851321375834, 0.7560851321375834, 0.7560851321375834, 0.7560851321375834, 0.7560851321375834, 0.7560851321375834, 0.7560851321375834, 0.7560851321375834, 0.7560851321375834]
[0.20929936945659194, 0.22614637508398205, 0.23894287640532635, 0.2552435393006439, 0.2513792139746912, 0.261045894713672, 0.26309467678291465, 0.28420371963931157, 0.2963153211129942, 0.29360133221986473, 0.3045287563494392, 0.3100072171761089, 0.31295919615029344, 0.3144735729592678, 0.3219053600216336, 0.32835395677746804, 0.33236743901200516, 0.3407497377927677, 0.3464570958404947, 0.35631379855675255, 0.35634529023181694, 0.36391769912340555, 0.37020276451246115, 0.3816213440626063, 0.38547074747084054, 0.39785929723477065, 0.40196836823682236, 0.40243062506289917, 0.4063159155325393, 0.40757895138579275, 0.4198855848264248, 0.4245281871525993, 0.43744154477314906, 0.44389728830092257, 0.45579621674287696, 0.4581077596437878, 0.4599500090004685, 0.46918828999172235, 0.46918828999172235, 0.47301964380142514, 0.4751579615451282, 0.4827028212250777, 0.4854420312746763, 0.49572812134912014, 0.503320016179869, 0.503320016179869, 0.5062441173518041, 0.5062441173518041, 0.5134290098594665, 0.5153804857435844, 0.5153804857435844, 0.522560213038941, 0.522560213038941, 0.522560213038941, 0.522560213038941, 0.522560213038941, 0.522560213038941, 0.522560213038941, 0.5310781479309845, 0.5310781479309845, 0.5365326302055841, 0.54172591139965, 0.54172591139965, 0.54172591139965, 0.54172591139965, 0.54172591139965, 0.54172591139965, 0.5477338261205775, 0.5477338261205775, 0.5477338261205775, 0.5663958436478741, 0.5663958436478741, 0.5663958436478741, 0.573374487509393, 0.573374487509393, 0.573374487509393, 0.573374487509393, 0.573374487509393, 0.5808266786405764, 0.5808266786405764, 0.5808266786405764, 0.5808266786405764, 0.5808266786405764, 0.5808266786405764, 0.5808266786405764, 0.5808266786405764, 0.5808266786405764, 0.5808266786405764, 0.5808266786405764, 0.5808266786405764]
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/KFold/ATCInchikeySideEffectByDrug.txt_P3_4
('Number of substructures, proteins, pathways, drugs, se: ', 888, 1448, 330, 808, 331)
((647, 2666), (80, 2666), (647, 331), (80, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19824.0)
('VALIDATE SUM PROTEIN TEST: ', 2518.0)
((647, 331), (647, 331), 190819.52, 58099.0)
('Error: ', tensor(126329.6562, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.49992062448612273, 0.27506652169140644)
('Val: AUC, AUPR, Erros: ', 0.5102520826730952, 0.29185157210764373, 15485.264)
('Test: AUC, AUPR, Erros: ', 0.4876395032736678, 0.2778919120372723, 15486.121)
((647, 331), (647, 331), 64650.57, 58099.0)
('Error: ', tensor(39510.8203, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7060435397879821, 0.5238314238489479)
('Val: AUC, AUPR, Erros: ', 0.683578157245986, 0.5090014483388998, 5055.166)
('Test: AUC, AUPR, Erros: ', 0.6873296527552902, 0.5110661759252886, 4992.595)
((647, 331), (647, 331), 71612.12, 58099.0)
('Error: ', tensor(36700.9062, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7559766972766826, 0.5826401076237099)
('Val: AUC, AUPR, Erros: ', 0.7224461858584754, 0.5474255413733895, 4783.864)
('Test: AUC, AUPR, Erros: ', 0.7322623869169564, 0.5589824314929217, 4696.935)
((647, 331), (647, 331), 71990.56, 58099.0)
('Error: ', tensor(34867.6719, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7698405621444164, 0.6006604529592989)
('Val: AUC, AUPR, Erros: ', 0.7314980865041364, 0.5536456392055242, 4651.148)
('Test: AUC, AUPR, Erros: ', 0.7433529575263528, 0.5698256843309588, 4531.1494)
((647, 331), (647, 331), 71168.34, 58099.0)
('Error: ', tensor(33906.5938, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7784862508869657, 0.6132772541122579)
('Val: AUC, AUPR, Erros: ', 0.7343414434763323, 0.5539386517701773, 4631.9375)
('Test: AUC, AUPR, Erros: ', 0.7478853566156223, 0.5742570649121432, 4475.938)
((647, 331), (647, 331), 69991.875, 58099.0)
('Error: ', tensor(33192.5820, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7867837344507346, 0.6261278570979798)
('Val: AUC, AUPR, Erros: ', 0.7350956197367352, 0.5507852980429053, 4651.863)
('Test: AUC, AUPR, Erros: ', 0.7506536950779941, 0.575608741319106, 4465.1274)
((647, 331), (647, 331), 69256.875, 58099.0)
('Error: ', tensor(32557.8984, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7960527106193641, 0.6403139193003978)
('Val: AUC, AUPR, Erros: ', 0.7323347815629186, 0.5388750490820394, 4754.8687)
('Test: AUC, AUPR, Erros: ', 0.7513246335617294, 0.5708431711365134, 4527.9453)
((647, 331), (647, 331), 68318.02, 58099.0)
('Error: ', tensor(32048.2871, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8034392437947138, 0.6517795832136606)
('Val: AUC, AUPR, Erros: ', 0.7263450387317258, 0.5227395504676021, 4920.238)
('Test: AUC, AUPR, Erros: ', 0.7512375478789175, 0.5652517530033572, 4586.087)
((647, 331), (647, 331), 67424.29, 58099.0)
('Error: ', tensor(31665.6484, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8084922379670518, 0.6594373627150739)
('Val: AUC, AUPR, Erros: ', 0.7246370927188859, 0.5172293333416748, 4959.478)
('Test: AUC, AUPR, Erros: ', 0.7515504303376391, 0.5616150685179675, 4597.2974)
((647, 331), (647, 331), 66834.38, 58099.0)
('Error: ', tensor(31390.4199, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8120904382200113, 0.6651438152809012)
('Val: AUC, AUPR, Erros: ', 0.7252295840012453, 0.5175758758229683, 4949.9277)
('Test: AUC, AUPR, Erros: ', 0.7527182993672525, 0.560894584259912, 4589.7446)
((647, 331), (647, 331), 66377.99, 58099.0)
('Error: ', tensor(31195.1250, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8145248644283885, 0.6691386962636082)
('Val: AUC, AUPR, Erros: ', 0.7253355225921986, 0.5185029255909727, 4929.128)
('Test: AUC, AUPR, Erros: ', 0.7533904564536804, 0.560649773583753, 4580.11)
Train: 0.7785 0.6133
Test: 0.7479 0.5743
[0.5708994354338252, 0.5824364653599287, 0.594932186355261, 0.5956053846377176, 0.5970010848958787, 0.5968344253842865, 0.6035487319985088, 0.6116928680062735, 0.6179624239351126, 0.6192534455786973, 0.623383771090854, 0.6261608519021986, 0.6288206162993214, 0.6305639980267873, 0.6374456821132879, 0.6370671346345598, 0.6424669023622739, 0.6472615603041854, 0.6508603412834164, 0.6543271501644188, 0.6552237354558254, 0.658712919606938, 0.661842673482477, 0.6661082384449577, 0.6682593263262869, 0.673788054502297, 0.6754682777964377, 0.676385765706304, 0.6776617845683487, 0.6788100016157248, 0.6842567761186955, 0.6873130804371107, 0.691317741246971, 0.6937424121502577, 0.6973533430527884, 0.6991838182236829, 0.700568942705537, 0.7033447446790162, 0.7033447446790162, 0.705586361676199, 0.7066759438193374, 0.7092444250087607, 0.7107614686388305, 0.7162064262810619, 0.7197256316609938, 0.7197256316609938, 0.7207991253811653, 0.7207991253811653, 0.7237145612439264, 0.7252531751202808, 0.7252531751202808, 0.7277126435513683, 0.7277126435513683, 0.7277126435513683, 0.7277126435513683, 0.7277126435513683, 0.7277126435513683, 0.7277126435513683, 0.7308871569001532, 0.7308871569001532, 0.7326685596150974, 0.7343726651487532, 0.7343726651487532, 0.7343726651487532, 0.7343726651487532, 0.7343726651487532, 0.7343726651487532, 0.7365523681428536, 0.7365523681428536, 0.7365523681428536, 0.7436068880370649, 0.7436068880370649, 0.7436068880370649, 0.7455252592395983, 0.7455252592395983, 0.7455252592395983, 0.7455252592395983, 0.7455252592395983, 0.7478853566156223, 0.7478853566156223, 0.7478853566156223, 0.7478853566156223, 0.7478853566156223, 0.7478853566156223, 0.7478853566156223, 0.7478853566156223, 0.7478853566156223, 0.7478853566156223, 0.7478853566156223, 0.7478853566156223]
[0.15357170802720188, 0.15917891514960525, 0.17398316938464864, 0.18506377169288965, 0.19203337191053685, 0.1947870924307889, 0.2068782702187486, 0.22223882030071043, 0.2340071403891169, 0.23618189281521623, 0.24583559634504173, 0.2526505460320943, 0.25893075242702734, 0.26162682770261736, 0.2758608444652638, 0.2710126414445242, 0.2810566792596181, 0.29300828694170034, 0.30031318089939296, 0.30887647274163654, 0.3117303796835726, 0.3196014898221975, 0.32590318786359795, 0.33689324600432646, 0.342837714774766, 0.35590589023794006, 0.3601142297183932, 0.36112897717483716, 0.36443158725629365, 0.36817348840312103, 0.3832564610249846, 0.39125904780126164, 0.40347259000916086, 0.40933043141769937, 0.4177489579291228, 0.42355819404733075, 0.4276802383617711, 0.43445296234016356, 0.43445296234016356, 0.4404997147393598, 0.4432934771033216, 0.4507701429002645, 0.45612382456996003, 0.4730203020883047, 0.48419590930361717, 0.48419590930361717, 0.48652140138017913, 0.48652140138017913, 0.49551746154137244, 0.5006657239356309, 0.5006657239356309, 0.5076411451741255, 0.5076411451741255, 0.5076411451741255, 0.5076411451741255, 0.5076411451741255, 0.5076411451741255, 0.5076411451741255, 0.5177039499513321, 0.5177039499513321, 0.5231713091093895, 0.528677528397322, 0.528677528397322, 0.528677528397322, 0.528677528397322, 0.528677528397322, 0.528677528397322, 0.5362543023876425, 0.5362543023876425, 0.5362543023876425, 0.5603457681126371, 0.5603457681126371, 0.5603457681126371, 0.566278476189967, 0.566278476189967, 0.566278476189967, 0.566278476189967, 0.566278476189967, 0.5742570649121432, 0.5742570649121432, 0.5742570649121432, 0.5742570649121432, 0.5742570649121432, 0.5742570649121432, 0.5742570649121432, 0.5742570649121432, 0.5742570649121432, 0.5742570649121432, 0.5742570649121432, 0.5742570649121432]
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/KFold/ATCInchikeySideEffectByDrug.txt_P3_5
('Number of substructures, proteins, pathways, drugs, se: ', 888, 1448, 330, 808, 331)
((646, 2666), (81, 2666), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19389.0)
('VALIDATE SUM PROTEIN TEST: ', 2301.0)
((646, 331), (646, 331), 155178.94, 58366.0)
('Error: ', tensor(86623.9062, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5452095724778642, 0.30138311725462164)
('Val: AUC, AUPR, Erros: ', 0.5350426786848967, 0.2852264831611928, 11030.056)
('Test: AUC, AUPR, Erros: ', 0.5505859996140224, 0.3106299436440246, 10795.392)
((646, 331), (646, 331), 58598.23, 58366.0)
('Error: ', tensor(38931.7695, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7216581715838072, 0.5457906438817695)
('Val: AUC, AUPR, Erros: ', 0.7036307299171349, 0.5152224752727528, 4828.6104)
('Test: AUC, AUPR, Erros: ', 0.6879150867869905, 0.5060480679069123, 5006.167)
((646, 331), (646, 331), 44778.355, 58366.0)
('Error: ', tensor(37127.8477, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7631148821092013, 0.5966316545258271)
('Val: AUC, AUPR, Erros: ', 0.7461375188548636, 0.5645330111767859, 4594.7026)
('Test: AUC, AUPR, Erros: ', 0.7247631712913436, 0.5376817073968668, 4842.594)
((646, 331), (646, 331), 49567.703, 58366.0)
('Error: ', tensor(34609.2461, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7752155581758815, 0.6125853683185087)
('Val: AUC, AUPR, Erros: ', 0.7546639580741299, 0.5727334273830218, 4346.7627)
('Test: AUC, AUPR, Erros: ', 0.7316626283155008, 0.5398457830167873, 4623.9)
((646, 331), (646, 331), 51905.656, 58366.0)
('Error: ', tensor(33461.6836, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7837727095465343, 0.6245382168629758)
('Val: AUC, AUPR, Erros: ', 0.757875531668514, 0.5757977930115059, 4263.192)
('Test: AUC, AUPR, Erros: ', 0.7333140131890288, 0.5380986779309878, 4581.946)
((646, 331), (646, 331), 51472.81, 58366.0)
('Error: ', tensor(32975.7070, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.791003535897165, 0.6344856339855179)
('Val: AUC, AUPR, Erros: ', 0.7585485522311557, 0.5759219156554458, 4248.1465)
('Test: AUC, AUPR, Erros: ', 0.7326559395534009, 0.5338218209954586, 4601.933)
((646, 331), (646, 331), 51197.395, 58366.0)
('Error: ', tensor(32587.0391, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7976517806807149, 0.6430095888676199)
('Val: AUC, AUPR, Erros: ', 0.7567920584302843, 0.5723736480405941, 4257.7324)
('Test: AUC, AUPR, Erros: ', 0.7296748929228362, 0.5275960860487177, 4634.865)
((646, 331), (646, 331), 51468.31, 58366.0)
('Error: ', tensor(32217.9258, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8029963307662447, 0.6497260114208209)
('Val: AUC, AUPR, Erros: ', 0.748088475611893, 0.5625917082986525, 4304.029)
('Test: AUC, AUPR, Erros: ', 0.7245691215814454, 0.5193116313728047, 4680.8604)
((646, 331), (646, 331), 52032.215, 58366.0)
('Error: ', tensor(31927.4512, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8064634990378812, 0.6546388845809977)
('Val: AUC, AUPR, Erros: ', 0.7422030542437688, 0.5567206044507504, 4334.0977)
('Test: AUC, AUPR, Erros: ', 0.7198220977776999, 0.5111820435396295, 4727.8706)
((646, 331), (646, 331), 52849.0, 58366.0)
('Error: ', tensor(31682.3242, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8089954883576935, 0.658430654067904)
('Val: AUC, AUPR, Erros: ', 0.7411588024679465, 0.5544126095524986, 4343.663)
('Test: AUC, AUPR, Erros: ', 0.7169207755187469, 0.5053340657004001, 4765.234)
((646, 331), (646, 331), 53209.863, 58366.0)
('Error: ', tensor(31516.3438, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8110937215733707, 0.6616512445152124)
('Val: AUC, AUPR, Erros: ', 0.7420006161615961, 0.5535661469388268, 4346.0713)
('Test: AUC, AUPR, Erros: ', 0.715279441567302, 0.5006752003128523, 4795.5645)
Train: 0.7910 0.6345
Test: 0.7327 0.5338
[0.5265826648064178, 0.5660732847189087, 0.5606668836769636, 0.5612599909189022, 0.5690780681826174, 0.5719254782434499, 0.5790065135276836, 0.5912011109087466, 0.5920318155735209, 0.593381946955225, 0.5965536245067317, 0.6012001465969277, 0.6042819089690219, 0.6074862765811992, 0.6162397556195929, 0.621666077289784, 0.6268455501239066, 0.6351808482956024, 0.6406860716731754, 0.6450521199957598, 0.6457489706445222, 0.6498046257396771, 0.6539245937099307, 0.656477770493466, 0.6578454398224791, 0.6622100622888978, 0.6637960646004792, 0.6643349570624726, 0.6653500802085348, 0.6657712921750236, 0.6710595376274797, 0.6741409532549937, 0.6781539806106378, 0.6798067751070003, 0.6835265178328218, 0.6851565127863701, 0.6864037456059883, 0.6891533789358089, 0.6891533789358089, 0.6922046799495546, 0.6930773976739278, 0.6955192277083827, 0.6967675419795173, 0.7015379109774328, 0.7044748524871927, 0.7044748524871927, 0.7052776390979563, 0.7052776390979563, 0.7079644262731469, 0.709306657775451, 0.709306657775451, 0.7125083171562003, 0.7125083171562003, 0.7125083171562003, 0.7125083171562003, 0.7125083171562003, 0.7125083171562003, 0.7125083171562003, 0.7163008719125876, 0.7163008719125876, 0.7179795784730426, 0.7197692896586084, 0.7197692896586084, 0.7197692896586084, 0.7197692896586084, 0.7197692896586084, 0.7197692896586084, 0.721486434190066, 0.721486434190066, 0.721486434190066, 0.7282673868188659, 0.7282673868188659, 0.7282673868188659, 0.7303059222720628, 0.7303059222720628, 0.7303059222720628, 0.7303059222720628, 0.7303059222720628, 0.7326559395534009, 0.7326559395534009, 0.7326559395534009, 0.7326559395534009, 0.7326559395534009, 0.7326559395534009, 0.7326559395534009, 0.7326559395534009, 0.7326559395534009, 0.7326559395534009, 0.7326559395534009, 0.7326559395534009]
[0.10907179602063381, 0.13796702789327928, 0.14474248094746184, 0.15390775905657722, 0.16281599525256554, 0.16457643543305922, 0.17621883020661191, 0.18997474641384157, 0.1913841319555301, 0.19311875591865826, 0.20101969533346126, 0.21095636245816624, 0.21435690639467142, 0.219269482470059, 0.2348194031786326, 0.2435517961337853, 0.2549517977665703, 0.2705150047974797, 0.28196186623010777, 0.2920707322341343, 0.2936123474926353, 0.30330290946847077, 0.31349641762367186, 0.3200021537990422, 0.32383782723020726, 0.3332328031536147, 0.3378334506775246, 0.3396067005820576, 0.34147476236088425, 0.34196103788444, 0.35579730263597575, 0.36321784459578227, 0.3725422417388843, 0.3761644360215408, 0.3862070185745515, 0.3900879977623787, 0.3935402316019399, 0.4013632133469899, 0.4013632133469899, 0.41015432088640735, 0.41186635023370277, 0.4189948833061711, 0.423100819906948, 0.43727854311263553, 0.4460962205256296, 0.4460962205256296, 0.44795185037602847, 0.44795185037602847, 0.4559250639851867, 0.45947910842835016, 0.45947910842835016, 0.4700146061249298, 0.4700146061249298, 0.4700146061249298, 0.4700146061249298, 0.4700146061249298, 0.4700146061249298, 0.4700146061249298, 0.4811678935349796, 0.4811678935349796, 0.48667430726380434, 0.49309799723794423, 0.49309799723794423, 0.49309799723794423, 0.49309799723794423, 0.49309799723794423, 0.49309799723794423, 0.49805015296026584, 0.49805015296026584, 0.49805015296026584, 0.5200000836195144, 0.5200000836195144, 0.5200000836195144, 0.5260251266068661, 0.5260251266068661, 0.5260251266068661, 0.5260251266068661, 0.5260251266068661, 0.5338218209954586, 0.5338218209954586, 0.5338218209954586, 0.5338218209954586, 0.5338218209954586, 0.5338218209954586, 0.5338218209954586, 0.5338218209954586, 0.5338218209954586, 0.5338218209954586, 0.5338218209954586, 0.5338218209954586]
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/KFold/ATCInchikeySideEffectByDrug.txt_P3_6
('Number of substructures, proteins, pathways, drugs, se: ', 888, 1448, 330, 808, 331)
((646, 2666), (81, 2666), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19352.0)
('VALIDATE SUM PROTEIN TEST: ', 2953.0)
((646, 331), (646, 331), 116446.39, 59017.0)
('Error: ', tensor(59103.5781, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.49976383030552374, 0.2709540403375955)
('Val: AUC, AUPR, Erros: ', 0.5085098993305834, 0.25480265494815546, 7422.9688)
('Test: AUC, AUPR, Erros: ', 0.5002238004098565, 0.2572805041889564, 7474.4004)
((646, 331), (646, 331), 62481.367, 59017.0)
('Error: ', tensor(39856.0508, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7026902945476775, 0.5145489336279165)
('Val: AUC, AUPR, Erros: ', 0.686398166274045, 0.46370251307980537, 4802.473)
('Test: AUC, AUPR, Erros: ', 0.7006954438573363, 0.5058370150220011, 4884.5493)
((646, 331), (646, 331), 61649.906, 59017.0)
('Error: ', tensor(36411.3555, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.754686002012775, 0.5860198678219084)
('Val: AUC, AUPR, Erros: ', 0.7281655673160612, 0.5222488379778213, 4463.4253)
('Test: AUC, AUPR, Erros: ', 0.7439757413753642, 0.5599300205706274, 4506.2285)
((646, 331), (646, 331), 74599.08, 59017.0)
('Error: ', tensor(35005.6172, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7712074424459973, 0.6095582112524136)
('Val: AUC, AUPR, Erros: ', 0.7391512236858652, 0.5376436666039979, 4503.809)
('Test: AUC, AUPR, Erros: ', 0.7540732446726194, 0.5716870483549806, 4466.7095)
((646, 331), (646, 331), 69886.76, 59017.0)
('Error: ', tensor(33762.0039, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7799700085419757, 0.6224107855433032)
('Val: AUC, AUPR, Erros: ', 0.7425917460249503, 0.5407947434128945, 4389.902)
('Test: AUC, AUPR, Erros: ', 0.7574370605986179, 0.575706881572134, 4347.757)
((646, 331), (646, 331), 71342.85, 59017.0)
('Error: ', tensor(33355.6016, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7882661438366381, 0.6351112601807914)
('Val: AUC, AUPR, Erros: ', 0.7416647136176369, 0.5336616937253074, 4476.988)
('Test: AUC, AUPR, Erros: ', 0.7608079222320904, 0.5814331955434834, 4357.0205)
((646, 331), (646, 331), 68917.7, 59017.0)
('Error: ', tensor(32661.0645, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7961984376234849, 0.6472446444033775)
('Val: AUC, AUPR, Erros: ', 0.7379375043619238, 0.5171284740043776, 4527.3643)
('Test: AUC, AUPR, Erros: ', 0.7629635726985963, 0.5859470815571648, 4308.094)
((646, 331), (646, 331), 69049.445, 59017.0)
('Error: ', tensor(32320.3086, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8026686936868825, 0.6570744425690941)
('Val: AUC, AUPR, Erros: ', 0.7337155737342549, 0.5024025070314935, 4644.71)
('Test: AUC, AUPR, Erros: ', 0.7641486027858048, 0.5872115939351311, 4327.775)
((646, 331), (646, 331), 67867.625, 59017.0)
('Error: ', tensor(31992.6328, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8066804237364544, 0.6631228825740926)
('Val: AUC, AUPR, Erros: ', 0.7309381226285634, 0.49556210759185854, 4658.2197)
('Test: AUC, AUPR, Erros: ', 0.7643719456357644, 0.5862369083767388, 4324.9966)
((646, 331), (646, 331), 67367.63, 59017.0)
('Error: ', tensor(31783.9043, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8094075297712733, 0.6670954017480698)
('Val: AUC, AUPR, Erros: ', 0.7284580909591034, 0.4901868467130934, 4681.0845)
('Test: AUC, AUPR, Erros: ', 0.7643278483007061, 0.5849639682405134, 4328.775)
((646, 331), (646, 331), 67327.445, 59017.0)
('Error: ', tensor(31616.6523, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8119620281675127, 0.6706461128840631)
('Val: AUC, AUPR, Erros: ', 0.7257315899173654, 0.4841840142570718, 4727.1284)
('Test: AUC, AUPR, Erros: ', 0.7642684834787776, 0.5834163775152773, 4342.416)
Train: 0.7800 0.6224
Test: 0.7574 0.5757
