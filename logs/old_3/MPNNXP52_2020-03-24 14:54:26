class Net52(torch.nn.Module):
    def __init__(self, numNode=10000, numAtomFeature=0):
        super(Net52, self).__init__()

        self.convD1 = GATConv(config.EMBED_DIM, config.EMBED_DIM)  # SAGEConv(config.EMBED_DIM, config.EMBED_DIM)
        self.convD2 = GATConv(config.EMBED_DIM, config.EMBED_DIM)  # SAGEConv(config.EMBED_DIM, config.EMBED_DIM)

        # self.my_reset_params(self.convD1.weight, config.EMBED_DIM)
        # self.my_reset_params(self.convD1.bias, config.EMBED_DIM)
        #
        # self.my_reset_params(self.convD2.weight, config.EMBED_DIM)
        # self.my_reset_params(self.convD2.bias, config.EMBED_DIM)

        self.convS1 = GATConv(config.EMBED_DIM, config.EMBED_DIM)  # SAGEConv(config.EMBED_DIM, config.EMBED_DIM)
        self.convS2 = GATConv(config.EMBED_DIM, config.EMBED_DIM)  # SAGEConv(config.EMBED_DIM, config.EMBED_DIM)

        # self.my_reset_params(self.convS1.weight, config.EMBED_DIM)
        # self.my_reset_params(self.convS1.bias, config.EMBED_DIM)
        #
        # self.my_reset_params(self.convS2.weight, config.EMBED_DIM)
        # self.my_reset_params(self.convS2.bias, config.EMBED_DIM)

        self.L1 = Linear(config.CHEM_FINGERPRINT_SIZE, config.EMBED_DIM * 2)
        self.actL1 = F.relu
        self.L2 = Linear(config.EMBED_DIM * 2, config.EMBED_DIM)
        self.actL2 = F.relu

        self.linear1 = Linear(config.EMBED_DIM * 2, config.EMBED_DIM)
        self.act1 = F.relu
        self.linear2 = Linear(config.EMBED_DIM, 1)
        self.act2 = F.relu

        self.nodesEmbedding = torch.nn.Embedding(num_embeddings=numNode + 1, embedding_dim=config.EMBED_DIM)
        self.nodesEmbedding.weight.data.uniform_(0.001, 0.3)

        # Molecule graph neural net

        self.mlinear1 = Linear(numAtomFeature, config.EMBED_DIM * 2)
        self.mact1 = F.relu
        self.mlinear2 = Linear(config.EMBED_DIM * 2, config.EMBED_DIM)
        self.mact2 = F.relu

        self.conv1 = EATConv(config.EMBED_DIM, config.EMBED_DIM)
        self.conv1g = GATConv(config.EMBED_DIM, config.EMBED_DIM)

        self.pool1 = TopKPooling(config.EMBED_DIM, ratio=0.8)
        self.conv2 = EATConv(config.EMBED_DIM, config.EMBED_DIM)
        self.conv2g = GATConv(config.EMBED_DIM, config.EMBED_DIM)

        self.pool2 = TopKPooling(config.EMBED_DIM, ratio=0.8)
        self.conv3 = EATConv(config.EMBED_DIM, config.EMBED_DIM)
        self.conv3g = GATConv(config.EMBED_DIM, config.EMBED_DIM)

        self.pool3 = TopKPooling(config.EMBED_DIM, ratio=0.8)

        self.lin1 = torch.nn.Linear(config.EMBED_DIM * 2, config.EMBED_DIM)
        self.lin2 = torch.nn.Linear(config.EMBED_DIM, config.EMBED_DIM)

        self.bn1 = torch.nn.BatchNorm1d(128)
        self.bn2 = torch.nn.BatchNorm1d(64)
        self.act1 = torch.nn.ReLU()
        self.act2 = torch.nn.ReLU()

    def my_reset_params(self, tensor, size=10):
        bound = 1.0 / math.sqrt(size)
        if tensor is not None:
            tensor.data.uniform_(0.0, bound)

    def forward(self, x, drugEdges, seEdges, drugNodes, seNodes, proteinNodes, proteinWeight, drugGraphBatch, nDrug, drugFeatures = None):


        if config.INNER_FEATURE and drugFeatures is not None:
            nDrug = drugFeatures.shape[0]
            x = self.nodesEmbedding(x[nDrug:])
            x = x.squeeze(1)

            xDrug = self.L1(drugFeatures)
            xDrug = self.actL1(xDrug)
            xDrug = self.L2(xDrug)
            xDrug = self.actL2(xDrug)

            x = torch.cat((xDrug, x), dim=0)

        elif config.INNER_GRAPH:
            xAtom, edge_index, batch = drugGraphBatch.x, drugGraphBatch.edge_index, drugGraphBatch.batch
            # xDrug = self.mact1(self.mlinear1(xDrug))
            # xDrug = self.mact2(self.mlinear2(xDrug))

            xProtein = self.nodesEmbedding(proteinNodes)

            xAtom = self.nodesEmbedding(xAtom)
            xAtom = xAtom.squeeze(1)




            iLevel = 0
            if config.BOTH_GRAPH and config.EXT_MODE and iLevel >= config.INTER_LEVELS:
                xAtom = F.relu(self.conv1(xAtom, edge_index, xProtein, proteinWeight))
            else:
                xAtom = F.relu(self.conv1g(xAtom, edge_index))
            xAtom, edge_index, _, batch, _, _ = self.pool1(xAtom, edge_index, None, batch)
            x1 = torch.cat([gmp(xAtom, batch), gap(xAtom, batch)], dim=1)
            iLevel += 1

            if config.BOTH_GRAPH and config.EXT_MODE and iLevel >= config.INTER_LEVELS:
                xAtom = F.relu(self.conv2(xAtom, edge_index, xProtein, proteinWeight))
            else:
                xAtom = F.relu(self.conv2g(xAtom, edge_index))

            iLevel += 1
            xAtom, edge_index, _, batch, _, _ = self.pool2(xAtom, edge_index, None, batch)
            x2 = torch.cat([gmp(xAtom, batch), gap(xAtom, batch)], dim=1)

            if config.BOTH_GRAPH and config.EXT_MODE and iLevel >= config.INTER_LEVELS:
                xAtom = F.relu(self.conv3(xAtom, edge_index, xProtein, proteinWeight))
            else:
                xAtom = F.relu(self.conv3g(xAtom, edge_index))

            xAtom, edge_index, _, batch, _, _ = self.pool3(xAtom, edge_index, None, batch)
            x3 = torch.cat([gmp(xAtom, batch), gap(xAtom, batch)], dim=1)

            xDrug = x1 + x2 + x3

            xDrug = self.lin1(xDrug)
            xDrug = self.act1(xDrug)
            xDrug = self.lin2(xDrug)
            xDrug = self.act2(xDrug)

            x = self.nodesEmbedding(x[nDrug:])
            x = x.squeeze(1)

            x = torch.cat((xDrug, x), dim=0)
        else:
            x = self.nodesEmbedding(x)

        if config.OUTER_GRAPH:
            # Conv Drug:
            x = self.convD1(x, drugEdges)
            x = F.relu(x)
            x = self.convD2(x, drugEdges)
            x = F.relu(x)

        if config.SE_GRAPH:
            # Conv SE:
            x = self.convS1(x, seEdges)
            x = F.relu(x)
            # x = self.convS2(x, seEdges)
            # x = F.relu(x)

        drugEmbedding = x[drugNodes]
        seEmbedding = x[seNodes]
        # re = torch.sigmoid(re)
        return drugEmbedding, seEmbedding, x

    def cal(self, drugE, seE):
        return torch.matmul(drugE, seE.t())

    def cal2(self, drugE, seE):
        nDrug, nDim = drugE.shape
        nSe, _ = seE.shape
        preRe = list()
        for i in range(nDrug):
            dE = drugE[i]
            dE = dE.squeeze()
            de = dE.expand((nSe, nDim))
            v = torch.cat((de, seE), dim=1)
            v = self.linear1(v)
            v = self.act1(v)
            v = self.linear2(v)
            # v = self.act2(v)
            v = v.squeeze()
            preRe.append(v)
        return torch.stack(preRe)

('Undirected graph: ', False)
('Protein Test: ', True)
('Inner Graph, Outer Graph, Se Graph: ', True, False, False)
('Drug Features: ', True)
('Cross Prob: ', 0.5)
('Inner Level: ', 0)
MPNNX
<models.MPNNXP5.MPNNXP5 object at 0x7f4b66759e50>
('Manual torch seed: ', 1772727637)
('Config: ', 'Protein Test: ', True, 'KNN: ', 2)
('EXT MODE: ', False)
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/KFold/ATCInchikeySideEffectByDrug.txt_P3_0
('Number of substructures, proteins, pathways, drugs, se: ', 888, 1448, 330, 808, 331)
((646, 2666), (81, 2666), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19906.0)
('VALIDATE SUM PROTEIN TEST: ', 2291.0)
((646, 331), (646, 331), 124888.16, 58595.0)
('Error: ', tensor(65133.5664, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5191549956766699, 0.28521033918896155)
('Val: AUC, AUPR, Erros: ', 0.5249970885539624, 0.2889276630949732, 8163.9478)
('Test: AUC, AUPR, Erros: ', 0.5285101582268372, 0.27955376811260907, 8171.402)
((646, 331), (646, 331), 80061.46, 58595.0)
('Error: ', tensor(50640.3945, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6009428736114872, 0.35954547668078385)
('Val: AUC, AUPR, Erros: ', 0.5877698509850773, 0.35434531315752726, 6688.4146)
('Test: AUC, AUPR, Erros: ', 0.5907099128872284, 0.3293598916027863, 6359.072)
((646, 331), (646, 331), 73851.94, 58595.0)
('Error: ', tensor(39743.4531, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.691916788932099, 0.49892225567382265)
('Val: AUC, AUPR, Erros: ', 0.6704248645918567, 0.48139856848197293, 5258.646)
('Test: AUC, AUPR, Erros: ', 0.6745896631436139, 0.4634063228961003, 4980.081)
((646, 331), (646, 331), 62520.723, 58595.0)
('Error: ', tensor(35813.1250, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7318448537372403, 0.5546111860361145)
('Val: AUC, AUPR, Erros: ', 0.6973670408559803, 0.5155882782344704, 4791.8916)
('Test: AUC, AUPR, Erros: ', 0.7091733903580832, 0.5082605405507498, 4453.644)
((646, 331), (646, 331), 52858.254, 58595.0)
('Error: ', tensor(35139.9961, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7458478127828486, 0.5737406283409112)
('Val: AUC, AUPR, Erros: ', 0.7050314795354009, 0.5127066330552106, 4757.472)
('Test: AUC, AUPR, Erros: ', 0.7194198410922263, 0.5176320099949765, 4358.828)
((646, 331), (646, 331), 54960.406, 58595.0)
('Error: ', tensor(34520.2617, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7563614504361542, 0.5874536913218319)
('Val: AUC, AUPR, Erros: ', 0.7126336243213706, 0.523813479022573, 4702.9893)
('Test: AUC, AUPR, Erros: ', 0.7264892008184091, 0.5245131226378423, 4319.6206)
((646, 331), (646, 331), 61558.55, 58595.0)
('Error: ', tensor(33958.3320, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7654577491458989, 0.6000516725161981)
('Val: AUC, AUPR, Erros: ', 0.7180024620541533, 0.5369038219794902, 4644.2456)
('Test: AUC, AUPR, Erros: ', 0.7273019632846855, 0.5228920050156138, 4331.248)
((646, 331), (646, 331), 58518.05, 58595.0)
('Error: ', tensor(33432.5859, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.77647888944595, 0.6139298303790757)
('Val: AUC, AUPR, Erros: ', 0.7162895509410498, 0.5346919364537706, 4650.794)
('Test: AUC, AUPR, Erros: ', 0.7278904282676701, 0.5215697991039496, 4325.8804)
((646, 331), (646, 331), 60244.953, 58595.0)
('Error: ', tensor(32992.0039, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7840108617768242, 0.6239848606028656)
('Val: AUC, AUPR, Erros: ', 0.7149077330631548, 0.5334629790679623, 4662.7026)
('Test: AUC, AUPR, Erros: ', 0.7275598600900752, 0.5191188589905664, 4336.581)
((646, 331), (646, 331), 60347.383, 58595.0)
('Error: ', tensor(32617.3477, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7906173455187121, 0.6334569495387441)
('Val: AUC, AUPR, Erros: ', 0.709913290713171, 0.528341070927411, 4697.366)
('Test: AUC, AUPR, Erros: ', 0.7276727185990604, 0.5175178947405198, 4341.4775)
((646, 331), (646, 331), 60285.52, 58595.0)
('Error: ', tensor(32273.5586, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7964013305211889, 0.6419663219534881)
('Val: AUC, AUPR, Erros: ', 0.7078979069500465, 0.5275282045837877, 4707.9644)
('Test: AUC, AUPR, Erros: ', 0.7283052405097431, 0.5158199155094436, 4347.221)
Train: 0.7655 0.6001
Test: 0.7273 0.5229
[0.5424256046030748, 0.5599260979447769, 0.5575735012151197, 0.5586508528242693, 0.5648418206270184, 0.5689403557006726, 0.5743544920672583, 0.5803213371637705, 0.5878232373506441, 0.590587408664912, 0.5926289247047025, 0.5967473332114797, 0.6025619068738997, 0.603951951759274, 0.6106849881573745, 0.6174524435649751, 0.6202388560390709, 0.6241645975104078, 0.6285047684991225, 0.6301237154011442, 0.6309090340261285, 0.634122874039034, 0.6372817933676119, 0.6393006583917087, 0.6411073230539377, 0.6469362888340513, 0.6501970489705122, 0.6503283559480961, 0.6529466335347702, 0.6542167607625726, 0.6603822625581468, 0.6622700941014567, 0.6651982205071149, 0.6680220146620788, 0.67336209120286, 0.6748809389959081, 0.6756542888910313, 0.6793264548567104, 0.6793264548567104, 0.6813831385825024, 0.6821277410572633, 0.6847817903736676, 0.685879039559863, 0.6911389145896853, 0.6948344079975891, 0.6948344079975891, 0.6962766101535582, 0.6962766101535582, 0.6995971196685049, 0.7008909559326607, 0.7008909559326607, 0.704219776569119, 0.704219776569119, 0.704219776569119, 0.704219776569119, 0.704219776569119, 0.704219776569119, 0.704219776569119, 0.7081325818742894, 0.7081325818742894, 0.7101529246467548, 0.7118347123035844, 0.7118347123035844, 0.7118347123035844, 0.7118347123035844, 0.7118347123035844, 0.7118347123035844, 0.7145620708398006, 0.7145620708398006, 0.7145620708398006, 0.7222962472937666, 0.7222962472937666, 0.7222962472937666, 0.7244280304462714, 0.7244280304462714, 0.7244280304462714, 0.7244280304462714, 0.7244280304462714, 0.7273019632846855, 0.7273019632846855, 0.7273019632846855, 0.7273019632846855, 0.7273019632846855, 0.7273019632846855, 0.7273019632846855, 0.7273019632846855, 0.7273019632846855, 0.7273019632846855, 0.7273019632846855, 0.7273019632846855]
[0.12814860630046193, 0.147934966892241, 0.14370013773471924, 0.1501285545496834, 0.15697165220567977, 0.16263395382590315, 0.1730346228509207, 0.18294944052811343, 0.19449140572104684, 0.19922093126342633, 0.20182617219125012, 0.20921445778355552, 0.2162933164575997, 0.21714449217869367, 0.22792058125943393, 0.2379715919077957, 0.242038060261336, 0.2512469483301706, 0.2616828655521541, 0.26635911845249766, 0.2679854748077308, 0.27406916503808487, 0.2807287863467906, 0.284425160129358, 0.28876316552614256, 0.29818579132693623, 0.3060220585740982, 0.3049735474263203, 0.3099423020743853, 0.3141090097409869, 0.32858957880390066, 0.3325755250938181, 0.3387747005184335, 0.3460231974330211, 0.3601037987654807, 0.36484151917943286, 0.36721565067887896, 0.3736830475317433, 0.3736830475317433, 0.3789401654961969, 0.3803952386671826, 0.38795506582321804, 0.3915534550765984, 0.4061613351667108, 0.4157173560367595, 0.4157173560367595, 0.41964640514020485, 0.41964640514020485, 0.4311012222189414, 0.4342782751908089, 0.4342782751908089, 0.4445890331597758, 0.4445890331597758, 0.4445890331597758, 0.4445890331597758, 0.4445890331597758, 0.4445890331597758, 0.4445890331597758, 0.45854960369926445, 0.45854960369926445, 0.4653230692531255, 0.46955733071351535, 0.46955733071351535, 0.46955733071351535, 0.46955733071351535, 0.46955733071351535, 0.46955733071351535, 0.4803006039171044, 0.4803006039171044, 0.4803006039171044, 0.5064384054333475, 0.5064384054333475, 0.5064384054333475, 0.512986155280368, 0.512986155280368, 0.512986155280368, 0.512986155280368, 0.512986155280368, 0.5228920050156138, 0.5228920050156138, 0.5228920050156138, 0.5228920050156138, 0.5228920050156138, 0.5228920050156138, 0.5228920050156138, 0.5228920050156138, 0.5228920050156138, 0.5228920050156138, 0.5228920050156138, 0.5228920050156138]
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/KFold/ATCInchikeySideEffectByDrug.txt_P3_1
('Number of substructures, proteins, pathways, drugs, se: ', 888, 1448, 330, 808, 331)
((646, 2666), (81, 2666), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19911.0)
('VALIDATE SUM PROTEIN TEST: ', 2446.0)
((646, 331), (646, 331), 155798.23, 58221.0)
('Error: ', tensor(89963.2344, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5365567613528598, 0.29723707488376017)
('Val: AUC, AUPR, Erros: ', 0.5185996975701915, 0.291937495258623, 11339.841)
('Test: AUC, AUPR, Erros: ', 0.5324568833146306, 0.3012423246594912, 11468.195)
((646, 331), (646, 331), 59572.688, 58221.0)
('Error: ', tensor(45120.9375, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5809335138229679, 0.34095458042507465)
('Val: AUC, AUPR, Erros: ', 0.5752647019151997, 0.33603576765822285, 5609.197)
('Test: AUC, AUPR, Erros: ', 0.5790788599177943, 0.34211580951802145, 5809.5303)
((646, 331), (646, 331), 48023.434, 58221.0)
('Error: ', tensor(38271.1328, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.694436235556006, 0.49360216780281013)
('Val: AUC, AUPR, Erros: ', 0.66727650549985, 0.46062223450675377, 4877.8687)
('Test: AUC, AUPR, Erros: ', 0.6761477417608841, 0.4745090532173245, 4962.072)
((646, 331), (646, 331), 52897.355, 58221.0)
('Error: ', tensor(35614.1211, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7350376289669747, 0.5554141348580176)
('Val: AUC, AUPR, Erros: ', 0.7059341162436972, 0.5029862077075542, 4621.7295)
('Test: AUC, AUPR, Erros: ', 0.6971550095314458, 0.506354713735754, 4785.9717)
((646, 331), (646, 331), 58858.727, 58221.0)
('Error: ', tensor(34790.8477, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.746495223203905, 0.5739189232092599)
('Val: AUC, AUPR, Erros: ', 0.7088120392588941, 0.5017417414133267, 4649.2017)
('Test: AUC, AUPR, Erros: ', 0.7033975884523554, 0.5062656973640611, 4795.164)
((646, 331), (646, 331), 59171.64, 58221.0)
('Error: ', tensor(34148.8359, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7586356275341563, 0.590041825621208)
('Val: AUC, AUPR, Erros: ', 0.7046339128586446, 0.49772515728651434, 4678.99)
('Test: AUC, AUPR, Erros: ', 0.7124327000080539, 0.523104268216248, 4709.1475)
((646, 331), (646, 331), 57220.785, 58221.0)
('Error: ', tensor(33574.5352, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7717472422161845, 0.6058116360736502)
('Val: AUC, AUPR, Erros: ', 0.694871708862507, 0.48715384614354784, 4718.4663)
('Test: AUC, AUPR, Erros: ', 0.7169855281446, 0.5332222470389689, 4655.6655)
((646, 331), (646, 331), 58520.93, 58221.0)
('Error: ', tensor(33046.6250, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7817690210024065, 0.6190866167603161)
('Val: AUC, AUPR, Erros: ', 0.6856790306393528, 0.4770690633781096, 4801.5)
('Test: AUC, AUPR, Erros: ', 0.7178619113922984, 0.5350463743296705, 4649.5645)
((646, 331), (646, 331), 59915.91, 58221.0)
('Error: ', tensor(32639.2422, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7886350969131176, 0.6288904063933296)
('Val: AUC, AUPR, Erros: ', 0.6816967868030588, 0.4703815751637573, 4872.7876)
('Test: AUC, AUPR, Erros: ', 0.714332002379995, 0.5296079702603439, 4685.089)
((646, 331), (646, 331), 59568.684, 58221.0)
('Error: ', tensor(32309.5195, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7939385432884022, 0.637050222793084)
('Val: AUC, AUPR, Erros: ', 0.6787243385265731, 0.46625157597339684, 4904.649)
('Test: AUC, AUPR, Erros: ', 0.7096603091921154, 0.5224048165482107, 4724.917)
((646, 331), (646, 331), 60020.516, 58221.0)
('Error: ', tensor(32017.3281, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7982860372538401, 0.6440609108439103)
('Val: AUC, AUPR, Erros: ', 0.675916202971388, 0.46320156443364807, 4941.1855)
('Test: AUC, AUPR, Erros: ', 0.7081526463904768, 0.5190637514866727, 4747.214)
Train: 0.7350 0.5554
Test: 0.6972 0.5064
[0.5137363560660659, 0.5217717995169303, 0.5312603374131657, 0.5331733209270851, 0.5407671878552769, 0.5414603897262364, 0.5402664284255962, 0.551942197809753, 0.5566657327506992, 0.5576319611177791, 0.5599012317507587, 0.5626479806738788, 0.5653448932642973, 0.5680492105281537, 0.5757790794255555, 0.5796364525747487, 0.5851802331417187, 0.5908790889404792, 0.5945047724656418, 0.5966671551041048, 0.5973556205754093, 0.600997863206925, 0.6025821156186132, 0.6049051614427696, 0.60652847675342, 0.6126954249556187, 0.6149580076149325, 0.6156096395860934, 0.6176588527888573, 0.6190769424111576, 0.6268291638093976, 0.6298529856040661, 0.6345841005835772, 0.6382169892759294, 0.6429559955180215, 0.644294073965761, 0.6452794963401882, 0.6494365537065221, 0.6494365537065221, 0.6519342655709388, 0.6530263296277872, 0.6562250936742494, 0.6582016992642044, 0.6641400350823234, 0.6674453500322388, 0.6674453500322388, 0.6683280882689194, 0.6683280882689194, 0.6709675914347939, 0.6729710186116917, 0.6729710186116917, 0.6758758173654549, 0.6758758173654549, 0.6758758173654549, 0.6758758173654549, 0.6758758173654549, 0.6758758173654549, 0.6758758173654549, 0.6791609934484952, 0.6791609934484952, 0.6809716257452163, 0.683095083294615, 0.683095083294615, 0.683095083294615, 0.683095083294615, 0.683095083294615, 0.683095083294615, 0.6849981819898274, 0.6849981819898274, 0.6849981819898274, 0.6918043940219452, 0.6918043940219452, 0.6918043940219452, 0.6943211115933545, 0.6943211115933545, 0.6943211115933545, 0.6943211115933545, 0.6943211115933545, 0.6971550095314458, 0.6971550095314458, 0.6971550095314458, 0.6971550095314458, 0.6971550095314458, 0.6971550095314458, 0.6971550095314458, 0.6971550095314458, 0.6971550095314458, 0.6971550095314458, 0.6971550095314458, 0.6971550095314458]
[0.13423345397204722, 0.14575344162309703, 0.15485750482360716, 0.1592454260541949, 0.1707828501446034, 0.17372550346132143, 0.17447798879731902, 0.19173862047616766, 0.19928790119961404, 0.19977087988397987, 0.2060441639464763, 0.21071166899637864, 0.213370879842798, 0.21730795264408742, 0.2272017924756195, 0.23363907294712064, 0.24474648744001326, 0.2547194107962109, 0.2594356169685558, 0.2644032469107754, 0.2655780778878339, 0.27087866605614985, 0.27406862145584787, 0.27904890130686255, 0.28126503844347917, 0.29384439045504795, 0.2984671248325005, 0.2995372445307498, 0.30370033314485884, 0.3085934472810705, 0.3239679788604898, 0.33057568216067135, 0.34108052440041, 0.3503029346204251, 0.3605751429619365, 0.3638900280687273, 0.36613116294308284, 0.37504541471639125, 0.37504541471639125, 0.381518574631857, 0.38374323496600493, 0.39277339028777847, 0.39821377698076366, 0.41402006218456744, 0.42226248732141974, 0.42226248732141974, 0.4242231542647184, 0.4242231542647184, 0.4314208475695119, 0.437045050024784, 0.437045050024784, 0.442804459620146, 0.442804459620146, 0.442804459620146, 0.442804459620146, 0.442804459620146, 0.442804459620146, 0.442804459620146, 0.4507811511727516, 0.4507811511727516, 0.4557217968201652, 0.4631943587233973, 0.4631943587233973, 0.4631943587233973, 0.4631943587233973, 0.4631943587233973, 0.4631943587233973, 0.46815381256171296, 0.46815381256171296, 0.46815381256171296, 0.4880797484584711, 0.4880797484584711, 0.4880797484584711, 0.4963248995099723, 0.4963248995099723, 0.4963248995099723, 0.4963248995099723, 0.4963248995099723, 0.506354713735754, 0.506354713735754, 0.506354713735754, 0.506354713735754, 0.506354713735754, 0.506354713735754, 0.506354713735754, 0.506354713735754, 0.506354713735754, 0.506354713735754, 0.506354713735754, 0.506354713735754]
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/KFold/ATCInchikeySideEffectByDrug.txt_P3_2
('Number of substructures, proteins, pathways, drugs, se: ', 888, 1448, 330, 808, 331)
((646, 2666), (81, 2666), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19946.0)
('VALIDATE SUM PROTEIN TEST: ', 2286.0)
((646, 331), (646, 331), 114706.68, 58507.0)
('Error: ', tensor(58796.5195, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5280281390422462, 0.2922470920930638)
('Val: AUC, AUPR, Erros: ', 0.5247040322135847, 0.29265772163632453, 7338.767)
('Test: AUC, AUPR, Erros: ', 0.527070156730431, 0.2956425651795598, 7209.554)
((646, 331), (646, 331), 42850.75, 58507.0)
('Error: ', tensor(42130.1953, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6138254603666519, 0.39715761564663277)
('Val: AUC, AUPR, Erros: ', 0.57049409338215, 0.3489601161479987, 5387.473)
('Test: AUC, AUPR, Erros: ', 0.5849576499898144, 0.35224733266088815, 5340.1133)
((646, 331), (646, 331), 71558.016, 58507.0)
('Error: ', tensor(37208.3750, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7276062499520888, 0.5312139908463204)
('Val: AUC, AUPR, Erros: ', 0.6834098540141491, 0.4701940756115709, 4918.1055)
('Test: AUC, AUPR, Erros: ', 0.6903082595808324, 0.46681413198372, 4874.203)
((646, 331), (646, 331), 65466.72, 58507.0)
('Error: ', tensor(34741.6250, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7584501309479013, 0.5808580428442599)
('Val: AUC, AUPR, Erros: ', 0.7067881773920521, 0.5068401057805224, 4696.3486)
('Test: AUC, AUPR, Erros: ', 0.7117722869552631, 0.4950854951795971, 4693.483)
((646, 331), (646, 331), 62162.434, 58507.0)
('Error: ', tensor(33652.8711, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7720956706093938, 0.6064172470500032)
('Val: AUC, AUPR, Erros: ', 0.7107688103539249, 0.5162045700075226, 4640.921)
('Test: AUC, AUPR, Erros: ', 0.7127398996205864, 0.5046507434390827, 4642.275)
((646, 331), (646, 331), 62012.742, 58507.0)
('Error: ', tensor(32976.1016, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.784154409917592, 0.6243566133182186)
('Val: AUC, AUPR, Erros: ', 0.7150663051147294, 0.5199614504741614, 4628.081)
('Test: AUC, AUPR, Erros: ', 0.7078438277268733, 0.5023870561733663, 4664.61)
((646, 331), (646, 331), 57987.0, 58507.0)
('Error: ', tensor(32535.1172, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7927741853085248, 0.635999497207804)
('Val: AUC, AUPR, Erros: ', 0.7125816368850119, 0.5173214019750529, 4613.476)
('Test: AUC, AUPR, Erros: ', 0.6945933279814731, 0.4903852332558148, 4709.496)
((646, 331), (646, 331), 90373.02, 58507.0)
('Error: ', tensor(38673.6562, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7830759453803101, 0.622979848800869)
('Val: AUC, AUPR, Erros: ', 0.7195299265764636, 0.5223227602891938, 5601.922)
('Test: AUC, AUPR, Erros: ', 0.704422941688782, 0.512820473496741, 5462.3735)
((646, 331), (646, 331), 54163.055, 58507.0)
('Error: ', tensor(32582.0371, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7936900451297464, 0.6393963322702093)
('Val: AUC, AUPR, Erros: ', 0.7202752198349033, 0.531755698435445, 4535.1885)
('Test: AUC, AUPR, Erros: ', 0.6929497223838257, 0.4933783320586471, 4707.036)
((646, 331), (646, 331), 59429.27, 58507.0)
('Error: ', tensor(32242.2109, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7972337559322313, 0.6441864864514751)
('Val: AUC, AUPR, Erros: ', 0.7225673302662505, 0.5343153207021543, 4528.266)
('Test: AUC, AUPR, Erros: ', 0.6922805473185202, 0.4953758745890398, 4702.915)
((646, 331), (646, 331), 60599.24, 58507.0)
('Error: ', tensor(31959.9102, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.8004070573183021, 0.649605175472224)
('Val: AUC, AUPR, Erros: ', 0.7197155705375649, 0.52958698674996, 4568.138)
('Test: AUC, AUPR, Erros: ', 0.6865178515287982, 0.48684232524106374, 4758.0)
Train: 0.7972 0.6442
Test: 0.6923 0.4954
[0.49016815000874225, 0.5176789604189134, 0.5273860044128537, 0.5273127294745593, 0.5282811338039505, 0.534032455859206, 0.5379238823893278, 0.5431179608166192, 0.5482537235142694, 0.5516865515048384, 0.5559245716444314, 0.5579895725532835, 0.5623126103558023, 0.56434513399233, 0.5692035054478962, 0.5735291589189775, 0.5791891665641921, 0.5840341077119096, 0.5881106330958854, 0.5926134951397755, 0.5939508446933568, 0.6005017650902662, 0.6037930612562031, 0.6079528952437088, 0.6100362577018695, 0.6153148902011709, 0.6180756971488337, 0.6193947953988423, 0.6216678931726526, 0.6224221037876446, 0.6278190773391336, 0.6297981135193458, 0.6342518138453522, 0.6375244570472451, 0.641644973069383, 0.643545532021291, 0.6443992919570901, 0.6482183069725835, 0.6482183069725835, 0.6500477539926918, 0.6510129301688903, 0.6534173053236174, 0.654984106242743, 0.6600223621609839, 0.6644285849021718, 0.6644285849021718, 0.6653223122147747, 0.6653223122147747, 0.6676825108274548, 0.6689754883921901, 0.6689754883921901, 0.6712420086076356, 0.6712420086076356, 0.6712420086076356, 0.6712420086076356, 0.6712420086076356, 0.6712420086076356, 0.6712420086076356, 0.6750263736000713, 0.6750263736000713, 0.676575414306852, 0.6786868561383882, 0.6786868561383882, 0.6786868561383882, 0.6786868561383882, 0.6786868561383882, 0.6786868561383882, 0.680948936299789, 0.680948936299789, 0.680948936299789, 0.687459814792048, 0.687459814792048, 0.687459814792048, 0.6899147829698365, 0.6899147829698365, 0.6899147829698365, 0.6899147829698365, 0.6899147829698365, 0.6922805473185202, 0.6922805473185202, 0.6922805473185202, 0.6922805473185202, 0.6922805473185202, 0.6922805473185202, 0.6922805473185202, 0.6922805473185202, 0.6922805473185202, 0.6922805473185202, 0.6922805473185202, 0.6922805473185202]
[0.12838369414152342, 0.139704025317194, 0.14057361888561704, 0.14299487003762884, 0.14672642633502647, 0.1526889523222492, 0.15801781783689048, 0.16591777372864197, 0.17390633827902058, 0.17848378636403398, 0.18730661486304315, 0.19152940699024534, 0.19894687118567064, 0.2013780933044644, 0.21172546582098867, 0.22056507646727574, 0.23228253267163093, 0.2421008949919633, 0.24906104613759272, 0.25844058825264926, 0.2612397163786383, 0.27141726295005003, 0.27812197116267456, 0.284749248927924, 0.2876629466961596, 0.29923283003674617, 0.3041211221489568, 0.30652780488708975, 0.3087708272970666, 0.311530474618123, 0.32288420919386845, 0.3267160157589173, 0.3368332842650521, 0.3457153762118229, 0.35480711679005117, 0.3601069149146892, 0.36122390953504874, 0.3690806689427466, 0.3690806689427466, 0.3745799566856085, 0.3767950248334211, 0.3837817437659405, 0.38772194585832753, 0.4016849334715737, 0.4145343192381253, 0.4145343192381253, 0.4169783673409116, 0.4169783673409116, 0.4224831295701294, 0.4260269037873546, 0.4260269037873546, 0.42981766970242646, 0.42981766970242646, 0.42981766970242646, 0.42981766970242646, 0.42981766970242646, 0.42981766970242646, 0.42981766970242646, 0.44171972576443064, 0.44171972576443064, 0.4454998120422184, 0.4525654448358943, 0.4525654448358943, 0.4525654448358943, 0.4525654448358943, 0.4525654448358943, 0.4525654448358943, 0.4592391836986368, 0.4592391836986368, 0.4592391836986368, 0.4807317371802162, 0.4807317371802162, 0.4807317371802162, 0.4880202716850441, 0.4880202716850441, 0.4880202716850441, 0.4880202716850441, 0.4880202716850441, 0.4953758745890398, 0.4953758745890398, 0.4953758745890398, 0.4953758745890398, 0.4953758745890398, 0.4953758745890398, 0.4953758745890398, 0.4953758745890398, 0.4953758745890398, 0.4953758745890398, 0.4953758745890398, 0.4953758745890398]
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/KFold/ATCInchikeySideEffectByDrug.txt_P3_3
('Number of substructures, proteins, pathways, drugs, se: ', 888, 1448, 330, 808, 331)
((647, 2666), (81, 2666), (647, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19714.0)
('VALIDATE SUM PROTEIN TEST: ', 2411.0)
((647, 331), (647, 331), 138032.97, 58338.0)
('Error: ', tensor(74905.2188, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5384313409729543, 0.30603731375580157)
('Val: AUC, AUPR, Erros: ', 0.5356901834177534, 0.31410572976134277, 9233.896)
('Test: AUC, AUPR, Erros: ', 0.5024344420679809, 0.2771957406823149, 9411.999)
((647, 331), (647, 331), 52098.5, 58338.0)
('Error: ', tensor(44146.9531, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5880095556161499, 0.342266296711561)
('Val: AUC, AUPR, Erros: ', 0.5882881701056238, 0.34035577139371015, 5564.1675)
('Test: AUC, AUPR, Erros: ', 0.5612354533253073, 0.308662137777367, 5621.781)
((647, 331), (647, 331), 41391.15, 58338.0)
('Error: ', tensor(39460.3008, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6957440250937509, 0.4999668799597228)
('Val: AUC, AUPR, Erros: ', 0.6893500533865221, 0.48725945396098835, 5030.0103)
('Test: AUC, AUPR, Erros: ', 0.6536325513309249, 0.445322082821936, 5086.224)
((647, 331), (647, 331), 68291.44, 58338.0)
('Error: ', tensor(35693.8633, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.740668837712374, 0.5624984189946621)
('Val: AUC, AUPR, Erros: ', 0.7244780133129538, 0.5457802303839348, 4566.9985)
('Test: AUC, AUPR, Erros: ', 0.7029440201811017, 0.5119627859874281, 4676.3174)
((647, 331), (647, 331), 54557.39, 58338.0)
('Error: ', tensor(34453.3008, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7583497312301072, 0.5843351775785428)
('Val: AUC, AUPR, Erros: ', 0.7297297255048051, 0.5571696019151526, 4491.7627)
('Test: AUC, AUPR, Erros: ', 0.7018814723724831, 0.5132891096993691, 4616.9424)
((647, 331), (647, 331), 55426.355, 58338.0)
('Error: ', tensor(33868.6445, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7675549717639776, 0.5996869226600186)
('Val: AUC, AUPR, Erros: ', 0.7288219020264894, 0.5605708486372224, 4487.4155)
('Test: AUC, AUPR, Erros: ', 0.7064568121033734, 0.514345343377062, 4605.698)
((647, 331), (647, 331), 57245.926, 58338.0)
('Error: ', tensor(33370.8477, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7761739747257688, 0.6126061212596439)
('Val: AUC, AUPR, Erros: ', 0.7273400562826753, 0.5568706564716029, 4503.897)
('Test: AUC, AUPR, Erros: ', 0.706916829962728, 0.5125328106046098, 4614.078)
((647, 331), (647, 331), 58496.848, 58338.0)
('Error: ', tensor(33000.4766, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7835780389756111, 0.6218292097520717)
('Val: AUC, AUPR, Erros: ', 0.7262426139620363, 0.5541765285203598, 4514.4976)
('Test: AUC, AUPR, Erros: ', 0.7050886047521145, 0.5123907069329328, 4625.6465)
((647, 331), (647, 331), 60608.547, 58338.0)
('Error: ', tensor(32700.2812, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7884004553529511, 0.6288888325898606)
('Val: AUC, AUPR, Erros: ', 0.7206866667719709, 0.5437050866981535, 4565.6353)
('Test: AUC, AUPR, Erros: ', 0.7042762182581095, 0.5094486502609913, 4649.076)
((647, 331), (647, 331), 59654.656, 58338.0)
('Error: ', tensor(32429.6602, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7928313201464104, 0.6354370616803965)
('Val: AUC, AUPR, Erros: ', 0.7128129621297576, 0.5317691011852254, 4634.3867)
('Test: AUC, AUPR, Erros: ', 0.7047245703439351, 0.5097518579923708, 4644.3184)
((647, 331), (647, 331), 59864.62, 58338.0)
('Error: ', tensor(32190.5273, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7968026463348339, 0.6412208599870919)
('Val: AUC, AUPR, Erros: ', 0.7071185560937989, 0.522327721084132, 4696.2046)
('Test: AUC, AUPR, Erros: ', 0.7047566910270098, 0.5083710500508171, 4648.8535)
Train: 0.7676 0.5997
Test: 0.7065 0.5143
[0.5108600931229741, 0.5303479513230994, 0.5285942545669147, 0.531965342955747, 0.5359237846270901, 0.5380833126091005, 0.5432240191411973, 0.5562528110084253, 0.5628233928891625, 0.5637580965100571, 0.5690995178233933, 0.5730449059110019, 0.5779879986349358, 0.580336403016374, 0.5849874452954518, 0.5901619677957181, 0.5945786649803497, 0.5999704390671222, 0.6046927181180771, 0.6088235144235243, 0.6096743357945108, 0.6136060284755761, 0.6168521374750541, 0.6211598488038126, 0.6230071163575113, 0.6290703727289917, 0.6312757557009595, 0.6317192053617902, 0.633075314160342, 0.6338321687255717, 0.6397624927245258, 0.6422870615165528, 0.6481528502512423, 0.651038865269235, 0.6556063215024399, 0.6572221343497233, 0.6585197946136137, 0.662729299577192, 0.662729299577192, 0.6642629061325558, 0.6653860582365785, 0.6678360943373028, 0.668611093893304, 0.6732380418978553, 0.6767249028247007, 0.6767249028247007, 0.6779434385618879, 0.6779434385618879, 0.6811835357372301, 0.6821931057822505, 0.6821931057822505, 0.6850882172351204, 0.6850882172351204, 0.6850882172351204, 0.6850882172351204, 0.6850882172351204, 0.6850882172351204, 0.6850882172351204, 0.6888983656060155, 0.6888983656060155, 0.6909891104271652, 0.6926970131711038, 0.6926970131711038, 0.6926970131711038, 0.6926970131711038, 0.6926970131711038, 0.6926970131711038, 0.694842113705733, 0.694842113705733, 0.694842113705733, 0.7015061652042414, 0.7015061652042414, 0.7015061652042414, 0.7039649798622389, 0.7039649798622389, 0.7039649798622389, 0.7039649798622389, 0.7039649798622389, 0.7064568121033734, 0.7064568121033734, 0.7064568121033734, 0.7064568121033734, 0.7064568121033734, 0.7064568121033734, 0.7064568121033734, 0.7064568121033734, 0.7064568121033734, 0.7064568121033734, 0.7064568121033734, 0.7064568121033734]
[0.1359568945851344, 0.1412218360124279, 0.14265514753143177, 0.14723960798272395, 0.15204223282998544, 0.15639718838008704, 0.16118341457254576, 0.17708834239011972, 0.18492559938573694, 0.18597220070663506, 0.19530299167565218, 0.20032684804115194, 0.2067840851092823, 0.2099847290249525, 0.2179987653110384, 0.2275664365014773, 0.23519038581198232, 0.24435168574517357, 0.2530137283161822, 0.2627167964930538, 0.2636466517696895, 0.26876795405149945, 0.2750456586191834, 0.28444410912804863, 0.28962841411997275, 0.3020176894109501, 0.3074322664475734, 0.308923516326479, 0.3123886105471104, 0.31348068496266146, 0.32771275046784665, 0.3333481232149423, 0.3491028060656115, 0.3553951810846223, 0.3660823194557168, 0.36933690855031565, 0.37250127756490103, 0.38195325737764785, 0.38195325737764785, 0.3853372518965186, 0.38769908239204887, 0.3942855043926024, 0.3965706690675158, 0.410455638545691, 0.4189231703674749, 0.4189231703674749, 0.4219020099232799, 0.4219020099232799, 0.43127871688719804, 0.43365809902553865, 0.43365809902553865, 0.4408150000204355, 0.4408150000204355, 0.4408150000204355, 0.4408150000204355, 0.4408150000204355, 0.4408150000204355, 0.4408150000204355, 0.4530682000403549, 0.4530682000403549, 0.4592811747891492, 0.465362988438571, 0.465362988438571, 0.465362988438571, 0.465362988438571, 0.465362988438571, 0.465362988438571, 0.47307209231863534, 0.47307209231863534, 0.47307209231863534, 0.4963079872982927, 0.4963079872982927, 0.4963079872982927, 0.5051477150057377, 0.5051477150057377, 0.5051477150057377, 0.5051477150057377, 0.5051477150057377, 0.514345343377062, 0.514345343377062, 0.514345343377062, 0.514345343377062, 0.514345343377062, 0.514345343377062, 0.514345343377062, 0.514345343377062, 0.514345343377062, 0.514345343377062, 0.514345343377062, 0.514345343377062]
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/KFold/ATCInchikeySideEffectByDrug.txt_P3_4
('Number of substructures, proteins, pathways, drugs, se: ', 888, 1448, 330, 808, 331)
((647, 2666), (80, 2666), (647, 331), (80, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19824.0)
('VALIDATE SUM PROTEIN TEST: ', 2518.0)
((647, 331), (647, 331), 147812.84, 58099.0)
('Error: ', tensor(84297.9766, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5235369708778121, 0.2875468058681403)
('Val: AUC, AUPR, Erros: ', 0.5538051480469273, 0.3017097550959328, 10287.526)
('Test: AUC, AUPR, Erros: ', 0.5171170334444052, 0.29050515495737955, 10502.659)
((647, 331), (647, 331), 0.0, 58099.0)
('Error: ', tensor(58099., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5, 0.2712916225012491)
('Val: AUC, AUPR, Erros: ', 0.5, 0.27779642683972994, 7448.0)
('Test: AUC, AUPR, Erros: ', 0.5, 0.2779833836858006, 7361.0)
((647, 331), (647, 331), 0.0, 58099.0)
('Error: ', tensor(58099., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5, 0.2712916225012491)
('Val: AUC, AUPR, Erros: ', 0.5, 0.27779642683972994, 7448.0)
('Test: AUC, AUPR, Erros: ', 0.5, 0.2779833836858006, 7361.0)
((647, 331), (647, 331), 0.0, 58099.0)
('Error: ', tensor(58099., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5, 0.2712916225012491)
('Val: AUC, AUPR, Erros: ', 0.5, 0.27779642683972994, 7448.0)
('Test: AUC, AUPR, Erros: ', 0.5, 0.2779833836858006, 7361.0)
((647, 331), (647, 331), 0.0, 58099.0)
('Error: ', tensor(58099., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5, 0.2712916225012491)
('Val: AUC, AUPR, Erros: ', 0.5, 0.27779642683972994, 7448.0)
('Test: AUC, AUPR, Erros: ', 0.5, 0.2779833836858006, 7361.0)
((647, 331), (647, 331), 0.0, 58099.0)
('Error: ', tensor(58099., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5, 0.2712916225012491)
('Val: AUC, AUPR, Erros: ', 0.5, 0.27779642683972994, 7448.0)
('Test: AUC, AUPR, Erros: ', 0.5, 0.2779833836858006, 7361.0)
((647, 331), (647, 331), 0.0, 58099.0)
('Error: ', tensor(58099., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5, 0.2712916225012491)
('Val: AUC, AUPR, Erros: ', 0.5, 0.27779642683972994, 7448.0)
('Test: AUC, AUPR, Erros: ', 0.5, 0.2779833836858006, 7361.0)
((647, 331), (647, 331), 0.0, 58099.0)
('Error: ', tensor(58099., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5, 0.2712916225012491)
('Val: AUC, AUPR, Erros: ', 0.5, 0.27779642683972994, 7448.0)
('Test: AUC, AUPR, Erros: ', 0.5, 0.2779833836858006, 7361.0)
((647, 331), (647, 331), 0.0, 58099.0)
('Error: ', tensor(58099., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5, 0.2712916225012491)
('Val: AUC, AUPR, Erros: ', 0.5, 0.27779642683972994, 7448.0)
('Test: AUC, AUPR, Erros: ', 0.5, 0.2779833836858006, 7361.0)
((647, 331), (647, 331), 0.0, 58099.0)
('Error: ', tensor(58099., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5, 0.2712916225012491)
('Val: AUC, AUPR, Erros: ', 0.5, 0.27779642683972994, 7448.0)
('Test: AUC, AUPR, Erros: ', 0.5, 0.2779833836858006, 7361.0)
((647, 331), (647, 331), 0.0, 58099.0)
('Error: ', tensor(58099., grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5, 0.2712916225012491)
('Val: AUC, AUPR, Erros: ', 0.5, 0.27779642683972994, 7448.0)
('Test: AUC, AUPR, Erros: ', 0.5, 0.2779833836858006, 7361.0)
Train: 0.5000 0.2713
Test: 0.5000 0.2780
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[0.11157407407407408, 0.11729166666666667, 0.12442528735632184, 0.13142201834862385, 0.13432377049180327, 0.13702290076335877, 0.1410211267605634, 0.1482361963190184, 0.15303672316384181, 0.15446428571428572, 0.1574074074074074, 0.15966494845360824, 0.16262437810945274, 0.16445121951219513, 0.16980140186915887, 0.17176136363636363, 0.17637665198237887, 0.18066239316239316, 0.18442708333333332, 0.18785714285714286, 0.1886178861788618, 0.1919820717131474, 0.1948529411764706, 0.19870192307692308, 0.20047709923664123, 0.20559701492537313, 0.2077490774907749, 0.20863970588235295, 0.2101733576642336, 0.21113636363636365, 0.21654804270462633, 0.21945422535211268, 0.22335069444444444, 0.22607388316151203, 0.22995762711864406, 0.23186026936026935, 0.23309563758389262, 0.23663079470198675, 0.23663079470198675, 0.23885690789473685, 0.24, 0.24246742671009772, 0.2437905844155844, 0.24891826923076923, 0.25246031746031744, 0.25246031746031744, 0.25363924050632913, 0.25363924050632913, 0.2564072327044025, 0.25783699059561127, 0.25783699059561127, 0.26039719626168223, 0.26039719626168223, 0.26039719626168223, 0.26039719626168223, 0.26039719626168223, 0.26039719626168223, 0.26039719626168223, 0.2633513931888545, 0.2633513931888545, 0.2649691358024691, 0.26653846153846156, 0.26653846153846156, 0.26653846153846156, 0.26653846153846156, 0.26653846153846156, 0.26653846153846156, 0.26836656441717793, 0.26836656441717793, 0.26836656441717793, 0.2742401215805471, 0.2742401215805471, 0.2742401215805471, 0.2759848484848485, 0.2759848484848485, 0.2759848484848485, 0.2759848484848485, 0.2759848484848485, 0.2779833836858006, 0.2779833836858006, 0.2779833836858006, 0.2779833836858006, 0.2779833836858006, 0.2779833836858006, 0.2779833836858006, 0.2779833836858006, 0.2779833836858006, 0.2779833836858006, 0.2779833836858006, 0.2779833836858006]
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/KFold/ATCInchikeySideEffectByDrug.txt_P3_5
('Number of substructures, proteins, pathways, drugs, se: ', 888, 1448, 330, 808, 331)
((646, 2666), (81, 2666), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19389.0)
('VALIDATE SUM PROTEIN TEST: ', 2301.0)
((646, 331), (646, 331), 133730.14, 58366.0)
('Error: ', tensor(72239.4375, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5291105246486238, 0.29289526886858397)
('Val: AUC, AUPR, Erros: ', 0.5359591354114055, 0.29364717046067507, 9153.095)
('Test: AUC, AUPR, Erros: ', 0.565135054298971, 0.3065300559259096, 8673.73)
((646, 331), (646, 331), 57700.02, 58366.0)
('Error: ', tensor(41436.9766, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.6214571246618958, 0.3926490190212435)
('Val: AUC, AUPR, Erros: ', 0.634420570240027, 0.38253095293328854, 5080.5107)
('Test: AUC, AUPR, Erros: ', 0.6303765811116276, 0.38397374920577937, 5291.0)
((646, 331), (646, 331), 39232.867, 58366.0)
('Error: ', tensor(39167.3555, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7169445568660963, 0.527592213983815)
('Val: AUC, AUPR, Erros: ', 0.7064790867459068, 0.4886286565852583, 4821.7666)
('Test: AUC, AUPR, Erros: ', 0.6982854853507412, 0.49106104312262006, 5035.1826)
((646, 331), (646, 331), 63015.484, 58366.0)
('Error: ', tensor(35549.9922, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7355947014712286, 0.5587862374073002)
('Val: AUC, AUPR, Erros: ', 0.7252089972747875, 0.5219273470599048, 4522.338)
('Test: AUC, AUPR, Erros: ', 0.7189797341236759, 0.5250194932601724, 4701.0835)
((646, 331), (646, 331), 60227.96, 58366.0)
('Error: ', tensor(34713.7695, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7493754611714183, 0.5780649003240005)
('Val: AUC, AUPR, Erros: ', 0.7302823820894241, 0.52752541304643, 4480.798)
('Test: AUC, AUPR, Erros: ', 0.7215282513356529, 0.531025814343272, 4668.558)
((646, 331), (646, 331), 55901.73, 58366.0)
('Error: ', tensor(34089.9102, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7619699523926302, 0.5955968413219035)
('Val: AUC, AUPR, Erros: ', 0.729648196923027, 0.5218686485565467, 4471.877)
('Test: AUC, AUPR, Erros: ', 0.7137060232808061, 0.5243139412547431, 4684.9854)
((646, 331), (646, 331), 58171.668, 58366.0)
('Error: ', tensor(33553.6484, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.772141940867087, 0.6084665687296319)
('Val: AUC, AUPR, Erros: ', 0.7265820380086714, 0.5147003467309095, 4520.8994)
('Test: AUC, AUPR, Erros: ', 0.7029467382812835, 0.5129364928444047, 4772.06)
((646, 331), (646, 331), 58846.418, 58366.0)
('Error: ', tensor(33149.1250, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7801079929726864, 0.618430235470791)
('Val: AUC, AUPR, Erros: ', 0.7226997352258162, 0.5058352109327857, 4572.921)
('Test: AUC, AUPR, Erros: ', 0.6879488626003518, 0.49910422432227997, 4877.5356)
((646, 331), (646, 331), 59652.01, 58366.0)
('Error: ', tensor(32844.4375, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7851360117641614, 0.6258250836983698)
('Val: AUC, AUPR, Erros: ', 0.7188685361639399, 0.49982104338382466, 4608.3223)
('Test: AUC, AUPR, Erros: ', 0.6735916005882968, 0.4881015765402372, 4983.2773)
((646, 331), (646, 331), 59824.625, 58366.0)
('Error: ', tensor(32594.9336, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7889734532473911, 0.6317793793064359)
('Val: AUC, AUPR, Erros: ', 0.7149773073884098, 0.4957521827145648, 4632.003)
('Test: AUC, AUPR, Erros: ', 0.6610763061289393, 0.4768572022410138, 5087.616)
((646, 331), (646, 331), 60038.336, 58366.0)
('Error: ', tensor(32378.5137, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.7925182051329087, 0.6370077550661427)
('Val: AUC, AUPR, Erros: ', 0.7125021049542599, 0.4961631604181568, 4639.42)
('Test: AUC, AUPR, Erros: ', 0.6526316489813893, 0.4683151676218398, 5187.559)
Train: 0.7620 0.5956
Test: 0.7137 0.5243
[0.4745814440181374, 0.5087091472554378, 0.506911961865038, 0.5094785670118853, 0.5162448040119006, 0.5183574537364375, 0.532521402947798, 0.5456747482368994, 0.547274976822227, 0.5489471753387676, 0.5549859034786158, 0.56099161788399, 0.5667441105692016, 0.5707341173193814, 0.5801812300433631, 0.5866241574932086, 0.5933714641898876, 0.6025066763415572, 0.6078486700442335, 0.6123583004993836, 0.6134219462437933, 0.6177711777130059, 0.6227617258673931, 0.6254917818032257, 0.6272953921613621, 0.6330750404993614, 0.6355477566425858, 0.6364319423579864, 0.6378406051137064, 0.6387650766556713, 0.6461021579146008, 0.6497131646950859, 0.654373870448016, 0.6562048093069933, 0.6607038561073859, 0.6628410200750202, 0.6640989094989507, 0.6673053875013123, 0.6673053875013123, 0.6699267563303233, 0.6705640579896714, 0.6731526785634377, 0.6747304695787618, 0.680121405620185, 0.6836485052787945, 0.6836485052787945, 0.6845895871808725, 0.6845895871808725, 0.6874153194355015, 0.6887237393501152, 0.6887237393501152, 0.6922801608320912, 0.6922801608320912, 0.6922801608320912, 0.6922801608320912, 0.6922801608320912, 0.6922801608320912, 0.6922801608320912, 0.6964217915700822, 0.6964217915700822, 0.6984674550639728, 0.7003415388132246, 0.7003415388132246, 0.7003415388132246, 0.7003415388132246, 0.7003415388132246, 0.7003415388132246, 0.7021445196517906, 0.7021445196517906, 0.7021445196517906, 0.709283913281008, 0.709283913281008, 0.709283913281008, 0.711392316130558, 0.711392316130558, 0.711392316130558, 0.711392316130558, 0.711392316130558, 0.7137060232808061, 0.7137060232808061, 0.7137060232808061, 0.7137060232808061, 0.7137060232808061, 0.7137060232808061, 0.7137060232808061, 0.7137060232808061, 0.7137060232808061, 0.7137060232808061, 0.7137060232808061, 0.7137060232808061]
[0.11495013427029435, 0.14961791711319045, 0.15385940309922103, 0.16033892941697397, 0.16814067358049975, 0.1674984811444093, 0.18116939552420014, 0.19146532686572468, 0.19164989100978652, 0.19402909209967345, 0.2020398911810358, 0.20888256765758706, 0.21604404271403732, 0.22026137883459657, 0.2331919499384006, 0.24414571738882704, 0.2532300351915775, 0.2686707130605798, 0.2777510607357365, 0.28579150773790996, 0.2879720541483508, 0.294185380758212, 0.30143957867232696, 0.30642713629747476, 0.3097912746926119, 0.3189468590258408, 0.32260698579042263, 0.32379234696764625, 0.3259614119116796, 0.32740920244584437, 0.3432789288172978, 0.3502124711056994, 0.36178926555488755, 0.3646328715361295, 0.3748170222328335, 0.3797269766200181, 0.38270138555413336, 0.38912724941030563, 0.38912724941030563, 0.3972089091355375, 0.39870583514049035, 0.4047712832997991, 0.4088008237958673, 0.4231836831240426, 0.4314690785161496, 0.4314690785161496, 0.4333006469946341, 0.4333006469946341, 0.44055407573277555, 0.44383102464631263, 0.44383102464631263, 0.45421942739474697, 0.45421942739474697, 0.45421942739474697, 0.45421942739474697, 0.45421942739474697, 0.45421942739474697, 0.45421942739474697, 0.4670424672454386, 0.4670424672454386, 0.4733311363221895, 0.4796391638731928, 0.4796391638731928, 0.4796391638731928, 0.4796391638731928, 0.4796391638731928, 0.4796391638731928, 0.4847389997064968, 0.4847389997064968, 0.4847389997064968, 0.509955141825126, 0.509955141825126, 0.509955141825126, 0.5158915190531482, 0.5158915190531482, 0.5158915190531482, 0.5158915190531482, 0.5158915190531482, 0.5243139412547431, 0.5243139412547431, 0.5243139412547431, 0.5243139412547431, 0.5243139412547431, 0.5243139412547431, 0.5243139412547431, 0.5243139412547431, 0.5243139412547431, 0.5243139412547431, 0.5243139412547431, 0.5243139412547431]
Training raw path: /home/anhnd/DTI Project/Codes/MPNN/data/KFold/ATCInchikeySideEffectByDrug.txt_P3_6
('Number of substructures, proteins, pathways, drugs, se: ', 888, 1448, 330, 808, 331)
((646, 2666), (81, 2666), (646, 331), (81, 331))
('VALIDATE SUM PROTEIN TRAIN: ', 19352.0)
('VALIDATE SUM PROTEIN TEST: ', 2953.0)
((646, 331), (646, 331), 117055.71, 59017.0)
('Error: ', tensor(61166.7578, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.5003459439588213, 0.2757108908519804)
('Val: AUC, AUPR, Erros: ', 0.5055266558370154, 0.261436172622998, 7502.6567)
('Test: AUC, AUPR, Erros: ', 0.51818217916018, 0.27983991741822534, 7710.734)
((646, 331), (646, 331), 8.196387, 59017.0)
('Error: ', tensor(59013.3633, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.49949539366762935, 0.2759153164759673)
('Val: AUC, AUPR, Erros: ', 0.5, 0.25351534817798665, 6797.0)
('Test: AUC, AUPR, Erros: ', 0.5, 0.2645928909775838, 7094.0)
((646, 331), (646, 331), 3.8617568, 59017.0)
('Error: ', tensor(59015.1641, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.49971532177844563, 0.27615736810908614)
('Val: AUC, AUPR, Erros: ', 0.5, 0.25351534817798665, 6797.0)
('Test: AUC, AUPR, Erros: ', 0.5, 0.2645928909775838, 7094.0)
((646, 331), (646, 331), 2.5874343, 59017.0)
('Error: ', tensor(59015.6719, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.4997153830719839, 0.2761992366301135)
('Val: AUC, AUPR, Erros: ', 0.5, 0.25351534817798665, 6797.0)
('Test: AUC, AUPR, Erros: ', 0.5, 0.2645928909775838, 7094.0)
((646, 331), (646, 331), 2.4698155, 59017.0)
('Error: ', tensor(59015.6562, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.4997154559675133, 0.2762573199177294)
('Val: AUC, AUPR, Erros: ', 0.5, 0.25351534817798665, 6797.0)
('Test: AUC, AUPR, Erros: ', 0.5, 0.2645928909775838, 7094.0)
((646, 331), (646, 331), 2.7891464, 59017.0)
('Error: ', tensor(59015.3984, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.49972195986863965, 0.27634370769172995)
('Val: AUC, AUPR, Erros: ', 0.5, 0.25351534817798665, 6797.0)
('Test: AUC, AUPR, Erros: ', 0.5, 0.2645928909775838, 7094.0)
((646, 331), (646, 331), 3.3617177, 59017.0)
('Error: ', tensor(59014.9609, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.4997220058387934, 0.2764002266778677)
('Val: AUC, AUPR, Erros: ', 0.5, 0.25351534817798665, 6797.0)
('Test: AUC, AUPR, Erros: ', 0.5, 0.2645928909775838, 7094.0)
((646, 331), (646, 331), 4.1438956, 59017.0)
('Error: ', tensor(59014.3203, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.49972850766031757, 0.27646507514082647)
('Val: AUC, AUPR, Erros: ', 0.5, 0.25351534817798665, 6797.0)
('Test: AUC, AUPR, Erros: ', 0.5, 0.2645928909775838, 7094.0)
((646, 331), (646, 331), 5.15838, 59017.0)
('Error: ', tensor(59013.4141, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.49972856610808436, 0.27652155419353824)
('Val: AUC, AUPR, Erros: ', 0.5, 0.25351534817798665, 6797.0)
('Test: AUC, AUPR, Erros: ', 0.5, 0.2645928909775838, 7094.0)
((646, 331), (646, 331), 6.4674454, 59017.0)
('Error: ', tensor(59012.1406, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.49972862674490615, 0.2765841733654699)
('Val: AUC, AUPR, Erros: ', 0.5, 0.25351534817798665, 6797.0)
('Test: AUC, AUPR, Erros: ', 0.5, 0.2645928909775838, 7094.0)
((646, 331), (646, 331), 8.163773, 59017.0)
('Error: ', tensor(59010.3516, grad_fn=<AddBackward0>))
('Train: AUC, AUPR: ', 0.4997286905558576, 0.27664978911742943)
('Val: AUC, AUPR, Erros: ', 0.5, 0.25351534817798665, 6797.0)
('Test: AUC, AUPR, Erros: ', 0.5, 0.2645928909775838, 7094.0)
Train: 0.4995 0.2759
Test: 0.5000 0.2646
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[0.10105166895290352, 0.10987654320987654, 0.11636157230026963, 0.12051194925812662, 0.12446873102610807, 0.12703797945528225, 0.13041210224308816, 0.1403468908581383, 0.14584641138313453, 0.14841948175281508, 0.15174080606179371, 0.1541937126129566, 0.15656286468890118, 0.15814513700692562, 0.1617053190261913, 0.16537598204264872, 0.1693587860988742, 0.17352537722908093, 0.17690329218106995, 0.17959183673469387, 0.18026698785506373, 0.18400472185332742, 0.18760590656015494, 0.1915479582146249, 0.19291301479596645, 0.19693200663349916, 0.19862420846430687, 0.19939179375453886, 0.2004145264485897, 0.2012121212121212, 0.2064935635516893, 0.20870283428968875, 0.21210562414266118, 0.21475541979551144, 0.2182046453232894, 0.2201853930248992, 0.22126936780180628, 0.22508380345024936, 0.22508380345024936, 0.22758284600389864, 0.22869864399919046, 0.23058672135762256, 0.2316418149751483, 0.23642766698322254, 0.23981971389378798, 0.23981971389378798, 0.24058446632286296, 0.24058446632286296, 0.2430312912493206, 0.2440496923255544, 0.2440496923255544, 0.24672127995077112, 0.24672127995077112, 0.24672127995077112, 0.24672127995077112, 0.24672127995077112, 0.24672127995077112, 0.24672127995077112, 0.24981844589687727, 0.24981844589687727, 0.25140984606005184, 0.25302943969610636, 0.25302943969610636, 0.25302943969610636, 0.25302943969610636, 0.25302943969610636, 0.25302943969610636, 0.2548663182610013, 0.2548663182610013, 0.2548663182610013, 0.26038500506585616, 0.26038500506585616, 0.26038500506585616, 0.2624766180321736, 0.2624766180321736, 0.2624766180321736, 0.2624766180321736, 0.2624766180321736, 0.2645928909775838, 0.2645928909775838, 0.2645928909775838, 0.2645928909775838, 0.2645928909775838, 0.2645928909775838, 0.2645928909775838, 0.2645928909775838, 0.2645928909775838, 0.2645928909775838, 0.2645928909775838, 0.2645928909775838]
